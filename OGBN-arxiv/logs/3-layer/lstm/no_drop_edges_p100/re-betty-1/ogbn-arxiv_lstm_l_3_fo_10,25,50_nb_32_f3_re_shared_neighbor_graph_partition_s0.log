[03:30:02] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37292890 edges into 32 parts and get 12569171 edge cuts
main start at this time 1652239771.7695837
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02833247184753418
global_2_local spend time (sec) 0.04017353057861328
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004767656326293945
A = g.adjacency_matrix() spent  0.00714874267578125
auxiliary_graph
Graph(num_nodes=158265, num_edges=37383831,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.1625995635986328
remove nodes length
67324
auxiliary_graph.remove_nodes spent  2.4002866744995117
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37383831,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.6596102714538574

the counter of shared neighbor distribution
Counter({1.0: 28475226, 2.0: 5923800, 3.0: 1746856, 4.0: 610464, 5.0: 250590, 6.0: 118902, 7.0: 62202, 8.0: 35984, 9.0: 21766, 10.0: 14382, 11.0: 9346, 12.0: 6378, 13.0: 4572, 14.0: 3354, 15.0: 2406, 16.0: 1744, 17.0: 1196, 18.0: 914, 19.0: 674, 20.0: 572, 21.0: 382, 22.0: 354, 23.0: 214, 24.0: 166, 25.0: 128, 26.0: 100, 27.0: 52, 28.0: 40, 30.0: 38, 29.0: 30, 31.0: 14, 32.0: 12, 33.0: 8, 40.0: 4, 39.0: 4, 35.0: 4, 34.0: 4, 38.0: 4, 37.0: 2, 49.0: 2})
37292890
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37292887, 37292888, 37292889])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28475226, 2.0: 5923800, 3.0: 1746856, 4.0: 610464, 5.0: 250590, 6.0: 118902, 7.0: 62202, 8.0: 35984, 9.0: 21766, 10.0: 14382, 11.0: 9346, 12.0: 6378, 13.0: 4572, 14.0: 3354, 15.0: 2406, 16.0: 1744, 17.0: 1196, 18.0: 914, 19.0: 674, 20.0: 572, 21.0: 382, 22.0: 354, 23.0: 214, 24.0: 166, 25.0: 128, 26.0: 100, 27.0: 52, 28.0: 40, 30.0: 38, 29.0: 30, 31.0: 14, 32.0: 12, 33.0: 8, 40.0: 4, 39.0: 4, 35.0: 4, 34.0: 4, 38.0: 4, 37.0: 2, 49.0: 2})
Convert a graph into a bidirected graph: 2.502 seconds
Metis partitioning: 7.753 seconds
Split the graph: 0.948 seconds
Construct subgraphs: 0.129 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  11.35076117515564
2876
2850
2856
2904
2798
2891
2927
2778
2877
2891
2903
2856
2878
2890
2927
2918
2785
2759
2905
2758
2802
2816
2790
2920
2785
2768
2758
2900
2792
2758
2761
2864
total k batches seeds list generation spend  27.39677405357361
after graph partition
graph partition algorithm spend time 27.501619577407837
2876
2850
2856
2904
2798
2891
2927
2778
2877
2891
2903
2856
2878
2890
2927
2918
2785
2759
2905
2758
2802
2816
2790
2920
2785
2768
2758
2900
2792
2758
2761
2864
partition_len_list
[6090, 6861, 5915, 6530, 6999, 6005, 7920, 7492, 6221, 7720, 5442, 5910, 6688, 6061, 9591, 7296, 13567, 11555, 8279, 17891, 9227, 8299, 7174, 6645, 17545, 19804, 22746, 23512, 19706, 20948, 20614, 21640]
shared_neighbor_graph_partition_s0 selection method  spend 27.595409870147705
time for parepare:  0.01961994171142578
local_output_nid generation:  0.0005140304565429688
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0011889934539794922
r_  generation:  0.00984334945678711
local_output_nid generation:  0.0006785392761230469
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.00115966796875
r_  generation:  0.009644746780395508
local_output_nid generation:  0.0007264614105224609
local_in_edges_tensor generation:  0.0006787776947021484
mini_batch_src_global generation:  0.000934600830078125
r_  generation:  0.008645296096801758
local_output_nid generation:  0.0007202625274658203
local_in_edges_tensor generation:  0.0006544589996337891
mini_batch_src_global generation:  0.0006895065307617188
r_  generation:  0.00676274299621582
local_output_nid generation:  0.0006878376007080078
local_in_edges_tensor generation:  0.000690460205078125
mini_batch_src_global generation:  0.0008819103240966797
r_  generation:  0.009386062622070312
local_output_nid generation:  0.0006909370422363281
local_in_edges_tensor generation:  0.0007259845733642578
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.011302471160888672
local_output_nid generation:  0.0007014274597167969
local_in_edges_tensor generation:  0.0007498264312744141
mini_batch_src_global generation:  0.0010223388671875
r_  generation:  0.01104879379272461
local_output_nid generation:  0.0006568431854248047
local_in_edges_tensor generation:  0.0006680488586425781
mini_batch_src_global generation:  0.0009653568267822266
r_  generation:  0.009331464767456055
local_output_nid generation:  0.0006716251373291016
local_in_edges_tensor generation:  0.0006537437438964844
mini_batch_src_global generation:  0.0007560253143310547
r_  generation:  0.0077860355377197266
local_output_nid generation:  0.0006546974182128906
local_in_edges_tensor generation:  0.0006840229034423828
mini_batch_src_global generation:  0.00091552734375
r_  generation:  0.010003805160522461
local_output_nid generation:  0.000644683837890625
local_in_edges_tensor generation:  0.0006413459777832031
mini_batch_src_global generation:  0.0006883144378662109
r_  generation:  0.0070683956146240234
local_output_nid generation:  0.0006115436553955078
local_in_edges_tensor generation:  0.0006453990936279297
mini_batch_src_global generation:  0.0006492137908935547
r_  generation:  0.007360696792602539
local_output_nid generation:  0.0006000995635986328
local_in_edges_tensor generation:  0.0006723403930664062
mini_batch_src_global generation:  0.0008778572082519531
r_  generation:  0.008482694625854492
local_output_nid generation:  0.0006003379821777344
local_in_edges_tensor generation:  0.0006666183471679688
mini_batch_src_global generation:  0.0007624626159667969
r_  generation:  0.008441925048828125
local_output_nid generation:  0.00060272216796875
local_in_edges_tensor generation:  0.0007500648498535156
mini_batch_src_global generation:  0.0010106563568115234
r_  generation:  0.011095285415649414
local_output_nid generation:  0.0006122589111328125
local_in_edges_tensor generation:  0.0007088184356689453
mini_batch_src_global generation:  0.0009796619415283203
r_  generation:  0.010345458984375
local_output_nid generation:  0.0005745887756347656
local_in_edges_tensor generation:  0.0006868839263916016
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.010785102844238281
local_output_nid generation:  0.0005862712860107422
local_in_edges_tensor generation:  0.0006415843963623047
mini_batch_src_global generation:  0.0007960796356201172
r_  generation:  0.0076062679290771484
local_output_nid generation:  0.0006101131439208984
local_in_edges_tensor generation:  0.0006628036499023438
mini_batch_src_global generation:  0.000736236572265625
r_  generation:  0.008920907974243164
local_output_nid generation:  0.0005805492401123047
local_in_edges_tensor generation:  0.0008029937744140625
mini_batch_src_global generation:  0.0039250850677490234
r_  generation:  0.01658487319946289
local_output_nid generation:  0.0006511211395263672
local_in_edges_tensor generation:  0.0008394718170166016
mini_batch_src_global generation:  0.0010552406311035156
r_  generation:  0.009143590927124023
local_output_nid generation:  0.0006463527679443359
local_in_edges_tensor generation:  0.0006487369537353516
mini_batch_src_global generation:  0.0007009506225585938
r_  generation:  0.007273197174072266
local_output_nid generation:  0.0006594657897949219
local_in_edges_tensor generation:  0.0007238388061523438
mini_batch_src_global generation:  0.0006420612335205078
r_  generation:  0.0069141387939453125
local_output_nid generation:  0.0006785392761230469
local_in_edges_tensor generation:  0.0006530284881591797
mini_batch_src_global generation:  0.0006639957427978516
r_  generation:  0.007435798645019531
local_output_nid generation:  0.0006339550018310547
local_in_edges_tensor generation:  0.0007166862487792969
mini_batch_src_global generation:  0.0009894371032714844
r_  generation:  0.011056661605834961
local_output_nid generation:  0.0006260871887207031
local_in_edges_tensor generation:  0.005817413330078125
mini_batch_src_global generation:  0.0018281936645507812
r_  generation:  0.012249946594238281
local_output_nid generation:  0.0006337165832519531
local_in_edges_tensor generation:  0.0011222362518310547
mini_batch_src_global generation:  0.002196788787841797
r_  generation:  0.016757965087890625
local_output_nid generation:  0.0006849765777587891
local_in_edges_tensor generation:  0.0012009143829345703
mini_batch_src_global generation:  0.0026731491088867188
r_  generation:  0.021236658096313477
local_output_nid generation:  0.0008337497711181641
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.002075672149658203
r_  generation:  0.016383647918701172
local_output_nid generation:  0.0017240047454833984
local_in_edges_tensor generation:  0.0038461685180664062
mini_batch_src_global generation:  0.002301931381225586
r_  generation:  0.016700029373168945
local_output_nid generation:  0.00101470947265625
local_in_edges_tensor generation:  0.00131988525390625
mini_batch_src_global generation:  0.0021774768829345703
r_  generation:  0.01699233055114746
local_output_nid generation:  0.0009500980377197266
local_in_edges_tensor generation:  0.0011670589447021484
mini_batch_src_global generation:  0.002596139907836914
r_  generation:  0.023898601531982422
----------------------check_connections_block total spend ----------------------------- 0.5664806365966797
generate_one_block  0.020925521850585938
generate_one_block  0.015585660934448242
generate_one_block  0.012704610824584961
generate_one_block  0.009990930557250977
generate_one_block  0.013457298278808594
generate_one_block  0.015779972076416016
generate_one_block  0.018044233322143555
generate_one_block  0.018819808959960938
generate_one_block  0.01178598403930664
generate_one_block  0.015310525894165039
generate_one_block  0.009597063064575195
generate_one_block  0.010128974914550781
generate_one_block  0.011777162551879883
generate_one_block  0.011589288711547852
generate_one_block  0.017787456512451172
generate_one_block  0.014981985092163086
generate_one_block  0.016887187957763672
generate_one_block  0.011661052703857422
generate_one_block  0.011670589447021484
generate_one_block  0.024263620376586914
generate_one_block  0.014753341674804688
generate_one_block  0.010541677474975586
generate_one_block  0.009798288345336914
generate_one_block  0.010124444961547852
generate_one_block  0.017403364181518555
generate_one_block  0.019765377044677734
generate_one_block  0.024243593215942383
generate_one_block  0.030617237091064453
generate_one_block  0.022537708282470703
generate_one_block  0.024296045303344727
generate_one_block  0.02464604377746582
generate_one_block  0.030870914459228516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0527043342590332
gen group dst list time:  0.012007951736450195
time for parepare:  0.026035070419311523
local_output_nid generation:  0.0010433197021484375
local_in_edges_tensor generation:  0.013502836227416992
mini_batch_src_global generation:  0.0033140182495117188
r_  generation:  0.02521061897277832
local_output_nid generation:  0.0021631717681884766
local_in_edges_tensor generation:  0.0019087791442871094
mini_batch_src_global generation:  0.0038895606994628906
r_  generation:  0.027726411819458008
local_output_nid generation:  0.001584768295288086
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.0029115676879882812
r_  generation:  0.021457672119140625
local_output_nid generation:  0.0016748905181884766
local_in_edges_tensor generation:  0.0013103485107421875
mini_batch_src_global generation:  0.0022077560424804688
r_  generation:  0.018641233444213867
local_output_nid generation:  0.0016105175018310547
local_in_edges_tensor generation:  0.0015363693237304688
mini_batch_src_global generation:  0.003116130828857422
r_  generation:  0.02751898765563965
local_output_nid generation:  0.0013966560363769531
local_in_edges_tensor generation:  0.0014667510986328125
mini_batch_src_global generation:  0.0032379627227783203
r_  generation:  0.02461695671081543
local_output_nid generation:  0.0018665790557861328
local_in_edges_tensor generation:  0.0020279884338378906
mini_batch_src_global generation:  0.003968000411987305
r_  generation:  0.0339818000793457
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.0025119781494140625
mini_batch_src_global generation:  0.003711700439453125
r_  generation:  0.02936077117919922
local_output_nid generation:  0.0015022754669189453
local_in_edges_tensor generation:  0.0017583370208740234
mini_batch_src_global generation:  0.0027205944061279297
r_  generation:  0.02002406120300293
local_output_nid generation:  0.001756906509399414
local_in_edges_tensor generation:  0.0019876956939697266
mini_batch_src_global generation:  0.003181934356689453
r_  generation:  0.03076648712158203
local_output_nid generation:  0.0013196468353271484
local_in_edges_tensor generation:  0.0012912750244140625
mini_batch_src_global generation:  0.002284526824951172
r_  generation:  0.01595306396484375
local_output_nid generation:  0.001367807388305664
local_in_edges_tensor generation:  0.0013163089752197266
mini_batch_src_global generation:  0.0020487308502197266
r_  generation:  0.01816391944885254
local_output_nid generation:  0.001657724380493164
local_in_edges_tensor generation:  0.0014739036560058594
mini_batch_src_global generation:  0.0026597976684570312
r_  generation:  0.023526430130004883
local_output_nid generation:  0.0013835430145263672
local_in_edges_tensor generation:  0.0012881755828857422
mini_batch_src_global generation:  0.002507925033569336
r_  generation:  0.020125150680541992
local_output_nid generation:  0.0023055076599121094
local_in_edges_tensor generation:  0.003620624542236328
mini_batch_src_global generation:  0.009029150009155273
r_  generation:  0.041016340255737305
local_output_nid generation:  0.0017669200897216797
local_in_edges_tensor generation:  0.002279520034790039
mini_batch_src_global generation:  0.007235050201416016
r_  generation:  0.03225111961364746
local_output_nid generation:  0.003228902816772461
local_in_edges_tensor generation:  0.003595113754272461
mini_batch_src_global generation:  0.007292270660400391
r_  generation:  0.06945109367370605
local_output_nid generation:  0.0031423568725585938
local_in_edges_tensor generation:  0.003316164016723633
mini_batch_src_global generation:  0.0067670345306396484
r_  generation:  0.0976259708404541
local_output_nid generation:  0.0026128292083740234
local_in_edges_tensor generation:  0.002674579620361328
mini_batch_src_global generation:  0.003766298294067383
r_  generation:  0.03541111946105957
local_output_nid generation:  0.004132509231567383
local_in_edges_tensor generation:  0.005041837692260742
mini_batch_src_global generation:  0.010356664657592773
r_  generation:  0.104888916015625
local_output_nid generation:  0.0025870800018310547
local_in_edges_tensor generation:  0.0024077892303466797
mini_batch_src_global generation:  0.005316495895385742
r_  generation:  0.04020285606384277
local_output_nid generation:  0.002347707748413086
local_in_edges_tensor generation:  0.0023317337036132812
mini_batch_src_global generation:  0.0028905868530273438
r_  generation:  0.031549930572509766
local_output_nid generation:  0.0018894672393798828
local_in_edges_tensor generation:  0.0017991065979003906
mini_batch_src_global generation:  0.002166271209716797
r_  generation:  0.025279521942138672
local_output_nid generation:  0.00170135498046875
local_in_edges_tensor generation:  0.0015516281127929688
mini_batch_src_global generation:  0.0018362998962402344
r_  generation:  0.021511077880859375
local_output_nid generation:  0.004006862640380859
local_in_edges_tensor generation:  0.005461931228637695
mini_batch_src_global generation:  0.009256839752197266
r_  generation:  0.09767556190490723
local_output_nid generation:  0.005118608474731445
local_in_edges_tensor generation:  0.009432792663574219
mini_batch_src_global generation:  0.01440739631652832
r_  generation:  0.1169283390045166
local_output_nid generation:  0.005686521530151367
local_in_edges_tensor generation:  0.011876106262207031
mini_batch_src_global generation:  0.01561427116394043
r_  generation:  0.14290595054626465
local_output_nid generation:  0.005720853805541992
local_in_edges_tensor generation:  0.008607864379882812
mini_batch_src_global generation:  0.016953468322753906
r_  generation:  0.1454324722290039
local_output_nid generation:  0.005120277404785156
local_in_edges_tensor generation:  0.009250640869140625
mini_batch_src_global generation:  0.014457941055297852
r_  generation:  0.12435650825500488
local_output_nid generation:  0.005377769470214844
local_in_edges_tensor generation:  0.010708332061767578
mini_batch_src_global generation:  0.021439075469970703
r_  generation:  0.12876057624816895
local_output_nid generation:  0.005167245864868164
local_in_edges_tensor generation:  0.008306026458740234
mini_batch_src_global generation:  0.014889001846313477
r_  generation:  0.13035058975219727
local_output_nid generation:  0.005258083343505859
local_in_edges_tensor generation:  0.006554365158081055
mini_batch_src_global generation:  0.016305208206176758
r_  generation:  0.14084911346435547
----------------------check_connections_block total spend ----------------------------- 2.6888062953948975
generate_one_block  0.033431053161621094
generate_one_block  0.03689384460449219
generate_one_block  0.027886629104614258
generate_one_block  0.02302718162536621
generate_one_block  0.03568077087402344
generate_one_block  0.031804800033569336
generate_one_block  0.04493069648742676
generate_one_block  0.0379636287689209
generate_one_block  0.025325536727905273
generate_one_block  0.03924131393432617
generate_one_block  0.018673419952392578
generate_one_block  0.04285836219787598
generate_one_block  0.03103327751159668
generate_one_block  0.024790525436401367
generate_one_block  0.057035207748413086
generate_one_block  0.04010748863220215
generate_one_block  0.0963125228881836
generate_one_block  0.07586669921875
generate_one_block  0.040373802185058594
generate_one_block  0.1484057903289795
generate_one_block  0.05498242378234863
generate_one_block  0.04234170913696289
generate_one_block  0.03206443786621094
generate_one_block  0.028563499450683594
generate_one_block  0.1548781394958496
generate_one_block  0.17437124252319336
generate_one_block  0.2006847858428955
generate_one_block  0.21539068222045898
generate_one_block  0.16777944564819336
generate_one_block  0.17899227142333984
generate_one_block  0.17644405364990234
generate_one_block  0.19666528701782227
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03376603126525879
gen group dst list time:  0.04183769226074219
time for parepare:  0.02357769012451172
local_output_nid generation:  0.003106355667114258
local_in_edges_tensor generation:  0.018545150756835938
mini_batch_src_global generation:  0.004687309265136719
r_  generation:  0.051782846450805664
local_output_nid generation:  0.006414651870727539
local_in_edges_tensor generation:  0.006366252899169922
mini_batch_src_global generation:  0.00649261474609375
r_  generation:  0.06709885597229004
local_output_nid generation:  0.005494594573974609
local_in_edges_tensor generation:  0.004751682281494141
mini_batch_src_global generation:  0.0056612491607666016
r_  generation:  0.0577089786529541
local_output_nid generation:  0.004771232604980469
local_in_edges_tensor generation:  0.004313945770263672
mini_batch_src_global generation:  0.004208087921142578
r_  generation:  0.04427361488342285
local_output_nid generation:  0.0054399967193603516
local_in_edges_tensor generation:  0.005251169204711914
mini_batch_src_global generation:  0.00549626350402832
r_  generation:  0.0561220645904541
local_output_nid generation:  0.004125356674194336
local_in_edges_tensor generation:  0.004228115081787109
mini_batch_src_global generation:  0.004756927490234375
r_  generation:  0.047870635986328125
local_output_nid generation:  0.004940509796142578
local_in_edges_tensor generation:  0.004964113235473633
mini_batch_src_global generation:  0.0063135623931884766
r_  generation:  0.058330535888671875
local_output_nid generation:  0.004817962646484375
local_in_edges_tensor generation:  0.0056285858154296875
mini_batch_src_global generation:  0.0056345462799072266
r_  generation:  0.05611562728881836
local_output_nid generation:  0.004711627960205078
local_in_edges_tensor generation:  0.0050506591796875
mini_batch_src_global generation:  0.005055427551269531
r_  generation:  0.04934239387512207
local_output_nid generation:  0.005820512771606445
local_in_edges_tensor generation:  0.00666356086730957
mini_batch_src_global generation:  0.007101535797119141
r_  generation:  0.07532358169555664
local_output_nid generation:  0.0032536983489990234
local_in_edges_tensor generation:  0.003190755844116211
mini_batch_src_global generation:  0.0040509700775146484
r_  generation:  0.0325927734375
local_output_nid generation:  0.0037958621978759766
local_in_edges_tensor generation:  0.00418543815612793
mini_batch_src_global generation:  0.0036230087280273438
r_  generation:  0.041376352310180664
local_output_nid generation:  0.004165172576904297
local_in_edges_tensor generation:  0.00493311882019043
mini_batch_src_global generation:  0.00464940071105957
r_  generation:  0.05016756057739258
local_output_nid generation:  0.0033190250396728516
local_in_edges_tensor generation:  0.003642559051513672
mini_batch_src_global generation:  0.00389862060546875
r_  generation:  0.038909196853637695
local_output_nid generation:  0.0075664520263671875
local_in_edges_tensor generation:  0.009526252746582031
mini_batch_src_global generation:  0.009491920471191406
r_  generation:  0.10710763931274414
local_output_nid generation:  0.0063707828521728516
local_in_edges_tensor generation:  0.00727534294128418
mini_batch_src_global generation:  0.009106159210205078
r_  generation:  0.0809776782989502
local_output_nid generation:  0.010241270065307617
local_in_edges_tensor generation:  0.013200044631958008
mini_batch_src_global generation:  0.013682126998901367
r_  generation:  0.15222716331481934
local_output_nid generation:  0.010788202285766602
local_in_edges_tensor generation:  0.01468968391418457
mini_batch_src_global generation:  0.015208244323730469
r_  generation:  0.1517963409423828
local_output_nid generation:  0.0071811676025390625
local_in_edges_tensor generation:  0.008252620697021484
mini_batch_src_global generation:  0.010315179824829102
r_  generation:  0.09282040596008301
local_output_nid generation:  0.012120246887207031
local_in_edges_tensor generation:  0.01840686798095703
mini_batch_src_global generation:  0.018558502197265625
r_  generation:  0.18530774116516113
local_output_nid generation:  0.008304834365844727
local_in_edges_tensor generation:  0.01009368896484375
mini_batch_src_global generation:  0.012614965438842773
r_  generation:  0.10976815223693848
local_output_nid generation: [03:30:20] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2768 nodes and 171320 edges into 2 parts and get 12566 edge cuts
 0.007818460464477539
local_in_edges_tensor generation:  0.009208917617797852
mini_batch_src_global generation:  0.010751008987426758
r_  generation:  0.09735560417175293
local_output_nid generation:  0.0060350894927978516
local_in_edges_tensor generation:  0.0066797733306884766
mini_batch_src_global generation:  0.007709980010986328
r_  generation:  0.07470226287841797
local_output_nid generation:  0.005772590637207031
local_in_edges_tensor generation:  0.006294965744018555
mini_batch_src_global generation:  0.0070078372955322266
r_  generation:  0.0672910213470459
local_output_nid generation:  0.016692399978637695
local_in_edges_tensor generation:  0.022753000259399414
mini_batch_src_global generation:  0.020109176635742188
r_  generation:  0.231309175491333
local_output_nid generation:  0.015154361724853516
local_in_edges_tensor generation:  0.022831439971923828
mini_batch_src_global generation:  0.025440454483032227
r_  generation:  0.24483966827392578
local_output_nid generation:  0.014523744583129883
local_in_edges_tensor generation:  0.0228271484375
mini_batch_src_global generation:  0.02387380599975586
r_  generation:  0.2340865135192871
local_output_nid generation:  0.014093637466430664
local_in_edges_tensor generation:  0.020939350128173828
mini_batch_src_global generation:  0.023218154907226562
r_  generation:  0.22550463676452637
local_output_nid generation:  0.014140605926513672
local_in_edges_tensor generation:  0.018861770629882812
mini_batch_src_global generation:  0.022770166397094727
r_  generation:  0.23768138885498047
local_output_nid generation:  0.014398336410522461
local_in_edges_tensor generation:  0.02184748649597168
mini_batch_src_global generation:  0.022237539291381836
r_  generation:  0.2067568302154541
local_output_nid generation:  0.013213872909545898
local_in_edges_tensor generation:  0.02392745018005371
mini_batch_src_global generation:  0.02315354347229004
r_  generation:  0.2130734920501709
local_output_nid generation:  0.012737512588500977
local_in_edges_tensor generation:  0.019283294677734375
mini_batch_src_global generation:  0.020771026611328125
r_  generation:  0.19698262214660645
----------------------check_connections_block total spend ----------------------------- 5.337184429168701
generate_one_block  0.06839227676391602
generate_one_block  0.08050942420959473
generate_one_block  0.06823539733886719
generate_one_block  0.05618715286254883
generate_one_block  0.07359743118286133
generate_one_block  0.06136941909790039
generate_one_block  0.07203030586242676
generate_one_block  0.07059812545776367
generate_one_block  0.06268596649169922
generate_one_block  0.09970593452453613
generate_one_block  0.03990745544433594
generate_one_block  0.05386495590209961
generate_one_block  0.06401824951171875
generate_one_block  0.04917335510253906
generate_one_block  0.14000248908996582
generate_one_block  0.13707733154296875
generate_one_block  0.18940067291259766
generate_one_block  0.18882131576538086
generate_one_block  0.11138105392456055
generate_one_block  0.23807644844055176
generate_one_block  0.13700127601623535
generate_one_block  0.12249755859375
generate_one_block  0.08958172798156738
generate_one_block  0.08566880226135254
generate_one_block  0.29586267471313477
generate_one_block  0.30326294898986816
generate_one_block  0.28675413131713867
generate_one_block  0.27790284156799316
generate_one_block  0.27503180503845215
generate_one_block  0.25867342948913574
generate_one_block  0.2546675205230713
generate_one_block  0.24442672729492188
global_2_local spend time (sec) 0.00410008430480957
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0008854866027832031
A = g.adjacency_matrix() spent  0.0005199909210205078
auxiliary_graph
Graph(num_nodes=19804, num_edges=174088,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013173341751098633
remove nodes length
17036
auxiliary_graph.remove_nodes spent  0.006973981857299805
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2768, num_edges=174088,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.006353855133056641

the counter of shared neighbor distribution
Counter({1.0: 135864, 2.0: 24416, 3.0: 6790, 4.0: 2208, 5.0: 922, 6.0: 448, 7.0: 256, 8.0: 156, 9.0: 96, 10.0: 52, 11.0: 32, 12.0: 30, 13.0: 12, 17.0: 6, 15.0: 6, 16.0: 6, 23.0: 4, 28.0: 4, 14.0: 4, 18.0: 2, 21.0: 2, 20.0: 2, 26.0: 2})
171320
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 171317, 171318, 171319])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 135864, 2.0: 24416, 3.0: 6790, 4.0: 2208, 5.0: 922, 6.0: 448, 7.0: 256, 8.0: 156, 9.0: 96, 10.0: 52, 11.0: 32, 12.0: 30, 13.0: 12, 17.0: 6, 15.0: 6, 16.0: 6, 23.0: 4, 28.0: 4, 14.0: 4, 18.0: 2, 21.0: 2, 20.0: 2, 26.0: 2})
Convert a graph into a bidirected graph: 0.005 seconds
Metis partitioning: 0.014 seconds
Split the graph: 0.027 seconds
Construct subgraphs: 0.018 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.06312108039855957
1360
1408
total k batches seeds list generation spend  0.16656112670898438
after graph partition
graph partition algorithm spend time 0.1738722324371338
1360
1408
time for parepare:  0.03636670112609863
local_output_nid generation:  0.000347137451171875
local_in_edges_tensor generation:  0.0041925907135009766
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.006803750991821289
local_output_nid generation:  0.0003330707550048828
local_in_edges_tensor generation:  0.0021834373474121094
mini_batch_src_global generation:  0.0016961097717285156
r_  generation:  0.011348485946655273
----------------------check_connections_block total spend ----------------------------- 0.07642960548400879
generate_one_block  0.011227130889892578
generate_one_block  0.017132282257080078
time for parepare:  0.021761417388916016
local_output_nid generation:  0.0012793540954589844
local_in_edges_tensor generation:  0.008798360824584961
mini_batch_src_global generation:  0.003931283950805664
r_  generation:  0.039299964904785156
local_output_nid generation:  0.004338979721069336
local_in_edges_tensor generation:  0.005629301071166992
mini_batch_src_global generation:  0.009912967681884766
r_  generation:  0.10357546806335449
----------------------check_connections_block total spend ----------------------------- 0.23713374137878418
generate_one_block  0.05187559127807617
generate_one_block  0.1342606544494629
time for parepare:  0.02318596839904785
local_output_nid generation:  0.006216764450073242
local_in_edges_tensor generation:  0.015764236450195312
mini_batch_src_global generation:  0.012611150741577148
r_  generation:  0.12013912200927734
local_output_nid generation:  0.016228675842285156
local_in_edges_tensor generation:  0.021174192428588867
mini_batch_src_global generation:  0.019230365753173828
r_  generation:  0.2101602554321289
----------------------check_connections_block total spend ----------------------------- 0.5242331027984619
generate_one_block  0.1617445945739746
generate_one_block  0.2585136890411377
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  8.025990724563599
block generation total time  7.091166734695435
average batch blocks generation time:  0.22159896045923233
pseudo mini batch 0 input nodes size: 31884
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.02085590362548828  GigaBytes
Max Memory Allocated: 0.02085590362548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.020877361297607422  GigaBytes
Max Memory Allocated: 0.020877361297607422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.020877361297607422  GigaBytes
Max Memory Allocated: 0.020877361297607422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8916015625 GB
    Memory Allocated: 0.022461414337158203  GigaBytes
Max Memory Allocated: 0.022461414337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8916015625 GB
    Memory Allocated: 0.022461414337158203  GigaBytes
Max Memory Allocated: 0.022461414337158203  GigaBytes

first layer input nodes number: 31884
first layer output nodes number: 16263
edges number: 121531
input nodes number: 16263
output nodes number: 6090
edges number: 63929
input nodes number: 6090
output nodes number: 2876
edges number: 26897
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3291015625 GB
    Memory Allocated: 2.345109462738037  GigaBytes
Max Memory Allocated: 2.3757662773132324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3291015625 GB
    Memory Allocated: 2.3451104164123535  GigaBytes
Max Memory Allocated: 2.3757662773132324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.5126953125 GB
    Memory Allocated: 0.03115224838256836  GigaBytes
Max Memory Allocated: 2.3757662773132324  GigaBytes

pseudo mini batch 1 input nodes size: 45445
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.5126953125 GB
    Memory Allocated: 0.026533126831054688  GigaBytes
Max Memory Allocated: 2.3757662773132324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.5126953125 GB
    Memory Allocated: 0.026533126831054688  GigaBytes
Max Memory Allocated: 2.3757662773132324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.5126953125 GB
    Memory Allocated: 0.0482029914855957  GigaBytes
Max Memory Allocated: 2.3757662773132324  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.5126953125 GB
    Memory Allocated: 0.048224449157714844  GigaBytes
Max Memory Allocated: 2.3757662773132324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.5126953125 GB
    Memory Allocated: 0.0325779914855957  GigaBytes
Max Memory Allocated: 2.3757662773132324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.5126953125 GB
    Memory Allocated: 0.03442716598510742  GigaBytes
Max Memory Allocated: 2.3757662773132324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5126953125 GB
    Memory Allocated: 0.03442716598510742  GigaBytes
Max Memory Allocated: 2.3757662773132324  GigaBytes

first layer input nodes number: 45445
first layer output nodes number: 19979
edges number: 150900
input nodes number: 19979
output nodes number: 6861
edges number: 71110
input nodes number: 6861
output nodes number: 2850
edges number: 26033
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0263671875 GB
    Memory Allocated: 2.6925559043884277  GigaBytes
Max Memory Allocated: 2.722445487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0263671875 GB
    Memory Allocated: 2.692556381225586  GigaBytes
Max Memory Allocated: 2.722445487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03797149658203125  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

pseudo mini batch 2 input nodes size: 44828
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03257417678833008  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03257417678833008  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.05405855178833008  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.05408000946044922  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03238868713378906  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.033883094787597656  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.033883094787597656  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

first layer input nodes number: 44828
first layer output nodes number: 17299
edges number: 125807
input nodes number: 17299
output nodes number: 5915
edges number: 52007
input nodes number: 5915
output nodes number: 2856
edges number: 22561
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 2.164950370788574  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 2.1649508476257324  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03682374954223633  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

pseudo mini batch 3 input nodes size: 41293
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03238964080810547  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03238964080810547  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.05207967758178711  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.05210161209106445  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.030595779418945312  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.031752586364746094  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.031752586364746094  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

first layer input nodes number: 41293
first layer output nodes number: 15465
edges number: 97089
input nodes number: 15465
output nodes number: 6530
edges number: 41617
input nodes number: 6530
output nodes number: 2904
edges number: 16360
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 1.7168550491333008  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 1.716855525970459  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03418445587158203  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

pseudo mini batch 4 input nodes size: 38948
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03060293197631836  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03060293197631836  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.05013418197631836  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.0501551628112793  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.030443191528320312  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.0321197509765625  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.0321197509765625  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

first layer input nodes number: 38948
first layer output nodes number: 18250
edges number: 130621
input nodes number: 18250
output nodes number: 6999
edges number: 69061
input nodes number: 6999
output nodes number: 2798
edges number: 25181
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 2.4905905723571777  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 2.490591049194336  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03537178039550781  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

pseudo mini batch 5 input nodes size: 36581
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03042745590209961  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.03042745590209961  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.047870635986328125  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.04789257049560547  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.02834033966064453  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.02989673614501953  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1611328125 GB
    Memory Allocated: 0.02989673614501953  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

first layer input nodes number: 36581
first layer output nodes number: 15544
edges number: 114650
input nodes number: 15544
output nodes number: 6005
edges number: 62514
input nodes number: 6005
output nodes number: 2891
edges number: 31522
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2314453125 GB
    Memory Allocated: 2.3660974502563477  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2314453125 GB
    Memory Allocated: 2.366097927093506  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.03295707702636719  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

pseudo mini batch 6 input nodes size: 36019
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.028354167938232422  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.028354167938232422  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.04552936553955078  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.045551300048828125  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.028086185455322266  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02999734878540039  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02999734878540039  GigaBytes
Max Memory Allocated: 2.729030132293701  GigaBytes

first layer input nodes number: 36019
first layer output nodes number: 18743
edges number: 136835
input nodes number: 18743
output nodes number: 7920
edges number: 89379
input nodes number: 7920
output nodes number: 2927
edges number: 30016
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3525390625 GB
    Memory Allocated: 2.918574810028076  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3525390625 GB
    Memory Allocated: 2.9185752868652344  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.033702850341796875  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

pseudo mini batch 7 input nodes size: 39282
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.0280914306640625  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.0280914306640625  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.0476226806640625  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.04764366149902344  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.030446529388427734  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.0321803092956543  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.0321803092956543  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

first layer input nodes number: 39282
first layer output nodes number: 18661
edges number: 132941
input nodes number: 18661
output nodes number: 7492
edges number: 74764
input nodes number: 7492
output nodes number: 2778
edges number: 24825
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 2.6033573150634766  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 2.6033577919006348  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.03554582595825195  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

pseudo mini batch 8 input nodes size: 42515
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.03042459487915039  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.03042459487915039  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.05069732666015625  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.05071878433227539  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.031166553497314453  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.0325007438659668  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.0325007438659668  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

first layer input nodes number: 42515
first layer output nodes number: 16851
edges number: 113585
input nodes number: 16851
output nodes number: 6221
edges number: 46196
input nodes number: 6221
output nodes number: 2877
edges number: 19158
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 1.936997413635254  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 1.936997890472412  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.035204410552978516  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

pseudo mini batch 9 input nodes size: 60338
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.03118133544921875  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.03118133544921875  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.059952735900878906  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.05997467041015625  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.03968048095703125  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.041736602783203125  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5283203125 GB
    Memory Allocated: 0.041736602783203125  GigaBytes
Max Memory Allocated: 2.9523839950561523  GigaBytes

first layer input nodes number: 60338
first layer output nodes number: 23532
edges number: 174159
input nodes number: 23532
output nodes number: 7720
edges number: 74981
input nodes number: 7720
output nodes number: 2891
edges number: 26723
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7509765625 GB
    Memory Allocated: 2.9524898529052734  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7509765625 GB
    Memory Allocated: 2.9524903297424316  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.04573535919189453  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

pseudo mini batch 10 input nodes size: 27705
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03968238830566406  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03968238830566406  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.05289316177368164  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.052915096282958984  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.024121761322021484  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.025023937225341797  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.025023937225341797  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

first layer input nodes number: 27705
first layer output nodes number: 11542
edges number: 70018
input nodes number: 11542
output nodes number: 5442
edges number: 34002
input nodes number: 5442
output nodes number: 2903
edges number: 16832
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 1.3741331100463867  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 1.374133586883545  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.026929378509521484  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

pseudo mini batch 11 input nodes size: 38027
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.024123668670654297  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.024123668670654297  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.04225635528564453  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.04227781295776367  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.02904510498046875  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03020000457763672  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03020000457763672  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

first layer input nodes number: 38027
first layer output nodes number: 14731
edges number: 95291
input nodes number: 14731
output nodes number: 5910
edges number: 41518
input nodes number: 5910
output nodes number: 2856
edges number: 18009
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 1.7184934616088867  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 1.718493938446045  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03257274627685547  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

pseudo mini batch 12 input nodes size: 40141
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.029037952423095703  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.029037952423095703  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.0485692024230957  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.048590660095214844  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03043651580810547  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03189563751220703  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03189563751220703  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

first layer input nodes number: 40141
first layer output nodes number: 17185
edges number: 116650
input nodes number: 17185
output nodes number: 6688
edges number: 57316
input nodes number: 6688
output nodes number: 2878
edges number: 21657
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 2.162208080291748  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 2.1622085571289062  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.034815311431884766  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

pseudo mini batch 13 input nodes size: 31305
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03043985366821289  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03043985366821289  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.04606485366821289  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.046086788177490234  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.026534080505371094  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.027715682983398438  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.027715682983398438  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

first layer input nodes number: 31305
first layer output nodes number: 13668
edges number: 89922
input nodes number: 13668
output nodes number: 6061
edges number: 47010
input nodes number: 6061
output nodes number: 2890
edges number: 21391
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 1.800957202911377  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 1.8009576797485352  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.03011941909790039  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

pseudo mini batch 14 input nodes size: 73969
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.026535987854003906  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.026535987854003906  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.06180715560913086  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.0618290901184082  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.04618215560913086  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.04906892776489258  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8955078125 GB
    Memory Allocated: 0.04906892776489258  GigaBytes
Max Memory Allocated: 2.983098030090332  GigaBytes

first layer input nodes number: 73969
first layer output nodes number: 32282
edges number: 249629
input nodes number: 32282
output nodes number: 9591
edges number: 107663
input nodes number: 9591
output nodes number: 2927
edges number: 29893
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4736328125 GB
    Memory Allocated: 4.081119060516357  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4736328125 GB
    Memory Allocated: 4.081119537353516  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.05450868606567383  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

pseudo mini batch 15 input nodes size: 59789
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.046187400817871094  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.046187400817871094  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.07469701766967773  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.07471895217895508  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.03942584991455078  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.04156494140625  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.04156494140625  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

first layer input nodes number: 59789
first layer output nodes number: 23709
edges number: 182068
input nodes number: 23709
output nodes number: 7296
edges number: 77224
input nodes number: 7296
output nodes number: 2918
edges number: 27604
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 3.063727378845215  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 3.063727855682373  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.04565858840942383  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

pseudo mini batch 16 input nodes size: 80063
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.03942441940307617  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.03942441940307617  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.07848691940307617  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.07850790023803711  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.049976348876953125  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.054183006286621094  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6806640625 GB
    Memory Allocated: 0.054183006286621094  GigaBytes
Max Memory Allocated: 4.114797592163086  GigaBytes

first layer input nodes number: 80063
first layer output nodes number: 43035
edges number: 351690
input nodes number: 43035
output nodes number: 13567
edges number: 184281
input nodes number: 13567
output nodes number: 2785
edges number: 28458
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2666015625 GB
    Memory Allocated: 5.997208595275879  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2666015625 GB
    Memory Allocated: 5.997209072113037  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.061850547790527344  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

pseudo mini batch 17 input nodes size: 87516
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.0499567985534668  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.0499567985534668  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.09168767929077148  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.09170866012573242  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.052625179290771484  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.05638742446899414  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.05638742446899414  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

first layer input nodes number: 87516
first layer output nodes number: 43985
edges number: 348779
input nodes number: 43985
output nodes number: 11555
edges number: 137060
input nodes number: 11555
output nodes number: 2759
edges number: 18953
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 5.163298606872559  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 5.163299083709717  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.06359529495239258  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

pseudo mini batch 18 input nodes size: 67186
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.05262136459350586  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.05262136459350586  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.08465814590454102  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.08468008041381836  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.042928218841552734  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.045125484466552734  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.045125484466552734  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

first layer input nodes number: 67186
first layer output nodes number: 27092
edges number: 200024
input nodes number: 27092
output nodes number: 8279
edges number: 74487
input nodes number: 8279
output nodes number: 2905
edges number: 20319
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 3.069657802581787  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 3.0696582794189453  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.0493769645690918  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

pseudo mini batch 19 input nodes size: 87590
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.042949676513671875  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.042949676513671875  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.0847158432006836  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.08473682403564453  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.05267810821533203  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.05841636657714844  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6220703125 GB
    Memory Allocated: 0.05841636657714844  GigaBytes
Max Memory Allocated: 6.029699802398682  GigaBytes

first layer input nodes number: 87590
first layer output nodes number: 53112
edges number: 447106
input nodes number: 53112
output nodes number: 17891
edges number: 281725
input nodes number: 17891
output nodes number: 2758
edges number: 41176
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.7587890625 GB
    Memory Allocated: 8.33763837814331  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.7587890625 GB
    Memory Allocated: 8.337638854980469  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.0690760612487793  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

pseudo mini batch 20 input nodes size: 75122
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.05265617370605469  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.05265617370605469  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.08847713470458984  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.08849811553955078  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.046710968017578125  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.049460411071777344  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.049460411071777344  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

first layer input nodes number: 75122
first layer output nodes number: 32320
edges number: 248762
input nodes number: 32320
output nodes number: 9227
edges number: 97383
input nodes number: 9227
output nodes number: 2802
edges number: 22765
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 3.8164095878601074  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 3.8164100646972656  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.05463409423828125  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

pseudo mini batch 21 input nodes size: 73468
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.04671764373779297  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.04671764373779297  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.08187389373779297  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.0818948745727539  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.04605293273925781  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.048422813415527344  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.048422813415527344  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

first layer input nodes number: 73468
first layer output nodes number: 29741
edges number: 223195
input nodes number: 29741
output nodes number: 8299
edges number: 77177
input nodes number: 8299
output nodes number: 2816
edges number: 17648
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 3.2629880905151367  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 3.262988567352295  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.0529322624206543  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

pseudo mini batch 22 input nodes size: 58044
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.046054840087890625  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.046054840087890625  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.07373237609863281  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.07375335693359375  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.03857612609863281  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.04033088684082031  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.04033088684082031  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

first layer input nodes number: 58044
first layer output nodes number: 22412
edges number: 160923
input nodes number: 22412
output nodes number: 7174
edges number: 58103
input nodes number: 7174
output nodes number: 2790
edges number: 16329
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 2.4759373664855957  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 2.475937843322754  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.04376554489135742  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

pseudo mini batch 23 input nodes size: 59529
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.03857231140136719  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.03857231140136719  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.06695795059204102  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.06697988510131836  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.039281368255615234  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.0409388542175293  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.0409388542175293  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

first layer input nodes number: 59529
first layer output nodes number: 21193
edges number: 152980
input nodes number: 21193
output nodes number: 6645
edges number: 51401
input nodes number: 6645
output nodes number: 2920
edges number: 17800
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 2.3277735710144043  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 2.3277740478515625  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.04423332214355469  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

pseudo mini batch 24 input nodes size: 108162
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.03930091857910156  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.03930091857910156  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.09087657928466797  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.0908975601196289  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.062489986419677734  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.06870412826538086  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2978515625 GB
    Memory Allocated: 0.06870412826538086  GigaBytes
Max Memory Allocated: 8.388736724853516  GigaBytes

first layer input nodes number: 108162
first layer output nodes number: 65870
edges number: 548028
input nodes number: 65870
output nodes number: 17545
edges number: 257312
input nodes number: 17545
output nodes number: 2785
edges number: 28435
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8916015625 GB
    Memory Allocated: 8.620888233184814  GigaBytes
Max Memory Allocated: 8.653822898864746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8916015625 GB
    Memory Allocated: 8.620888710021973  GigaBytes
Max Memory Allocated: 8.653822898864746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.3837890625 GB
    Memory Allocated: 0.07973384857177734  GigaBytes
Max Memory Allocated: 8.653822898864746  GigaBytes

pseudo mini batch 25 input nodes size: 98469
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.3837890625 GB
    Memory Allocated: 0.0624699592590332  GigaBytes
Max Memory Allocated: 8.653822898864746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.3837890625 GB
    Memory Allocated: 0.0624699592590332  GigaBytes
Max Memory Allocated: 8.653822898864746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.3837890625 GB
    Memory Allocated: 0.10942363739013672  GigaBytes
Max Memory Allocated: 8.653822898864746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.3837890625 GB
    Memory Allocated: 0.10944461822509766  GigaBytes
Max Memory Allocated: 8.653822898864746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.3837890625 GB
    Memory Allocated: 0.05784797668457031  GigaBytes
Max Memory Allocated: 8.653822898864746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.3837890625 GB
    Memory Allocated: 0.06546449661254883  GigaBytes
Max Memory Allocated: 8.653822898864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3837890625 GB
    Memory Allocated: 0.06546449661254883  GigaBytes
Max Memory Allocated: 8.653822898864746  GigaBytes

first layer input nodes number: 98469
first layer output nodes number: 65821
edges number: 552595
input nodes number: 65821
output nodes number: 22746
edges number: 380893
input nodes number: 22746
output nodes number: 2758
edges number: 41665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3271484375 GB
    Memory Allocated: 10.651142120361328  GigaBytes
Max Memory Allocated: 10.7034330368042  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.3271484375 GB
    Memory Allocated: 10.651142597198486  GigaBytes
Max Memory Allocated: 10.7034330368042  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.0556640625 GB
    Memory Allocated: 0.0797877311706543  GigaBytes
Max Memory Allocated: 10.7034330368042  GigaBytes

pseudo mini batch 26 input nodes size: 94719
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.0556640625 GB
    Memory Allocated: 0.057843685150146484  GigaBytes
Max Memory Allocated: 10.7034330368042  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.0556640625 GB
    Memory Allocated: 0.057843685150146484  GigaBytes
Max Memory Allocated: 10.7034330368042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.0556640625 GB
    Memory Allocated: 0.10300922393798828  GigaBytes
Max Memory Allocated: 10.7034330368042  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.0556640625 GB
    Memory Allocated: 0.10303115844726562  GigaBytes
Max Memory Allocated: 10.7034330368042  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.0556640625 GB
    Memory Allocated: 0.05605649948120117  GigaBytes
Max Memory Allocated: 10.7034330368042  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.0556640625 GB
    Memory Allocated: 0.06398963928222656  GigaBytes
Max Memory Allocated: 10.7034330368042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.0556640625 GB
    Memory Allocated: 0.06398963928222656  GigaBytes
Max Memory Allocated: 10.7034330368042  GigaBytes

first layer input nodes number: 94719
first layer output nodes number: 63662
edges number: 535384
input nodes number: 63662
output nodes number: 23512
edges number: 394795
input nodes number: 23512
output nodes number: 2900
edges number: 48865
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4326171875 GB
    Memory Allocated: 10.827639102935791  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4326171875 GB
    Memory Allocated: 10.82763957977295  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.07814502716064453  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 27 input nodes size: 99028
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05607795715332031  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05607795715332031  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.10329818725585938  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.10331916809082031  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05813169479370117  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06511354446411133  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06511354446411133  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 99028
first layer output nodes number: 62526
edges number: 523358
input nodes number: 62526
output nodes number: 19706
edges number: 322836
input nodes number: 19706
output nodes number: 2792
edges number: 35886
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 9.470714092254639  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 9.470714569091797  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.07766580581665039  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 28 input nodes size: 90757
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.058115482330322266  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.058115482330322266  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.10139179229736328  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.10141277313232422  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05417156219482422  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.060741424560546875  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.060741424560546875  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 90757
first layer output nodes number: 58940
edges number: 494200
input nodes number: 58940
output nodes number: 20948
edges number: 346658
input nodes number: 20948
output nodes number: 2758
edges number: 40752
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 9.681365013122559  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 9.681365489959717  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.07412195205688477  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 29 input nodes size: 91364
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.054166316986083984  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.054166316986083984  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0977320671081543  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.09775304794311523  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05445575714111328  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06097888946533203  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06097888946533203  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 91364
first layer output nodes number: 58105
edges number: 490944
input nodes number: 58105
output nodes number: 20614
edges number: 343874
input nodes number: 20614
output nodes number: 2761
edges number: 40564
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 9.613749504089355  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 9.613749980926514  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.07476997375488281  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 30 input nodes size: 83639
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.054456233978271484  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.054456233978271484  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.09433841705322266  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0943598747253418  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05077314376831055  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.057538509368896484  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.057538509368896484  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 83639
first layer output nodes number: 54557
edges number: 468533
input nodes number: 54557
output nodes number: 21640
edges number: 384645
input nodes number: 21640
output nodes number: 2864
edges number: 54553
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 10.198343753814697  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 10.198344230651855  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0704350471496582  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 31 input nodes size: 79506
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05078840255737305  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05078840255737305  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0886998176574707  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.08871030807495117  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04880666732788086  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05180644989013672  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05180644989013672  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 79506[03:31:15] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37273158 edges into 32 parts and get 12677935 edge cuts

first layer output nodes number: 34169
edges number: 284241
input nodes number: 34169
output nodes number: 7214
edges number: 95030
input nodes number: 7214
output nodes number: 1360
edges number: 10799
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 3.8538079261779785  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 3.8538084030151367  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05681419372558594  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 32 input nodes size: 94354
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04858255386352539  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04858255386352539  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.09357404708862305  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.09358453750610352  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05566263198852539  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0612940788269043  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0612940788269043  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 94354
first layer output nodes number: 56702
edges number: 492558
input nodes number: 56702
output nodes number: 13854
edges number: 242917
input nodes number: 13854
output nodes number: 1408
edges number: 20127
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 7.809737682342529  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 7.8097381591796875  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.07147502899169922  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.08192729949951172  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.08192729949951172  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04399464347145774 |0.017234628850763493 |0.30693484797622217 |0.00012186079314260772 |0.4409720247442072 |0.012473821640014648 |
----------------------------------------------------------pseudo_mini_loss sum 5.372345447540283
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3562688
Number of first layer input nodes during this epoch:  2116585
Number of first layer output nodes during this epoch:  1086946
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.08192682266235352  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03774595260620117
global_2_local spend time (sec) 0.07544231414794922
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.006311178207397461
A = g.adjacency_matrix() spent  0.01686263084411621
auxiliary_graph
Graph(num_nodes=158253, num_edges=37364099,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.17302298545837402
remove nodes length
67312
auxiliary_graph.remove_nodes spent  2.1842222213745117
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37364099,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.6441404819488525

the counter of shared neighbor distribution
Counter({1.0: 28442724, 2.0: 5934866, 3.0: 1749448, 4.0: 608950, 5.0: 251286, 6.0: 118122, 7.0: 62400, 8.0: 36188, 9.0: 21960, 10.0: 14378, 11.0: 9394, 12.0: 6446, 13.0: 4594, 14.0: 3290, 15.0: 2434, 16.0: 1740, 17.0: 1284, 18.0: 882, 19.0: 642, 20.0: 566, 21.0: 378, 22.0: 312, 23.0: 240, 24.0: 178, 25.0: 122, 26.0: 96, 27.0: 62, 29.0: 40, 28.0: 38, 30.0: 34, 31.0: 14, 32.0: 12, 33.0: 10, 34.0: 8, 40.0: 6, 35.0: 4, 37.0: 4, 38.0: 4, 49.0: 2})
37273158
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37273155, 37273156, 37273157])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28442724, 2.0: 5934866, 3.0: 1749448, 4.0: 608950, 5.0: 251286, 6.0: 118122, 7.0: 62400, 8.0: 36188, 9.0: 21960, 10.0: 14378, 11.0: 9394, 12.0: 6446, 13.0: 4594, 14.0: 3290, 15.0: 2434, 16.0: 1740, 17.0: 1284, 18.0: 882, 19.0: 642, 20.0: 566, 21.0: 378, 22.0: 312, 23.0: 240, 24.0: 178, 25.0: 122, 26.0: 96, 27.0: 62, 29.0: 40, 28.0: 38, 30.0: 34, 31.0: 14, 32.0: 12, 33.0: 10, 34.0: 8, 40.0: 6, 35.0: 4, 37.0: 4, 38.0: 4, 49.0: 2})
Convert a graph into a bidirected graph: 2.504 seconds
Metis partitioning: 7.772 seconds
Split the graph: 0.994 seconds
Construct subgraphs: 0.128 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  11.415398359298706
2915
2880
2927
2864
2901
2792
2921
2872
2862
2909
2870
2887
2921
2797
2914
2899
2859
2758
2759
2758
2772
2806
2769
2813
2907
2761
2880
2762
2758
2788
2853
2807
total k batches seeds list generation spend  27.132059574127197
after graph partition
graph partition algorithm spend time 27.25896191596985
2915
2880
2927
2864
2901
2792
2921
2872
2862
2909
2870
2887
2921
2797
2914
2899
2859
2758
2759
2758
2772
2806
2769
2813
2907
2761
2880
2762
2758
2788
2853
2807
partition_len_list
[6493, 7890, 8147, 7143, 5243, 5288, 5934, 8067, 5391, 6404, 7010, 5870, 7922, 7242, 8104, 7559, 22004, 22552, 21858, 20340, 17858, 17590, 23642, 21944, 6316, 8320, 8588, 9722, 18415, 15459, 12895, 7711]
shared_neighbor_graph_partition_s0 selection method  spend 27.3978431224823
time for parepare:  0.018672466278076172
local_output_nid generation:  0.0006339550018310547
local_in_edges_tensor generation:  0.0009808540344238281
mini_batch_src_global generation:  0.0012047290802001953
r_  generation:  0.009133577346801758
local_output_nid generation:  0.0007834434509277344
local_in_edges_tensor generation:  0.0008118152618408203
mini_batch_src_global generation:  0.0011105537414550781
r_  generation:  0.008959293365478516
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0008432865142822266
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.010552644729614258
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0008616447448730469
r_  generation:  0.008975028991699219
local_output_nid generation:  0.000858306884765625
local_in_edges_tensor generation:  0.0008182525634765625
mini_batch_src_global generation:  0.0006837844848632812
r_  generation:  0.006906270980834961
local_output_nid generation:  0.0007956027984619141
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.0006184577941894531
r_  generation:  0.006905794143676758
local_output_nid generation:  0.0008456707000732422
local_in_edges_tensor generation:  0.0007882118225097656
mini_batch_src_global generation:  0.0008862018585205078
r_  generation:  0.008249998092651367
local_output_nid generation:  0.0008099079132080078
local_in_edges_tensor generation:  0.0008056163787841797
mini_batch_src_global generation:  0.0009090900421142578
r_  generation:  0.009807825088500977
local_output_nid generation:  0.0008347034454345703
local_in_edges_tensor generation:  0.0007913112640380859
mini_batch_src_global generation:  0.0010540485382080078
r_  generation:  0.010020017623901367
local_output_nid generation:  0.0008540153503417969
local_in_edges_tensor generation:  0.0007445812225341797
mini_batch_src_global generation:  0.0009589195251464844
r_  generation:  0.010810375213623047
local_output_nid generation:  0.0008380413055419922
local_in_edges_tensor generation:  0.0007624626159667969
mini_batch_src_global generation:  0.0009779930114746094
r_  generation:  0.010370016098022461
local_output_nid generation:  0.0008220672607421875
local_in_edges_tensor generation:  0.000789642333984375
mini_batch_src_global generation:  0.0007996559143066406
r_  generation:  0.007223844528198242
local_output_nid generation:  0.0008199214935302734
local_in_edges_tensor generation:  0.0008199214935302734
mini_batch_src_global generation:  0.0012264251708984375
r_  generation:  0.010713815689086914
local_output_nid generation:  0.000774383544921875
local_in_edges_tensor generation:  0.0007472038269042969
mini_batch_src_global generation:  0.0009059906005859375
r_  generation:  0.008140087127685547
local_output_nid generation:  0.0008113384246826172
local_in_edges_tensor generation:  0.0008375644683837891
mini_batch_src_global generation:  0.0010380744934082031
r_  generation:  0.011931419372558594
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.001157999038696289
r_  generation:  0.011495590209960938
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0019350051879882812
r_  generation:  0.019501686096191406
local_output_nid generation:  0.0009024143218994141
local_in_edges_tensor generation:  0.0009458065032958984
mini_batch_src_global generation:  0.0019202232360839844
r_  generation:  0.017123937606811523
local_output_nid generation:  0.0009400844573974609
local_in_edges_tensor generation:  0.0008144378662109375
mini_batch_src_global generation:  0.001383066177368164
r_  generation:  0.014379501342773438
local_output_nid generation:  0.0009303092956542969
local_in_edges_tensor generation:  0.0008313655853271484
mini_batch_src_global generation:  0.0014920234680175781
r_  generation:  0.01933884620666504
local_output_nid generation:  0.0010216236114501953
local_in_edges_tensor generation:  0.0008165836334228516
mini_batch_src_global generation:  0.0012886524200439453
r_  generation:  0.011086463928222656
local_output_nid generation:  0.0010180473327636719
local_in_edges_tensor generation:  0.0008234977722167969
mini_batch_src_global generation:  0.0012159347534179688
r_  generation:  0.01248788833618164
local_output_nid generation:  0.0009255409240722656
local_in_edges_tensor generation:  0.000858306884765625
mini_batch_src_global generation:  0.0014371871948242188
r_  generation:  0.018067121505737305
local_output_nid generation:  0.0009765625
local_in_edges_tensor generation:  0.0008497238159179688
mini_batch_src_global generation:  0.001455545425415039
r_  generation:  0.01526188850402832
local_output_nid generation:  0.000990152359008789
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.000997781753540039
r_  generation:  0.007843255996704102
local_output_nid generation:  0.000881195068359375
local_in_edges_tensor generation:  0.0009336471557617188
mini_batch_src_global generation:  0.0006873607635498047
r_  generation:  0.007310390472412109
local_output_nid generation:  0.0009527206420898438
local_in_edges_tensor generation:  0.0008366107940673828
mini_batch_src_global generation:  0.0010178089141845703
r_  generation:  0.008829116821289062
local_output_nid generation:  0.0008490085601806641
local_in_edges_tensor generation:  0.0007545948028564453
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.008978128433227539
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.000858306884765625
mini_batch_src_global generation:  0.0013704299926757812
r_  generation:  0.016399860382080078
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.000823974609375
mini_batch_src_global generation:  0.001344442367553711
r_  generation:  0.010657548904418945
local_output_nid generation:  0.0009653568267822266
local_in_edges_tensor generation:  0.0008199214935302734
mini_batch_src_global generation:  0.0010709762573242188
r_  generation:  0.01121664047241211
local_output_nid generation:  0.0009279251098632812
local_in_edges_tensor generation:  0.0007450580596923828
mini_batch_src_global generation:  0.0008738040924072266
r_  generation:  0.007925033569335938
----------------------check_connections_block total spend ----------------------------- 0.5535712242126465
generate_one_block  0.021039485931396484
generate_one_block  0.016437292098999023
generate_one_block  0.017181396484375
generate_one_block  0.013617992401123047
generate_one_block  0.010232210159301758
generate_one_block  0.010263204574584961
generate_one_block  0.012663602828979492
generate_one_block  0.015275239944458008
generate_one_block  0.015110492706298828
generate_one_block  0.014969348907470703
generate_one_block  0.015813589096069336
generate_one_block  0.010757207870483398
generate_one_block  0.016472578048706055
generate_one_block  0.012582063674926758
generate_one_block  0.01794600486755371
generate_one_block  0.018395662307739258
generate_one_block  0.03626084327697754
generate_one_block  0.02917027473449707
generate_one_block  0.02410888671875
generate_one_block  0.026829957962036133
generate_one_block  0.01948404312133789
generate_one_block  0.02057027816772461
generate_one_block  0.027629375457763672
generate_one_block  0.024724721908569336
generate_one_block  0.011601448059082031
generate_one_block  0.011713981628417969
generate_one_block  0.01372385025024414
generate_one_block  0.014180183410644531
generate_one_block  0.02590465545654297
generate_one_block  0.01811981201171875
generate_one_block  0.01736760139465332
generate_one_block  0.01217031478881836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05482888221740723
gen group dst list time:  0.011298894882202148
time for parepare:  0.026691436767578125
local_output_nid generation:  0.0016677379608154297
local_in_edges_tensor generation:  0.01218557357788086
mini_batch_src_global generation:  0.002276897430419922
r_  generation:  0.022763967514038086
local_output_nid generation:  0.002852916717529297
local_in_edges_tensor generation:  0.0030350685119628906
mini_batch_src_global generation:  0.0032215118408203125
r_  generation:  0.03109264373779297
local_output_nid generation:  0.0026102066040039062
local_in_edges_tensor generation:  0.002379179000854492
mini_batch_src_global generation:  0.003396749496459961
r_  generation:  0.035803794860839844
local_output_nid generation:  0.0022513866424560547
local_in_edges_tensor generation:  0.0018887519836425781
mini_batch_src_global generation:  0.0024156570434570312
r_  generation:  0.0279695987701416
local_output_nid generation:  0.0016732215881347656
local_in_edges_tensor generation:  0.0013799667358398438
mini_batch_src_global generation:  0.0014727115631103516
r_  generation:  0.013406038284301758
local_output_nid generation:  0.0016179084777832031
local_in_edges_tensor generation:  0.0015151500701904297
mini_batch_src_global generation:  0.00147247314453125
r_  generation:  0.014176368713378906
local_output_nid generation:  0.0018107891082763672
local_in_edges_tensor generation:  0.0016143321990966797
mini_batch_src_global generation:  0.0014238357543945312
r_  generation:  0.018229007720947266
local_output_nid generation:  0.0022575855255126953
local_in_edges_tensor generation:  0.0021791458129882812
mini_batch_src_global generation:  0.0023026466369628906
r_  generation:  0.02904653549194336
local_output_nid generation:  0.0014226436614990234
local_in_edges_tensor generation:  0.0012969970703125
mini_batch_src_global generation:  0.0019638538360595703
r_  generation:  0.020102977752685547
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0015981197357177734
mini_batch_src_global generation:  0.001996278762817383
r_  generation:  0.02542901039123535
local_output_nid generation:  0.0016484260559082031
local_in_edges_tensor generation:  0.001967906951904297
mini_batch_src_global generation:  0.002452373504638672
r_  generation:  0.028575658798217773
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.001634359359741211
mini_batch_src_global generation:  0.0016858577728271484
r_  generation:  0.018182039260864258
local_output_nid generation:  0.0022673606872558594
local_in_edges_tensor generation:  0.0019757747650146484
mini_batch_src_global generation:  0.002393960952758789
r_  generation:  0.03190159797668457
local_output_nid generation:  0.002010345458984375
local_in_edges_tensor generation:  0.0017559528350830078
mini_batch_src_global generation:  0.0025496482849121094
r_  generation:  0.02631092071533203
local_output_nid generation:  0.002166271209716797
local_in_edges_tensor generation:  0.00218963623046875
mini_batch_src_global generation:  0.0029850006103515625
r_  generation:  0.03478527069091797
local_output_nid generation:  0.002033233642578125
local_in_edges_tensor generation:  0.002170562744140625
mini_batch_src_global generation:  0.003000497817993164
r_  generation:  0.03130912780761719
local_output_nid generation:  0.0058023929595947266
local_in_edges_tensor generation:  0.009571075439453125
mini_batch_src_global generation:  0.013780832290649414
r_  generation:  0.14886903762817383
local_output_nid generation:  0.008573532104492188
local_in_edges_tensor generation:  0.012065887451171875
mini_batch_src_global generation:  0.016431331634521484
r_  generation:  0.14322805404663086
local_output_nid generation:  0.006145954132080078
local_in_edges_tensor generation:  0.007122039794921875
mini_batch_src_global generation:  0.015276670455932617
r_  generation:  0.13384199142456055
local_output_nid generation:  0.005728006362915039
local_in_edges_tensor generation:  0.006506443023681641
mini_batch_src_global generation:  0.01497340202331543
r_  generation:  0.129713773727417
local_output_nid generation:  0.0051496028900146484
local_in_edges_tensor generation:  0.0057544708251953125
mini_batch_src_global generation:  0.012053251266479492
r_  generation:  0.10692000389099121
local_output_nid generation:  0.0057070255279541016
local_in_edges_tensor generation:  0.005377769470214844
mini_batch_src_global generation:  0.01196432113647461
r_  generation:  0.10178875923156738
local_output_nid generation:  0.0064275264739990234
local_in_edges_tensor generation:  0.009988546371459961
mini_batch_src_global generation:  0.0160219669342041
r_  generation:  0.14991307258605957
local_output_nid generation:  0.006159782409667969
local_in_edges_tensor generation:  0.0068759918212890625
mini_batch_src_global generation:  0.016062021255493164
r_  generation:  0.14136195182800293
local_output_nid generation:  0.0021524429321289062
local_in_edges_tensor generation:  0.0019524097442626953
mini_batch_src_global generation:  0.004709959030151367
r_  generation:  0.022562742233276367
local_output_nid generation:  0.002591371536254883
local_in_edges_tensor generation:  0.0024099349975585938
mini_batch_src_global generation:  0.002566814422607422
r_  generation:  0.0337522029876709
local_output_nid generation:  0.0025327205657958984
local_in_edges_tensor generation:  0.0022454261779785156
mini_batch_src_global generation:  0.0026760101318359375
r_  generation:  0.032135009765625
local_output_nid generation:  0.0026483535766601562
local_in_edges_tensor generation:  0.0024993419647216797
mini_batch_src_global generation:  0.00341033935546875
r_  generation:  0.042098283767700195
local_output_nid generation:  0.00484919548034668
local_in_edges_tensor generation:  0.005870342254638672
mini_batch_src_global generation:  0.01103067398071289
r_  generation:  0.11314153671264648
local_output_nid generation:  0.0046291351318359375
local_in_edges_tensor generation:  0.005221128463745117
mini_batch_src_global generation:  0.009961843490600586
r_  generation:  0.08746790885925293
local_output_nid generation:  0.0038433074951171875
local_in_edges_tensor generation:  0.003912925720214844
mini_batch_src_global generation:  0.007447719573974609
r_  generation:  0.06676483154296875
local_output_nid generation:  0.0024209022521972656
local_in_edges_tensor generation:  0.002251148223876953
mini_batch_src_global generation:  0.003440380096435547
r_  generation:  0.029109954833984375
----------------------check_connections_block total spend ----------------------------- 2.7158615589141846
generate_one_block  0.03735780715942383
generate_one_block  0.05430006980895996
generate_one_block  0.0527188777923584
generate_one_block  0.0381922721862793
generate_one_block  0.018574953079223633
generate_one_block  0.0190732479095459
generate_one_block  0.024463415145874023
generate_one_block  0.04121589660644531
generate_one_block  0.0280148983001709
generate_one_block  0.036223411560058594
generate_one_block  0.040305137634277344
generate_one_block  0.02541947364807129
generate_one_block  0.0441899299621582
generate_one_block  0.036858558654785156
generate_one_block  0.0491330623626709
generate_one_block  0.04434013366699219
generate_one_block  0.2077016830444336
generate_one_block  0.20728254318237305
generate_one_block  0.1909961700439453
generate_one_block  0.1802196502685547
generate_one_block  0.17455673217773438
generate_one_block  0.15365290641784668
generate_one_block  0.21708464622497559
generate_one_block  0.2396845817565918
generate_one_block  0.03702425956726074
generate_one_block  0.04744243621826172
generate_one_block  0.04515504837036133
generate_one_block  0.06238579750061035
generate_one_block  0.1571485996246338
generate_one_block  0.127577543258667
generate_one_block  0.09433722496032715
generate_one_block  0.03985905647277832
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03516101837158203
gen group dst list time:  0.0432741641998291
time for parepare:  0.021437644958496094
local_output_nid generation:  0.0036749839782714844
local_in_edges_tensor generation:  0.02184581756591797
mini_batch_src_global generation:  0.0051784515380859375
r_  generation:  0.08111429214477539
local_output_nid generation:  0.011638641357421875
local_in_edges_tensor generation:  0.01091623306274414
mini_batch_src_global generation:  0.007895946502685547
r_  generation:  0.07872724533081055
local_output_nid generation:  0.011902093887329102
local_in_edges_tensor generation:  0.009768009185791016
mini_batch_src_global generation:  0.008446455001831055
r_  generation:  0.13922929763793945
local_output_nid generation:  0.006960868835449219
local_in_edges_tensor generation:  0.0064411163330078125
mini_batch_src_global generation:  0.008100032806396484
r_  generation:  0.07653665542602539
local_output_nid generation:  0.003398418426513672
local_in_edges_tensor generation:  0.0025594234466552734
mini_batch_src_global generation:  0.00424504280090332
r_  generation:  0.028584718704223633
local_output_nid generation:  0.0036211013793945312
local_in_edges_tensor generation:  0.0033347606658935547
mini_batch_src_global generation:  0.0033299922943115234
r_  generation:  0.033043861389160156
local_output_nid generation:  0.0037708282470703125
local_in_edges_tensor generation:  0.0029497146606445312
mini_batch_src_global generation:  0.003877878189086914
r_  generation:  0.03984498977661133
local_output_nid generation:  0.006058216094970703
local_in_edges_tensor generation:  0.005319356918334961
mini_batch_src_global generation:  0.006684780120849609
r_  generation:  0.06682968139648438
local_output_nid generation:  0.003997325897216797
local_in_edges_tensor generation:  0.0036001205444335938
mini_batch_src_global generation:  0.005270719528198242
r_  generation:  0.04056096076965332
local_output_nid generation:  0.0045013427734375
local_in_edges_tensor generation:  0.004698038101196289
mini_batch_src_global generation:  0.005450248718261719
r_  generation:  0.053038597106933594
local_output_nid generation:  0.005555868148803711
local_in_edges_tensor generation:  0.005764007568359375
mini_batch_src_global generation:  0.007479190826416016
r_  generation:  0.06777024269104004
local_output_nid generation:  0.00465846061706543
local_in_edges_tensor generation:  0.004614353179931641
mini_batch_src_global generation:  0.005719900131225586
r_  generation:  0.04986119270324707
local_output_nid generation:  0.005227804183959961
local_in_edges_tensor generation:  0.005220174789428711
mini_batch_src_global generation:  0.006459474563598633
r_  generation:  0.059644222259521484
local_output_nid generation:  0.005557537078857422
local_in_edges_tensor generation:  0.005691051483154297
mini_batch_src_global generation:  0.006767988204956055
r_  generation:  0.06410932540893555
local_output_nid generation:  0.005189180374145508
local_in_edges_tensor generation:  0.004946470260620117
mini_batch_src_global generation:  0.006932973861694336
r_  generation:  0.05834531784057617
local_output_nid generation:  0.004974842071533203
local_in_edges_tensor generation:  0.005324363708496094
mini_batch_src_global generation:  0.006125688552856445
r_  generation:  0.05780816078186035
local_output_nid generation:  0.013083696365356445
local_in_edges_tensor generation:  0.01888728141784668
mini_batch_src_global generation:  0.02253890037536621
r_  generation:  0.20238900184631348
local_output_nid generation:  0.01513671875
local_in_edges_tensor generation:  0.020331621170043945
mini_batch_src_global generation:  0.022745370864868164
r_  generation:  0.22958016395568848
local_output_nid generation:  0.015943527221679688
local_in_edges_tensor generation:  0.02076125144958496
mini_batch_src_global generation:  0.025365114212036133
r_  generation:  0.24684476852416992
local_output_nid generation:  0.013862371444702148
local_in_edges_tensor generation:  0.016230106353759766
mini_batch_src_global generation:  0.022011280059814453
r_  generation:  0.21038818359375
local_output_nid generation:  0.015807390213012695
local_in_edges_tensor generation:  0.019162416458129883
mini_batch_src_global generation:  0.02348041534423828
r_  generation:  0.23139047622680664
local_output_nid generation:  0.014896154403686523
local_in_edges_tensor generation:  0.02059197425842285
mini_batch_src_global generation:  0.022701501846313477
r_  generation:  0.2168867588043213
local_output_nid generation:  0.01627516746520996
local_in_edges_tensor generation:  0.022894620895385742
mini_batch_src_global generation:  0.024796009063720703
r_  generation:  0.2486433982849121
local_output_nid generation:  0.01595163345336914
local_in_edges_tensor generation:  0.02258443832397461
mini_batch_src_global generation:  0.02459716796875
r_  generation:  0.23848366737365723
local_output_nid generation:  0.005962371826171875
local_in_edges_tensor generation:  0.005719423294067383
mini_batch_src_global generation:  0.010883808135986328
r_  generation:  0.0651237964630127
local_output_nid generation:  0.007955789566040039
local_in_edges_tensor generation:  0.00819706916809082
mini_batch_src_global generation:  0.009882211685180664
r_  generation:  0.0995643138885498
local_output_nid generation:  0.007431507110595703
local_in_edges_tensor generation:  0.007360219955444336
mini_batch_src_global generation:  0.010242938995361328
r_  generation:  0.08879518508911133
local_output_nid generation:  0.00925898551940918
local_in_edges_tensor generation:  0.009974479675292969
mini_batch_src_global generation:  0.01234292984008789
r_  generation:  0.12316393852233887
local_output_nid generation:  0.013339996337890625
local_in_edges_tensor generation:  0.01593470573425293
mini_batch_src_global generation:  0.0198824405670166
r_  generation:  0.19782066345214844
local_output_nid generation:  0.01478433609008789
local_in_edges_tensor generation:  0.019048213958740234
mini_batch_src_global generation:  0.021962642669677734
r_  generation:  0.2198331356048584
local_output_nid generation:  0.010943174362182617
local_in_edges_tensor generation:  0.015709638595581055
mini_batch_src_global generation:  0.0178682804107666
r_  generation:  0.1528160572052002
local_output_nid generation:  0.006846904754638672
local_in_edges_tensor generation:  0.006674528121948242
mini_batch_src_global generation:  0.010466814041137695
r_  generation:  0.08384251594543457
----------------------check_connections_block total spend ----------------------------- 5.636741399765015
generate_one_block  0.07480645179748535
generate_one_block  0.1068258285522461
generate_one_block  0.13255977630615234
generate_one_block  0.09736919403076172
generate_one_block  0.03611588478088379
generate_one_block  0.0432429313659668
generate_one_block  0.051070213317871094
generate_one_block  0.1245126724243164
generate_one_block  0.05821514129638672
generate_one_block  0.0768289566040039
generate_one_block  0.09295320510864258
generate_one_block  0.07157731056213379
generate_one_block  0.08132648468017578
generate_one_block  0.08586907386779785
generate_one_block  0.07848381996154785
generate_one_block  0.07745027542114258
generate_one_block  0.276775598526001
generate_one_block  0.3081381320953369
generate_one_block  0.30547261238098145
generate_one_block  0.2629413604736328
generate_one_block  0.29717397689819336
generate_one_block  0.27608799934387207
generate_one_block  0.3142678737640381
generate_one_block  0.29979848861694336
generate_one_block  0.0838003158569336
generate_one_block  0.12810277938842773
generate_one_block  0.11767697334289551
generate_one_block  0.16414666175842285
generate_one_block  0.2549896240234375
generate_one_block  0.2785637378692627
generate_one_block  0.1934208869934082
generate_one_block  0.1026008129119873
global_2_local spend time (sec) 0.004041433334350586
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0008106231689453125
A = g.adjacency_matrix() spent  0.0005528926849365234
auxiliary_graph
Graph(num_nodes=15459, num_edges=77850,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.011700153350830078
remove nodes length
12671
auxiliary_graph.remove_nodes spent  0.004995584487915039
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2788, num_edges=77850,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0038886070251464844

the counter of shared neighbor distribution
Counter({1.0: 57454, 2.0: 10004, 3.0: 3508, 4.0: 1434, 5.0: 780, 6.0: 474, 7.0: 330, 8.0: 208, 9.0: 190, 10.0: 130, 11.0: 90, 12.0: 82, 13.0: 56, 14.0: 56, 15.0: 40, 16.0: 38, 17.0: 32, 18.0: 30, 20.0: 28, 22.0: 20, 19.0: 18, 21.0: 12, 24.0: 12, 27.0: 8, 26.0: 8, 25.0: 8, 23.0: 6, 32.0: 2, 28.0: 2, 29.0: 2})
75062
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([    0,     1,     2,  ..., 75059, 75060, 75061])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w][03:31:34] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2788 nodes and 75062 edges into 2 parts and get 432 edge cuts

the counter of shared neigbor distribution
Counter({1.0: 57454, 2.0: 10004, 3.0: 3508, 4.0: 1434, 5.0: 780, 6.0: 474, 7.0: 330, 8.0: 208, 9.0: 190, 10.0: 130, 11.0: 90, 12.0: 82, 13.0: 56, 14.0: 56, 15.0: 40, 16.0: 38, 17.0: 32, 18.0: 30, 20.0: 28, 22.0: 20, 19.0: 18, 21.0: 12, 24.0: 12, 27.0: 8, 26.0: 8, 25.0: 8, 23.0: 6, 32.0: 2, 28.0: 2, 29.0: 2})
Convert a graph into a bidirected graph: 0.002 seconds
Metis partitioning: 0.007 seconds
Split the graph: 0.013 seconds
Construct subgraphs: 0.034 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.05723452568054199
1418
1370
total k batches seeds list generation spend  0.12180900573730469
after graph partition
graph partition algorithm spend time 0.12946105003356934
1418
1370
time for parepare:  0.03287458419799805
local_output_nid generation:  0.0004494190216064453
local_in_edges_tensor generation:  0.0036077499389648438
mini_batch_src_global generation:  0.0013232231140136719
r_  generation:  0.011210441589355469
local_output_nid generation:  0.0003833770751953125
local_in_edges_tensor generation:  0.0017695426940917969
mini_batch_src_global generation:  0.0006804466247558594
r_  generation:  0.0037572383880615234
----------------------check_connections_block total spend ----------------------------- 0.06552624702453613
generate_one_block  0.013436317443847656
generate_one_block  0.006204843521118164
time for parepare:  0.0203096866607666
local_output_nid generation:  0.0023376941680908203
local_in_edges_tensor generation:  0.00953054428100586
mini_batch_src_global generation:  0.010322093963623047
r_  generation:  0.08278799057006836
local_output_nid generation:  0.0014598369598388672
local_in_edges_tensor generation:  0.001580953598022461
mini_batch_src_global generation:  0.0029044151306152344
r_  generation:  0.013876914978027344
----------------------check_connections_block total spend ----------------------------- 0.17516183853149414
generate_one_block  0.10376286506652832
generate_one_block  0.021054983139038086
time for parepare:  0.020101070404052734
local_output_nid generation:  0.00956583023071289
local_in_edges_tensor generation:  0.022421836853027344
mini_batch_src_global generation:  0.015147209167480469
r_  generation:  0.18854212760925293
local_output_nid generation:  0.0049359798431396484
local_in_edges_tensor generation:  0.004450559616088867
mini_batch_src_global generation:  0.009116172790527344
r_  generation:  0.046339988708496094
----------------------check_connections_block total spend ----------------------------- 0.3775293827056885
generate_one_block  0.258228063583374
generate_one_block  0.07170295715332031
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.08192682266235352  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

connection checking time:  8.3526029586792
block generation total time  7.7256550788879395
average batch blocks generation time:  0.2414267212152481
block dataloader generation time/epoch 46.63713073730469
pseudo mini batch 0 input nodes size: 44169
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06612110137939453  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06612110137939453  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.08760547637939453  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.08762741088867188  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04262542724609375  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04409027099609375  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04409027099609375  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 44169
first layer output nodes number: 17059
edges number: 117915
input nodes number: 17059
output nodes number: 6493
edges number: 55038
input nodes number: 6493
output nodes number: 2915
edges number: 23526
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.1766862869262695  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.176687240600586  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0472569465637207  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 1 input nodes size: 62181
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04285097122192383  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04285097122192383  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.07250118255615234  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.07252264022827148  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05101633071899414  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05311250686645508  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05311250686645508  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 62181
first layer output nodes number: 24649
edges number: 182293
input nodes number: 24649
output nodes number: 7890
edges number: 75744
input nodes number: 7890
output nodes number: 2880
edges number: 23160
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.9945054054260254  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.9945058822631836  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.057166099548339844  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 2 input nodes size: 69206
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.051011085510253906  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.051011085510253906  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0842142105102539  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.08423614501953125  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.054564476013183594  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.057097434997558594  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.057097434997558594  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 69206
first layer output nodes number: 28146
edges number: 221453
input nodes number: 28146
output nodes number: 8147
edges number: 90209
input nodes number: 8147
output nodes number: 2927
edges number: 28101
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 3.575347900390625  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 3.575348377227783  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.061881065368652344  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 3 input nodes size: 57102
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05457162857055664  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05457162857055664  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.08191537857055664  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.08193683624267578  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04871177673339844  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.050617218017578125  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.050617218017578125  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 57102
first layer output nodes number: 22619
edges number: 166815
input nodes number: 22619
output nodes number: 7143
edges number: 66196
input nodes number: 7143
output nodes number: 2864
edges number: 22498
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.719663143157959  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.719663619995117  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05429983139038086  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 4 input nodes size: 23694
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.048702239990234375  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.048702239990234375  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06000041961669922  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06002235412597656  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03265714645385742  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.033437252044677734  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.033437252044677734  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 23694
first layer output nodes number: 10105
edges number: 58283
input nodes number: 10105
output nodes number: 5243
edges number: 30123
input nodes number: 5243
output nodes number: 2901
edges number: 16015
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 1.225041389465332  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 1.2250418663024902  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03512144088745117  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 5 input nodes size: 30101
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03266286849975586  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03266286849975586  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.047016143798828125  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04703712463378906  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.035717010498046875  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03660869598388672  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03660869598388672  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 30101
first layer output nodes number: 11749
edges number: 71438
input nodes number: 11749
output nodes number: 5288
edges number: 32000
input nodes number: 5288
output nodes number: 2792
edges number: 16032
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 1.3556184768676758  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 1.355618953704834  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03848123550415039  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 6 input nodes size: 30272
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03570079803466797  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03570079803466797  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05013561248779297  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05015754699707031  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03578329086303711  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03689241409301758  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03689241409301758  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 30272
first layer output nodes number: 13240
edges number: 85546
input nodes number: 13240
output nodes number: 5934
edges number: 42938
input nodes number: 5934
output nodes number: 2921
edges number: 20211
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 1.6911516189575195  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 1.6911520957946777  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03918027877807617  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 7 input nodes size: 50556
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.035802364349365234  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.035802364349365234  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05990934371948242  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05993080139160156  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04547405242919922  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04732799530029297  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04732799530029297  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 50556
first layer output nodes number: 21672
edges number: 150803
input nodes number: 21672
output nodes number: 8067
edges number: 72704
input nodes number: 8067
output nodes number: 2872
edges number: 25188
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.733602523803711  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.733603000640869  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05098104476928711  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 8 input nodes size: 30859
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04546689987182617  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04546689987182617  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06109189987182617  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06111335754394531  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.036984920501708984  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0382533073425293  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0382533073425293  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 30859
first layer output nodes number: 12933
edges number: 92890
input nodes number: 12933
output nodes number: 5391
edges number: 50483
input nodes number: 5391
output nodes number: 2862
edges number: 26698
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 1.9447331428527832  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 1.9447336196899414  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0407719612121582  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 9 input nodes size: 35111
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.036983489990234375  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.036983489990234375  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0537257194519043  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05374765396118164  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0381011962890625  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03971672058105469  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03971672058105469  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 35111
first layer output nodes number: 16709
edges number: 124990
input nodes number: 16709
output nodes number: 6404
edges number: 65415
input nodes number: 6404
output nodes number: 2909
edges number: 26181
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.413379669189453  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.4133801460266113  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04283761978149414  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 10 input nodes size: 51375
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03810834884643555  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03810834884643555  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0626058578491211  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06262731552124023  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04586315155029297  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04779624938964844  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04779624938964844  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 51375
first layer output nodes number: 21057
edges number: 158920
input nodes number: 21057
output nodes number: 7010
edges number: 73027
input nodes number: 7010
output nodes number: 2870
edges number: 27358
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.8237762451171875  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.8237767219543457  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05151653289794922  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 11 input nodes size: 44319
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04585695266723633  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04585695266723633  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06734132766723633  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06736326217651367  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.042844295501708984  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04410123825073242  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04410123825073242  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 44319
first layer output nodes number: 16341
edges number: 110605
input nodes number: 16341
output nodes number: 5870
edges number: 41321
input nodes number: 5870
output nodes number: 2887
edges number: 16539
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 1.8294286727905273  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 1.8294291496276855  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04665422439575195  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 12 input nodes size: 39184
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0428471565246582  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0428471565246582  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0623784065246582  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06240034103393555  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0408940315246582  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04272031784057617  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04272031784057617  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 39184
first layer output nodes number: 18936
edges number: 135160
input nodes number: 18936
output nodes number: 7922
edges number: 81502
input nodes number: 7922
output nodes number: 2921
edges number: 28403
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.793985366821289  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.7939858436584473  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04629659652709961  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 13 input nodes size: 48738
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.040898799896240234  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.040898799896240234  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06433629989624023  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06435728073120117  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04480409622192383  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04652833938598633  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04652833938598633  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 48738
first layer output nodes number: 20675
edges number: 145839
input nodes number: 20675
output nodes number: 7242
edges number: 65236
input nodes number: 7242
output nodes number: 2797
edges number: 20189
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.502009391784668  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.502009868621826  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04989290237426758  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 14 input nodes size: 35409
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04478597640991211  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04478597640991211  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.06167030334472656  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.061692237854003906  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03823375701904297  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04017925262451172  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.04017925262451172  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 35409
first layer output nodes number: 18761
edges number: 138421
input nodes number: 18761
output nodes number: 8104
edges number: 92028
input nodes number: 8104
output nodes number: 2914
edges number: 30580
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.974931240081787  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 2.9749317169189453  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.043955326080322266  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 15 input nodes size: 35762
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03825092315673828  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.03825092315673828  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05530357360839844  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.05532550811767578  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.038419246673583984  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0402684211730957  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1865234375 GB
    Memory Allocated: 0.0402684211730957  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 35762
first layer output nodes number: 18632
edges number: 135685
input nodes number: 18632
output nodes number: 7559
edges number: 81899
input nodes number: 7559
output nodes number: 2899
edges number: 30450
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1982421875 GB
    Memory Allocated: 2.8245105743408203  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1982421875 GB
    Memory Allocated: 2.8245110511779785  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04384040832519531  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 16 input nodes size: 86387
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03841686248779297  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03841686248779297  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07960939407348633  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07963085174560547  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06255626678466797  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06942272186279297  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06942272186279297  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 86387
first layer output nodes number: 56690
edges number: 482949
input nodes number: 56690
output nodes number: 22004
edges number: 386542
input nodes number: 22004
output nodes number: 2859
edges number: 51865
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.335765361785889  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.335765838623047  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08272647857666016  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 17 input nodes size: 96728
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06255054473876953  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06255054473876953  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.1086740493774414  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10869503021240234  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06748104095458984  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0746774673461914  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0746774673461914  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 96728
first layer output nodes number: 63245
edges number: 535842
input nodes number: 63245
output nodes number: 22552
edges number: 385159
input nodes number: 22552
output nodes number: 2758
edges number: 44598
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.634826183319092  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.63482666015625  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09015417098999023  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 18 input nodes size: 100079
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06746578216552734  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06746578216552734  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11518716812133789  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11520814895629883  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06906366348266602  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07609319686889648  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07609319686889648  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 100079
first layer output nodes number: 66084
edges number: 551035
input nodes number: 66084
output nodes number: 21858
edges number: 356071
input nodes number: 21858
output nodes number: 2759
edges number: 36332
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.200929164886475  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.200929641723633  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0897665023803711  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 19 input nodes size: 89339
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06906414031982422  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06906414031982422  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.1116642951965332  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11168527603149414  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06394290924072266  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07040596008300781  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07040596008300781  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 89339
first layer output nodes number: 56765
edges number: 481173
input nodes number: 56765
output nodes number: 20340
edges number: 342920
input nodes number: 20340
output nodes number: 2758
edges number: 43113
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 9.55484914779663  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 9.554849624633789  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08278036117553711  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 20 input nodes size: 104441
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06394243240356445  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06394243240356445  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11374378204345703  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11376476287841797  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07114362716674805  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07736349105834961  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07736349105834961  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 104441
first layer output nodes number: 64953
edges number: 537828
input nodes number: 64953
output nodes number: 17858
edges number: 268961
input nodes number: 17858
output nodes number: 2772
edges number: 27801
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.710596084594727  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.710596561431885  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08895444869995117  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 21 input nodes size: 103381
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07114601135253906  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07114601135253906  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.12044191360473633  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.12046289443969727  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07064056396484375  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07716226577758789  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07716226577758789  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 103381
first layer output nodes number: 60278
edges number: 500280
input nodes number: 60278
output nodes number: 17590
edges number: 264253
input nodes number: 17590
output nodes number: 2806
edges number: 31463
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.417474746704102  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.41747522354126  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08826732635498047  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

pseudo mini batch 22 input nodes size: 102666
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07064533233642578  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07064533233642578  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11960029602050781  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11962127685546875  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07030439376831055  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07820749282836914  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07820749282836914  GigaBytes
Max Memory Allocated: 10.887482643127441  GigaBytes

first layer input nodes number: 102666
first layer output nodes number: 68385
edges number: 574460
input nodes number: 68385
output nodes number: 23642
edges number: 394473
input nodes number: 23642
output nodes number: 2769
edges number: 43795
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 11.063848495483398  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 11.063848972320557  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09340238571166992  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 23 input nodes size: 98993
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07029914855957031  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07029914855957031  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11750268936157227  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.1175236701965332  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06854772567749023  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07569408416748047  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07569408416748047  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 98993
first layer output nodes number: 65757
edges number: 550412
input nodes number: 65757
output nodes number: 21944
edges number: 357611
input nodes number: 21944
output nodes number: 2813
edges number: 37889
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.23887014389038  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.238870620727539  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08897686004638672  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 24 input nodes size: 54792
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06855440139770508  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06855440139770508  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0946812629699707  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09470319747924805  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.047478675842285156  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04900360107421875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04900360107421875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 54792
first layer output nodes number: 19460
edges number: 138915
input nodes number: 19460
output nodes number: 6316
edges number: 48134
input nodes number: 6316
output nodes number: 2907
edges number: 17408
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.1647095680236816  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.16471004486084  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05205202102661133  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 25 input nodes size: 71927
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04749250411987305  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04749250411987305  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08264875411987305  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08266973495483398  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.056520938873291016  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05888032913208008  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05888032913208008  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 71927
first layer output nodes number: 28983
edges number: 219804
input nodes number: 28983
output nodes number: 8320
edges number: 79303
input nodes number: 8320
output nodes number: 2761
edges number: 17344
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.2667555809020996  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.266756057739258  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06334161758422852  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 26 input nodes size: 67461
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05649900436401367  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05649900436401367  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08866691589355469  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08868837356567383  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05351114273071289  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.055722713470458984  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.055722713470458984  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 67461
first layer output nodes number: 27336
edges number: 198430
input nodes number: 27336
output nodes number: 8588
edges number: 77108
input nodes number: 8588
output nodes number: 2880
edges number: 21079
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.116759777069092  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.11676025390625  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.060025691986083984  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 27 input nodes size: 81970
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.053528785705566406  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.053528785705566406  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09261512756347656  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0926361083984375  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.060446739196777344  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06344890594482422  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06344890594482422  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 81970
first layer output nodes number: 35368
edges number: 275969
input nodes number: 35368
output nodes number: 9722
edges number: 104689
input nodes number: 9722
output nodes number: 2762
edges number: 22093
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 4.1544575691223145  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 4.154458045959473  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06922197341918945  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 28 input nodes size: 89081
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06042957305908203  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06042957305908203  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10290670394897461  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10292768478393555  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06382036209106445  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06978082656860352  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06978082656860352  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 89081
first layer output nodes number: 54811
edges number: 463250
input nodes number: 54811
output nodes number: 18415
edges number: 293818
input nodes number: 18415
output nodes number: 2758
edges number: 42702
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.690016269683838  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.690016746520996  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08167076110839844  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 29 input nodes size: 79685
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06381940841674805  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06381940841674805  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10181617736816406  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.1018376350402832  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05933952331542969  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06339740753173828  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06339740753173828  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 79685
first layer output nodes number: 42441
edges number: 346853
input nodes number: 42441
output nodes number: 12895
edges number: 170034
input nodes number: 12895
output nodes number: 2853
edges number: 27576
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 5.73114538192749  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 5.731145858764648  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07155799865722656  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 30 input nodes size: 59659
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05935382843017578  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05935382843017578  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08780145645141602  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08782243728637695  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0498042106628418  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05172586441040039  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05172586441040039  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 59659
first layer output nodes number: 23757
edges number: 172658
input nodes number: 23757
output nodes number: 7711
edges number: 67039
input nodes number: 7711
output nodes number: 2807
edges number: 18120
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.741098403930664  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.7410988807678223  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05545806884765625  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 31 input nodes size: 94402
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04979753494262695  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04979753494262695  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09481191635131836  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09482288360595703  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06635427474975586  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07119512557983398  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07119512557983398  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 94402
first layer output nodes number: 52290
edges number: 446486
input nodes number: 52290
output nodes number: 11758
edges number: 185775
input nodes number: 11758
output nodes number: 1418
edges number: 17253
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 6.58513069152832  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 6.5851311683654785  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0805511474609375  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 32 input nodes size: 43496
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0661473274230957  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0661473274230957  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0876317024230957  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08764219284057617  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.042616844177246094  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.043670654296875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.043670654296875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 43496
first layer output nodes number: 13979
edges number: 100924
input nodes number: 13979
output nodes number: 3875
edges number: 32033
input nodes number: 3875
output nodes number: 1370
edges number: 8196
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.464217185974121  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.4642176628112793  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.045760154724121094  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.045760154724121094  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.045760154724121094  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051794276092991684 |0.006487066095525568 |0.2984524423425848 |0.00011907924305308948 |0.4347176407322739 |0.010375499725341797 |
----------------------------------------------------------pseudo_mini_loss sum 5.005788803100586
Total (block generation + training)time/epoch 72.98360323905945
Training time/epoch 26.346182346343994
Training time without block to device /epoch 26.13210916519165
Training time without total dataloading part /epoch 24.20891785621643
load block tensor time/epoch 1.7092111110687256
block to device time/epoch 0.21407318115234375
input features size transfer per epoch 4.425644874572754e-06
blocks size to device per epoch 2.950429916381836e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3571485
Number of first layer input nodes during this epoch:  2112525
Number of first layer output nodes during this epoch:  1093865
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04575967788696289  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes
[03:32:29] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37218218 edges into 32 parts and get 12384841 edge cuts

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02777862548828125
global_2_local spend time (sec) 0.05641961097717285
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004914045333862305
A = g.adjacency_matrix() spent  0.00737309455871582
auxiliary_graph
Graph(num_nodes=158231, num_edges=37309159,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.15877699851989746
remove nodes length
67290
auxiliary_graph.remove_nodes spent  2.13038969039917
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37309159,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.651963472366333

the counter of shared neighbor distribution
Counter({1.0: 28394942, 2.0: 5919872, 3.0: 1750688, 4.0: 612700, 5.0: 253056, 6.0: 119164, 7.0: 62452, 8.0: 36226, 9.0: 21794, 10.0: 14268, 11.0: 9568, 12.0: 6566, 13.0: 4528, 14.0: 3276, 15.0: 2426, 16.0: 1748, 17.0: 1260, 18.0: 896, 19.0: 674, 20.0: 530, 21.0: 404, 22.0: 326, 23.0: 200, 24.0: 168, 25.0: 148, 26.0: 94, 27.0: 70, 29.0: 46, 28.0: 46, 30.0: 20, 31.0: 18, 32.0: 10, 33.0: 8, 35.0: 6, 34.0: 6, 40.0: 6, 36.0: 2, 49.0: 2, 39.0: 2, 38.0: 2})
37218218
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37218215, 37218216, 37218217])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28394942, 2.0: 5919872, 3.0: 1750688, 4.0: 612700, 5.0: 253056, 6.0: 119164, 7.0: 62452, 8.0: 36226, 9.0: 21794, 10.0: 14268, 11.0: 9568, 12.0: 6566, 13.0: 4528, 14.0: 3276, 15.0: 2426, 16.0: 1748, 17.0: 1260, 18.0: 896, 19.0: 674, 20.0: 530, 21.0: 404, 22.0: 326, 23.0: 200, 24.0: 168, 25.0: 148, 26.0: 94, 27.0: 70, 29.0: 46, 28.0: 46, 30.0: 20, 31.0: 18, 32.0: 10, 33.0: 8, 35.0: 6, 34.0: 6, 40.0: 6, 36.0: 2, 49.0: 2, 39.0: 2, 38.0: 2})
Convert a graph into a bidirected graph: 2.667 seconds
Metis partitioning: 8.562 seconds
Split the graph: 1.215 seconds
Construct subgraphs: 0.098 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  12.561947345733643
2884
2822
2911
2909
2913
2910
2876
2882
2791
2815
2781
2927
2779
2895
2890
2927
2878
2927
2924
2796
2758
2760
2772
2825
2784
2791
2796
2866
2758
2758
2878
2758
total k batches seeds list generation spend  28.680607557296753
after graph partition
graph partition algorithm spend time 28.801511526107788
2884
2822
2911
2909
2913
2910
2876
2882
2791
2815
2781
2927
2779
2895
2890
2927
2878
2927
2924
2796
2758
2760
2772
2825
2784
2791
2796
2866
2758
2758
2878
2758
partition_len_list
[5476, 4921, 5090, 5681, 8285, 8011, 5924, 5918, 5620, 6544, 7171, 8214, 7198, 6443, 8145, 7926, 8802, 6405, 8059, 9010, 18686, 16101, 11625, 13384, 15589, 18148, 22388, 23040, 18584, 20571, 20307, 23030]
shared_neighbor_graph_partition_s0 selection method  spend 28.91891574859619
time for parepare:  0.01929783821105957
local_output_nid generation:  0.0006721019744873047
local_in_edges_tensor generation:  0.0009407997131347656
mini_batch_src_global generation:  0.0008058547973632812
r_  generation:  0.007306337356567383
local_output_nid generation:  0.0007421970367431641
local_in_edges_tensor generation:  0.0008087158203125
mini_batch_src_global generation:  0.0006642341613769531
r_  generation:  0.006803750991821289
local_output_nid generation:  0.0008120536804199219
local_in_edges_tensor generation:  0.000782012939453125
mini_batch_src_global generation:  0.0006527900695800781
r_  generation:  0.007132291793823242
local_output_nid generation:  0.0008192062377929688
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0007293224334716797
r_  generation:  0.007376194000244141
local_output_nid generation:  0.0008344650268554688
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.010386943817138672
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.0010533332824707031
r_  generation:  0.013091325759887695
local_output_nid generation:  0.0009987354278564453
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0008018016815185547
r_  generation:  0.007914543151855469
local_output_nid generation:  0.0009257793426513672
local_in_edges_tensor generation:  0.0007674694061279297
mini_batch_src_global generation:  0.0007777214050292969
r_  generation:  0.008398294448852539
local_output_nid generation:  0.0008592605590820312
local_in_edges_tensor generation:  0.0008518695831298828
mini_batch_src_global generation:  0.0009202957153320312
r_  generation:  0.009497880935668945
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0007982254028320312
mini_batch_src_global generation:  0.0010170936584472656
r_  generation:  0.010651111602783203
local_output_nid generation:  0.0008058547973632812
local_in_edges_tensor generation:  0.0007760524749755859
mini_batch_src_global generation:  0.0010704994201660156
r_  generation:  0.00911712646484375
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0007765293121337891
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.011065006256103516
local_output_nid generation:  0.0008046627044677734
local_in_edges_tensor generation:  0.0007920265197753906
mini_batch_src_global generation:  0.0009648799896240234
r_  generation:  0.00955963134765625
local_output_nid generation:  0.0008196830749511719
local_in_edges_tensor generation:  0.0007731914520263672
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010928153991699219
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0008454322814941406
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.011604785919189453
local_output_nid generation:  0.0009551048278808594
local_in_edges_tensor generation:  0.0007908344268798828
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.011455535888671875
local_output_nid generation:  0.0008544921875
local_in_edges_tensor generation:  0.0008094310760498047
mini_batch_src_global generation:  0.001026153564453125
r_  generation:  0.008484363555908203
local_output_nid generation:  0.0008573532104492188
local_in_edges_tensor generation:  0.0007767677307128906
mini_batch_src_global generation:  0.0007300376892089844
r_  generation:  0.00757145881652832
local_output_nid generation:  0.0008382797241210938
local_in_edges_tensor generation:  0.0007867813110351562
mini_batch_src_global generation:  0.0007889270782470703
r_  generation:  0.008408546447753906
local_output_nid generation:  0.0007803440093994141
local_in_edges_tensor generation:  0.000774383544921875
mini_batch_src_global generation:  0.0009012222290039062
r_  generation:  0.008574247360229492
local_output_nid generation:  0.0007767677307128906
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.002131223678588867
r_  generation:  0.017297029495239258
local_output_nid generation:  0.0008296966552734375
local_in_edges_tensor generation:  0.0008060932159423828
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.01032114028930664
local_output_nid generation:  0.0008513927459716797
local_in_edges_tensor generation:  0.0008349418640136719
mini_batch_src_global generation:  0.0008285045623779297
r_  generation:  0.008213996887207031
local_output_nid generation:  0.0008873939514160156
local_in_edges_tensor generation:  0.0008111000061035156
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.011670351028442383
local_output_nid generation:  0.0008258819580078125
local_in_edges_tensor generation:  0.0007865428924560547
mini_batch_src_global generation:  0.0011806488037109375
r_  generation:  0.009502887725830078
local_output_nid generation:  0.0008590221405029297
local_in_edges_tensor generation:  0.0008637905120849609
mini_batch_src_global generation:  0.0017652511596679688
r_  generation:  0.014778375625610352
local_output_nid generation:  0.0008454322814941406
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.002154827117919922
r_  generation:  0.017608642578125
local_output_nid generation:  0.0009417533874511719
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0023221969604492188
r_  generation:  0.017679929733276367
local_output_nid generation:  0.000911712646484375
local_in_edges_tensor generation:  0.0007846355438232422
mini_batch_src_global generation:  0.0019927024841308594
r_  generation:  0.014551639556884766
local_output_nid generation:  0.0009417533874511719
local_in_edges_tensor generation:  0.0008411407470703125
mini_batch_src_global generation:  0.002268552780151367
r_  generation:  0.019528627395629883
local_output_nid generation:  0.001071929931640625
local_in_edges_tensor generation:  0.0010800361633300781
mini_batch_src_global generation:  0.0026161670684814453
r_  generation:  0.019900083541870117
local_output_nid generation:  0.0009682178497314453
local_in_edges_tensor generation:  0.0010578632354736328
mini_batch_src_global generation:  0.0023794174194335938
r_  generation:  0.016951799392700195
----------------------check_connections_block total spend ----------------------------- 0.5664651393890381
generate_one_block  0.017597198486328125
generate_one_block  0.011659622192382812
generate_one_block  0.011136770248413086
generate_one_block  0.011223554611206055
generate_one_block  0.0167236328125
generate_one_block  0.0169222354888916
generate_one_block  0.011691808700561523
generate_one_block  0.012431144714355469
generate_one_block  0.014376401901245117
generate_one_block  0.01624441146850586
generate_one_block  0.013634443283081055
generate_one_block  0.017113685607910156
generate_one_block  0.014620542526245117
generate_one_block  0.01642751693725586
generate_one_block  0.017751455307006836
generate_one_block  0.01718878746032715
generate_one_block  0.01707601547241211
generate_one_block  0.011574506759643555
generate_one_block  0.013181924819946289
generate_one_block  0.013727188110351562
generate_one_block  0.027476787567138672
generate_one_block  0.020616531372070312
generate_one_block  0.0170590877532959
generate_one_block  0.018637418746948242
generate_one_block  0.016855955123901367
generate_one_block  0.021938323974609375
generate_one_block  0.027896642684936523
generate_one_block  0.028224945068359375
generate_one_block  0.022719860076904297
generate_one_block  0.028839111328125
generate_one_block  0.03116917610168457
generate_one_block  0.026857614517211914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.050162315368652344
gen group dst list time:  0.011064529418945312
time for parepare:  0.022745132446289062
local_output_nid generation:  0.0012943744659423828
local_in_edges_tensor generation:  0.014436006546020508
mini_batch_src_global generation:  0.002228260040283203
r_  generation:  0.017188549041748047
local_output_nid generation:  0.0016982555389404297
local_in_edges_tensor generation:  0.0013647079467773438
mini_batch_src_global generation:  0.0016622543334960938
r_  generation:  0.013461828231811523
local_output_nid generation:  0.0015654563903808594
local_in_edges_tensor generation:  0.0013194084167480469
mini_batch_src_global generation:  0.0010502338409423828
r_  generation:  0.014831304550170898
local_output_nid generation:  0.003247976303100586
local_in_edges_tensor generation:  0.0013811588287353516
mini_batch_src_global generation:  0.0021724700927734375
r_  generation:  0.017354965209960938
local_output_nid generation:  0.00264739990234375
local_in_edges_tensor generation:  0.003068685531616211
mini_batch_src_global generation:  0.004169940948486328
r_  generation:  0.03402280807495117
local_output_nid generation:  0.0023300647735595703
local_in_edges_tensor generation:  0.002272367477416992
mini_batch_src_global generation:  0.0039174556732177734
r_  generation:  0.0333256721496582
local_output_nid generation:  0.0018665790557861328
local_in_edges_tensor generation:  0.002032041549682617
mini_batch_src_global generation:  0.002710580825805664
r_  generation:  0.02026200294494629
local_output_nid generation:  0.0017850399017333984
local_in_edges_tensor generation:  0.0014243125915527344
mini_batch_src_global generation:  0.0023348331451416016
r_  generation:  0.01987457275390625
local_output_nid generation:  0.0016932487487792969
local_in_edges_tensor generation:  0.0014052391052246094
mini_batch_src_global generation:  0.002620697021484375
r_  generation:  0.02196955680847168
local_output_nid generation:  0.001954317092895508
local_in_edges_tensor generation:  0.0016949176788330078
mini_batch_src_global generation:  0.008325576782226562
r_  generation:  0.027022838592529297
local_output_nid generation:  0.002082347869873047
local_in_edges_tensor generation:  0.0017855167388916016
mini_batch_src_global generation:  0.007239341735839844
r_  generation:  0.029433012008666992
local_output_nid generation:  0.0024225711822509766
local_in_edges_tensor generation:  0.00252532958984375
mini_batch_src_global generation:  0.004389762878417969
r_  generation:  0.03859066963195801
local_output_nid generation:  0.0022382736206054688
local_in_edges_tensor generation:  0.0019037723541259766
mini_batch_src_global generation:  0.0035567283630371094
r_  generation:  0.029310226440429688
local_output_nid generation:  0.0021440982818603516
local_in_edges_tensor generation:  0.001974344253540039
mini_batch_src_global generation:  0.0032722949981689453
r_  generation:  0.027234792709350586
local_output_nid generation:  0.002401113510131836
local_in_edges_tensor generation:  0.002275705337524414
mini_batch_src_global generation:  0.004050254821777344
r_  generation:  0.03378629684448242
local_output_nid generation:  0.002174854278564453
local_in_edges_tensor generation:  0.0027093887329101562
mini_batch_src_global generation:  0.0039522647857666016
r_  generation:  0.03431582450866699
local_output_nid generation:  0.0026595592498779297
local_in_edges_tensor generation:  0.0025441646575927734
mini_batch_src_global generation:  0.0037369728088378906
r_  generation:  0.03478384017944336
local_output_nid generation:  0.0018320083618164062
local_in_edges_tensor generation:  0.0021266937255859375
mini_batch_src_global generation:  0.003115415573120117
r_  generation:  0.02202129364013672
local_output_nid generation:  0.002253293991088867
local_in_edges_tensor generation:  0.0019083023071289062
mini_batch_src_global generation:  0.00298309326171875
r_  generation:  0.027683019638061523
local_output_nid generation:  0.0024700164794921875
local_in_edges_tensor generation:  0.0025119781494140625
mini_batch_src_global generation:  0.004114866256713867
r_  generation:  0.03788447380065918
local_output_nid generation:  0.00548100471496582
local_in_edges_tensor generation:  0.0080718994140625
mini_batch_src_global generation:  0.011756420135498047
r_  generation:  0.11568784713745117
local_output_nid generation:  0.0052034854888916016
local_in_edges_tensor generation:  0.00770258903503418
mini_batch_src_global generation:  0.011223077774047852
r_  generation:  0.08698654174804688
local_output_nid generation:  0.003695964813232422
local_in_edges_tensor generation:  0.004318952560424805
mini_batch_src_global generation:  0.00763392448425293
r_  generation:  0.06078314781188965
local_output_nid generation:  0.004166126251220703
local_in_edges_tensor generation:  0.006291627883911133
mini_batch_src_global generation:  0.00732731819152832
r_  generation:  0.07161712646484375
local_output_nid generation:  0.005161762237548828
local_in_edges_tensor generation:  0.00502467155456543
mini_batch_src_global generation:  0.008769750595092773
r_  generation:  0.08494377136230469
local_output_nid generation:  0.00575566291809082
local_in_edges_tensor generation:  0.009784460067749023
mini_batch_src_global generation:  0.015958309173583984
r_  generation:  0.11255955696105957
local_output_nid generation:  0.006978511810302734
local_in_edges_tensor generation:  0.009573936462402344
mini_batch_src_global generation:  0.016503572463989258
r_  generation:  0.14046621322631836
local_output_nid generation:  0.006994485855102539
local_in_edges_tensor generation:  0.012786626815795898
mini_batch_src_global generation:  0.01814436912536621
r_  generation:  0.14786028861999512
local_output_nid generation:  0.0060329437255859375
local_in_edges_tensor generation:  0.006527900695800781
mini_batch_src_global generation:  0.013710975646972656
r_  generation:  0.11320662498474121
local_output_nid generation:  0.006532192230224609
local_in_edges_tensor generation:  0.006644010543823242
mini_batch_src_global generation:  0.014885902404785156
r_  generation:  0.13201045989990234
local_output_nid generation:  0.0063304901123046875
local_in_edges_tensor generation:  0.007673501968383789
mini_batch_src_global generation:  0.01636505126953125
r_  generation:  0.13578438758850098
local_output_nid generation:  0.007168292999267578
local_in_edges_tensor generation:  0.008979558944702148
mini_batch_src_global generation:  0.01808786392211914
r_  generation:  0.15386414527893066
----------------------check_connections_block total spend ----------------------------- 2.7621941566467285
generate_one_block  0.024646997451782227
generate_one_block  0.028872251510620117
generate_one_block  0.018329143524169922
generate_one_block  0.02344036102294922
generate_one_block  0.04763197898864746
generate_one_block  0.04420614242553711
generate_one_block  0.027076244354248047
generate_one_block  0.026731491088867188
generate_one_block  0.029745817184448242
generate_one_block  0.03771257400512695
generate_one_block  0.04104137420654297
generate_one_block  0.054015398025512695
generate_one_block  0.040192365646362305
generate_one_block  0.03731393814086914
generate_one_block  0.047272443771362305
generate_one_block  0.047158241271972656
generate_one_block  0.04913783073425293
generate_one_block  0.030649662017822266
generate_one_block  0.03736734390258789
generate_one_block  0.052808523178100586
generate_one_block  0.16147160530090332
generate_one_block  0.12978792190551758
generate_one_block  0.08273029327392578
generate_one_block  0.09767961502075195
generate_one_block  0.12302112579345703
generate_one_block  0.15375351905822754
generate_one_block  0.2045588493347168
generate_one_block  0.2079019546508789
generate_one_block  0.1625373363494873
generate_one_block  0.19154071807861328
generate_one_block  0.19034147262573242
generate_one_block  0.2171003818511963
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03480052947998047
gen group dst list time:  0.040464162826538086
time for parepare:  0.019772768020629883
local_output_nid generation:  0.003236055374145508
local_in_edges_tensor generation:  0.013711690902709961
mini_batch_src_global generation:  0.003956317901611328
r_  generation:  0.0418553352355957
local_output_nid generation:  0.004230499267578125
local_in_edges_tensor generation:  0.003851175308227539
mini_batch_src_global generation:  0.00351715087890625
r_  generation:  0.03463101387023926
local_output_nid generation:  0.0028769969940185547
local_in_edges_tensor generation:  0.0025522708892822266
mini_batch_src_global generation:  0.0018482208251953125
r_  generation:  0.021144628524780273
local_output_nid generation:  0.00467371940612793
local_in_edges_tensor generation:  0.004080772399902344
mini_batch_src_global generation:  0.0030188560485839844
r_  generation:  0.04604029655456543
local_output_nid generation:  0.008213520050048828
local_in_edges_tensor generation:  0.008274555206298828
mini_batch_src_global generation:  0.00784921646118164
r_  generation:  0.08159399032592773
local_output_nid generation:  0.007866382598876953
local_in_edges_tensor generation:  0.0065708160400390625
mini_batch_src_global generation:  0.00809931755065918
r_  generation:  0.07723069190979004
local_output_nid generation:  0.0048329830169677734
local_in_edges_tensor generation:  0.004665851593017578
mini_batch_src_global generation:  0.005017757415771484
r_  generation:  0.04436445236206055
local_output_nid generation:  0.00423741340637207
local_in_edges_tensor generation:  0.0040607452392578125
mini_batch_src_global generation:  0.0034875869750976562
r_  generation:  0.041352033615112305
local_output_nid generation:  0.004472494125366211
local_in_edges_tensor generation:  0.00414276123046875
mini_batch_src_global generation:  0.0036630630493164062
r_  generation:  0.04475140571594238
local_output_nid generation:  0.005631685256958008
local_in_edges_tensor generation:  0.004892587661743164
mini_batch_src_global generation:  0.005352973937988281
r_  generation:  0.05782175064086914
local_output_nid generation:  0.007235050201416016
local_in_edges_tensor generation:  0.007165670394897461
mini_batch_src_global generation:  0.007037639617919922
r_  generation:  0.07872772216796875
local_output_nid generation:  0.008208751678466797
local_in_edges_tensor generation:  0.008003950119018555
mini_batch_src_global generation:  0.010356426239013672
r_  generation:  0.10084867477416992
local_output_nid generation:  0.005713462829589844
local_in_edges_tensor generation:  0.005299091339111328
mini_batch_src_global generation:  0.006422758102416992
r_  generation:  0.0574038028717041
local_output_nid generation:  0.004765748977661133
local_in_edges_tensor generation:  0.005051851272583008
mini_batch_src_global generation:  0.005090236663818359
r_  generation:  0.05126452445983887
local_output_nid generation:  0.005539655685424805
local_in_edges_tensor generation:  0.0054721832275390625
mini_batch_src_global generation:  0.00569462776184082
r_  generation:  0.06242942810058594
local_output_nid generation:  0.005316019058227539
local_in_edges_tensor generation:  0.005154132843017578
mini_batch_src_global generation:  0.005743265151977539
r_  generation:  0.058420419692993164
local_output_nid generation:  0.008031368255615234
local_in_edges_tensor generation:  0.008569717407226562
mini_batch_src_global generation:  0.009628534317016602
r_  generation:  0.09459972381591797
local_output_nid generation:  0.0064220428466796875
local_in_edges_tensor generation:  0.006123781204223633
mini_batch_src_global generation:  0.007222652435302734
r_  generation:  0.06686019897460938
local_output_nid generation:  0.006475210189819336
local_in_edges_tensor generation:  0.0056972503662109375
mini_batch_src_global generation:  0.0065081119537353516
r_  generation:  0.06842923164367676
local_output_nid generation:  0.008826017379760742
local_in_edges_tensor generation:  0.009714365005493164
mini_batch_src_global generation:  0.009930610656738281
r_  generation:  0.10656571388244629
local_output_nid generation:  0.013676643371582031
local_in_edges_tensor generation:  0.018023252487182617
mini_batch_src_global generation:  0.020581960678100586
r_  generation:  0.19573068618774414
local_output_nid generation:  0.015568017959594727
local_in_edges_tensor generation:  0.02513599395751953
mini_batch_src_global generation:  0.023533105850219727
r_  generation:  0.22124814987182617
local_output_nid generation:  0.012146472930908203
local_in_edges_tensor generation:  0.01682877540588379
mini_batch_src_global generation:  0.01744818687438965
r_  generation:  0.1575946807861328
local_output_nid generation:  0.011041879653930664
local_in_edges_tensor generation:  0.012133121490478516
mini_batch_src_global generation:  0.015221118927001953
r_  generation:  0.1449286937713623
local_output_nid generation:  0.015451669692993164
local_in_edges_tensor generation:  0.01798391342163086
mini_batch_src_global generation:  0.020965099334716797
r_  generation:  0.21340012550354004
local_output_nid generation:  0.01494741439819336
local_in_edges_tensor generation:  0.021793365478515625
mini_batch_src_global generation:  0.02174091339111328
r_  generation:  0.22094273567199707
local_output_nid generation:  0.016438007354736328
local_in_edges_tensor generation:  0.019476890563964844[03:32:48] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2760 nodes and 76590 edges into 2 parts and get 2041 edge cuts

mini_batch_src_global generation:  0.026342153549194336
r_  generation:  0.2391366958618164
local_output_nid generation:  0.015743732452392578
local_in_edges_tensor generation:  0.02342057228088379
mini_batch_src_global generation:  0.024028539657592773
r_  generation:  0.2409219741821289
local_output_nid generation:  0.018954753875732422
local_in_edges_tensor generation:  0.01646733283996582
mini_batch_src_global generation:  0.024892091751098633
r_  generation:  0.20689606666564941
local_output_nid generation:  0.014367341995239258
local_in_edges_tensor generation:  0.016265869140625
mini_batch_src_global generation:  0.020561933517456055
r_  generation:  0.20238447189331055
local_output_nid generation:  0.013907909393310547
local_in_edges_tensor generation:  0.015299320220947266
mini_batch_src_global generation:  0.02032303810119629
r_  generation:  0.19542217254638672
local_output_nid generation:  0.01682734489440918
local_in_edges_tensor generation:  0.01956343650817871
mini_batch_src_global generation:  0.02438497543334961
r_  generation:  0.24448871612548828
----------------------check_connections_block total spend ----------------------------- 5.469847917556763
generate_one_block  0.06693482398986816
generate_one_block  0.04622626304626465
generate_one_block  0.027996540069580078
generate_one_block  0.05695819854736328
generate_one_block  0.10109615325927734
generate_one_block  0.10204911231994629
generate_one_block  0.0607454776763916
generate_one_block  0.054555416107177734
generate_one_block  0.08973264694213867
generate_one_block  0.08051919937133789
generate_one_block  0.1046597957611084
generate_one_block  0.13359284400939941
generate_one_block  0.07655453681945801
generate_one_block  0.06917548179626465
generate_one_block  0.08309721946716309
generate_one_block  0.0788259506225586
generate_one_block  0.12960457801818848
generate_one_block  0.09125757217407227
generate_one_block  0.08977270126342773
generate_one_block  0.14006996154785156
generate_one_block  0.2618834972381592
generate_one_block  0.2901129722595215
generate_one_block  0.20328259468078613
generate_one_block  0.18853187561035156
generate_one_block  0.2813072204589844
generate_one_block  0.27319765090942383
generate_one_block  0.3115105628967285
generate_one_block  0.3058900833129883
generate_one_block  0.26526451110839844
generate_one_block  0.26296424865722656
generate_one_block  0.25696253776550293
generate_one_block  0.31836771965026855
global_2_local spend time (sec) 0.004259586334228516
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0009059906005859375
A = g.adjacency_matrix() spent  0.0005655288696289062
auxiliary_graph
Graph(num_nodes=16101, num_edges=79350,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.011672735214233398
remove nodes length
13341
auxiliary_graph.remove_nodes spent  0.0057065486907958984
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2760, num_edges=79350,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0034627914428710938

the counter of shared neighbor distribution
Counter({1.0: 62426, 2.0: 8766, 3.0: 2748, 4.0: 1082, 5.0: 598, 6.0: 320, 7.0: 204, 8.0: 134, 9.0: 102, 10.0: 64, 12.0: 36, 11.0: 34, 13.0: 20, 14.0: 12, 15.0: 12, 19.0: 8, 22.0: 4, 25.0: 4, 18.0: 4, 20.0: 4, 17.0: 4, 16.0: 2, 21.0: 2})
76590
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([    0,     1,     2,  ..., 76587, 76588, 76589])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 62426, 2.0: 8766, 3.0: 2748, 4.0: 1082, 5.0: 598, 6.0: 320, 7.0: 204, 8.0: 134, 9.0: 102, 10.0: 64, 12.0: 36, 11.0: 34, 13.0: 20, 14.0: 12, 15.0: 12, 19.0: 8, 22.0: 4, 25.0: 4, 18.0: 4, 20.0: 4, 17.0: 4, 16.0: 2, 21.0: 2})
Convert a graph into a bidirected graph: 0.003 seconds
Metis partitioning: 0.008 seconds
Split the graph: 0.007 seconds
Construct subgraphs: 0.016 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.03452420234680176
1370
1390
total k batches seeds list generation spend  0.09863018989562988
after graph partition
graph partition algorithm spend time 0.1092836856842041
1370
1390
time for parepare:  0.02187347412109375
local_output_nid generation:  0.0003058910369873047
local_in_edges_tensor generation:  0.002620697021484375
mini_batch_src_global generation:  0.000579833984375
r_  generation:  0.004323244094848633
local_output_nid generation:  0.000270843505859375
local_in_edges_tensor generation:  0.001434326171875
mini_batch_src_global generation:  0.0007963180541992188
r_  generation:  0.005465984344482422
----------------------check_connections_block total spend ----------------------------- 0.04554390907287598
generate_one_block  0.00920414924621582
generate_one_block  0.010852336883544922
time for parepare:  0.02173471450805664
local_output_nid generation:  0.0014715194702148438
local_in_edges_tensor generation:  0.00756072998046875
mini_batch_src_global generation:  0.0024988651275634766
r_  generation:  0.02898693084716797
local_output_nid generation:  0.0030241012573242188
local_in_edges_tensor generation:  0.005403757095336914
mini_batch_src_global generation:  0.00649571418762207
r_  generation:  0.061194658279418945
----------------------check_connections_block total spend ----------------------------- 0.1675736904144287
generate_one_block  0.04475283622741699
generate_one_block  0.08696508407592773
time for parepare:  0.019584178924560547
local_output_nid generation:  0.005599260330200195
local_in_edges_tensor generation:  0.011346817016601562
mini_batch_src_global generation:  0.008226633071899414
r_  generation:  0.09504818916320801
local_output_nid generation:  0.013759374618530273
local_in_edges_tensor generation:  0.014261484146118164
mini_batch_src_global generation:  0.015797138214111328
r_  generation:  0.16791176795959473
----------------------check_connections_block total spend ----------------------------- 0.4183166027069092
generate_one_block  0.13671207427978516
generate_one_block  0.22625088691711426
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04575967788696289  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

connection checking time:  8.232042074203491
block generation total time  7.570474863052368
average batch blocks generation time:  0.2365773394703865
block dataloader generation time/epoch 47.23024868965149
pseudo mini batch 0 input nodes size: 39983
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04260873794555664  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04260873794555664  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06213998794555664  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.062161922454833984  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.040667057037353516  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04177522659301758  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04177522659301758  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 39983
first layer output nodes number: 14187
edges number: 93916
input nodes number: 14187
output nodes number: 5476
edges number: 36985
input nodes number: 5476
output nodes number: 2884
edges number: 17762
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.6440753936767578  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.6440763473510742  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.044289588928222656  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 1 input nodes size: 33153
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0408935546875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0408935546875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0567021369934082  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.056723594665527344  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03717041015625  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03808021545410156  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03808021545410156  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 33153
first layer output nodes number: 11652
edges number: 74545
input nodes number: 11652
output nodes number: 4921
edges number: 31137
input nodes number: 4921
output nodes number: 2822
edges number: 16234
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.373727798461914  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.3737282752990723  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03998708724975586  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 2 input nodes size: 17370
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03716087341308594  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03716087341308594  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04544353485107422  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04546546936035156  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.02963542938232422  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.030321121215820312  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.030321121215820312  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 17370
first layer output nodes number: 8395
edges number: 45837
input nodes number: 8395
output nodes number: 5090
edges number: 29294
input nodes number: 5090
output nodes number: 2911
edges number: 16765
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.1202278137207031  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.1202282905578613  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0318293571472168  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 3 input nodes size: 38915
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.029648780822753906  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.029648780822753906  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.049180030822753906  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04920196533203125  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.040897369384765625  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.042022705078125  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.042022705078125  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 38915
first layer output nodes number: 14579
edges number: 95642
input nodes number: 14579
output nodes number: 5681
edges number: 38325
input nodes number: 5681
output nodes number: 2909
edges number: 16857
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.6621627807617188  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.662163257598877  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04433727264404297  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 4 input nodes size: 56467
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.040897369384765625  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.040897369384765625  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06824111938476562  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06826305389404297  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.048709869384765625  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05083465576171875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05083465576171875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 56467
first layer output nodes number: 24138
edges number: 176012
input nodes number: 24138
output nodes number: 8285
edges number: 81918
input nodes number: 8285
output nodes number: 2913
edges number: 27101
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.0893940925598145  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.0893945693969727  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05495309829711914  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 5 input nodes size: 58415
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04871034622192383  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04871034622192383  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07656478881835938  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07658672332763672  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.049221038818359375  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.051293373107910156  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.051293373107910156  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 58415
first layer output nodes number: 23230
edges number: 171151
input nodes number: 23230
output nodes number: 8011
edges number: 78617
input nodes number: 8011
output nodes number: 2910
edges number: 28087
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.0076417922973633  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.0076422691345215  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05532979965209961  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 6 input nodes size: 38249
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04922056198120117  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04922056198120117  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0674591064453125  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06748056411743164  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03960418701171875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.040833473205566406  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.040833473205566406  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 38249
first layer output nodes number: 14954
edges number: 101432
input nodes number: 14954
output nodes number: 5924
edges number: 44814
input nodes number: 5924
output nodes number: 2876
edges number: 18451
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.8342628479003906  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.8342633247375488  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04331636428833008  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 7 input nodes size: 33667
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.039598941802978516  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.039598941802978516  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.055652618408203125  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05567455291748047  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03741455078125  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03859901428222656  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03859901428222656  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 33667
first layer output nodes number: 14058
edges number: 93001
input nodes number: 14058
output nodes number: 5918
edges number: 45372
input nodes number: 5918
output nodes number: 2882
edges number: 20479
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.8002920150756836  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 1.8002924919128418  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04100799560546875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 8 input nodes size: 34844
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.037415504455566406  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.037415504455566406  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.054030418395996094  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05405139923095703  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03797578811645508  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03932809829711914  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03932809829711914  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 34844
first layer output nodes number: 14134
edges number: 102324
input nodes number: 14134
output nodes number: 5620
edges number: 53432
input nodes number: 5620
output nodes number: 2791
edges number: 25501
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.064350128173828  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.0643506050109863  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04199028015136719  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 9 input nodes size: 41066
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03796243667602539  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03796243667602539  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05754423141479492  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05756521224975586  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.040929317474365234  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04266786575317383  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04266786575317383  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 41066
first layer output nodes number: 18202
edges number: 137229
input nodes number: 18202
output nodes number: 6544
edges number: 67557
input nodes number: 6544
output nodes number: 2815
edges number: 28341
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.577972412109375  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.577972888946533  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04601860046386719  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 10 input nodes size: 59086
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.040932655334472656  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.040932655334472656  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0691070556640625  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06912803649902344  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04952526092529297  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.051543235778808594  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.051543235778808594  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 59086
first layer output nodes number: 23886
edges number: 177593
input nodes number: 23886
output nodes number: 7171
edges number: 70875
input nodes number: 7171
output nodes number: 2781
edges number: 22255
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.8641858100891113  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.8641862869262695  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.055419921875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 11 input nodes size: 69307
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04952049255371094  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04952049255371094  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08272361755371094  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08274555206298828  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0545501708984375  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05716133117675781  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05716133117675781  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 69307
first layer output nodes number: 28549
edges number: 226630
input nodes number: 28549
output nodes number: 8214
edges number: 94433
input nodes number: 8214
output nodes number: 2927
edges number: 29294
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.704982280731201  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.7049827575683594  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.062090396881103516  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 12 input nodes size: 38668
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05457162857055664  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05457162857055664  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07300996780395508  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07303094863891602  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03980588912963867  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04151010513305664  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04151010513305664  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 38668
first layer output nodes number: 18588
edges number: 132039
input nodes number: 18588
output nodes number: 7198
edges number: 71697
input nodes number: 7198
output nodes number: 2779
edges number: 24771
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.5474929809570312  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.5474934577941895  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.044811248779296875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 13 input nodes size: 31984
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03978395462036133  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03978395462036133  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05540895462036133  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05543088912963867  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0369715690612793  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.038607120513916016  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.038607120513916016  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 31984
first layer output nodes number: 16452
edges number: 122753
input nodes number: 16452
output nodes number: 6443
edges number: 67982
input nodes number: 6443
output nodes number: 2895
edges number: 28490
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.4680304527282715  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.4680309295654297  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04176521301269531  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 14 input nodes size: 43152
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03698873519897461  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03698873519897461  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05847311019897461  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05849504470825195  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04284811019897461  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04480314254760742  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04480314254760742  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 43152
first layer output nodes number: 20201
edges number: 145386
input nodes number: 20201
output nodes number: 8145
edges number: 85774
input nodes number: 8145
output nodes number: 2890
edges number: 31012
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.965230941772461  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.965231418609619  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04861927032470703  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 15 input nodes size: 37025
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.042847633361816406  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.042847633361816406  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06050252914428711  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06052446365356445  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.03901815414428711  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04093503952026367  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04093503952026367  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 37025
first layer output nodes number: 18886
edges number: 138658
input nodes number: 18886
output nodes number: 7926
edges number: 88459
input nodes number: 7926
output nodes number: 2927
edges number: 29879
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.9159040451049805  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.9159045219421387  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04465007781982422  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 16 input nodes size: 70720
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.039023399353027344  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.039023399353027344  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07274532318115234  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07276678085327148  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05508995056152344  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05748748779296875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05748748779296875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 70720
first layer output nodes number: 29122
edges number: 217717
input nodes number: 29122
output nodes number: 8802
edges number: 83221
input nodes number: 8802
output nodes number: 2878
edges number: 20707
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.362596035003662  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.3625965118408203  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06206226348876953  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 17 input nodes size: 58888
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05508279800415039  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05508279800415039  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08316278457641602  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08318471908569336  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04944133758544922  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0510711669921875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0510711669921875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 58888
first layer output nodes number: 20710
edges number: 151239
input nodes number: 20710
output nodes number: 6405
edges number: 49963
input nodes number: 6405
output nodes number: 2927
edges number: 17342
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.289498805999756  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.289499282836914  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0542912483215332  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 18 input nodes size: 54871
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.049448490142822266  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.049448490142822266  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07561302185058594  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07563495635986328  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04753303527832031  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04930400848388672  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04930400848388672  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 54871
first layer output nodes number: 22047
edges number: 152421
input nodes number: 22047
output nodes number: 8059
edges number: 64806
input nodes number: 8059
output nodes number: 2924
edges number: 20347
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.562319755554199  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 2.5623202323913574  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.052825927734375  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 19 input nodes size: 75684
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04753255844116211  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.04753255844116211  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08362150192260742  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08364248275756836  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.057456016540527344  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06009197235107422  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06009197235107422  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 75684
first layer output nodes number: 31950
edges number: 241502
input nodes number: 31950
output nodes number: 9010
edges number: 91028
input nodes number: 9010
output nodes number: 2796
edges number: 21084
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.6589417457580566  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.658942222595215  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06505823135375977  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 20 input nodes size: 88801
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05743694305419922  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05743694305419922  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09978055953979492  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09980154037475586  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06369161605834961  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06973505020141602  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06973505020141602  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 88801
first layer output nodes number: 55196
edges number: 467004
input nodes number: 55196
output nodes number: 18686
edges number: 300826
input nodes number: 18686
output nodes number: 2758
edges number: 43069
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.824493408203125  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.824493885040283  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08326387405395508  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 21 input nodes size: 87691
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06368589401245117  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06368589401245117  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.1055002212524414  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10552120208740234  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0631566047668457  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0670323371887207  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0670323371887207  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 87691
first layer output nodes number: 45149
edges number: 360850
input nodes number: 45149
output nodes number: 11625
edges number: 139384
input nodes number: 11625
output nodes number: 2772
edges number: 19747
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 5.304272651672363  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 5.3042731285095215  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07421588897705078  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 22 input nodes size: 77518
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06315898895263672  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06315898895263672  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10012245178222656  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.1001439094543457  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05830860137939453  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06319475173950195  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06319475173950195  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 77518
first layer output nodes number: 41377
edges number: 336721
input nodes number: 41377
output nodes number: 13384
edges number: 176320
input nodes number: 13384
output nodes number: 2825
edges number: 29211
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 5.779238700866699  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 5.779239177703857  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07061338424682617  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 23 input nodes size: 103992
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05831623077392578  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05831623077392578  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10790348052978516  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.1079244613647461  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07093954086303711  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07648992538452148  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07648992538452148  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 103992
first layer output nodes number: 61206
edges number: 503204
input nodes number: 61206
output nodes number: 15589
edges number: 218238
input nodes number: 15589
output nodes number: 2784
edges number: 23390
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 7.634427547454834  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 7.634428024291992  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08635950088500977  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 24 input nodes size: 98527
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07093334197998047  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07093334197998047  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11791467666625977  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.1179356575012207  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06832742691040039  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07434415817260742  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07434415817260742  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 98527
first layer output nodes number: 58891
edges number: 492254
input nodes number: 58891
output nodes number: 18148
edges number: 280963
input nodes number: 18148
output nodes number: 2791
edges number: 34118
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.622796535491943  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.622797012329102  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08578157424926758  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 25 input nodes size: 104218
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.068328857421875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.068328857421875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11802387237548828  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11804485321044922  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07104253768920898  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07828664779663086  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07828664779663086  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 104218
first layer output nodes number: 67029
edges number: 562259
input nodes number: 67029
output nodes number: 22388
edges number: 368004
input nodes number: 22388
output nodes number: 2796
edges number: 41773
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.542925834655762  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.54292631149292  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09445714950561523  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 26 input nodes size: 99724
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07104301452636719  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07104301452636719  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11859512329101562  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11861658096313477  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06890058517456055  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07619428634643555  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07619428634643555  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 99724
first layer output nodes number: 66213
edges number: 553165
input nodes number: 66213
output nodes number: 23040
edges number: 382469
input nodes number: 23040
output nodes number: 2866
edges number: 43132
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.697806358337402  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.69780683517456  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09113597869873047  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 27 input nodes size: 93648
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06891107559204102  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06891107559204102  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11356592178344727  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.1135869026184082  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06601333618164062  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07238960266113281  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07238960266113281  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 93648
first layer output nodes number: 57593
edges number: 481454
input nodes number: 57593
output nodes number: 18584
edges number: 296314
input nodes number: 18584
output nodes number: 2758
edges number: 33491
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.745742797851562  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 8.74574327468872  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0837850570678711  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 28 input nodes size: 86894
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06599712371826172  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06599712371826172  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10743141174316406  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.107452392578125  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06277656555175781  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06925201416015625  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06925201416015625  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 86894
first layer output nodes number: 55533
edges number: 472280
input nodes number: 55533
output nodes number: 20571
edges number: 351508
input nodes number: 20571
output nodes number: 2758
edges number: 45158
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 9.620412349700928  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 9.620412826538086  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08116626739501953  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 29 input nodes size: 84223
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06277656555175781  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06277656555175781  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10293722152709961  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10295867919921875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06150341033935547  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06794071197509766  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06794071197509766  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 84223
first layer output nodes number: 54086
edges number: 461298
input nodes number: 54086
output nodes number: 20307
edges number: 353119
input nodes number: 20307
output nodes number: 2878
edges number: 49518
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 9.628626346588135  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 9.628626823425293  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.08109664916992188  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 30 input nodes size: 102538
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06152153015136719  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06152153015136719  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11041545867919922  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.11043643951416016  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07025432586669922  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07794046401977539  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07794046401977539  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 102538
first layer output nodes number: 67228
edges number: 561303
input nodes number: 67228
output nodes number: 23030
edges number: 388733
input nodes number: 23030
output nodes number: 2758
edges number: 41027
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.82394552230835  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 10.823945999145508  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09239006042480469  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 31 input nodes size: 74752
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0702362060546875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0702362060546875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.1058807373046875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.10589122772216797  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.056976318359375  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05931854248046875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05931854248046875  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 74752
first layer output nodes number: 28827
edges number: 230859
input nodes number: 28827
output nodes number: 6525
edges number: 72275
input nodes number: 6525
output nodes number: 1370
edges number: 11022
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.1347241401672363  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 3.1347246170043945  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06344032287597656  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

pseudo mini batch 32 input nodes size: 90297Using backend: pytorch

----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05676984786987305  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.05676984786987305  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.09982681274414062  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.0998373031616211  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06418228149414062  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06843376159667969  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.06843376159667969  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

first layer input nodes number: 90297
first layer output nodes number: 47338
edges number: 402942
input nodes number: 47338
output nodes number: 10021
edges number: 153207
input nodes number: 10021
output nodes number: 1390
edges number: 14341
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 5.704615116119385  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 5.704615592956543  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07590961456298828  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07590961456298828  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.2021484375 GB
    Memory Allocated: 0.07590961456298828  GigaBytes
Max Memory Allocated: 11.120779037475586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05081633365515507 |0.005232702602039684 |0.28655795617537066 |0.00011206395698316169 |0.43029484604344226 |0.010277748107910156 |
----------------------------------------------------------pseudo_mini_loss sum 4.328907489776611
Total (block generation + training)time/epoch 73.2893226146698
Training time/epoch 25.771336793899536
Training time without block to device /epoch 25.598657608032227
Training time without total dataloading part /epoch 23.67011833190918
load block tensor time/epoch 1.6769390106201172
block to device time/epoch 0.17267918586730957
input features size transfer per epoch 4.425644874572754e-06
blocks size to device per epoch 2.950429916381836e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3578664
Number of first layer input nodes during this epoch:  2124337
Number of first layer output nodes during this epoch:  1093586
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  1402880
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.2.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.2.lstm.bias_ih_l0, torch.Size([1024])
layers.2.lstm.bias_hh_l0, torch.Size([1024])
layers.2.fc_self.weight, torch.Size([40, 256])
layers.2.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
bns.1.weight, torch.Size([256])
bns.1.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
