[23:58:04] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37292890 edges into 32 parts and get 12503062 edge cuts
main start at this time 1652227053.2677722
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024317264556884766
global_2_local spend time (sec) 0.03910708427429199
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004828691482543945
A = g.adjacency_matrix() spent  0.006995439529418945
auxiliary_graph
Graph(num_nodes=158265, num_edges=37383831,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10141777992248535
remove nodes length
67324
auxiliary_graph.remove_nodes spent  2.0409064292907715
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37383831,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.6906001567840576

the counter of shared neighbor distribution
Counter({1.0: 28475226, 2.0: 5923800, 3.0: 1746856, 4.0: 610464, 5.0: 250590, 6.0: 118902, 7.0: 62202, 8.0: 35984, 9.0: 21766, 10.0: 14382, 11.0: 9346, 12.0: 6378, 13.0: 4572, 14.0: 3354, 15.0: 2406, 16.0: 1744, 17.0: 1196, 18.0: 914, 19.0: 674, 20.0: 572, 21.0: 382, 22.0: 354, 23.0: 214, 24.0: 166, 25.0: 128, 26.0: 100, 27.0: 52, 28.0: 40, 30.0: 38, 29.0: 30, 31.0: 14, 32.0: 12, 33.0: 8, 40.0: 4, 39.0: 4, 35.0: 4, 34.0: 4, 38.0: 4, 37.0: 2, 49.0: 2})
37292890
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37292887, 37292888, 37292889])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28475226, 2.0: 5923800, 3.0: 1746856, 4.0: 610464, 5.0: 250590, 6.0: 118902, 7.0: 62202, 8.0: 35984, 9.0: 21766, 10.0: 14382, 11.0: 9346, 12.0: 6378, 13.0: 4572, 14.0: 3354, 15.0: 2406, 16.0: 1744, 17.0: 1196, 18.0: 914, 19.0: 674, 20.0: 572, 21.0: 382, 22.0: 354, 23.0: 214, 24.0: 166, 25.0: 128, 26.0: 100, 27.0: 52, 28.0: 40, 30.0: 38, 29.0: 30, 31.0: 14, 32.0: 12, 33.0: 8, 40.0: 4, 39.0: 4, 35.0: 4, 34.0: 4, 38.0: 4, 37.0: 2, 49.0: 2})
Convert a graph into a bidirected graph: 2.583 seconds
Metis partitioning: 8.652 seconds
Split the graph: 0.965 seconds
Construct subgraphs: 0.161 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  12.377985715866089
2927
2832
2832
2874
2833
2788
2870
2845
2889
2867
2927
2906
2910
2871
2865
2897
2828
2922
2804
2793
2758
2873
2817
2758
2788
2781
2927
2758
2927
2758
2758
2758
total k batches seeds list generation spend  27.998880624771118
after graph partition
graph partition algorithm spend time 28.113076210021973
2927
2832
2832
2874
2833
2788
2870
2845
2889
2867
2927
2906
2910
2871
2865
2897
2828
2922
2804
2793
2758
2873
2817
2758
2788
2781
2927
2758
2927
2758
2758
2758
partition_len_list
[7880, 7935, 6983, 6218, 5358, 5993, 6221, 6574, 8077, 7726, 9198, 7413, 6003, 5435, 6363, 5231, 7078, 6892, 8775, 9533, 17804, 10947, 14040, 11000, 16707, 17810, 23651, 22511, 22984, 19907, 21182, 21118]
shared_neighbor_graph_partition_s0 selection method  spend 28.20971441268921
time for parepare:  0.020259857177734375
local_output_nid generation:  0.0005970001220703125
local_in_edges_tensor generation:  0.001241922378540039
mini_batch_src_global generation:  0.0014226436614990234
r_  generation:  0.010792732238769531
local_output_nid generation:  0.0007383823394775391
local_in_edges_tensor generation:  0.0007951259613037109
mini_batch_src_global generation:  0.0013935565948486328
r_  generation:  0.011059284210205078
local_output_nid generation:  0.0007967948913574219
local_in_edges_tensor generation:  0.0007288455963134766
mini_batch_src_global generation:  0.0009045600891113281
r_  generation:  0.009588003158569336
local_output_nid generation:  0.0007824897766113281
local_in_edges_tensor generation:  0.0006661415100097656
mini_batch_src_global generation:  0.0006961822509765625
r_  generation:  0.006714582443237305
local_output_nid generation:  0.0007548332214355469
local_in_edges_tensor generation:  0.0006976127624511719
mini_batch_src_global generation:  0.0008213520050048828
r_  generation:  0.009517192840576172
local_output_nid generation:  0.0007116794586181641
local_in_edges_tensor generation:  0.0006778240203857422
mini_batch_src_global generation:  0.0008223056793212891
r_  generation:  0.008378744125366211
local_output_nid generation:  0.0007176399230957031
local_in_edges_tensor generation:  0.0007395744323730469
mini_batch_src_global generation:  0.0009849071502685547
r_  generation:  0.010224342346191406
local_output_nid generation:  0.0006918907165527344
local_in_edges_tensor generation:  0.0007042884826660156
mini_batch_src_global generation:  0.0008833408355712891
r_  generation:  0.009518623352050781
local_output_nid generation:  0.0006868839263916016
local_in_edges_tensor generation:  0.0007045269012451172
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.009552001953125
local_output_nid generation:  0.0006577968597412109
local_in_edges_tensor generation:  0.000675201416015625
mini_batch_src_global generation:  0.0007774829864501953
r_  generation:  0.008050203323364258
local_output_nid generation:  0.00064849853515625
local_in_edges_tensor generation:  0.0007131099700927734
mini_batch_src_global generation:  0.0009164810180664062
r_  generation:  0.01004171371459961
local_output_nid generation:  0.0006468296051025391
local_in_edges_tensor generation:  0.0007107257843017578
mini_batch_src_global generation:  0.0009684562683105469
r_  generation:  0.010087728500366211
local_output_nid generation:  0.0006375312805175781
local_in_edges_tensor generation:  0.0007307529449462891
mini_batch_src_global generation:  0.0007650852203369141
r_  generation:  0.008196592330932617
local_output_nid generation:  0.0006215572357177734
local_in_edges_tensor generation:  0.0009615421295166016
mini_batch_src_global generation:  0.0006108283996582031
r_  generation:  0.006551027297973633
local_output_nid generation:  0.0006079673767089844
local_in_edges_tensor generation:  0.00080108642578125
mini_batch_src_global generation:  0.0007779598236083984
r_  generation:  0.009037256240844727
local_output_nid generation:  0.0006005764007568359
local_in_edges_tensor generation:  0.0006825923919677734
mini_batch_src_global generation:  0.0007066726684570312
r_  generation:  0.007456302642822266
local_output_nid generation:  0.0005848407745361328
local_in_edges_tensor generation:  0.0006515979766845703
mini_batch_src_global generation:  0.0006246566772460938
r_  generation:  0.006819963455200195
local_output_nid generation:  0.0005941390991210938
local_in_edges_tensor generation:  0.0006620883941650391
mini_batch_src_global generation:  0.0006384849548339844
r_  generation:  0.0071828365325927734
local_output_nid generation:  0.0005552768707275391
local_in_edges_tensor generation:  0.0008568763732910156
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.009026288986206055
local_output_nid generation:  0.0005519390106201172
local_in_edges_tensor generation:  0.0007483959197998047
mini_batch_src_global generation:  0.0007958412170410156
r_  generation:  0.008426904678344727
local_output_nid generation:  0.0005486011505126953
local_in_edges_tensor generation:  0.0011928081512451172
mini_batch_src_global generation:  0.002413511276245117
r_  generation:  0.0163881778717041
local_output_nid generation:  0.0006277561187744141
local_in_edges_tensor generation:  0.0007741451263427734
mini_batch_src_global generation:  0.001039743423461914
r_  generation:  0.009873628616333008
local_output_nid generation:  0.0006568431854248047
local_in_edges_tensor generation:  0.0007469654083251953
mini_batch_src_global generation:  0.0010306835174560547
r_  generation:  0.011352300643920898
local_output_nid generation:  0.0006213188171386719
local_in_edges_tensor generation:  0.0006492137908935547
mini_batch_src_global generation:  0.0007860660552978516
r_  generation:  0.007845401763916016
local_output_nid generation:  0.0006122589111328125
local_in_edges_tensor generation:  0.0006964206695556641
mini_batch_src_global generation:  0.0009365081787109375
r_  generation:  0.010553598403930664
local_output_nid generation:  0.0006160736083984375
local_in_edges_tensor generation:  0.005356311798095703
mini_batch_src_global generation:  0.0012769699096679688
r_  generation:  0.011232614517211914
local_output_nid generation:  0.0006105899810791016
local_in_edges_tensor generation:  0.0009694099426269531
mini_batch_src_global generation:  0.002508401870727539
r_  generation:  0.020518779754638672
local_output_nid generation:  0.0006642341613769531
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.0024635791778564453
r_  generation:  0.016859054565429688
local_output_nid generation:  0.0007517337799072266
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.002665996551513672
r_  generation:  0.022365093231201172
local_output_nid generation:  0.0007848739624023438
local_in_edges_tensor generation:  0.0007460117340087891
mini_batch_src_global generation:  0.002161741256713867
r_  generation:  0.01422429084777832
local_output_nid generation:  0.0007688999176025391
local_in_edges_tensor generation:  0.0007636547088623047
mini_batch_src_global generation:  0.0014562606811523438
r_  generation:  0.01618814468383789
local_output_nid generation:  0.0007777214050292969
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.0016243457794189453
r_  generation:  0.01691460609436035
----------------------check_connections_block total spend ----------------------------- 0.5425496101379395
generate_one_block  0.02286815643310547
generate_one_block  0.017330408096313477
generate_one_block  0.013989686965942383
generate_one_block  0.00985097885131836
generate_one_block  0.013488054275512695
generate_one_block  0.01188206672668457
generate_one_block  0.014676094055175781
generate_one_block  0.013366222381591797
generate_one_block  0.013873577117919922
generate_one_block  0.012129545211791992
generate_one_block  0.015412092208862305
generate_one_block  0.014603137969970703
generate_one_block  0.011207103729248047
generate_one_block  0.009037256240844727
generate_one_block  0.01264643669128418
generate_one_block  0.01031947135925293
generate_one_block  0.009943008422851562
generate_one_block  0.01010441780090332
generate_one_block  0.013518571853637695
generate_one_block  0.01222848892211914
generate_one_block  0.023223400115966797
generate_one_block  0.013972282409667969
generate_one_block  0.01662755012512207
generate_one_block  0.011106491088867188
generate_one_block  0.01646709442138672
generate_one_block  0.01724720001220703
generate_one_block  0.0277407169342041
generate_one_block  0.024825572967529297
generate_one_block  0.03040480613708496
generate_one_block  0.021021604537963867
generate_one_block  0.024820327758789062
generate_one_block  0.025272130966186523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06203603744506836
gen group dst list time:  0.011803627014160156
time for parepare:  0.02752828598022461
local_output_nid generation:  0.001424551010131836
local_in_edges_tensor generation:  0.01716160774230957
mini_batch_src_global generation:  0.003545045852661133
r_  generation:  0.03312849998474121
local_output_nid generation:  0.002638101577758789
local_in_edges_tensor generation:  0.0023467540740966797
mini_batch_src_global generation:  0.0038895606994628906
r_  generation:  0.03218483924865723
local_output_nid generation:  0.0017476081848144531
local_in_edges_tensor generation:  0.0015957355499267578
mini_batch_src_global generation:  0.003434896469116211
r_  generation:  0.027303695678710938
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0012993812561035156
mini_batch_src_global generation:  0.00238037109375
r_  generation:  0.017963886260986328
local_output_nid generation:  0.0012094974517822266
local_in_edges_tensor generation:  0.0012333393096923828
mini_batch_src_global generation:  0.002375364303588867
r_  generation:  0.020093441009521484
local_output_nid generation:  0.0013399124145507812
local_in_edges_tensor generation:  0.0013356208801269531
mini_batch_src_global generation:  0.002611398696899414
r_  generation:  0.021420717239379883
local_output_nid generation:  0.001409292221069336
local_in_edges_tensor generation:  0.001665353775024414
mini_batch_src_global generation:  0.003000974655151367
r_  generation:  0.025475025177001953
local_output_nid generation:  0.0012857913970947266
local_in_edges_tensor generation:  0.0016601085662841797
mini_batch_src_global generation:  0.003030061721801758
r_  generation:  0.025821685791015625
local_output_nid generation:  0.0017964839935302734
local_in_edges_tensor generation:  0.0023200511932373047
mini_batch_src_global generation:  0.003735780715942383
r_  generation:  0.03152179718017578
local_output_nid generation:  0.0016493797302246094
local_in_edges_tensor generation:  0.0017278194427490234
mini_batch_src_global generation:  0.003071308135986328
r_  generation:  0.02637004852294922
local_output_nid generation:  0.002071380615234375
local_in_edges_tensor generation:  0.002450227737426758
mini_batch_src_global generation:  0.004242897033691406
r_  generation:  0.03970599174499512
local_output_nid generation:  0.0019459724426269531
local_in_edges_tensor generation:  0.0020258426666259766
mini_batch_src_global generation:  0.003804445266723633
r_  generation:  0.03127908706665039
local_output_nid generation:  0.0015940666198730469
local_in_edges_tensor generation:  0.0014452934265136719
mini_batch_src_global generation:  0.002693653106689453
r_  generation:  0.019115447998046875
local_output_nid generation:  0.0013871192932128906
local_in_edges_tensor generation:  0.0012125968933105469
mini_batch_src_global generation:  0.0013153553009033203
r_  generation:  0.01393890380859375
local_output_nid generation:  0.0015625953674316406
local_in_edges_tensor generation:  0.0014088153839111328
mini_batch_src_global generation:  0.0025620460510253906
r_  generation:  0.022359371185302734
local_output_nid generation:  0.0010929107666015625
local_in_edges_tensor generation:  0.0011203289031982422
mini_batch_src_global generation:  0.002066373825073242
r_  generation:  0.015167713165283203
local_output_nid generation:  0.0014324188232421875
local_in_edges_tensor generation:  0.0014832019805908203
mini_batch_src_global generation:  0.002555370330810547
r_  generation:  0.02304840087890625
local_output_nid generation:  0.001363515853881836
local_in_edges_tensor generation:  0.0015599727630615234
mini_batch_src_global generation:  0.0027260780334472656
r_  generation:  0.024075984954833984
local_output_nid generation:  0.0018262863159179688
local_in_edges_tensor generation:  0.003589630126953125
mini_batch_src_global generation:  0.00380706787109375
r_  generation:  0.035486459732055664
local_output_nid generation:  0.002204418182373047
local_in_edges_tensor generation:  0.0023016929626464844
mini_batch_src_global generation:  0.004654407501220703
r_  generation:  0.04125666618347168
local_output_nid generation:  0.004026889801025391
local_in_edges_tensor generation:  0.005574226379394531
mini_batch_src_global generation:  0.01174306869506836
r_  generation:  0.10695242881774902
local_output_nid generation:  0.003040313720703125
local_in_edges_tensor generation:  0.003445863723754883
mini_batch_src_global generation:  0.006821393966674805
r_  generation:  0.05223488807678223
local_output_nid generation:  0.003485441207885742
local_in_edges_tensor generation:  0.004329204559326172
mini_batch_src_global generation:  0.007888317108154297
r_  generation:  0.0748748779296875
local_output_nid generation:  0.0030198097229003906
local_in_edges_tensor generation:  0.0038199424743652344
mini_batch_src_global generation:  0.005877017974853516
r_  generation:  0.05076789855957031
local_output_nid generation:  0.0043108463287353516
local_in_edges_tensor generation:  0.006016969680786133
mini_batch_src_global generation:  0.010306835174560547
r_  generation:  0.09521818161010742
local_output_nid generation:  0.004736423492431641
local_in_edges_tensor generation:  0.010004043579101562
mini_batch_src_global generation:  0.01136469841003418
r_  generation:  0.10349035263061523
local_output_nid generation:  0.00573420524597168
local_in_edges_tensor generation:  0.010757923126220703
mini_batch_src_global generation:  0.016164541244506836
r_  generation:  0.15883421897888184
local_output_nid generation:  0.005639553070068359
local_in_edges_tensor generation:  0.007386207580566406
mini_batch_src_global generation:  0.016352176666259766
r_  generation:  0.1427326202392578
local_output_nid generation:  0.0056400299072265625
local_in_edges_tensor generation:  0.007508039474487305
mini_batch_src_global generation:  0.017729997634887695
r_  generation:  0.15670561790466309
local_output_nid generation:  0.005194425582885742
local_in_edges_tensor generation:  0.0066182613372802734
mini_batch_src_global generation:  0.014469623565673828
r_  generation:  0.12206149101257324
local_output_nid generation:  0.005322933197021484
local_in_edges_tensor generation:  0.007136106491088867
mini_batch_src_global generation:  0.015146017074584961
r_  generation:  0.13283753395080566
local_output_nid generation:  0.005444765090942383
local_in_edges_tensor generation:  0.00787973403930664
mini_batch_src_global generation:  0.015296697616577148
r_  generation:  0.14374375343322754
----------------------check_connections_block total spend ----------------------------- 2.6716232299804688
generate_one_block  0.04808855056762695
generate_one_block  0.04324769973754883
generate_one_block  0.03598451614379883
generate_one_block  0.022908926010131836
generate_one_block  0.035155296325683594
generate_one_block  0.028828859329223633
generate_one_block  0.03422236442565918
generate_one_block  0.038060665130615234
generate_one_block  0.04995441436767578
generate_one_block  0.03435111045837402
generate_one_block  0.05582714080810547
generate_one_block  0.0619509220123291
generate_one_block  0.024383544921875
generate_one_block  0.018869876861572266
generate_one_block  0.028955698013305664
generate_one_block  0.018463850021362305
generate_one_block  0.0302886962890625
generate_one_block  0.02987360954284668
generate_one_block  0.049638986587524414
generate_one_block  0.054956674575805664
generate_one_block  0.1484661102294922
generate_one_block  0.06692314147949219
generate_one_block  0.10157227516174316
generate_one_block  0.06886649131774902
generate_one_block  0.13435626029968262
generate_one_block  0.14511799812316895
generate_one_block  0.2062211036682129
generate_one_block  0.197251558303833
generate_one_block  0.2707686424255371
generate_one_block  0.16826224327087402
generate_one_block  0.18289852142333984
generate_one_block  0.18893671035766602
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05331277847290039
gen group dst list time:  0.05671215057373047
time for parepare:  0.02482461929321289
local_output_nid generation:  0.003251791000366211
local_in_edges_tensor generation:  0.02338719367980957
mini_batch_src_global generation:  0.006009101867675781
r_  generation:  0.05700540542602539
local_output_nid generation:  0.005635976791381836
local_in_edges_tensor generation:  0.005506992340087891
mini_batch_src_global generation:  0.00667262077331543
r_  generation:  0.057746171951293945
local_output_nid generation:  0.004880666732788086
local_in_edges_tensor generation:  0.004965782165527344
mini_batch_src_global generation:  0.004944324493408203
r_  generation:  0.05310368537902832
local_output_nid generation:  0.004201412200927734
local_in_edges_tensor generation:  0.003892183303833008
mini_batch_src_global generation:  0.0037724971771240234
r_  generation:  0.04134082794189453
local_output_nid generation:  0.0033812522888183594
local_in_edges_tensor generation:  0.003610849380493164
mini_batch_src_global generation:  0.0032868385314941406
r_  generation:  0.03783392906188965
local_output_nid generation:  0.004553794860839844
local_in_edges_tensor generation:  0.004152774810791016
mini_batch_src_global generation:  0.0041997432708740234
r_  generation:  0.05017280578613281
local_output_nid generation:  0.00452113151550293
local_in_edges_tensor generation:  0.004210948944091797
mini_batch_src_global generation:  0.004872322082519531
r_  generation:  0.05156683921813965
local_output_nid generation:  0.005024433135986328
local_in_edges_tensor generation:  0.005024909973144531
mini_batch_src_global generation:  0.0050890445709228516
r_  generation:  0.05839061737060547
local_output_nid generation:  0.006422519683837891
local_in_edges_tensor generation:  0.00755620002746582
mini_batch_src_global generation:  0.0068628787994384766
r_  generation:  0.0712740421295166
local_output_nid generation:  0.0058765411376953125
local_in_edges_tensor generation:  0.007051229476928711
mini_batch_src_global generation:  0.00619053840637207
r_  generation:  0.06362080574035645
local_output_nid generation:  0.007729768753051758
local_in_edges_tensor generation:  0.009001970291137695
mini_batch_src_global generation:  0.009704828262329102
r_  generation:  0.0997159481048584
local_output_nid generation:  0.006286144256591797
local_in_edges_tensor generation:  0.0065996646881103516
mini_batch_src_global generation:  0.008292198181152344
r_  generation:  0.07848453521728516
local_output_nid generation:  0.003602266311645508
local_in_edges_tensor generation:  0.0035157203674316406
mini_batch_src_global generation:  0.004471540451049805
r_  generation:  0.03651762008666992
local_output_nid generation:  0.0030448436737060547
local_in_edges_tensor generation:  0.002851247787475586
mini_batch_src_global generation:  0.002766132354736328
r_  generation:  0.03142046928405762
local_output_nid generation:  0.003992319107055664
local_in_edges_tensor generation:  0.0043828487396240234
mini_batch_src_global generation:  0.0041654109954833984
r_  generation:  0.05197715759277344
local_output_nid generation:  0.0026023387908935547
local_in_edges_tensor generation:  0.0023648738861083984
mini_batch_src_global generation:  0.002721071243286133
r_  generation:  0.027362585067749023
local_output_nid generation:  0.005020856857299805
local_in_edges_tensor generation:  0.004820346832275391
mini_batch_src_global generation:  0.005138874053955078
r_  generation:  0.06525158882141113
local_output_nid generation:  0.005826711654663086
local_in_edges_tensor generation:  0.006592750549316406
mini_batch_src_global generation:  0.007852792739868164
r_  generation:  0.07289743423461914
local_output_nid generation:  0.007281064987182617
local_in_edges_tensor generation:  0.007831335067749023
mini_batch_src_global generation:  0.008598089218139648
r_  generation:  0.09540367126464844
local_output_nid generation:  0.008663654327392578
local_in_edges_tensor generation:  0.011278152465820312
mini_batch_src_global generation:  0.01131296157836914
r_  generation:  0.11203861236572266
local_output_nid generation:  0.011934757232666016
local_in_edges_tensor generation:  0.018987655639648438
mini_batch_src_global generation:  0.017839431762695312
r_  generation:  0.18810534477233887[23:58:23] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2781 nodes and 127750 edges into 2 parts and get 2653 edge cuts

local_output_nid generation:  0.010325908660888672
local_in_edges_tensor generation:  0.012990474700927734
mini_batch_src_global generation:  0.015450477600097656
r_  generation:  0.13864707946777344
local_output_nid generation:  0.010691404342651367
local_in_edges_tensor generation:  0.013575553894042969
mini_batch_src_global generation:  0.01592421531677246
r_  generation:  0.15600299835205078
local_output_nid generation:  0.010708808898925781
local_in_edges_tensor generation:  0.014601707458496094
mini_batch_src_global generation:  0.023048877716064453
r_  generation:  0.1558065414428711
local_output_nid generation:  0.017592191696166992
local_in_edges_tensor generation:  0.029298067092895508
mini_batch_src_global generation:  0.025063037872314453
r_  generation:  0.2441880702972412
local_output_nid generation:  0.02176499366760254
local_in_edges_tensor generation:  0.022922754287719727
mini_batch_src_global generation:  0.024204015731811523
r_  generation:  0.26070594787597656
local_output_nid generation:  0.015315532684326172
local_in_edges_tensor generation:  0.019962787628173828
mini_batch_src_global generation:  0.023452043533325195
r_  generation:  0.22869324684143066
local_output_nid generation:  0.015367984771728516
local_in_edges_tensor generation:  0.022892236709594727
mini_batch_src_global generation:  0.023470640182495117
r_  generation:  0.24454998970031738
local_output_nid generation:  0.013462305068969727
local_in_edges_tensor generation:  0.01640152931213379
mini_batch_src_global generation:  0.021599769592285156
r_  generation:  0.20111680030822754
local_output_nid generation:  0.014654874801635742
local_in_edges_tensor generation:  0.01729416847229004
mini_batch_src_global generation:  0.021672487258911133
r_  generation:  0.2168562412261963
local_output_nid generation:  0.014629840850830078
local_in_edges_tensor generation:  0.02146744728088379
mini_batch_src_global generation:  0.022275447845458984
r_  generation:  0.22631621360778809
local_output_nid generation:  0.014416694641113281
local_in_edges_tensor generation:  0.018157482147216797
mini_batch_src_global generation:  0.02188873291015625
r_  generation:  0.21677923202514648
----------------------check_connections_block total spend ----------------------------- 5.4108099937438965
generate_one_block  0.08276200294494629
generate_one_block  0.07547783851623535
generate_one_block  0.06573152542114258
generate_one_block  0.05433177947998047
generate_one_block  0.09630990028381348
generate_one_block  0.08097338676452637
generate_one_block  0.06443095207214355
generate_one_block  0.07660913467407227
generate_one_block  0.09193015098571777
generate_one_block  0.0818490982055664
generate_one_block  0.1314992904663086
generate_one_block  0.10246396064758301
generate_one_block  0.046303510665893555
generate_one_block  0.03975081443786621
generate_one_block  0.06457781791687012
generate_one_block  0.0626993179321289
generate_one_block  0.08475303649902344
generate_one_block  0.09462976455688477
generate_one_block  0.11967635154724121
generate_one_block  0.1488339900970459
generate_one_block  0.24797415733337402
generate_one_block  0.24743318557739258
generate_one_block  0.21277713775634766
generate_one_block  0.18991661071777344
generate_one_block  0.2789585590362549
generate_one_block  0.3078479766845703
generate_one_block  0.3011436462402344
generate_one_block  0.30448102951049805
generate_one_block  0.260514497756958
generate_one_block  0.27208423614501953
generate_one_block  0.2808725833892822
generate_one_block  0.3644595146179199
global_2_local spend time (sec) 0.003911018371582031
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0009584426879882812
A = g.adjacency_matrix() spent  0.0007250308990478516
auxiliary_graph
Graph(num_nodes=17810, num_edges=130531,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013348102569580078
remove nodes length
15029
auxiliary_graph.remove_nodes spent  0.00622868537902832
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2781, num_edges=130531,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.016506671905517578

the counter of shared neighbor distribution
Counter({1.0: 101540, 2.0: 16930, 3.0: 5104, 4.0: 1908, 5.0: 804, 6.0: 468, 7.0: 262, 8.0: 216, 9.0: 156, 10.0: 108, 11.0: 72, 12.0: 54, 13.0: 38, 15.0: 28, 14.0: 16, 16.0: 14, 17.0: 12, 23.0: 4, 19.0: 4, 18.0: 4, 21.0: 2, 28.0: 2, 26.0: 2, 22.0: 2})
127750
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.004 seconds
Metis partitioning: 0.011 seconds
Split the graph: 0.011 seconds
Construct subgraphs: 0.023 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.04929494857788086
1365
1416
total k batches seeds list generation spend  0.12809014320373535
after graph partition
graph partition algorithm spend time 0.1318812370300293
1365
1416
time for parepare:  0.02047109603881836
local_output_nid generation:  0.00022983551025390625
local_in_edges_tensor generation:  0.0023877620697021484
mini_batch_src_global generation:  0.00046539306640625
r_  generation:  0.0031244754791259766
local_output_nid generation:  0.0002205371856689453
local_in_edges_tensor generation:  0.0013365745544433594
mini_batch_src_global generation:  0.0010142326354980469
r_  generation:  0.00725102424621582
----------------------check_connections_block total spend ----------------------------- 0.04367566108703613
generate_one_block  0.01101541519165039
generate_one_block  0.016190528869628906
time for parepare:  0.019346237182617188
local_output_nid generation:  0.0007503032684326172
local_in_edges_tensor generation:  0.0061571598052978516
mini_batch_src_global generation:  0.002141714096069336
r_  generation:  0.019944429397583008
local_output_nid generation:  0.0028967857360839844
local_in_edges_tensor generation:  0.0062367916107177734
mini_batch_src_global generation:  0.008505821228027344
r_  generation:  0.08781218528747559
----------------------check_connections_block total spend ----------------------------- 0.1889958381652832
generate_one_block  0.028593063354492188
generate_one_block  0.12014055252075195
time for parepare:  0.020397663116455078
local_output_nid generation:  0.003942251205444336
local_in_edges_tensor generation:  0.01704549789428711
mini_batch_src_global generation:  0.006746053695678711
r_  generation:  0.0756678581237793
local_output_nid generation:  0.014853239059448242
local_in_edges_tensor generation:  0.017344951629638672
mini_batch_src_global generation:  0.01776742935180664
r_  generation:  0.20566725730895996
----------------------check_connections_block total spend ----------------------------- 0.4474494457244873
generate_one_block  0.10322332382202148
generate_one_block  0.25364041328430176
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  8.082433223724365
block generation total time  7.557709217071533
average batch blocks generation time:  0.2361784130334854
pseudo mini batch 0 input nodes size: 37689
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8447265625 GB
    Memory Allocated: 0.02320241928100586  GigaBytes
Max Memory Allocated: 0.02320241928100586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8447265625 GB
    Memory Allocated: 0.023224353790283203  GigaBytes
Max Memory Allocated: 0.023224353790283203  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8447265625 GB
    Memory Allocated: 0.023224353790283203  GigaBytes
Max Memory Allocated: 0.023224353790283203  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8955078125 GB
    Memory Allocated: 0.025146961212158203  GigaBytes
Max Memory Allocated: 0.025146961212158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8955078125 GB
    Memory Allocated: 0.025146961212158203  GigaBytes
Max Memory Allocated: 0.025146961212158203  GigaBytes

first layer input nodes number: 37689
first layer output nodes number: 19001
edges number: 139658
input nodes number: 19001
output nodes number: 7880
edges number: 88295
input nodes number: 7880
output nodes number: 2927
edges number: 29880
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8974609375 GB
    Memory Allocated: 2.9138240814208984  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8974609375 GB
    Memory Allocated: 2.913825035095215  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1318359375 GB
    Memory Allocated: 0.0345306396484375  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

pseudo mini batch 1 input nodes size: 41180
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1318359375 GB
    Memory Allocated: 0.02888774871826172  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1318359375 GB
    Memory Allocated: 0.02888774871826172  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1318359375 GB
    Memory Allocated: 0.048523902893066406  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1318359375 GB
    Memory Allocated: 0.04854536056518555  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1318359375 GB
    Memory Allocated: 0.030551910400390625  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1318359375 GB
    Memory Allocated: 0.032469749450683594  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1318359375 GB
    Memory Allocated: 0.032469749450683594  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

first layer input nodes number: 41180
first layer output nodes number: 19667
edges number: 141924
input nodes number: 19667
output nodes number: 7935
edges number: 84241
input nodes number: 7935
output nodes number: 2832
edges number: 30991
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1474609375 GB
    Memory Allocated: 2.8867549896240234  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1474609375 GB
    Memory Allocated: 2.8867554664611816  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03619098663330078  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

pseudo mini batch 2 input nodes size: 35500
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03053760528564453  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03053760528564453  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.04746532440185547  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.04748678207397461  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.02782917022705078  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.029474258422851562  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.029474258422851562  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

first layer input nodes number: 35500
first layer output nodes number: 17437
edges number: 124733
input nodes number: 17437
output nodes number: 6983
edges number: 70096
input nodes number: 6983
output nodes number: 2832
edges number: 25814
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 2.4731197357177734  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 2.4731202125549316  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03268003463745117  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

pseudo mini batch 3 input nodes size: 41055
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.02782917022705078  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.02782917022705078  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.04740571975708008  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.04742717742919922  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03047800064086914  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03161764144897461  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03161764144897461  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

first layer input nodes number: 41055
first layer output nodes number: 15218
edges number: 96341
input nodes number: 15218
output nodes number: 6218
edges number: 40279
input nodes number: 6218
output nodes number: 2874
edges number: 16215
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 1.683481216430664  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 1.6834816932678223  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03400468826293945  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

pseudo mini batch 4 input nodes size: 31544
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.030484676361083984  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.030484676361083984  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.04552602767944336  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.0455474853515625  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.025949478149414062  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.02719879150390625  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.02719879150390625  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

first layer input nodes number: 31544
first layer output nodes number: 12790
edges number: 91814
input nodes number: 12790
output nodes number: 5358
edges number: 49805
input nodes number: 5358
output nodes number: 2833
edges number: 25813
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 1.9002408981323242  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 1.9002413749694824  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.029680252075195312  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

pseudo mini batch 5 input nodes size: 43547
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.025943279266357422  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.025943279266357422  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.046708106994628906  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.046729087829589844  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03166627883911133  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03312540054321289  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03312540054321289  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

first layer input nodes number: 43547
first layer output nodes number: 16936
edges number: 121261
input nodes number: 16936
output nodes number: 5993
edges number: 52591
input nodes number: 5993
output nodes number: 2788
edges number: 21835
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 2.1365199089050293  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 2.1365203857421875  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03600311279296875  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

pseudo mini batch 6 input nodes size: 31858
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.031659603118896484  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.031659603118896484  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.04685068130493164  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.04687213897705078  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.02608633041381836  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.027695178985595703  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.027695178985595703  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

first layer input nodes number: 31858
first layer output nodes number: 16512
edges number: 122724
input nodes number: 16512
output nodes number: 6221
edges number: 65442
input nodes number: 6221
output nodes number: 2870
edges number: 27560
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 2.409904956817627  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 2.409905433654785  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.030790328979492188  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

pseudo mini batch 7 input nodes size: 44612
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.026098251342773438  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.026098251342773438  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.04737091064453125  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.04739236831665039  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.032179832458496094  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03390693664550781  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03390693664550781  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

first layer input nodes number: 44612
first layer output nodes number: 18885
edges number: 141022
input nodes number: 18885
output nodes number: 6574
edges number: 65312
input nodes number: 6574
output nodes number: 2845
edges number: 25263
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 2.5121798515319824  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 2.5121803283691406  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03724336624145508  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

pseudo mini batch 8 input nodes size: 55070
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03217649459838867  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.03217649459838867  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.058435916900634766  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.05845785140991211  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.037163734436035156  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.039185523986816406  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1494140625 GB
    Memory Allocated: 0.039185523986816406  GigaBytes
Max Memory Allocated: 2.9470725059509277  GigaBytes

first layer input nodes number: 55070
first layer output nodes number: 23369
edges number: 168508
input nodes number: 23369
output nodes number: 8077
edges number: 77516
input nodes number: 8077
output nodes number: 2889
edges number: 25117
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6005859375 GB
    Memory Allocated: 2.9320526123046875  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.6005859375 GB
    Memory Allocated: 2.9320530891418457  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.04312849044799805  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

pseudo mini batch 9 input nodes size: 53605
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.0371699333190918  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.0371699333190918  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.06273078918457031  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.036470890045166016  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.03820180892944336  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.03820180892944336  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

first layer input nodes number: 53605
first layer output nodes number: 21530
edges number: 148192
input nodes number: 21530
output nodes number: 7726
edges number: 63642
input nodes number: 7726
output nodes number: 2867
edges number: 20232
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 2.5029773712158203  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 2.5029778480529785  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.04164409637451172  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

pseudo mini batch 10 input nodes size: 73908
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.036467552185058594  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.036467552185058594  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.07170963287353516  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.0717315673828125  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.046149253845214844  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.048872947692871094  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7490234375 GB
    Memory Allocated: 0.048872947692871094  GigaBytes
Max Memory Allocated: 2.9611172676086426  GigaBytes

first layer input nodes number: 73908
first layer output nodes number: 31098
edges number: 239675
input nodes number: 31098
output nodes number: 9198
edges number: 98890
input nodes number: 9198
output nodes number: 2927
edges number: 26825
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5751953125 GB
    Memory Allocated: 3.8306665420532227  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5751953125 GB
    Memory Allocated: 3.830667018890381  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.05402803421020508  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

pseudo mini batch 11 input nodes size: 59924
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.0461583137512207  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.0461583137512207  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.0754551887512207  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.07547712326049805  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.04021310806274414  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.0423426628112793  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.0423426628112793  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

first layer input nodes number: 59924
first layer output nodes number: 23828
edges number: 181229
input nodes number: 23828
output nodes number: 7413
edges number: 77627
input nodes number: 7413
output nodes number: 2906
edges number: 26780
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 3.0499157905578613  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 3.0499162673950195  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.04642820358276367  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

pseudo mini batch 12 input nodes size: 30080
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.04021024703979492  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.04021024703979492  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.05455350875854492  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.054575443267822266  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.025256633758544922  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.026354312896728516  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.026354312896728516  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

first layer input nodes number: 30080
first layer output nodes number: 12963
edges number: 83175
input nodes number: 12963
output nodes number: 6003
edges number: 43665
input nodes number: 6003
output nodes number: 2910
edges number: 20288
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 1.672074794769287  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 1.6720752716064453  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.028612613677978516  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

pseudo mini batch 13 input nodes size: 28458
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.025257110595703125  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.025257110595703125  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.038826942443847656  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.0388484001159668  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.024483203887939453  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.02537393569946289  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.02537393569946289  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

first layer input nodes number: 28458
first layer output nodes number: 11812
edges number: 71230
input nodes number: 11812
output nodes number: 5435
edges number: 32688
input nodes number: 5435
output nodes number: 2871
edges number: 15439
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 1.3479456901550293  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 1.3479461669921875  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.027250289916992188  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

pseudo mini batch 14 input nodes size: 43132
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.024477481842041016  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.024477481842041016  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.045961856842041016  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.045983314514160156  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.032392024993896484  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.03385019302368164  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.03385019302368164  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

first layer input nodes number: 43132
first layer output nodes number: 16779
edges number: 117575
input nodes number: 16779
output nodes number: 6363
edges number: 54338
input nodes number: 6363
output nodes number: 2865
edges number: 23636
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 2.1532158851623535  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 2.1532163619995117  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.03676271438598633  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

pseudo mini batch 15 input nodes size: 24589
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.03239107131958008  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.03239107131958008  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.04411602020263672  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.04413795471191406  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.022632122039794922  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.02348184585571289  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.02348184585571289  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

first layer input nodes number: 24589
first layer output nodes number: 10237
edges number: 61697
input nodes number: 10237
output nodes number: 5231
edges number: 33608
input nodes number: 5231
output nodes number: 2897
edges number: 18489
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 1.3205323219299316  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 1.3205327987670898  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.025288105010986328  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

pseudo mini batch 16 input nodes size: 56225
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.022636890411376953  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.022636890411376953  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.049447059631347656  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.0494685173034668  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.03772163391113281  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.03938484191894531  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.03938484191894531  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

first layer input nodes number: 56225
first layer output nodes number: 21631
edges number: 152036
input nodes number: 21631
output nodes number: 7078
edges number: 54661
input nodes number: 7078
output nodes number: 2828
edges number: 16376
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 2.3492822647094727  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 2.349282741546631  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.04266214370727539  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

pseudo mini batch 17 input nodes size: 62581
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.037711143493652344  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.037711143493652344  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.06755208969116211  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.06757402420043945  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.04074239730834961  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.042490482330322266  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.042490482330322266  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

first layer input nodes number: 62581
first layer output nodes number: 22672
edges number: 163660
input nodes number: 22672
output nodes number: 6892
edges number: 53502
input nodes number: 6892
output nodes number: 2922
edges number: 17295
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 2.4307355880737305  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 2.4307360649108887  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.045943260192871094  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

pseudo mini batch 18 input nodes size: 69501
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.0407567024230957  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.0407567024230957  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.0739598274230957  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.07398080825805664  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.04411792755126953  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.046538352966308594  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.046538352966308594  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

first layer input nodes number: 69501
first layer output nodes number: 28663
edges number: 213147
input nodes number: 28663
output nodes number: 8775
edges number: 87988
input nodes number: 8775
output nodes number: 2804
edges number: 23486
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 3.422908306121826  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 3.4229087829589844  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.051160335540771484  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

pseudo mini batch 19 input nodes size: 80150
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.044100284576416016  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.044100284576416016  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.08231878280639648  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.08233976364135742  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.049115657806396484  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.05201387405395508  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7666015625 GB
    Memory Allocated: 0.05201387405395508  GigaBytes
Max Memory Allocated: 3.861419200897217  GigaBytes

first layer input nodes number: 80150
first layer output nodes number: 34612
edges number: 268413
input nodes number: 34612
output nodes number: 9533
edges number: 99367
input nodes number: 9533
output nodes number: 2793
edges number: 21039
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.3408203125 GB
    Memory Allocated: 3.978520393371582  GigaBytes
Max Memory Allocated: 4.003525257110596  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.3408203125 GB
    Memory Allocated: 3.9785208702087402  GigaBytes
Max Memory Allocated: 4.003525257110596  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.5322265625 GB
    Memory Allocated: 0.057425498962402344  GigaBytes
Max Memory Allocated: 4.003525257110596  GigaBytes

pseudo mini batch 20 input nodes size: 89800
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.5322265625 GB
    Memory Allocated: 0.04911375045776367  GigaBytes
Max Memory Allocated: 4.003525257110596  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.5322265625 GB
    Memory Allocated: 0.04911375045776367  GigaBytes
Max Memory Allocated: 4.003525257110596  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.5322265625 GB
    Memory Allocated: 0.0919337272644043  GigaBytes
Max Memory Allocated: 4.003525257110596  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.5322265625 GB
    Memory Allocated: 0.09195470809936523  GigaBytes
Max Memory Allocated: 4.003525257110596  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.5322265625 GB
    Memory Allocated: 0.05371522903442383  GigaBytes
Max Memory Allocated: 4.003525257110596  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.5322265625 GB
    Memory Allocated: 0.05989551544189453  GigaBytes
Max Memory Allocated: 4.003525257110596  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.5322265625 GB
    Memory Allocated: 0.05989551544189453  GigaBytes
Max Memory Allocated: 4.003525257110596  GigaBytes

first layer input nodes number: 89800
first layer output nodes number: 53917
edges number: 453230
input nodes number: 53917
output nodes number: 17804
edges number: 280033
input nodes number: 17804
output nodes number: 2758
edges number: 40648
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.8076171875 GB
    Memory Allocated: 8.362075805664062  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.8076171875 GB
    Memory Allocated: 8.36207628250122  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.07203245162963867  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

pseudo mini batch 21 input nodes size: 86515
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.053709983825683594  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.053709983825683594  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.09496355056762695  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.0949850082397461  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.05214405059814453  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.05570697784423828  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.05570697784423828  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

first layer input nodes number: 86515
first layer output nodes number: 41739
edges number: 331600
input nodes number: 41739
output nodes number: 10947
edges number: 123551
input nodes number: 10947
output nodes number: 2873
edges number: 22798
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 4.848038196563721  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 4.848038673400879  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.062236785888671875  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

pseudo mini batch 22 input nodes size: 81682
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.052161216735839844  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.052161216735839844  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.09122371673583984  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.09124517440795898  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.049970149993896484  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.05437803268432617  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.05437803268432617  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

first layer input nodes number: 81682
first layer output nodes number: 44930
edges number: 368571
input nodes number: 44930
output nodes number: 14040
edges number: 193727
input nodes number: 14040
output nodes number: 2817
edges number: 29179
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 6.267148494720459  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 6.267148971557617  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.06240129470825195  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

pseudo mini batch 23 input nodes size: 90343
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.04996204376220703  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.04996204376220703  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.09304094314575195  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.09306192398071289  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.05397796630859375  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.05820608139038086  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.05820608139038086  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

first layer input nodes number: 90343
first layer output nodes number: 43932
edges number: 349085
input nodes number: 43932
output nodes number: 11000
edges number: 127571
input nodes number: 11000
output nodes number: 2758
edges number: 17806
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 4.975092887878418  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 4.975093364715576  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.06490135192871094  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

pseudo mini batch 24 input nodes size: 103729
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.05396890640258789  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.05396890640258789  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.10343074798583984  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.10345172882080078  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.06035184860229492  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.06626749038696289  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3466796875 GB
    Memory Allocated: 0.06626749038696289  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

first layer input nodes number: 103729
first layer output nodes number: 62458
edges number: 520453
input nodes number: 62458
output nodes number: 16707
edges number: 246492
input nodes number: 16707
output nodes number: 2788
edges number: 26772
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2373046875 GB
    Memory Allocated: 8.19385576248169  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.2373046875 GB
    Memory Allocated: 8.193856239318848  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.7099609375 GB
    Memory Allocated: 0.07693958282470703  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

pseudo mini batch 25 input nodes size: 96688
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.7099609375 GB
    Memory Allocated: 0.06035661697387695  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.7099609375 GB
    Memory Allocated: 0.06035661697387695  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.7099609375 GB
    Memory Allocated: 0.1064610481262207  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.7099609375 GB
    Memory Allocated: 0.10648298263549805  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.7099609375 GB
    Memory Allocated: 0.057000160217285156  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.7099609375 GB
    Memory Allocated: 0.0643625259399414  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.7099609375 GB
    Memory Allocated: 0.0643625259399414  GigaBytes
Max Memory Allocated: 8.41289758682251  GigaBytes

first layer input nodes number: 96688
first layer output nodes number: 64562
edges number: 542190
input nodes number: 64562
output nodes number: 23651
edges number: 397122
input nodes number: 23651
output nodes number: 2927
edges number: 48726
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6103515625 GB
    Memory Allocated: 10.911601543426514  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.6103515625 GB
    Memory Allocated: 10.911602020263672  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.08098363876342773  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 26 input nodes size: 99595
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.05702066421508789  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.05702066421508789  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.10451126098632812  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.10453224182128906  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.05840587615966797  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.06561565399169922  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.06561565399169922  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 99595
first layer output nodes number: 65831
edges number: 553564
input nodes number: 65831
output nodes number: 22511
edges number: 372701
input nodes number: 22511
output nodes number: 2758
edges number: 41336
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 10.523956298828125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 10.523956775665283  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.08119916915893555  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 27 input nodes size: 86003
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.0583806037902832  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.0583806037902832  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.09939002990722656  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.0994119644165039  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.051900386810302734  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.05921173095703125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3701171875 GB
    Memory Allocated: 0.05921173095703125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 86003
first layer output nodes number: 57252
edges number: 487833
input nodes number: 57252
output nodes number: 22984
edges number: 401181
input nodes number: 22984
output nodes number: 2927
edges number: 54826
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7529296875 GB
    Memory Allocated: 10.620157241821289  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7529296875 GB
    Memory Allocated: 10.620157718658447  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.07324886322021484  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 28 input nodes size: 97093
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0519256591796875  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0519256591796875  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.09822320938110352  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.09824419021606445  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05721282958984375  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06391382217407227  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06391382217407227  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 97093
first layer output nodes number: 61774
edges number: 516312
input nodes number: 61774
output nodes number: 19907
edges number: 321851
input nodes number: 19907
output nodes number: 2758
edges number: 35396
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 9.412779331207275  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 9.412779808044434  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0758829116821289  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 29 input nodes size: 94019
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.057187557220458984  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.057187557220458984  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.10210943222045898  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.10213041305541992  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05581188201904297  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06260013580322266  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06260013580322266  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 94019
first layer output nodes number: 60798
edges number: 514036
input nodes number: 60798
output nodes number: 21182
edges number: 354865
input nodes number: 21182
output nodes number: 2758
edges number: 42036
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 9.957082748413086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 9.957083225250244  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0763235092163086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 30 input nodes size: 95731
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05581188201904297  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05581188201904297  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.10145998001098633  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.10148096084594727  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05653810501098633  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0639495849609375  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0639495849609375  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 95731
first layer output nodes number: 60880
edges number: 514670
input nodes number: 60880
output nodes number: 21118
edges number: 361447
input nodes number: 21118
output nodes number: 2758
edges number: 43641
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 10.09282636642456  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 10.092826843261719  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0773000717163086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 31 input nodes size: 67344
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05653810501098633  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05653810501098633  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08865022659301758  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08866071701049805  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04299163818359375  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04480934143066406  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04480934143066406  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 67344
first layer output nodes number: 23267
edges number: 185784
input nodes number: 23267
output nodes number: 4821
edges number: 49936
input nodes number: 4821
output nodes number: 1365
edges number: 8007
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.380338668823242  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.3803391456604004  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04799985885620117  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 32 input nodes size: 95328
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04278421401977539  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes
[23:59:17] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37273158 edges into 32 parts and get 12735106 edge cuts

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04278421401977539  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08824014663696289  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08825111389160156  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.056128501892089844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.061652183532714844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.061652183532714844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 95328
first layer output nodes number: 56213
edges number: 486528
input nodes number: 56213
output nodes number: 13690
edges number: 234621
input nodes number: 13690
output nodes number: 1416
edges number: 20212
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 7.638749599456787  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 7.638750076293945  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.07140207290649414  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08185434341430664  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08185434341430664  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0422633272228819 |0.017267870180534595 |0.3091148174170292 |0.0001266002655029297 |0.44796262365398987 |0.013077259063720703 |
----------------------------------------------------------pseudo_mini_loss sum 5.360841274261475
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3582519
Number of first layer input nodes during this epoch:  2128078
Number of first layer output nodes during this epoch:  1093193
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08185386657714844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028395891189575195
global_2_local spend time (sec) 0.05193614959716797
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0048182010650634766
A = g.adjacency_matrix() spent  0.012001276016235352
auxiliary_graph
Graph(num_nodes=158253, num_edges=37364099,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10685276985168457
remove nodes length
67312
auxiliary_graph.remove_nodes spent  2.0551257133483887
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37364099,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.5691699981689453

the counter of shared neighbor distribution
Counter({1.0: 28442724, 2.0: 5934866, 3.0: 1749448, 4.0: 608950, 5.0: 251286, 6.0: 118122, 7.0: 62400, 8.0: 36188, 9.0: 21960, 10.0: 14378, 11.0: 9394, 12.0: 6446, 13.0: 4594, 14.0: 3290, 15.0: 2434, 16.0: 1740, 17.0: 1284, 18.0: 882, 19.0: 642, 20.0: 566, 21.0: 378, 22.0: 312, 23.0: 240, 24.0: 178, 25.0: 122, 26.0: 96, 27.0: 62, 29.0: 40, 28.0: 38, 30.0: 34, 31.0: 14, 32.0: 12, 33.0: 10, 34.0: 8, 40.0: 6, 35.0: 4, 37.0: 4, 38.0: 4, 49.0: 2})
37273158
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37273155, 37273156, 37273157])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28442724, 2.0: 5934866, 3.0: 1749448, 4.0: 608950, 5.0: 251286, 6.0: 118122, 7.0: 62400, 8.0: 36188, 9.0: 21960, 10.0: 14378, 11.0: 9394, 12.0: 6446, 13.0: 4594, 14.0: 3290, 15.0: 2434, 16.0: 1740, 17.0: 1284, 18.0: 882, 19.0: 642, 20.0: 566, 21.0: 378, 22.0: 312, 23.0: 240, 24.0: 178, 25.0: 122, 26.0: 96, 27.0: 62, 29.0: 40, 28.0: 38, 30.0: 34, 31.0: 14, 32.0: 12, 33.0: 10, 34.0: 8, 40.0: 6, 35.0: 4, 37.0: 4, 38.0: 4, 49.0: 2})
Convert a graph into a bidirected graph: 2.493 seconds
Metis partitioning: 8.133 seconds
Split the graph: 0.958 seconds
Construct subgraphs: 0.102 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  11.703934907913208
2908
2852
2927
2865
2887
2781
2896
2925
2870
2912
2895
2869
2920
2774
2870
2868
2875
2910
2857
2874
2758
2759
2783
2782
2777
2758
2894
2758
2851
2758
2768
2760
total k batches seeds list generation spend  27.008936643600464
after graph partition
graph partition algorithm spend time 27.131219148635864
2908
2852
2927
2865
2887
2781
2896
2925
2870
2912
2895
2869
2920
2774
2870
2868
2875
2910
2857
2874
2758
2759
2783
2782
2777
2758
2894
2758
2851
2758
2768
2760
partition_len_list
[6437, 7543, 8252, 7055, 5027, 6737, 5888, 8175, 5377, 6220, 6987, 5638, 7787, 7658, 7862, 7422, 8218, 7476, 6172, 9258, 18221, 15166, 9487, 14397, 18568, 16285, 22487, 24466, 20746, 20495, 23458, 18457]
shared_neighbor_graph_partition_s0 selection method  spend 27.24406385421753
time for parepare:  0.019204139709472656
local_output_nid generation:  0.0006504058837890625
local_in_edges_tensor generation:  0.0010437965393066406
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.011500835418701172
local_output_nid generation:  0.0009191036224365234
local_in_edges_tensor generation:  0.0010199546813964844
mini_batch_src_global generation:  0.0011518001556396484
r_  generation:  0.008931636810302734
local_output_nid generation:  0.0009293556213378906
local_in_edges_tensor generation:  0.0008726119995117188
mini_batch_src_global generation:  0.0012362003326416016
r_  generation:  0.010823249816894531
local_output_nid generation:  0.0009062290191650391
local_in_edges_tensor generation:  0.0008084774017333984
mini_batch_src_global generation:  0.0008704662322998047
r_  generation:  0.009076118469238281
local_output_nid generation:  0.000896453857421875
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.00067138671875
r_  generation:  0.0067577362060546875
local_output_nid generation:  0.0007963180541992188
local_in_edges_tensor generation:  0.0007719993591308594
mini_batch_src_global generation:  0.0007493495941162109
r_  generation:  0.007379055023193359
local_output_nid generation:  0.0008525848388671875
local_in_edges_tensor generation:  0.0008115768432617188
mini_batch_src_global generation:  0.0007474422454833984
r_  generation:  0.008348941802978516
local_output_nid generation:  0.0007958412170410156
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.0011196136474609375
r_  generation:  0.009728670120239258
local_output_nid generation:  0.0007851123809814453
local_in_edges_tensor generation:  0.0008225440979003906
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.012634515762329102
local_output_nid generation:  0.0012960433959960938
local_in_edges_tensor generation:  0.0008709430694580078
mini_batch_src_global generation:  0.0009777545928955078
r_  generation:  0.010140180587768555
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0008039474487304688
mini_batch_src_global generation:  0.0010066032409667969
r_  generation:  0.010491609573364258
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0008416175842285156
mini_batch_src_global generation:  0.0007715225219726562
r_  generation:  0.006821870803833008
local_output_nid generation:  0.0008249282836914062
local_in_edges_tensor generation:  0.0007741451263427734
mini_batch_src_global generation:  0.0009613037109375
r_  generation:  0.010692119598388672
local_output_nid generation:  0.0007469654083251953
local_in_edges_tensor generation:  0.0007605552673339844
mini_batch_src_global generation:  0.0009026527404785156
r_  generation:  0.008325338363647461
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.0008380413055419922
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.011249780654907227
local_output_nid generation:  0.000797271728515625
local_in_edges_tensor generation:  0.00087738037109375
mini_batch_src_global generation:  0.0012891292572021484
r_  generation:  0.013613700866699219
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.0007605552673339844
mini_batch_src_global generation:  0.0010364055633544922
r_  generation:  0.00832676887512207
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0008001327514648438
mini_batch_src_global generation:  0.0008454322814941406
r_  generation:  0.007593870162963867
local_output_nid generation:  0.0008289813995361328
local_in_edges_tensor generation:  0.0008001327514648438
mini_batch_src_global generation:  0.0007054805755615234
r_  generation:  0.007410526275634766
local_output_nid generation:  0.0008168220520019531
local_in_edges_tensor generation:  0.0007956027984619141
mini_batch_src_global generation:  0.0008702278137207031
r_  generation:  0.009160041809082031
local_output_nid generation:  0.0007584095001220703
local_in_edges_tensor generation:  0.0008678436279296875
mini_batch_src_global generation:  0.0022475719451904297
r_  generation:  0.016273975372314453
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.0007841587066650391
mini_batch_src_global generation:  0.0012030601501464844
r_  generation:  0.010039329528808594
local_output_nid generation:  0.0008230209350585938
local_in_edges_tensor generation:  0.0007159709930419922
mini_batch_src_global generation:  0.0007772445678710938
r_  generation:  0.009345769882202148
local_output_nid generation:  0.0010952949523925781
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0010607242584228516
r_  generation:  0.011169910430908203
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0008285045623779297
mini_batch_src_global generation:  0.0012862682342529297
r_  generation:  0.011893749237060547
local_output_nid generation:  0.0008466243743896484
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  0.0011131763458251953
r_  generation:  0.010997295379638672
local_output_nid generation:  0.0008969306945800781
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.0015048980712890625
r_  generation:  0.016508817672729492
local_output_nid generation:  0.0008356571197509766
local_in_edges_tensor generation:  0.0008914470672607422
mini_batch_src_global generation:  0.0018491744995117188
r_  generation:  0.018517732620239258
local_output_nid generation:  0.0009412765502929688
local_in_edges_tensor generation:  0.002118349075317383
mini_batch_src_global generation:  0.0023627281188964844
r_  generation:  0.01970052719116211
local_output_nid generation:  0.0009744167327880859
local_in_edges_tensor generation:  0.0008873939514160156
mini_batch_src_global generation:  0.0016040802001953125
r_  generation:  0.016265153884887695
local_output_nid generation:  0.0009560585021972656
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.0014972686767578125
r_  generation:  0.017006874084472656
local_output_nid generation:  0.0009365081787109375
local_in_edges_tensor generation:  0.0007739067077636719
mini_batch_src_global generation:  0.0013766288757324219
r_  generation:  0.012611150741577148
----------------------check_connections_block total spend ----------------------------- 0.5619547367095947
generate_one_block  0.023228168487548828
generate_one_block  0.01607680320739746
generate_one_block  0.01758098602294922
generate_one_block  0.013697624206542969
generate_one_block  0.010030984878540039
generate_one_block  0.011344194412231445
generate_one_block  0.01250600814819336
generate_one_block  0.015430450439453125
generate_one_block  0.01482701301574707
generate_one_block  0.015149116516113281
generate_one_block  0.0167083740234375
generate_one_block  0.010309219360351562
generate_one_block  0.016684293746948242
generate_one_block  0.01319432258605957
generate_one_block  0.01769399642944336
generate_one_block  0.017513036727905273
generate_one_block  0.018393516540527344
generate_one_block  0.012405633926391602
generate_one_block  0.011233329772949219
generate_one_block  0.014653444290161133
generate_one_block  0.027089834213256836
generate_one_block  0.01706242561340332
generate_one_block  0.012616157531738281
generate_one_block  0.018355369567871094
generate_one_block  0.020520448684692383
generate_one_block  0.018365144729614258
generate_one_block  0.0265805721282959
generate_one_block  0.029230356216430664
generate_one_block  0.031186819076538086
generate_one_block  0.02555990219116211
generate_one_block  0.026275634765625
generate_one_block  0.02125072479248047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05193829536437988
gen group dst list time:  0.011171102523803711
time for parepare:  0.027021169662475586
local_output_nid generation:  0.0016007423400878906
local_in_edges_tensor generation:  0.01987171173095703
mini_batch_src_global generation:  0.0022852420806884766
r_  generation:  0.022251367568969727
local_output_nid generation:  0.0027115345001220703
local_in_edges_tensor generation:  0.0034894943237304688
mini_batch_src_global generation:  0.003190279006958008
r_  generation:  0.03007364273071289
local_output_nid generation:  0.002615690231323242
local_in_edges_tensor generation:  0.002362489700317383
mini_batch_src_global generation:  0.0035588741302490234
r_  generation:  0.03828859329223633
local_output_nid generation:  0.0022826194763183594
local_in_edges_tensor generation:  0.0024673938751220703
mini_batch_src_global generation:  0.0025396347045898438
r_  generation:  0.0266873836517334
local_output_nid generation:  0.0015933513641357422
local_in_edges_tensor generation:  0.0013589859008789062
mini_batch_src_global generation:  0.0014219284057617188
r_  generation:  0.012357473373413086
local_output_nid generation:  0.002081632614135742
local_in_edges_tensor generation:  0.001796722412109375
mini_batch_src_global generation:  0.0016808509826660156
r_  generation:  0.025278568267822266
local_output_nid generation:  0.0017533302307128906
local_in_edges_tensor generation:  0.0015969276428222656
mini_batch_src_global generation:  0.0017061233520507812
r_  generation:  0.018341779708862305
local_output_nid generation:  0.0023031234741210938
local_in_edges_tensor generation:  0.0020563602447509766
mini_batch_src_global generation:  0.0020418167114257812
r_  generation:  0.02879810333251953
local_output_nid generation:  0.0016398429870605469
local_in_edges_tensor generation:  0.0014064311981201172
mini_batch_src_global generation:  0.002012014389038086
r_  generation:  0.019955158233642578
local_output_nid generation:  0.0018367767333984375
local_in_edges_tensor generation:  0.001644134521484375
mini_batch_src_global generation:  0.010238885879516602
r_  generation:  0.02566051483154297
local_output_nid generation:  0.003406524658203125
local_in_edges_tensor generation:  0.0065155029296875
mini_batch_src_global generation:  0.002476215362548828
r_  generation:  0.02800750732421875
local_output_nid generation:  0.0018742084503173828
local_in_edges_tensor generation:  0.0020952224731445312
mini_batch_src_global generation:  0.0016722679138183594
r_  generation:  0.01714181900024414
local_output_nid generation:  0.002491474151611328
local_in_edges_tensor generation:  0.002227306365966797
mini_batch_src_global generation:  0.002445220947265625
r_  generation:  0.03084254264831543
local_output_nid generation:  0.0022106170654296875
local_in_edges_tensor generation:  0.0025603771209716797
mini_batch_src_global generation:  0.002802133560180664
r_  generation:  0.02968907356262207
local_output_nid generation:  0.002263307571411133
local_in_edges_tensor generation:  0.006844997406005859
mini_batch_src_global generation:  0.003330707550048828
r_  generation:  0.03396725654602051
local_output_nid generation:  0.0021514892578125
local_in_edges_tensor generation:  0.0023589134216308594
mini_batch_src_global generation:  0.003008604049682617
r_  generation:  0.030926942825317383
local_output_nid generation:  0.0024480819702148438
local_in_edges_tensor generation:  0.0029897689819335938
mini_batch_src_global generation:  0.002482175827026367
r_  generation:  0.030207395553588867
local_output_nid generation:  0.002118825912475586
local_in_edges_tensor generation:  0.0022089481353759766
mini_batch_src_global generation:  0.002103090286254883
r_  generation:  0.02461695671081543
local_output_nid generation:  0.0017206668853759766
local_in_edges_tensor generation:  0.001604318618774414
mini_batch_src_global generation:  0.001691579818725586
r_  generation:  0.01973748207092285
local_output_nid generation:  0.002432584762573242
local_in_edges_tensor generation:  0.0036025047302246094
mini_batch_src_global generation:  0.003284931182861328
r_  generation:  0.037441253662109375
local_output_nid generation:  0.004835844039916992
local_in_edges_tensor generation:  0.009710550308227539
mini_batch_src_global generation:  0.011811256408691406
r_  generation:  0.11469388008117676
local_output_nid generation:  0.0044651031494140625
local_in_edges_tensor generation:  0.007877349853515625
mini_batch_src_global generation:  0.00948190689086914
r_  generation:  0.08650755882263184
local_output_nid generation:  0.002898693084716797
local_in_edges_tensor generation:  0.0030548572540283203
mini_batch_src_global generation:  0.0052032470703125
r_  generation:  0.04244422912597656
local_output_nid generation:  0.003920555114746094
local_in_edges_tensor generation:  0.0043413639068603516
mini_batch_src_global generation:  0.00693202018737793
r_  generation:  0.08319735527038574
local_output_nid generation:  0.0052983760833740234
local_in_edges_tensor generation:  0.00954747200012207
mini_batch_src_global generation:  0.011850833892822266
r_  generation:  0.11766552925109863
local_output_nid generation:  0.00461268424987793
local_in_edges_tensor generation:  0.00875234603881836
mini_batch_src_global generation:  0.010434150695800781
r_  generation:  0.09137654304504395
local_output_nid generation:  0.006128072738647461
local_in_edges_tensor generation:  0.010596752166748047
mini_batch_src_global generation:  0.01683974266052246
r_  generation:  0.1405622959136963
local_output_nid generation:  0.0064351558685302734
local_in_edges_tensor generation:  0.011450052261352539
mini_batch_src_global generation:  0.020203351974487305
r_  generation:  0.15610623359680176
local_output_nid generation:  0.0054895877838134766
local_in_edges_tensor generation:  0.00658726692199707
mini_batch_src_global generation:  0.01684880256652832
r_  generation:  0.14204764366149902
local_output_nid generation:  0.0056307315826416016
local_in_edges_tensor generation:  0.007065773010253906
mini_batch_src_global generation:  0.01478266716003418
r_  generation:  0.13341069221496582
local_output_nid generation:  0.007561683654785156
local_in_edges_tensor generation:  0.008424997329711914
mini_batch_src_global generation:  0.01656651496887207
r_  generation:  0.1578235626220703
local_output_nid generation:  0.0053863525390625
local_in_edges_tensor generation:  0.006370067596435547
mini_batch_src_global generation:  0.013210535049438477
r_  generation:  0.12098360061645508
----------------------check_connections_block total spend ----------------------------- 2.793497323989868
generate_one_block  0.04529976844787598
generate_one_block  0.053449153900146484
generate_one_block  0.054077863693237305
generate_one_block  0.03810524940490723
generate_one_block  0.017548799514770508
generate_one_block  0.034761667251586914
generate_one_block  0.025017261505126953
generate_one_block  0.0406801700592041
generate_one_block  0.027596235275268555
generate_one_block  0.03515458106994629
generate_one_block  0.039888620376586914
generate_one_block  0.02353525161743164
generate_one_block  0.043282508850097656
generate_one_block  0.04034543037414551
generate_one_block  0.04767489433288574
generate_one_block  0.045589447021484375
generate_one_block  0.08733344078063965
generate_one_block  0.04559588432312012
generate_one_block  0.028613805770874023
generate_one_block  0.05484962463378906
generate_one_block  0.16092872619628906
generate_one_block  0.12657499313354492
generate_one_block  0.06389975547790527
generate_one_block  0.12207317352294922
generate_one_block  0.1731574535369873
generate_one_block  0.13284897804260254
generate_one_block  0.20009326934814453
generate_one_block  0.22175884246826172
generate_one_block  0.18964838981628418
generate_one_block  0.18454957008361816
generate_one_block  0.20939302444458008
generate_one_block  0.15974831581115723
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04025387763977051
gen group dst list time:  0.04251694679260254
time for parepare:  0.01970076560974121
local_output_nid generation:  0.003701925277709961
local_in_edges_tensor generation:  0.028395891189575195
mini_batch_src_global generation:  0.004693269729614258
r_  generation:  0.05004382133483887
local_output_nid generation:  0.0071370601654052734
local_in_edges_tensor generation:  0.006805419921875
mini_batch_src_global generation:  0.007071495056152344
r_  generation:  0.07299590110778809
local_output_nid generation:  0.008313655853271484
local_in_edges_tensor generation:  0.008928298950195312
mini_batch_src_global generation:  0.008538007736206055
r_  generation:  0.09349775314331055
local_output_nid generation:  0.00676417350769043
local_in_edges_tensor generation:  0.005940914154052734
mini_batch_src_global generation:  0.006622791290283203
r_  generation:  0.0688791275024414
local_output_nid generation:  0.0031599998474121094
local_in_edges_tensor generation:  0.0025467872619628906
mini_batch_src_global generation:  0.00327301025390625
r_  generation:  0.02458643913269043
local_output_nid generation:  0.0070953369140625
local_in_edges_tensor generation:  0.007183551788330078
mini_batch_src_global generation:  0.00603938102722168
r_  generation:  0.08019256591796875
local_output_nid generation:  0.004225015640258789
local_in_edges_tensor generation:  0.003686666488647461
mini_batch_src_global generation:  0.0049359798431396484
r_  generation:  0.03897833824157715
local_output_nid generation:  0.006127357482910156
local_in_edges_tensor generation:  0.0059108734130859375
mini_batch_src_global generation:  0.005154132843017578
r_  generation:  0.06591916084289551
local_output_nid generation:  0.003905773162841797
local_in_edges_tensor generation:  0.003549337387084961
mini_batch_src_global generation:  0.004419088363647461
r_  generation:  0.039882659912109375
local_output_nid generation:  0.0041637420654296875
local_in_edges_tensor generation:  0.00487518310546875
mini_batch_src_global generation:  0.004106998443603516
r_  generation:  0.050763607025146484
local_output_nid generation: [23:59:37] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2759 nodes and 76560 edges into 2 parts and get 244 edge cuts
 0.005565166473388672
local_in_edges_tensor generation:  0.006651639938354492
mini_batch_src_global generation:  0.006401538848876953
r_  generation:  0.0702214241027832
local_output_nid generation:  0.00447845458984375
local_in_edges_tensor generation:  0.004191160202026367
mini_batch_src_global generation:  0.00463557243347168
r_  generation:  0.0461885929107666
local_output_nid generation:  0.0050928592681884766
local_in_edges_tensor generation:  0.005135297775268555
mini_batch_src_global generation:  0.005100727081298828
r_  generation:  0.058498382568359375
local_output_nid generation:  0.006035566329956055
local_in_edges_tensor generation:  0.0069866180419921875
mini_batch_src_global generation:  0.006818532943725586
r_  generation:  0.07540416717529297
local_output_nid generation:  0.005185127258300781
local_in_edges_tensor generation:  0.004640102386474609
mini_batch_src_global generation:  0.005917787551879883
r_  generation:  0.05747413635253906
local_output_nid generation:  0.004858493804931641
local_in_edges_tensor generation:  0.005280494689941406
mini_batch_src_global generation:  0.005234479904174805
r_  generation:  0.05944466590881348
local_output_nid generation:  0.006831169128417969
local_in_edges_tensor generation:  0.0078089237213134766
mini_batch_src_global generation:  0.008390426635742188
r_  generation:  0.08217597007751465
local_output_nid generation:  0.006451129913330078
local_in_edges_tensor generation:  0.0059185028076171875
mini_batch_src_global generation:  0.006983280181884766
r_  generation:  0.0742490291595459
local_output_nid generation:  0.005423069000244141
local_in_edges_tensor generation:  0.0055806636810302734
mini_batch_src_global generation:  0.006005764007568359
r_  generation:  0.07478046417236328
local_output_nid generation:  0.009209156036376953
local_in_edges_tensor generation:  0.008836030960083008
mini_batch_src_global generation:  0.010793924331665039
r_  generation:  0.10017919540405273
local_output_nid generation:  0.013010263442993164
local_in_edges_tensor generation:  0.018570423126220703
mini_batch_src_global generation:  0.01805591583251953
r_  generation:  0.19525790214538574
local_output_nid generation:  0.014404773712158203
local_in_edges_tensor generation:  0.020438671112060547
mini_batch_src_global generation:  0.0210573673248291
r_  generation:  0.21869921684265137
local_output_nid generation:  0.009503364562988281
local_in_edges_tensor generation:  0.019562244415283203
mini_batch_src_global generation:  0.01681661605834961
r_  generation:  0.12401700019836426
local_output_nid generation:  0.011542558670043945
local_in_edges_tensor generation:  0.017055988311767578
mini_batch_src_global generation:  0.019386768341064453
r_  generation:  0.17017483711242676
local_output_nid generation:  0.01672077178955078
local_in_edges_tensor generation:  0.022080421447753906
mini_batch_src_global generation:  0.024115800857543945
r_  generation:  0.23910307884216309
local_output_nid generation:  0.015329599380493164
local_in_edges_tensor generation:  0.01996636390686035
mini_batch_src_global generation:  0.02234363555908203
r_  generation:  0.21351027488708496
local_output_nid generation:  0.016486406326293945
local_in_edges_tensor generation:  0.020270347595214844
mini_batch_src_global generation:  0.025013446807861328
r_  generation:  0.23165249824523926
local_output_nid generation:  0.015816211700439453
local_in_edges_tensor generation:  0.022848129272460938
mini_batch_src_global generation:  0.023454666137695312
r_  generation:  0.23617148399353027
local_output_nid generation:  0.012807130813598633
local_in_edges_tensor generation:  0.01481771469116211
mini_batch_src_global generation:  0.02063298225402832
r_  generation:  0.18330001831054688
local_output_nid generation:  0.014456510543823242
local_in_edges_tensor generation:  0.01703786849975586
mini_batch_src_global generation:  0.02054882049560547
r_  generation:  0.21244144439697266
local_output_nid generation:  0.016355276107788086
local_in_edges_tensor generation:  0.022614479064941406
mini_batch_src_global generation:  0.024274826049804688
r_  generation:  0.2397441864013672
local_output_nid generation:  0.015119552612304688
local_in_edges_tensor generation:  0.02186274528503418
mini_batch_src_global generation:  0.021962642669677734
r_  generation:  0.21876311302185059
----------------------check_connections_block total spend ----------------------------- 5.546105146408081
generate_one_block  0.08085131645202637
generate_one_block  0.1012885570526123
generate_one_block  0.1296858787536621
generate_one_block  0.0914912223815918
generate_one_block  0.034052371978759766
generate_one_block  0.11115646362304688
generate_one_block  0.05220317840576172
generate_one_block  0.12796926498413086
generate_one_block  0.05385136604309082
generate_one_block  0.0662238597869873
generate_one_block  0.09380102157592773
generate_one_block  0.06570172309875488
generate_one_block  0.0756373405456543
generate_one_block  0.09618520736694336
generate_one_block  0.07773351669311523
generate_one_block  0.07533740997314453
generate_one_block  0.11803364753723145
generate_one_block  0.09745669364929199
generate_one_block  0.08072042465209961
generate_one_block  0.13480806350708008
generate_one_block  0.2785966396331787
generate_one_block  0.30083179473876953
generate_one_block  0.24947142601013184
generate_one_block  0.22440671920776367
generate_one_block  0.34543538093566895
generate_one_block  0.3078446388244629
generate_one_block  0.31386828422546387
generate_one_block  0.3237617015838623
generate_one_block  0.23974347114562988
generate_one_block  0.26953649520874023
generate_one_block  0.31449222564697266
generate_one_block  0.2805330753326416
global_2_local spend time (sec) 0.004163265228271484
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0009324550628662109
A = g.adjacency_matrix() spent  0.0005924701690673828
auxiliary_graph
Graph(num_nodes=15166, num_edges=79319,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.024910688400268555
remove nodes length
12407
auxiliary_graph.remove_nodes spent  0.010497093200683594
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2759, num_edges=79319,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.005772590637207031

the counter of shared neighbor distribution
Counter({1.0: 59070, 2.0: 9946, 3.0: 3474, 4.0: 1496, 5.0: 768, 6.0: 448, 7.0: 310, 8.0: 192, 9.0: 184, 10.0: 124, 11.0: 86, 12.0: 78, 13.0: 58, 14.0: 52, 16.0: 40, 15.0: 40, 17.0: 34, 18.0: 32, 20.0: 28, 22.0: 20, 19.0: 18, 21.0: 12, 24.0: 12, 25.0: 10, 26.0: 8, 27.0: 8, 23.0: 6, 32.0: 2, 28.0: 2, 29.0: 2})
76560
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.003 seconds
Metis partitioning: 0.012 seconds
Split the graph: 0.011 seconds
Construct subgraphs: 0.015 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.04270339012145996
1399
1360
total k batches seeds list generation spend  0.13547587394714355
after graph partition
graph partition algorithm spend time 0.14375686645507812
1399
1360
time for parepare:  0.028708219528198242
local_output_nid generation:  0.0003681182861328125
local_in_edges_tensor generation:  0.0035054683685302734
mini_batch_src_global generation:  0.001190185546875
r_  generation:  0.008555889129638672
local_output_nid generation:  0.00029587745666503906
local_in_edges_tensor generation:  0.001756906509399414
mini_batch_src_global generation:  0.0005676746368408203
r_  generation:  0.0033369064331054688
----------------------check_connections_block total spend ----------------------------- 0.0566401481628418
generate_one_block  0.01307821273803711
generate_one_block  0.005743741989135742
time for parepare:  0.020639657974243164
local_output_nid generation:  0.0023391246795654297
local_in_edges_tensor generation:  0.009838104248046875
mini_batch_src_global generation:  0.006983757019042969
r_  generation:  0.07568550109863281
local_output_nid generation:  0.0012824535369873047
local_in_edges_tensor generation:  0.0013499259948730469
mini_batch_src_global generation:  0.002584695816040039
r_  generation:  0.011678934097290039
----------------------check_connections_block total spend ----------------------------- 0.15715718269348145
generate_one_block  0.11222958564758301
generate_one_block  0.01708245277404785
time for parepare:  0.02148127555847168
local_output_nid generation:  0.010097742080688477
local_in_edges_tensor generation:  0.024897336959838867
mini_batch_src_global generation:  0.01586151123046875
r_  generation:  0.208648681640625
local_output_nid generation:  0.00430607795715332
local_in_edges_tensor generation:  0.0039670467376708984
mini_batch_src_global generation:  0.0067768096923828125
r_  generation:  0.04048585891723633
----------------------check_connections_block total spend ----------------------------- 0.3921694755554199
generate_one_block  0.2597057819366455
generate_one_block  0.060235023498535156
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08185386657714844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

connection checking time:  8.33960247039795
block generation total time  7.985784530639648
average batch blocks generation time:  0.249555766582489
block dataloader generation time/epoch 46.67600870132446
pseudo mini batch 0 input nodes size: 44706
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06658744812011719  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06658744812011719  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08807182312011719  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08809375762939453  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04262685775756836  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04408884048461914  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04408884048461914  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 44706
first layer output nodes number: 17066
edges number: 118424
input nodes number: 17066
output nodes number: 6437
edges number: 54195
input nodes number: 6437
output nodes number: 2908
edges number: 23399
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.1695175170898438  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.16951847076416  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.047246456146240234  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 1 input nodes size: 59866
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04285001754760742  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04285001754760742  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.07214689254760742  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.07216835021972656  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05066204071044922  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05266284942626953  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05266284942626953  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 59866
first layer output nodes number: 23582
edges number: 173621
input nodes number: 23582
output nodes number: 7543
edges number: 71593
input nodes number: 7543
output nodes number: 2852
edges number: 23126
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.890216827392578  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.8902173042297363  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05653810501098633  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 2 input nodes size: 68707
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.050653934478759766  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.050653934478759766  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08385705947875977  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.08387899398803711  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05456066131591797  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.057127952575683594  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.057127952575683594  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 68707
first layer output nodes number: 28176
edges number: 222754
input nodes number: 28176
output nodes number: 8252
edges number: 92352
input nodes number: 8252
output nodes number: 2927
edges number: 29192
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 3.6315460205078125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 3.6315464973449707  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.061974525451660156  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 3 input nodes size: 53244
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05457162857055664  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05457162857055664  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.07996034622192383  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.07998180389404297  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.046756744384765625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.048607826232910156  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.048607826232910156  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 53244
first layer output nodes number: 21625
edges number: 159056
input nodes number: 21625
output nodes number: 7055
edges number: 66480
input nodes number: 7055
output nodes number: 2865
edges number: 22672
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.660250186920166  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.660250663757324  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.052187442779541016  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 4 input nodes size: 21934
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.046747684478759766  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.046747684478759766  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05720663070678711  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05722856521606445  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.031818389892578125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03254222869873047  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03254222869873047  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 21934
first layer output nodes number: 9401
edges number: 53434
input nodes number: 9401
output nodes number: 5027
edges number: 28137
input nodes number: 5027
output nodes number: 2887
edges number: 15482
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 1.144932746887207  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 1.1449332237243652  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03411531448364258  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 5 input nodes size: 67949
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03182172775268555  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03182172775268555  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06502485275268555  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06504583358764648  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0545649528503418  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0565495491027832  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0565495491027832  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 67949
first layer output nodes number: 24896
edges number: 189316
input nodes number: 24896
output nodes number: 6737
edges number: 59483
input nodes number: 6737
output nodes number: 2781
edges number: 17382
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.7214794158935547  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.721479892730713  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06033802032470703  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 6 input nodes size: 32430
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.054549217224121094  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.054549217224121094  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.07001304626464844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.07003498077392578  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.036810874938964844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03794384002685547  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03794384002685547  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 32430
first layer output nodes number: 13619
edges number: 88431
input nodes number: 13619
output nodes number: 5888
edges number: 43111
input nodes number: 5888
output nodes number: 2896
edges number: 20441
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 1.722872257232666  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 1.7228727340698242  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04027986526489258  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 7 input nodes size: 51595
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03682756423950195  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03682756423950195  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06142997741699219  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06145191192626953  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.045966148376464844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.047809600830078125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.047809600830078125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 51595
first layer output nodes number: 21659
edges number: 150071
input nodes number: 21659
output nodes number: 8175
edges number: 72068
input nodes number: 8175
output nodes number: 2925
edges number: 25054
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.712198257446289  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.7121987342834473  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.051468849182128906  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 8 input nodes size: 30583
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.045970916748046875  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.045970916748046875  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06055402755737305  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06057548522949219  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03595113754272461  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03721284866333008  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03721284866333008  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 30583
first layer output nodes number: 12793
edges number: 92249
input nodes number: 12793
output nodes number: 5377
edges number: 50202
input nodes number: 5377
output nodes number: 2870
edges number: 26637
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 1.928278923034668  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 1.9282793998718262  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.039708614349365234  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 9 input nodes size: 32253
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03594255447387695  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.03594255447387695  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.051321983337402344  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05134391784667969  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.036739349365234375  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.038303375244140625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.038303375244140625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 32253
first layer output nodes number: 15996
edges number: 119392
input nodes number: 15996
output nodes number: 6220
edges number: 63861
input nodes number: 6220
output nodes number: 2912
edges number: 26547
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.355329990386963  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.355330467224121  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04131889343261719  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 10 input nodes size: 54122
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.036745548248291016  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.036745548248291016  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06255292892456055  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06257486343383789  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.047173500061035156  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04913902282714844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04913902282714844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 54122
first layer output nodes number: 21722
edges number: 164082
input nodes number: 21722
output nodes number: 6987
edges number: 71906
input nodes number: 6987
output nodes number: 2895
edges number: 27688
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.845883369445801  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 2.845883846282959  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.05292510986328125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 11 input nodes size: 42937
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04717111587524414  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04717111587524414  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06764507293701172  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06766653060913086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.041837215423583984  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04302167892456055  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04302167892456055  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 42937
first layer output nodes number: 15643
edges number: 105008
input nodes number: 15643
output nodes number: 5638
edges number: 38217
input nodes number: 5638
output nodes number: 2869
edges number: 15528
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 1.7228012084960938  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 1.722801685333252  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04543495178222656  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 12 input nodes size: 38768
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04183340072631836  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.04183340072631836  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06031942367553711  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.06034135818481445  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.039845943450927734  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0416560173034668  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5185546875 GB
    Memory Allocated: 0.0416560173034668  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 38768
first layer output nodes number: 18785
edges number: 134138
input nodes number: 18785
output nodes number: 7787
edges number: 80266
input nodes number: 7787
output nodes number: 2920
edges number: 28314
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5224609375 GB
    Memory Allocated: 2.7498960494995117  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5224609375 GB
    Memory Allocated: 2.74989652633667  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.04520130157470703  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 13 input nodes size: 55749
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.039853572845458984  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.039853572845458984  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.066436767578125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.06645774841308594  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.047949790954589844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.049900054931640625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.049900054931640625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 55749
first layer output nodes number: 23367
edges number: 168683
input nodes number: 23367
output nodes number: 7658
edges number: 72199
input nodes number: 7658
output nodes number: 2774
edges number: 20727
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 2.7885122299194336  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 2.788512706756592  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.053664207458496094  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 14 input nodes size: 35040
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.0479278564453125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.0479278564453125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.06463623046875  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.06465768814086914  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.03805351257324219  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.039969444274902344  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.039969444274902344  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 35040
first layer output nodes number: 18586
edges number: 137306
input nodes number: 18586
output nodes number: 7862
edges number: 89972
input nodes number: 7862
output nodes number: 2870
edges number: 29824
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 2.942758560180664  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 2.9427590370178223  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.043679237365722656  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 15 input nodes size: 35912
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.03806781768798828  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.03806781768798828  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.055191993713378906  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.05521345138549805  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.038483619689941406  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.04033184051513672  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5263671875 GB
    Memory Allocated: 0.04033184051513672  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 35912
first layer output nodes number: 18548
edges number: 136174
input nodes number: 18548
output nodes number: 7422
edges number: 80797
input nodes number: 7422
output nodes number: 2868
edges number: 30932
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5537109375 GB
    Memory Allocated: 2.809441566467285  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5537109375 GB
    Memory Allocated: 2.8094420433044434  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.04389476776123047  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 16 input nodes size: 66374
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.038483619689941406  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.038483619689941406  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07013320922851562  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07015466690063477  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.053009033203125  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05513572692871094  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05513572692871094  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 66374
first layer output nodes number: 26379
edges number: 191095
input nodes number: 26379
output nodes number: 8218
edges number: 73775
input nodes number: 8218
output nodes number: 2875
edges number: 20388
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 3.0063562393188477  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 3.006356716156006  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05926990509033203  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 17 input nodes size: 61217
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.053009986877441406  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.053009986877441406  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.0823068618774414  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.08232879638671875  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05065774917602539  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05240774154663086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05240774154663086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 61217
first layer output nodes number: 23275
edges number: 160319
input nodes number: 23275
output nodes number: 7476
edges number: 56780
input nodes number: 7476
output nodes number: 2910
edges number: 17602
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 2.473369598388672  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 2.47337007522583  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05589580535888672  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 18 input nodes size: 54510
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.050662994384765625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.050662994384765625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07665538787841797  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07667684555053711  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.047358036041259766  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.04885721206665039  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.04885721206665039  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 54510
first layer output nodes number: 19086
edges number: 137133
input nodes number: 19086
output nodes number: 6172
edges number: 46718
input nodes number: 6172
output nodes number: 2857
edges number: 17256
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 2.1294236183166504  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 2.1294240951538086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05183124542236328  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 19 input nodes size: 71480
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.04734992980957031  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.04734992980957031  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.08143424987792969  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.08145570755004883  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.055441856384277344  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.058013916015625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.058013916015625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 71480
first layer output nodes number: 29899
edges number: 228113
input nodes number: 29899
output nodes number: 9258
edges number: 94108
input nodes number: 9258
output nodes number: 2874
edges number: 22679
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 3.6209778785705566  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 3.620978355407715  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06290292739868164  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 20 input nodes size: 87400
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05544471740722656  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05544471740722656  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.09712028503417969  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.09714126586914062  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06303548812866211  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06938409805297852  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06938409805297852  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 87400
first layer output nodes number: 53844
edges number: 455894
input nodes number: 53844
output nodes number: 18221
edges number: 291285
input nodes number: 18221
output nodes number: 2758
edges number: 42690
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 8.606215476989746  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 8.606215953826904  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.08209228515625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 21 input nodes size: 74798
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.0630178451538086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.0630178451538086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.09868431091308594  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.09870529174804688  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05700874328613281  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06000804901123047  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06000804901123047  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 74798
first layer output nodes number: 35170
edges number: 279061
input nodes number: 35170
output nodes number: 9487
edges number: 104976
input nodes number: 9487
output nodes number: 2783
edges number: 18211
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 4.117668628692627  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 4.117669105529785  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06607532501220703  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 22 input nodes size: 83644
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05701255798339844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.05701255798339844  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.09689712524414062  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.09691810607910156  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06123065948486328  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06574344635009766  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06574344635009766  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 83644
first layer output nodes number: 46336
edges number: 378898
input nodes number: 46336
output nodes number: 14397
edges number: 197578
input nodes number: 14397
output nodes number: 2782
edges number: 28975
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 6.422112464904785  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 6.422112941741943  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07476043701171875  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 23 input nodes size: 104502
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06123065948486328  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06123065948486328  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.11106109619140625  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.11108207702636719  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07117652893066406  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07847929000854492  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07847929000854492  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 104502
first layer output nodes number: 65496
edges number: 545843
input nodes number: 65496
output nodes number: 18568
edges number: 286182
input nodes number: 18568
output nodes number: 2777
edges number: 31223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 9.065539836883545  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 9.065540313720703  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.09041881561279297  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 24 input nodes size: 103441
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07117557525634766  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07117557525634766  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.12050008773803711  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.12052106857299805  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07066965103149414  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07632780075073242  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07632780075073242  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 103441
first layer output nodes number: 60241
edges number: 498048
input nodes number: 60241
output nodes number: 16285
edges number: 233819
input nodes number: 16285
output nodes number: 2758
edges number: 27459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 7.87545919418335  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 7.875459671020508  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.08692693710327148  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 25 input nodes size: 96080
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07066679000854492  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07066679000854492  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.11648130416870117  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.11650323867797852  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06715774536132812  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07439517974853516  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07439517974853516  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 96080
first layer output nodes number: 63913
edges number: 537109
input nodes number: 63913
output nodes number: 22487
edges number: 372269
input nodes number: 22487
output nodes number: 2894
edges number: 42567
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 10.421325206756592  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 10.42132568359375  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.08861923217773438  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

pseudo mini batch 26 input nodes size: 97606
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06717824935913086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06717824935913086  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.11372041702270508  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.11374139785766602  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.06790494918823242  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07549619674682617  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5556640625 GB
    Memory Allocated: 0.07549619674682617  GigaBytes
Max Memory Allocated: 10.970747947692871  GigaBytes

first layer input nodes number: 97606
first layer output nodes number: 66177
edges number: 557469
input nodes number: 66177
output nodes number: 24466
edges number: 414940
input nodes number: 24466
output nodes number: 2758
edges number: 46332
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9521484375 GB
    Memory Allocated: 11.247736930847168  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9521484375 GB
    Memory Allocated: 11.247737407684326  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0900125503540039  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 27 input nodes size: 79537
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06788444519042969  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06788444519042969  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10581064224243164  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10583209991455078  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.059268951416015625  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06561565399169922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06561565399169922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 79537
first layer output nodes number: 51055
edges number: 436984
input nodes number: 51055
output nodes number: 20746
edges number: 362803
input nodes number: 20746
output nodes number: 2851
edges number: 51943
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.637495994567871  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.63749647140503  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0785670280456543  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 28 input nodes size: 90308
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.059282779693603516  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.059282779693603516  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10234498977661133  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10236597061157227  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06441831588745117  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0709981918334961  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0709981918334961  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 90308
first layer output nodes number: 58578
edges number: 495694
input nodes number: 58578
output nodes number: 20495
edges number: 344456
input nodes number: 20495
output nodes number: 2758
edges number: 41080
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.68470048904419  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.684700965881348  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0842890739440918  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 29 input nodes size: 103075
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06440448760986328  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06440448760986328  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11355447769165039  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11357545852661133  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07049226760864258  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07797861099243164  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07797861099243164  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 103075
first layer output nodes number: 68220
edges number: 571652
input nodes number: 68220
output nodes number: 23458
edges number: 391362
input nodes number: 23458
output nodes number: 2768
edges number: 41499
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 10.939671993255615  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 10.939672470092773  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.09331655502319336  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 30 input nodes size: 98301
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07049369812011719  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07049369812011719  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11736726760864258  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11738824844360352  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06821727752685547  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07445430755615234  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07445430755615234  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 98301
first layer output nodes number: 61293
edges number: 511137
input nodes number: 61293
output nodes number: 18457
edges number: 293594
input nodes number: 18457
output nodes number: 2760
edges number: 32236
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 8.905689716339111  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 8.90569019317627  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08597803115844727  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 31 input nodes size: 95232
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06821632385253906  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06821632385253906  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11362648010253906  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11363697052001953  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0667424201965332  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0717158317565918  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0717158317565918  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 95232
first layer output nodes number: 53471
edges number: 458190
input nodes number: 53471
output nodes number: 11897
edges number: 192104
input nodes number: 11897
output nodes number: 1399
edges number: 17129
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 6.74801778793335  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 6.748018264770508  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08072900772094727  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 32 input nodes size: 38039
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06653976440429688  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06653976440429688  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08467817306518555  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08468866348266602  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03926801681518555  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.040128231048583984  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.040128231048583984  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 38039
first layer output nodes number: 11703
edges number: 82278
input nodes number: 11703
output nodes number: 3372
edges number: 25540
input nodes number: 3372
output nodes number: 1360
edges number: 7542
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.2003931999206543  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.2003936767578125  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04186725616455078  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04186725616455078  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04186725616455078  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05173392729325728 |0.006911740158543442 |0.33025498101205536 |0.0001364693497166489 |0.42804636377276795 |0.011970043182373047 |
----------------------------------------------------------pseudo_mini_loss sum 4.994904041290283
Total (block generation + training)time/epoch 73.87327837944031
Training time/epoch 27.19690465927124
Training time without block to device /epoch 26.968817234039307
Training time without total dataloading part /epoch 25.040417909622192
load block tensor time/epoch 1.7072196006774902
block to device time/epoch 0.2280874252319336
input features size transfer per epoch 4.425644874572754e-06
blocks size to device per epoch 2.950429916381836e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3594464
Number of first layer input nodes during this epoch:  2131339
Number of first layer output nodes during this epoch:  1099600
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04186677932739258  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027777910232543945
global_2_local spend time (sec) 0.05366325378417969
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0048868656158447266
A = g.adjacency_matrix() spent  0.009197235107421875
auxiliary_graph
Graph(num_nodes=158231, num_edges=37309159,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10771465301513672
remove nodes length
67290
auxiliary_graph.remove_nodes spent  2.0913305282592773
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37309159,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.6660268306732178

the counter of shared neighbor distribution
Counter({1.0: 28394942, 2.0: 5919872, 3.0: 1750688, 4.0: 612700, 5.0: 253056, 6.0: 119164, 7.0: 62452, 8.0: 36226, 9.0: 21794, 10.0: 14268, 11.0: 9568, 12.0: 6566, 13.0: 4528, 14.0: 3276, 15.0: 2426, 16.0: 1748, 17.0: 1260, 18.0: 896, 19.0: 674, 20.0: 530, 21.0: 404, 22.0: 326, 23.0: 200, 24.0: 168, 25.0: 148, 26.0: 94, 27.0: 70, 29.0: 46, 28.0: 46, 30.0: 20, 31.0: 18, 32.0: 10, 33.0: 8, 35.0: 6, 34.0: 6, 40.0: 6, 36.0: 2, 49.0: 2, 39.0: 2, 38.0: 2})
37218218
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------[00:00:32] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37218218 edges into 32 parts and get 12746333 edge cuts


before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37218215, 37218216, 37218217])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28394942, 2.0: 5919872, 3.0: 1750688, 4.0: 612700, 5.0: 253056, 6.0: 119164, 7.0: 62452, 8.0: 36226, 9.0: 21794, 10.0: 14268, 11.0: 9568, 12.0: 6566, 13.0: 4528, 14.0: 3276, 15.0: 2426, 16.0: 1748, 17.0: 1260, 18.0: 896, 19.0: 674, 20.0: 530, 21.0: 404, 22.0: 326, 23.0: 200, 24.0: 168, 25.0: 148, 26.0: 94, 27.0: 70, 29.0: 46, 28.0: 46, 30.0: 20, 31.0: 18, 32.0: 10, 33.0: 8, 35.0: 6, 34.0: 6, 40.0: 6, 36.0: 2, 49.0: 2, 39.0: 2, 38.0: 2})
Convert a graph into a bidirected graph: 2.614 seconds
Metis partitioning: 8.313 seconds
Split the graph: 1.244 seconds
Construct subgraphs: 0.135 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  12.324204444885254
2896
2911
2908
2884
2908
2881
2904
2903
2798
2892
2893
2864
2837
2912
2765
2927
2786
2768
2758
2761
2926
2775
2886
2891
2799
2758
2786
2790
2758
2759
2759
2898
total k batches seeds list generation spend  28.006699800491333
after graph partition
graph partition algorithm spend time 28.198226928710938
2896
2911
2908
2884
2908
2881
2904
2903
2798
2892
2893
2864
2837
2912
2765
2927
2786
2768
2758
2761
2926
2775
2886
2891
2799
2758
2786
2790
2758
2759
2759
2898
partition_len_list
[5297, 5710, 7763, 6053, 9509, 7026, 6026, 6994, 5292, 5257, 6279, 6268, 6944, 7154, 9781, 7715, 12314, 12678, 19162, 15650, 8145, 9389, 8879, 6306, 22669, 22124, 18462, 18205, 19882, 23965, 20704, 21030]
shared_neighbor_graph_partition_s0 selection method  spend 28.314253330230713
time for parepare:  0.01850295066833496
local_output_nid generation:  0.0006244182586669922
local_in_edges_tensor generation:  0.0010042190551757812
mini_batch_src_global generation:  0.0007960796356201172
r_  generation:  0.006570577621459961
local_output_nid generation:  0.0007348060607910156
local_in_edges_tensor generation:  0.0007998943328857422
mini_batch_src_global generation:  0.0008015632629394531
r_  generation:  0.007697582244873047
local_output_nid generation:  0.0007762908935546875
local_in_edges_tensor generation:  0.0008590221405029297
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.01038217544555664
local_output_nid generation:  0.0008127689361572266
local_in_edges_tensor generation:  0.0007996559143066406
mini_batch_src_global generation:  0.0007953643798828125
r_  generation:  0.006853818893432617
local_output_nid generation:  0.00083160400390625
local_in_edges_tensor generation:  0.0008220672607421875
mini_batch_src_global generation:  0.0010585784912109375
r_  generation:  0.011231660842895508
local_output_nid generation:  0.0008246898651123047
local_in_edges_tensor generation:  0.0008242130279541016
mini_batch_src_global generation:  0.0009837150573730469
r_  generation:  0.010074138641357422
local_output_nid generation:  0.0008246898651123047
local_in_edges_tensor generation:  0.0007851123809814453
mini_batch_src_global generation:  0.0008769035339355469
r_  generation:  0.008194208145141602
local_output_nid generation:  0.0008153915405273438
local_in_edges_tensor generation:  0.0008189678192138672
mini_batch_src_global generation:  0.0008683204650878906
r_  generation:  0.009378433227539062
local_output_nid generation:  0.0007674694061279297
local_in_edges_tensor generation:  0.0008084774017333984
mini_batch_src_global generation:  0.0008976459503173828
r_  generation:  0.01002192497253418
local_output_nid generation:  0.0007982254028320312
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  0.0008754730224609375
r_  generation:  0.008221864700317383
local_output_nid generation:  0.0008082389831542969
local_in_edges_tensor generation:  0.0009405612945556641
mini_batch_src_global generation:  0.0009951591491699219
r_  generation:  0.010852575302124023
local_output_nid generation:  0.0007927417755126953
local_in_edges_tensor generation:  0.0007863044738769531
mini_batch_src_global generation:  0.0009589195251464844
r_  generation:  0.010010957717895508
local_output_nid generation:  0.0007812976837158203
local_in_edges_tensor generation:  0.0007786750793457031
mini_batch_src_global generation:  0.0010237693786621094
r_  generation:  0.010814905166625977
local_output_nid generation:  0.0008029937744140625
local_in_edges_tensor generation:  0.0008211135864257812
mini_batch_src_global generation:  0.0008869171142578125
r_  generation:  0.009116888046264648
local_output_nid generation:  0.0007450580596923828
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0009138584136962891
r_  generation:  0.00931549072265625
local_output_nid generation:  0.0008130073547363281
local_in_edges_tensor generation:  0.0008051395416259766
mini_batch_src_global generation:  0.0010483264923095703
r_  generation:  0.011333942413330078
local_output_nid generation:  0.0007574558258056641
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.0009174346923828125
r_  generation:  0.008503437042236328
local_output_nid generation:  0.0007643699645996094
local_in_edges_tensor generation:  0.0007710456848144531
mini_batch_src_global generation:  0.0009829998016357422
r_  generation:  0.010502099990844727
local_output_nid generation:  0.0007712841033935547
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0021414756774902344
r_  generation:  0.017723560333251953
local_output_nid generation:  0.0008370876312255859
local_in_edges_tensor generation:  0.0007638931274414062
mini_batch_src_global generation:  0.0013184547424316406
r_  generation:  0.010020732879638672
local_output_nid generation:  0.0008969306945800781
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  0.001058340072631836
r_  generation:  0.008986234664916992
local_output_nid generation:  0.0008969306945800781
local_in_edges_tensor generation:  0.0009329319000244141
mini_batch_src_global generation:  0.0008258819580078125
r_  generation:  0.007926702499389648
local_output_nid generation:  0.0009441375732421875
local_in_edges_tensor generation:  0.0008308887481689453
mini_batch_src_global generation:  0.0008497238159179688
r_  generation:  0.008695840835571289
local_output_nid generation:  0.000904083251953125
local_in_edges_tensor generation:  0.0007863044738769531
mini_batch_src_global generation:  0.0007452964782714844
r_  generation:  0.007616758346557617
local_output_nid generation:  0.0008261203765869141
local_in_edges_tensor generation:  0.0009241104125976562
mini_batch_src_global generation:  0.0019457340240478516
r_  generation:  0.016104459762573242
local_output_nid generation:  0.0008132457733154297
local_in_edges_tensor generation:  0.0008442401885986328
mini_batch_src_global generation:  0.0022017955780029297
r_  generation:  0.016348838806152344
local_output_nid generation:  0.0008602142333984375
local_in_edges_tensor generation:  0.0008349418640136719
mini_batch_src_global generation:  0.0018732547760009766
r_  generation:  0.014150142669677734
local_output_nid generation:  0.0008456707000732422
local_in_edges_tensor generation:  0.0008375644683837891
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.011222124099731445
local_output_nid generation:  0.0008339881896972656
local_in_edges_tensor generation:  0.0007786750793457031
mini_batch_src_global generation:  0.0017638206481933594
r_  generation:  0.013933181762695312
local_output_nid generation:  0.0008475780487060547
local_in_edges_tensor generation:  0.0008387565612792969
mini_batch_src_global generation:  0.0014522075653076172
r_  generation:  0.017562150955200195
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0010793209075927734
mini_batch_src_global generation:  0.0016949176788330078
r_  generation:  0.017562389373779297
local_output_nid generation:  0.0009450912475585938
local_in_edges_tensor generation:  0.0010819435119628906
mini_batch_src_global generation:  0.0017468929290771484
r_  generation:  0.01983022689819336
----------------------check_connections_block total spend ----------------------------- 0.5581643581390381
generate_one_block  0.0166475772857666
generate_one_block  0.01344609260559082
generate_one_block  0.017504453659057617
generate_one_block  0.010572433471679688
generate_one_block  0.018520116806030273
generate_one_block  0.015149831771850586
generate_one_block  0.012840509414672852
generate_one_block  0.014293193817138672
generate_one_block  0.01389932632446289
generate_one_block  0.012063026428222656
generate_one_block  0.0160675048828125
generate_one_block  0.015592098236083984
generate_one_block  0.01631474494934082
generate_one_block  0.013722896575927734
generate_one_block  0.015231132507324219
generate_one_block  0.01733088493347168
generate_one_block  0.017635583877563477
generate_one_block  0.01739501953125
generate_one_block  0.027415752410888672
generate_one_block  0.017611265182495117
generate_one_block  0.013663291931152344
generate_one_block  0.012963533401489258
generate_one_block  0.013558626174926758
generate_one_block  0.011217355728149414
generate_one_block  0.025655746459960938
generate_one_block  0.026086807250976562
generate_one_block  0.02193164825439453
generate_one_block  0.01942610740661621
generate_one_block  0.022150754928588867
generate_one_block  0.027476787567138672
generate_one_block  0.028249025344848633
generate_one_block  0.034353017807006836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.060799360275268555
gen group dst list time:  0.011895895004272461
time for parepare:  0.023163318634033203
local_output_nid generation:  0.0017888545989990234
local_in_edges_tensor generation:  0.015325784683227539
mini_batch_src_global generation:  0.002079486846923828
r_  generation:  0.014442682266235352
local_output_nid generation:  0.0020678043365478516
local_in_edges_tensor generation:  0.002012014389038086
mini_batch_src_global generation:  0.0017745494842529297
r_  generation:  0.016237974166870117
local_output_nid generation:  0.002672433853149414
local_in_edges_tensor generation:  0.0021376609802246094
mini_batch_src_global generation:  0.003197193145751953
r_  generation:  0.030866146087646484
local_output_nid generation:  0.0018908977508544922
local_in_edges_tensor generation:  0.001661539077758789
mini_batch_src_global generation:  0.0018358230590820312
r_  generation:  0.017566204071044922
local_output_nid generation:  0.003017425537109375
local_in_edges_tensor generation:  0.00454258918762207
mini_batch_src_global generation:  0.0042572021484375
r_  generation:  0.042801856994628906
local_output_nid generation:  0.0022339820861816406
local_in_edges_tensor generation:  0.0020062923431396484
mini_batch_src_global generation:  0.0032699108123779297
r_  generation:  0.030865192413330078
local_output_nid generation:  0.0019712448120117188
local_in_edges_tensor generation:  0.001981973648071289
mini_batch_src_global generation:  0.0018758773803710938
r_  generation:  0.01961994171142578
local_output_nid generation:  0.002142667770385742
local_in_edges_tensor generation:  0.0019791126251220703
mini_batch_src_global generation:  0.0025472640991210938
r_  generation:  0.025054931640625
local_output_nid generation:  0.0016541481018066406
local_in_edges_tensor generation:  0.0015285015106201172
mini_batch_src_global generation:  0.0019652843475341797
r_  generation:  0.01885199546813965
local_output_nid generation:  0.0016016960144042969
local_in_edges_tensor generation:  0.0015728473663330078
mini_batch_src_global generation:  0.0015788078308105469
r_  generation:  0.016354799270629883
local_output_nid generation:  0.0018815994262695312
local_in_edges_tensor generation:  0.0017404556274414062
mini_batch_src_global generation:  0.0019373893737792969
r_  generation:  0.02559685707092285
local_output_nid generation:  0.0016248226165771484
local_in_edges_tensor generation:  0.0021736621856689453
mini_batch_src_global generation:  0.0022208690643310547
r_  generation:  0.024122238159179688
local_output_nid generation:  0.00299835205078125
local_in_edges_tensor generation:  0.002123117446899414
mini_batch_src_global generation:  0.0022439956665039062
r_  generation:  0.027905702590942383
local_output_nid generation:  0.0019550323486328125
local_in_edges_tensor generation:  0.0017788410186767578
mini_batch_src_global generation:  0.0022919178009033203
r_  generation:  0.026361703872680664
local_output_nid generation:  0.0025756359100341797
local_in_edges_tensor generation:  0.0037887096405029297
mini_batch_src_global generation:  0.007367372512817383
r_  generation:  0.04411053657531738
local_output_nid generation:  0.002711057662963867
local_in_edges_tensor generation:  0.0024738311767578125
mini_batch_src_global generation:  0.0035986900329589844
r_  generation:  0.032894134521484375
local_output_nid generation:  0.004266023635864258
local_in_edges_tensor generation:  0.005191802978515625
mini_batch_src_global generation:  0.005229949951171875
r_  generation:  0.0652775764465332
local_output_nid generation:  0.004387855529785156
local_in_edges_tensor generation:  0.005774736404418945
mini_batch_src_global generation:  0.008627891540527344
r_  generation:  0.06756758689880371
local_output_nid generation:  0.006494045257568359
local_in_edges_tensor generation:  0.00873255729675293
mini_batch_src_global generation:  0.012121438980102539
r_  generation:  0.12845468521118164
local_output_nid generation:  0.005411863327026367
local_in_edges_tensor generation:  0.008248329162597656
mini_batch_src_global generation:  0.01082158088684082
r_  generation:  0.09193992614746094
local_output_nid generation:  0.0030617713928222656
local_in_edges_tensor generation:  0.002520322799682617
mini_batch_src_global generation:  0.0041005611419677734
r_  generation:  0.030507802963256836
local_output_nid generation:  0.003274202346801758
local_in_edges_tensor generation:  0.0044214725494384766
mini_batch_src_global generation:  0.003501415252685547
r_  generation:  0.04235029220581055
local_output_nid generation:  0.0029802322387695312
local_in_edges_tensor generation:  0.0027921199798583984
mini_batch_src_global generation:  0.003286600112915039
r_  generation:  0.036545753479003906
local_output_nid generation:  0.0020318031311035156
local_in_edges_tensor generation:  0.0020325183868408203
mini_batch_src_global generation:  0.002192258834838867
r_  generation:  0.02120065689086914
local_output_nid generation:  0.007157325744628906
local_in_edges_tensor generation:  0.012325286865234375
mini_batch_src_global generation:  0.014256715774536133
r_  generation:  0.15447616577148438
local_output_nid generation:  0.007455110549926758
local_in_edges_tensor generation:  0.01042032241821289
mini_batch_src_global generation:  0.016546964645385742
r_  generation:  0.15504670143127441
local_output_nid generation:  0.0063745975494384766
local_in_edges_tensor generation:  0.008565902709960938
mini_batch_src_global generation:  0.013105630874633789
r_  generation:  0.12534570693969727
local_output_nid generation:  0.009675741195678711
local_in_edges_tensor generation:  0.00943136215209961
mini_batch_src_global generation:  0.014134645462036133
r_  generation:  0.11896300315856934
local_output_nid generation:  0.006887197494506836
local_in_edges_tensor generation:  0.007135629653930664
mini_batch_src_global generation:  0.013885498046875
r_  generation:  0.1350388526916504
local_output_nid generation:  0.008049964904785156
local_in_edges_tensor generation:  0.008661270141601562
mini_batch_src_global generation:  0.01921534538269043
r_  generation:  0.16867971420288086
local_output_nid generation:  0.007020235061645508
local_in_edges_tensor generation:  0.007547616958618164
mini_batch_src_global generation:  0.0160830020904541
r_  generation:  0.14944052696228027
local_output_nid generation:  0.006999492645263672
local_in_edges_tensor generation:  0.010710000991821289
mini_batch_src_global generation:  0.01825547218322754
r_  generation:  0.15490412712097168
----------------------check_connections_block total spend ----------------------------- 2.977710723876953
generate_one_block  0.029962539672851562
generate_one_block  0.035858869552612305
generate_one_block  0.04601168632507324
generate_one_block  0.025036096572875977
generate_one_block  0.06525826454162598
generate_one_block  0.04187893867492676
generate_one_block  0.027306556701660156
generate_one_block  0.03528738021850586
generate_one_block  0.025832653045654297
generate_one_block  0.022535085678100586
generate_one_block  0.03711056709289551
generate_one_block  0.034804344177246094
generate_one_block  0.0402529239654541
generate_one_block  0.037284135818481445
generate_one_block  0.06469988822937012
generate_one_block  0.04565119743347168
generate_one_block  0.09029436111450195
generate_one_block  0.09377264976501465
generate_one_block  0.17006659507751465
generate_one_block  0.12537646293640137
generate_one_block  0.041420936584472656
generate_one_block  0.06007742881774902
generate_one_block  0.05075836181640625
generate_one_block  0.02999281883239746
generate_one_block  0.20272445678710938
generate_one_block  0.19871020317077637
generate_one_block  0.1552286148071289
generate_one_block  0.15222787857055664
generate_one_block  0.17137885093688965
generate_one_block  0.2222907543182373
generate_one_block  0.19835662841796875
generate_one_block  0.20018553733825684
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07649111747741699
gen group dst list time:  0.06002545356750488
time for parepare:  0.02479696273803711
local_output_nid generation:  0.0032417774200439453
local_in_edges_tensor generation:  0.02109241485595703
mini_batch_src_global generation:  0.009897470474243164
r_  generation:  0.036023855209350586
local_output_nid generation:  0.0039014816284179688
local_in_edges_tensor generation:  0.003794431686401367
mini_batch_src_global generation:  0.00492548942565918
r_  generation:  0.032607316970825195
local_output_nid generation:  0.0068895816802978516
local_in_edges_tensor generation:  0.006746530532836914
mini_batch_src_global generation:  0.010262250900268555
r_  generation:  0.07510209083557129
local_output_nid generation:  0.005198478698730469
local_in_edges_tensor generation:  0.004912853240966797
mini_batch_src_global generation:  0.0057220458984375
r_  generation:  0.04868602752685547
local_output_nid generation:  0.010103940963745117
local_in_edges_tensor generation:  0.011182785034179688
mini_batch_src_global generation:  0.011096477508544922
r_  generation:  0.11627936363220215
local_output_nid generation:  0.0073206424713134766
local_in_edges_tensor generation:  0.006778240203857422
mini_batch_src_global generation:  0.008194684982299805
r_  generation:  0.07973480224609375
local_output_nid generation:  0.004857063293457031
local_in_edges_tensor generation:  0.00453495979309082
mini_batch_src_global generation:  0.0049440860748291016
r_  generation:  0.046700477600097656
local_output_nid generation:  0.005833625793457031
local_in_edges_tensor generation:  0.0070171356201171875
mini_batch_src_global generation:  0.004873991012573242
r_  generation:  0.0538029670715332
local_output_nid generation:  0.0038704872131347656
local_in_edges_tensor generation:  0.003462076187133789
mini_batch_src_global generation:  0.003634929656982422
r_  generation:  0.0365602970123291
local_output_nid generation:  0.004096269607543945
local_in_edges_tensor generation:  0.004782199859619141
mini_batch_src_global generation:  0.003130197525024414
r_  generation:  0.03832554817199707
local_output_nid generation:  0.0046427249908447266
local_in_edges_tensor generation:  0.004179954528808594
mini_batch_src_global generation:  0.004417896270751953
r_  generation:  0.05079245567321777
local_output_nid generation:  0.005745649337768555
local_in_edges_tensor generation:  0.005129814147949219
mini_batch_src_global generation:  0.004860639572143555
r_  generation:  0.05443692207336426
local_output_nid generation:  0.00462794303894043
local_in_edges_tensor generation:  0.004662036895751953
mini_batch_src_global generation:  0.004742145538330078
r_  generation:  0.05141019821166992
local_output_nid generation:  0.0049686431884765625
local_in_edges_tensor generation:  0.004868745803833008
mini_batch_src_global generation:  0.010164022445678711
r_  generation:  0.05468392372131348
local_output_nid generation:  0.012425422668457031
local_in_edges_tensor generation:  0.013518333435058594
mini_batch_src_global generation:  0.011187314987182617
r_  generation:  0.13458490371704102
local_output_nid generation:  0.00640416145324707
local_in_edges_tensor generation:  0.005620718002319336
mini_batch_src_global generation:  0.007506132125854492
r_  generation:  0.06011843681335449
local_output_nid generation:  0.015740633010864258
local_in_edges_tensor generation:  0.01763916015625
mini_batch_src_global generation:  0.01636791229248047
r_  generation:  0.1819477081298828
local_output_nid generation:  0.011090755462646484
local_in_edges_tensor generation:  0.012897491455078125
mini_batch_src_global generation:  0.015836238861083984
r_  generation:  0.14682912826538086
local_output_nid generation:  0.014280319213867188
local_in_edges_tensor generation:  0.01814126968383789
mini_batch_src_global generation:  0.02113938331604004
r_  generation:  0.20297837257385254
local_output_nid generation:  0.015880346298217773
local_in_edges_tensor generation:  0.024817228317260742
mini_batch_src_global generation:  0.02365398406982422
r_  generation:  0.2198023796081543
local_output_nid generation:  0.007306098937988281
local_in_edges_tensor generation:  0.0062258243560791016
mini_batch_src_global generation:  0.010560274124145508
r_  generation:  0.07472062110900879
local_output_nid generation:  0.010431289672851562
local_in_edges_tensor generation:  0.011461973190307617
mini_batch_src_global generation:  0.012249946594238281
r_  generation:  0.13007688522338867
local_output_nid generation:  0.008451461791992188
local_in_edges_tensor generation:  0.008841514587402344
mini_batch_src_global generation:  0.010770797729492188
r_  generation:  0.09743762016296387
local_output_nid generation:  0.006246805191040039
local_in_edges_tensor generation:  0.006648063659667969
mini_batch_src_global generation:  0.007340192794799805
r_  generation:  0.06620192527770996
local_output_nid generation:  0.01683831214904785
local_in_edges_tensor generation:  0.020074129104614258
mini_batch_src_global generation:  0.02316737174987793
r_  generation:  0.2538435459136963
local_output_nid generation:  0.016933202743530273
local_in_edges_tensor generation:  0.023952722549438477
mini_batch_src_global generation:  0.023908376693725586
r_  generation:  0.23800158500671387
local_output_nid generation:  0.016300201416015625
local_in_edges_tensor generation:  0.02066206932067871
mini_batch_src_global generation:  0.02429819107055664
r_  generation:  0.23274731636047363
local_output_nid generation:  0.017266035079956055
local_in_edges_tensor generation:  0.02026200294494629
mini_batch_src_global generation:  0.02403855323791504
r_  generation:  0.24705934524536133
local_output_nid generation:  0.01643204689025879
local_in_edges_tensor generation:  0.023537874221801758
mini_batch_src_global generation:  0.02344369888305664
r_  generation:  0.226576566696167
local_output_nid generation:  0.017350196838378906
local_in_edges_tensor generation:  0.022270679473876953
mini_batch_src_global generation:  0.024259567260742188
r_  generation:  0.2447800636291504
local_output_nid generation:  0.015044927597045898
local_in_edges_tensor generation:  0.016876697540283203
mini_batch_src_global generation:  0.022246599197387695
r_  generation:  0.20944666862487793
local_output_nid generation:  0.013727664947509766
local_in_edges_tensor generation:  0.01723337173461914
mini_batch_src_global generation:  0.028781414031982422
r_  generation:  0.2149496078491211
----------------------check_connections_block total spend ----------------------------- 5.859537124633789
generate_one_block  0.06081819534301758
generate_one_block  0.045648813247680664
generate_one_block  0.10383820533752441
generate_one_block  0.06947875022888184
generate_one_block  0.15881896018981934
generate_one_block  0.11274218559265137
generate_one_block  [00:00:52] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2761 nodes and 66552 edges into 2 parts and get 948 edge cuts
0.061135053634643555
generate_one_block  0.07444882392883301
generate_one_block  0.07924842834472656
generate_one_block  0.05326962471008301
generate_one_block  0.0691072940826416
generate_one_block  0.07239937782287598
generate_one_block  0.07216477394104004
generate_one_block  0.07507562637329102
generate_one_block  0.1645982265472412
generate_one_block  0.07762646675109863
generate_one_block  0.23851251602172852
generate_one_block  0.18886113166809082
generate_one_block  0.26625990867614746
generate_one_block  0.2847726345062256
generate_one_block  0.09490275382995605
generate_one_block  0.1688671112060547
generate_one_block  0.1319417953491211
generate_one_block  0.08998394012451172
generate_one_block  0.3185901641845703
generate_one_block  0.33299708366394043
generate_one_block  0.31338024139404297
generate_one_block  0.33751940727233887
generate_one_block  0.3033473491668701
generate_one_block  0.3213951587677002
generate_one_block  0.2713131904602051
generate_one_block  0.25290799140930176
global_2_local spend time (sec) 0.004388093948364258
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0009095668792724609
A = g.adjacency_matrix() spent  0.0006020069122314453
auxiliary_graph
Graph(num_nodes=15650, num_edges=69313,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.011364936828613281
remove nodes length
12889
auxiliary_graph.remove_nodes spent  0.005076169967651367
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2761, num_edges=69313,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.003247976303100586

the counter of shared neighbor distribution
Counter({1.0: 53524, 2.0: 8122, 3.0: 2480, 4.0: 1000, 5.0: 504, 6.0: 294, 7.0: 192, 8.0: 134, 9.0: 112, 10.0: 48, 11.0: 34, 12.0: 32, 13.0: 24, 14.0: 10, 15.0: 10, 19.0: 6, 17.0: 6, 18.0: 4, 25.0: 4, 20.0: 4, 22.0: 2, 16.0: 2, 23.0: 2, 21.0: 2})
66552
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.002 seconds
Metis partitioning: 0.007 seconds
Split the graph: 0.012 seconds
Construct subgraphs: 0.009 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.03015875816345215
1351
1410
total k batches seeds list generation spend  0.08150577545166016
after graph partition
graph partition algorithm spend time 0.08935189247131348
1351
1410
time for parepare:  0.034029483795166016
local_output_nid generation:  0.0004303455352783203
local_in_edges_tensor generation:  0.0059947967529296875
mini_batch_src_global generation:  0.0014688968658447266
r_  generation:  0.012554168701171875
local_output_nid generation:  0.0006718635559082031
local_in_edges_tensor generation:  0.00262451171875
mini_batch_src_global generation:  0.0009396076202392578
r_  generation:  0.008418083190917969
----------------------check_connections_block total spend ----------------------------- 0.08209657669067383
generate_one_block  0.02028489112854004
generate_one_block  0.012392044067382812
time for parepare:  0.029974937438964844
local_output_nid generation:  0.002763032913208008
local_in_edges_tensor generation:  0.013044595718383789
mini_batch_src_global generation:  0.006505727767944336
r_  generation:  0.0630803108215332
local_output_nid generation:  0.0018680095672607422
local_in_edges_tensor generation:  0.002107858657836914
mini_batch_src_global generation:  0.0035390853881835938
r_  generation:  0.02241969108581543
----------------------check_connections_block total spend ----------------------------- 0.17527556419372559
generate_one_block  0.09252786636352539
generate_one_block  0.03247833251953125
time for parepare:  0.02388620376586914
local_output_nid generation:  0.01009678840637207
local_in_edges_tensor generation:  0.02538275718688965
mini_batch_src_global generation:  0.014499187469482422
r_  generation:  0.19358158111572266
local_output_nid generation:  0.007413625717163086
local_in_edges_tensor generation:  0.006846189498901367
mini_batch_src_global generation:  0.009481430053710938
r_  generation:  0.07954001426696777
----------------------check_connections_block total spend ----------------------------- 0.43187379837036133
generate_one_block  0.251431941986084
generate_one_block  0.10260605812072754
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04186677932739258  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

connection checking time:  8.837247848510742
block generation total time  8.043604850769043
average batch blocks generation time:  0.2513626515865326
block dataloader generation time/epoch 47.55902898311615
pseudo mini batch 0 input nodes size: 32059
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0392608642578125  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0392608642578125  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.054547786712646484  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05456972122192383  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03642082214355469  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03734874725341797  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03734874725341797  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 32059
first layer output nodes number: 12405
edges number: 76566
input nodes number: 12405
output nodes number: 5297
edges number: 32531
input nodes number: 5297
output nodes number: 2896
edges number: 15156
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.3954620361328125  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.395462989807129  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.039531707763671875  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 1 input nodes size: 27729
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.036650657653808594  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.036650657653808594  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04987287521362305  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04989480972290039  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03458595275878906  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.035533905029296875  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.035533905029296875  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 27729
first layer output nodes number: 11614
edges number: 71395
input nodes number: 11614
output nodes number: 5710
edges number: 37248
input nodes number: 5710
output nodes number: 2911
edges number: 18554
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.4688091278076172  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.4688096046447754  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03752899169921875  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 2 input nodes size: 57864
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03458833694458008  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03458833694458008  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0621800422668457  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06220197677612305  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04895782470703125  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.050994873046875  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.050994873046875  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 57864
first layer output nodes number: 22825
edges number: 169074
input nodes number: 22825
output nodes number: 7763
edges number: 76726
input nodes number: 7763
output nodes number: 2908
edges number: 27478
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.9572696685791016  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.9572701454162598  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05495882034301758  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 3 input nodes size: 42226
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04895734786987305  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04895734786987305  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0690922737121582  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06911420822143555  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04150056838989258  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04270219802856445  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04270219802856445  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 42226
first layer output nodes number: 16373
edges number: 106020
input nodes number: 16373
output nodes number: 6053
edges number: 39591
input nodes number: 6053
output nodes number: 2884
edges number: 15486
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.74891996383667  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.7489204406738281  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04516172409057617  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 4 input nodes size: 76997
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.041497230529785156  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.041497230529785156  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07821226119995117  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07823419570922852  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.058077335357666016  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06104707717895508  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06104707717895508  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 76997
first layer output nodes number: 33158
edges number: 259297
input nodes number: 33158
output nodes number: 9509
edges number: 109188
input nodes number: 9509
output nodes number: 2908
edges number: 29889
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 4.177671432495117  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 4.177671909332275  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06662130355834961  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 5 input nodes size: 58802
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05808067321777344  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05808067321777344  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0861196517944336  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08614158630371094  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04940462112426758  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.051465511322021484  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.051465511322021484  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 58802
first layer output nodes number: 22975
edges number: 176695
input nodes number: 22975
output nodes number: 7026
edges number: 73608
input nodes number: 7026
output nodes number: 2881
edges number: 26051
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.9573817253112793  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.9573822021484375  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05540895462036133  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 6 input nodes size: 36400
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04940080642700195  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04940080642700195  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0667576789855957  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06677961349487305  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03871870040893555  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03995084762573242  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03995084762573242  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 36400
first layer output nodes number: 14946
edges number: 99973
input nodes number: 14946
output nodes number: 6026
edges number: 45413
input nodes number: 6026
output nodes number: 2904
edges number: 19717
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.835197925567627  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.8351984024047852  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04244804382324219  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 7 input nodes size: 43140
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03872203826904297  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03872203826904297  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06020641326904297  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06022834777832031  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04284954071044922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.044411659240722656  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.044411659240722656  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 43140
first layer output nodes number: 17899
edges number: 124113
input nodes number: 17899
output nodes number: 6994
edges number: 61411
input nodes number: 6994
output nodes number: 2903
edges number: 23964
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.322065830230713  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.322066307067871  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04752349853515625  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 8 input nodes size: 29560
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04284954071044922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04284954071044922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.056944847106933594  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05696582794189453  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03545951843261719  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03661155700683594  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03661155700683594  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 29560
first layer output nodes number: 11897
edges number: 83654
input nodes number: 11897
output nodes number: 5292
edges number: 46195
input nodes number: 5292
output nodes number: 2798
edges number: 24649
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.7736210823059082  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.7736215591430664  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03891324996948242  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 9 input nodes size: 35196
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.035443782806396484  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.035443782806396484  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05222654342651367  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.052248477935791016  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0381321907043457  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 35196
first layer output nodes number: 12725
edges number: 84736
input nodes number: 12725
output nodes number: 5257
edges number: 38289
input nodes number: 5257
output nodes number: 2892
edges number: 20445
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.6157054901123047  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 1.615705966949463  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04142427444458008  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 10 input nodes size: 31147
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.038146018981933594  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.038146018981933594  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05299806594848633  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05302000045776367  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03621530532836914  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03781938552856445  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03781938552856445  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 31147
first layer output nodes number: 16050
edges number: 119939
input nodes number: 16050
output nodes number: 6279
edges number: 66429
input nodes number: 6279
output nodes number: 2893
edges number: 28745
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.4295597076416016  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.4295601844787598  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.040900230407714844  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 11 input nodes size: 40621
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.036215782165527344  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.036215782165527344  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.055747032165527344  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.055768489837646484  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.040894508361816406  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04248237609863281  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04248237609863281  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 40621
first layer output nodes number: 16846
edges number: 125266
input nodes number: 16846
output nodes number: 6268
edges number: 61443
input nodes number: 6268
output nodes number: 2864
edges number: 26139
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.3557372093200684  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.3557376861572266  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.045572757720947266  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 12 input nodes size: 32662
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.040889739990234375  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.040889739990234375  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.056464195251464844  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.056485652923583984  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.036932945251464844  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03859710693359375  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03859710693359375  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 32662
first layer output nodes number: 16853
edges number: 121795
input nodes number: 16853
output nodes number: 6944
edges number: 72362
input nodes number: 6944
output nodes number: 2837
edges number: 28954
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.5471878051757812  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.5471882820129395  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0418238639831543  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 13 input nodes size: 39034
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03692913055419922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03692913055419922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05646038055419922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05648231506347656  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04088640213012695  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04248189926147461  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04248189926147461  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 39034
first layer output nodes number: 18002
edges number: 125231
input nodes number: 18002
output nodes number: 7154
edges number: 65913
input nodes number: 7154
output nodes number: 2912
edges number: 22851
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.3926119804382324  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.3926124572753906  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04563760757446289  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 14 input nodes size: 80943
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.040897369384765625  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.040897369384765625  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07995986938476562  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07998085021972656  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06042766571044922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06352710723876953  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06352710723876953  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 80943
first layer output nodes number: 35951
edges number: 281456
input nodes number: 35951
output nodes number: 9781
edges number: 110403
input nodes number: 9781
output nodes number: 2765
edges number: 24047
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 4.305810928344727  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 4.305811405181885  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06939029693603516  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 15 input nodes size: 35805
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06040620803833008  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06040620803833008  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07747936248779297  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07750129699707031  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.038417816162109375  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04026603698730469  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04026603698730469  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 35805
first layer output nodes number: 18086
edges number: 133235
input nodes number: 18086
output nodes number: 7715
edges number: 84931
input nodes number: 7715
output nodes number: 2927
edges number: 29788
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.839035987854004  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.839036464691162  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04387235641479492  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 16 input nodes size: 92025
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03844165802001953  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.03844165802001953  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08232259750366211  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08234357833862305  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06524848937988281  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06950759887695312  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06950759887695312  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 92025
first layer output nodes number: 49359
edges number: 398206
input nodes number: 49359
output nodes number: 12314
edges number: 152913
input nodes number: 12314
output nodes number: 2786
edges number: 20381
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 5.789134979248047  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 5.789135456085205  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07713603973388672  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 17 input nodes size: 77360
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06522750854492188  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06522750854492188  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10211563110351562  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10213661193847656  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05823469161987305  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06303596496582031  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06303596496582031  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 77360
first layer output nodes number: 40454
edges number: 327235
input nodes number: 40454
output nodes number: 12678
edges number: 162714
input nodes number: 12678
output nodes number: 2768
edges number: 26095
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 5.4624481201171875  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 5.462448596954346  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07008600234985352  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 18 input nodes size: 91129
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05823183059692383  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05823183059692383  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.1016855239868164  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10170650482177734  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06479740142822266  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07127094268798828  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07127094268798828  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 91129
first layer output nodes number: 56551
edges number: 474666
input nodes number: 56551
output nodes number: 19162
edges number: 306815
input nodes number: 19162
output nodes number: 2758
edges number: 43641
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 8.974701404571533  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 8.974701881408691  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08419942855834961  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 19 input nodes size: 56067
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06479597091674805  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06479597091674805  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.09153079986572266  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.091552734375  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.048078060150146484  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04991865158081055  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04991865158081055  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 56067
first layer output nodes number: 22634
edges number: 158113
input nodes number: 22634
output nodes number: 8145
edges number: 67562
input nodes number: 8145
output nodes number: 2926
edges number: 21205
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.6621108055114746  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.662111282348633  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05358695983886719  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 20 input nodes size: 84437
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04810333251953125  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04810333251953125  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08836603164672852  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08838701248168945  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0616302490234375  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06471061706542969  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06471061706542969  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 84437
first layer output nodes number: 37217
edges number: 292791
input nodes number: 37217
output nodes number: 9389
edges number: 101280
input nodes number: 9389
output nodes number: 2775
edges number: 19183
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 4.183741092681885  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 4.183741569519043  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07066631317138672  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 21 input nodes size: 70870
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06160783767700195  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06160783767700195  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.09540128707885742  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.09542322158813477  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05513954162597656  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05757427215576172  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05757427215576172  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 70870
first layer output nodes number: 29442
edges number: 220390
input nodes number: 29442
output nodes number: 8879
edges number: 85326
input nodes number: 8879
output nodes number: 2886
edges number: 20922
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 3.408993721008301  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 3.408994197845459  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.062238216400146484  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 22 input nodes size: 58589
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05515575408935547  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05515575408935547  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08309316635131836  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0831151008605957  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.04929971694946289  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05089521408081055  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05089521408081055  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 58589
first layer output nodes number: 20273
edges number: 147334
input nodes number: 20273
output nodes number: 6306
edges number: 48902
input nodes number: 6306
output nodes number: 2891
edges number: 17658
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.239323139190674  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.239323616027832  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05405426025390625  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 23 input nodes size: 102940
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0493006706237793  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0493006706237793  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.09838628768920898  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.09840726852416992  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07044792175292969  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07786273956298828  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07786273956298828  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 102940
first layer output nodes number: 67579
edges number: 561840
input nodes number: 67579
output nodes number: 22669
edges number: 368877
input nodes number: 22669
output nodes number: 2799
edges number: 39996
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 10.5599684715271  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 10.559968948364258  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.09285354614257812  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 24 input nodes size: 102691
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0704340934753418  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0704340934753418  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.1194009780883789  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11942195892333984  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07031536102294922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07750320434570312  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07750320434570312  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 102691
first layer output nodes number: 67050
edges number: 561362
input nodes number: 67050
output nodes number: 22124
edges number: 363559
input nodes number: 22124
output nodes number: 2758
edges number: 39564
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 10.448565006256104  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 10.448565483093262  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0918722152709961  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 25 input nodes size: 101972
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07030916213989258  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07030916213989258  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11893320083618164  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11895418167114258  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06996631622314453  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.076446533203125  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.076446533203125  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 101972
first layer output nodes number: 61733
edges number: 513000
input nodes number: 61733
output nodes number: 18462
edges number: 285097
input nodes number: 18462
output nodes number: 2786
edges number: 32810
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 8.803577899932861  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 8.80357837677002  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08809232711791992  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 26 input nodes size: 109064
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06997060775756836  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06997060775756836  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.12197637557983398  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.12199735641479492  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07335233688354492  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07981538772583008  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07981538772583008  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 109064
first layer output nodes number: 67730
edges number: 562852
input nodes number: 67730
output nodes number: 18205
edges number: 275908
input nodes number: 18205
output nodes number: 2790
edges number: 28470
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.0116605758667  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.011661052703857  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.09144163131713867  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 27 input nodes size: 100046
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07335281372070312  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07335281372070312  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.12105846405029297  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.1210794448852539  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06905269622802734  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0755777359008789  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0755777359008789  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 100046
first layer output nodes number: 63183
edges number: 525658
input nodes number: 63183
output nodes number: 19882
edges number: 315615
input nodes number: 19882
output nodes number: 2758
edges number: 34370
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.36964464187622  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.369645118713379  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08745336532592773  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 28 input nodes size: 101702
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06904792785644531  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06904792785644531  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11754322052001953  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11756420135498047  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06983757019042969  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07741546630859375  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07741546630859375  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 101702
first layer output nodes number: 68095
edges number: 569279
input nodes number: 68095
output nodes number: 23965
edges number: 405698
input nodes number: 23965
output nodes number: 2759
edges number: 41878
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 11.148975372314453  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 11.148975849151611  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.09356832504272461  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 29 input nodes size: 90268
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06983804702758789  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06983804702758789  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11288118362426758  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.11290216445922852  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06438589096069336  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07106304168701172  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07106304168701172  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 90268
first layer output nodes number: 57889
edges number: 492412
input nodes number: 57889
output nodes number: 20704
edges number: 352605
input nodes number: 20704
output nodes number: 2759
edges number: 45108
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.821846961975098  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.821847438812256  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08545207977294922  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 30 input nodes size: 82514
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06438589096069336  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06438589096069336  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10373163223266602  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10375356674194336  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.060689449310302734  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06803560256958008  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06803560256958008  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 82514
first layer output nodes number: 53401
edges number: 457076
input nodes number: 53401
output nodes number: 21030
edges number: 370635
input nodes number: 21030
output nodes number: 2898
edges number: 52102
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.866352558135986  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 9.866353034973145  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.08057928085327148  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 31 input nodes size: 95680
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06070995330810547  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06070995330810547  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10633373260498047  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.10634422302246094  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06697654724121094  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07140064239501953  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07140064239501953  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 95680
first layer output nodes number: 50085
edges number: 420116
input nodes number: 50085
output nodes number: 10604
edges number: 158727
input nodes number: 10604
output nodes number: 1351
edges number: 14649
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 5.937472820281982  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 5.937473297119141  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.07982301712036133  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

pseudo mini batch 32 input nodes size: 58678
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06674623489379883  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.06674623489379883  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.0947260856628418  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.09473705291748047  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.049102783203125  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05078315734863281  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05078315734863281  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

first layer input nodes number: 58678
first layer output nodes number: 21090
edges number: 162579
input nodes number: 21090
output nodes number: 5397
edges number: 52896
input nodes number: 5397
output nodes number: 1410
edges number: 9811
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.308417320251465  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 2.308417797088623  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05398845672607422  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05398845672607422  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes
Using backend: pytorch

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.7451171875 GB
    Memory Allocated: 0.05398845672607422  GigaBytes
Max Memory Allocated: 11.309683322906494  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055563493208451706 |0.006839101964777166 |0.3289195190776478 |0.00012930956753817472 |0.4281460227388324 |0.010666847229003906 |
----------------------------------------------------------pseudo_mini_loss sum 4.277942180633545
Total (block generation + training)time/epoch 74.79162180423737
Training time/epoch 27.26756525039673
Training time without block to device /epoch 27.041874885559082
Training time without total dataloading part /epoch 24.99809694290161
load block tensor time/epoch 1.8335952758789062
block to device time/epoch 0.22569036483764648
input features size transfer per epoch 4.425644874572754e-06
blocks size to device per epoch 2.950429916381836e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3677570
Number of first layer input nodes during this epoch:  2176217
Number of first layer output nodes during this epoch:  1132370
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  1402880
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.2.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.2.lstm.bias_ih_l0, torch.Size([1024])
layers.2.lstm.bias_hh_l0, torch.Size([1024])
layers.2.fc_self.weight, torch.Size([40, 256])
layers.2.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
bns.1.weight, torch.Size([256])
bns.1.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
