[23:56:06] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37292890 edges into 16 parts and get 9158262 edge cuts
main start at this time 1652226934.8121138
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.034511566162109375
global_2_local spend time (sec) 0.07239079475402832
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0076444149017333984
A = g.adjacency_matrix() spent  0.009711742401123047
auxiliary_graph
Graph(num_nodes=158265, num_edges=37383831,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.14568018913269043
remove nodes length
67324
auxiliary_graph.remove_nodes spent  2.0708632469177246
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37383831,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.8183751106262207

the counter of shared neighbor distribution
Counter({1.0: 28475226, 2.0: 5923800, 3.0: 1746856, 4.0: 610464, 5.0: 250590, 6.0: 118902, 7.0: 62202, 8.0: 35984, 9.0: 21766, 10.0: 14382, 11.0: 9346, 12.0: 6378, 13.0: 4572, 14.0: 3354, 15.0: 2406, 16.0: 1744, 17.0: 1196, 18.0: 914, 19.0: 674, 20.0: 572, 21.0: 382, 22.0: 354, 23.0: 214, 24.0: 166, 25.0: 128, 26.0: 100, 27.0: 52, 28.0: 40, 30.0: 38, 29.0: 30, 31.0: 14, 32.0: 12, 33.0: 8, 40.0: 4, 39.0: 4, 35.0: 4, 34.0: 4, 38.0: 4, 37.0: 2, 49.0: 2})
37292890
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37292887, 37292888, 37292889])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28475226, 2.0: 5923800, 3.0: 1746856, 4.0: 610464, 5.0: 250590, 6.0: 118902, 7.0: 62202, 8.0: 35984, 9.0: 21766, 10.0: 14382, 11.0: 9346, 12.0: 6378, 13.0: 4572, 14.0: 3354, 15.0: 2406, 16.0: 1744, 17.0: 1196, 18.0: 914, 19.0: 674, 20.0: 572, 21.0: 382, 22.0: 354, 23.0: 214, 24.0: 166, 25.0: 128, 26.0: 100, 27.0: 52, 28.0: 40, 30.0: 38, 29.0: 30, 31.0: 14, 32.0: 12, 33.0: 8, 40.0: 4, 39.0: 4, 35.0: 4, 34.0: 4, 38.0: 4, 37.0: 2, 49.0: 2})
Convert a graph into a bidirected graph: 2.618 seconds
Metis partitioning: 7.956 seconds
Split the graph: 2.239 seconds
Construct subgraphs: 0.250 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  13.083120822906494
5517
5743
5722
5854
5854
5854
5854
5854
5517
5517
5517
5852
5735
5517
5517
5517
total k batches seeds list generation spend  30.51059627532959
after graph partition
graph partition algorithm spend time 30.63650417327881
5517
5743
5722
5854
5854
5854
5854
5854
5517
5517
5517
5852
5735
5517
5517
5517
partition_len_list
[10646, 11235, 11573, 12844, 10531, 14448, 14104, 14318, 34099, 27689, 30574, 33187, 11382, 13575, 19305, 28550]
shared_neighbor_graph_partition_s0 selection method  spend 30.76767349243164
time for parepare:  0.018953800201416016
local_output_nid generation:  0.0009238719940185547
local_in_edges_tensor generation:  0.0013463497161865234
mini_batch_src_global generation:  0.006232261657714844
r_  generation:  0.019968271255493164
local_output_nid generation:  0.0013015270233154297
local_in_edges_tensor generation:  0.0011696815490722656
mini_batch_src_global generation:  0.0029418468475341797
r_  generation:  0.020145654678344727
local_output_nid generation:  0.0012202262878417969
local_in_edges_tensor generation:  0.001123666763305664
mini_batch_src_global generation:  0.0025670528411865234
r_  generation:  0.01891946792602539
local_output_nid generation:  0.0012066364288330078
local_in_edges_tensor generation:  0.0011932849884033203
mini_batch_src_global generation:  0.003041505813598633
r_  generation:  0.02367091178894043
local_output_nid generation:  0.0015060901641845703
local_in_edges_tensor generation:  0.0011568069458007812
mini_batch_src_global generation:  0.002282857894897461
r_  generation:  0.016805171966552734
local_output_nid generation:  0.0012977123260498047
local_in_edges_tensor generation:  0.0011587142944335938
mini_batch_src_global generation:  0.0025882720947265625
r_  generation:  0.020816564559936523
local_output_nid generation:  0.0012428760528564453
local_in_edges_tensor generation:  0.0011720657348632812
mini_batch_src_global generation:  0.0027828216552734375
r_  generation:  0.02212071418762207
local_output_nid generation:  0.0012409687042236328
local_in_edges_tensor generation:  0.0011532306671142578
mini_batch_src_global generation:  0.0025620460510253906
r_  generation:  0.02027106285095215
local_output_nid generation:  0.0011692047119140625
local_in_edges_tensor generation:  0.0018610954284667969
mini_batch_src_global generation:  0.003828287124633789
r_  generation:  0.031719207763671875
local_output_nid generation:  0.0013682842254638672
local_in_edges_tensor generation:  0.001556396484375
mini_batch_src_global generation:  0.002196788787841797
r_  generation:  0.02156519889831543
local_output_nid generation:  0.0014140605926513672
local_in_edges_tensor generation:  0.0013015270233154297
mini_batch_src_global generation:  0.0027418136596679688
r_  generation:  0.03357958793640137
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.002134084701538086
mini_batch_src_global generation:  0.007010459899902344
r_  generation:  0.0395052433013916
local_output_nid generation:  0.001707315444946289
local_in_edges_tensor generation:  0.0011816024780273438
mini_batch_src_global generation:  0.0018343925476074219
r_  generation:  0.014182567596435547
local_output_nid generation:  0.001413583755493164
local_in_edges_tensor generation:  0.0011327266693115234
mini_batch_src_global generation:  0.0019004344940185547
r_  generation:  0.016451358795166016
local_output_nid generation:  0.0012969970703125
local_in_edges_tensor generation:  0.001112222671508789
mini_batch_src_global generation:  0.0022847652435302734
r_  generation:  0.019436359405517578
local_output_nid generation:  0.0013728141784667969
local_in_edges_tensor generation:  0.0013344287872314453
mini_batch_src_global generation:  0.003096342086791992
r_  generation:  0.02722311019897461
----------------------check_connections_block total spend ----------------------------- 0.5577907562255859
generate_one_block  0.03177356719970703
generate_one_block  0.026820898056030273
generate_one_block  0.024720191955566406
generate_one_block  0.030684232711791992
generate_one_block  0.0248105525970459
generate_one_block  0.02802276611328125
generate_one_block  0.02937173843383789
generate_one_block  0.026062726974487305
generate_one_block  0.04793548583984375
generate_one_block  0.029143095016479492
generate_one_block  0.046921491622924805
generate_one_block  0.05529975891113281
generate_one_block  0.018870115280151367
generate_one_block  0.020043373107910156
generate_one_block  0.026507139205932617
generate_one_block  0.03738069534301758
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05130648612976074
gen group dst list time:  0.010046005249023438
time for parepare:  0.025183916091918945
local_output_nid generation:  0.0017685890197753906
local_in_edges_tensor generation:  0.012225151062011719
mini_batch_src_global generation:  0.004752635955810547
r_  generation:  0.04102969169616699
local_output_nid generation:  0.0031549930572509766
local_in_edges_tensor generation:  0.0027005672454833984
mini_batch_src_global generation:  0.005150794982910156
r_  generation:  0.04124760627746582
local_output_nid generation:  0.0031499862670898438
local_in_edges_tensor generation:  0.0025396347045898438
mini_batch_src_global generation:  0.004541873931884766
r_  generation:  0.03990578651428223
local_output_nid generation:  0.0035097599029541016
local_in_edges_tensor generation:  0.003015756607055664
mini_batch_src_global generation:  0.008177042007446289
r_  generation:  0.050342559814453125
local_output_nid generation:  0.0029327869415283203
local_in_edges_tensor generation:  0.0023794174194335938
mini_batch_src_global generation:  0.0037581920623779297
r_  generation:  0.030358076095581055
local_output_nid generation:  0.003840208053588867
local_in_edges_tensor generation:  0.0034797191619873047
mini_batch_src_global generation:  0.010580301284790039
r_  generation:  0.05571746826171875
local_output_nid generation:  0.005005836486816406
local_in_edges_tensor generation:  0.00856328010559082
mini_batch_src_global generation:  0.012009143829345703
r_  generation:  0.0581357479095459
local_output_nid generation:  0.003899812698364258
local_in_edges_tensor generation:  0.004358053207397461
mini_batch_src_global generation:  0.009089231491088867
r_  generation:  0.05184578895568848
local_output_nid generation:  0.007930517196655273
local_in_edges_tensor generation:  0.020017623901367188
mini_batch_src_global generation:  0.019628286361694336
r_  generation:  0.19606518745422363
local_output_nid generation:  0.007059574127197266
local_in_edges_tensor generation:  0.011954545974731445
mini_batch_src_global generation:  0.01726984977722168
r_  generation:  0.1458885669708252
local_output_nid generation:  0.007264852523803711
local_in_edges_tensor generation:  0.011559009552001953
mini_batch_src_global generation:  0.02052903175354004
r_  generation:  0.1934950351715088
local_output_nid generation:  0.010254144668579102
local_in_edges_tensor generation:  0.012290477752685547
mini_batch_src_global generation:  0.0240781307220459
r_  generation:  0.20316576957702637
local_output_nid generation:  0.0032720565795898438
local_in_edges_tensor generation:  0.002564668655395508
mini_batch_src_global generation:  0.008193731307983398
r_  generation:  0.0377497673034668
local_output_nid generation:  0.0037527084350585938
local_in_edges_tensor generation:  0.0032596588134765625
mini_batch_src_global generation:  0.009073734283447266
r_  generation:  0.049516916275024414
local_output_nid generation:  0.004798173904418945
local_in_edges_tensor generation:  0.004903316497802734
mini_batch_src_global generation:  0.01494145393371582
r_  generation:  0.0933523178100586
local_output_nid generation:  0.008316516876220703
local_in_edges_tensor generation:  0.008100748062133789
mini_batch_src_global generation:  0.0208432674407959
r_  generation:  0.1565845012664795
----------------------check_connections_block total spend ----------------------------- 2.145526170730591
generate_one_block  0.06963181495666504
generate_one_block  0.06616425514221191
generate_one_block  0.058655500411987305
generate_one_block  0.06476998329162598
generate_one_block  0.038011789321899414
generate_one_block  0.0706486701965332
generate_one_block  0.08376598358154297
generate_one_block  0.06602263450622559
generate_one_block  0.26535749435424805
generate_one_block  0.197127103805542
generate_one_block  0.2483654022216797
generate_one_block  0.27263307571411133
generate_one_block  0.04901623725891113
generate_one_block  0.05989336967468262
generate_one_block  0.11806654930114746
generate_one_block  0.20608973503112793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03239774703979492
gen group dst list time:  0.025287628173828125
time for parepare:  0.020004749298095703
local_output_nid generation:  0.0037679672241210938
local_in_edges_tensor generation:  0.012339591979980469
mini_batch_src_global generation:  0.00650787353515625
r_  generation:  0.06493830680847168
local_output_nid generation:  0.00701904296875
local_in_edges_tensor generation:  0.016736745834350586
mini_batch_src_global generation:  0.00792551040649414
r_  generation:  0.08236193656921387
local_output_nid generation:  0.007043361663818359
local_in_edges_tensor generation:  0.007111310958862305
mini_batch_src_global generation:  0.014499664306640625
r_  generation:  0.07625627517700195
local_output_nid generation:  0.006865024566650391
local_in_edges_tensor generation:  0.008266448974609375
mini_batch_src_global generation:  0.007344245910644531
r_  generation:  0.07512521743774414
local_output_nid generation:  0.005698204040527344
local_in_edges_tensor generation:  0.005234956741333008
mini_batch_src_global generation:  0.0055789947509765625
r_  generation:  0.054648399353027344
local_output_nid generation:  0.009238243103027344
local_in_edges_tensor generation:  0.01000833511352539
mini_batch_src_global generation:  0.010832071304321289
r_  generation:  0.12096357345581055
local_output_nid generation:  0.010045528411865234
local_in_edges_tensor generation:  0.012535572052001953
mini_batch_src_global generation:  0.013351678848266602
r_  generation:  0.1389636993408203
local_output_nid generation:  0.008815765380859375
local_in_edges_tensor generation:  0.009530305862426758
mini_batch_src_global generation:  0.011675596237182617
r_  generation:  0.1088399887084961
local_output_nid generation:  0.015498161315917969
local_in_edges_tensor generation:  0.022849082946777344
mini_batch_src_global generation:  0.02433180809020996
r_  generation:  0.26024556159973145
local_output_nid generation:  0.019507408142089844
local_in_edges_tensor generation:  0.02681899070739746
mini_batch_src_global generation:  0.027422666549682617
r_  generation:  0.29023051261901855
local_output_nid generation:  0.01424098014831543
local_in_edges_tensor generation:  0.017664432525634766
mini_batch_src_global generation:  0.023771047592163086
r_  generation:  0.23558759689331055
local_output_nid generation:  0.014904022216796875
local_in_edges_tensor generation:  0.017581701278686523
mini_batch_src_global generation:  0.024662017822265625
r_  generation:  0.23816919326782227
local_output_nid generation:  0.007802724838256836
local_in_edges_tensor generation:  0.007850885391235352
mini_batch_src_global generation:  0.01219034194946289
r_  generation:  0.09578585624694824
local_output_nid generation:  0.009072065353393555
local_in_edges_tensor generation:  0.009609222412109375
mini_batch_src_global generation:  0.011104106903076172
r_  generation:  0.1098184585571289
local_output_nid generation:  0.012294769287109375
local_in_edges_tensor generation:  0.014312982559204102
mini_batch_src_global generation:  0.016697168350219727
r_  generation:  0.18424510955810547
local_output_nid generation:  0.01630687713623047
local_in_edges_tensor generation:  0.02231621742248535
mini_batch_src_global generation:  0.0239412784576416
r_  generation:  0.25162553787231445
----------------------check_connections_block total spend ----------------------------- 3.5013604164123535
generate_one_block  0.08717179298400879
generate_one_block  0.1049196720123291
generate_one_block  0.09337806701660156
generate_one_block  0.09561014175415039
generate_one_block  0.06841182708740234
generate_one_block  0.14770722389221191
generate_one_block  0.16962409019470215
generate_one_block  0.13586664199829102
generate_one_block  0.322101354598999
generate_one_block  0.3624763488769531
generate_one_block  0.29053616523742676
generate_one_block  0.29205775260925293
generate_one_block  0.11544322967529297
generate_one_block  0.13817429542541504
generate_one_block  0.21895074844360352
generate_one_block  0.31905364990234375
global_2_local spend time (sec) 0.006285429000854492
----------------------------  graph partition start---------------------[23:56:21] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5517 nodes and 215218 edges into 2 parts and get 4561 edge cuts

g = dgl.graph((u,v))  spent  0.0011284351348876953
A = g.adjacency_matrix() spent  0.0008904933929443359
auxiliary_graph
Graph(num_nodes=27689, num_edges=220735,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.01828145980834961
remove nodes length
22172
auxiliary_graph.remove_nodes spent  0.008240461349487305
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5517, num_edges=220735,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.005850315093994141

the counter of shared neighbor distribution
Counter({1.0: 183512, 2.0: 19968, 3.0: 5566, 4.0: 2422, 5.0: 1242, 6.0: 702, 7.0: 454, 8.0: 356, 9.0: 262, 10.0: 162, 11.0: 122, 12.0: 108, 13.0: 96, 15.0: 72, 14.0: 64, 16.0: 32, 17.0: 26, 19.0: 16, 18.0: 16, 20.0: 8, 22.0: 6, 28.0: 2, 21.0: 2, 24.0: 2})
215218
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.007 seconds
Metis partitioning: 0.019 seconds
Split the graph: 0.017 seconds
Construct subgraphs: 0.011 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.05373382568359375
2766
2751
total k batches seeds list generation spend  0.1541292667388916
after graph partition
graph partition algorithm spend time 0.16083049774169922
2766
2751
time for parepare:  0.019648313522338867
local_output_nid generation:  0.0004665851593017578
local_in_edges_tensor generation:  0.0034182071685791016
mini_batch_src_global generation:  0.0010428428649902344
r_  generation:  0.007117271423339844
local_output_nid generation:  0.0004715919494628906
local_in_edges_tensor generation:  0.0012905597686767578
mini_batch_src_global generation:  0.001554727554321289
r_  generation:  0.010928630828857422
----------------------check_connections_block total spend ----------------------------- 0.055554866790771484
generate_one_block  0.011848926544189453
generate_one_block  0.017958879470825195
time for parepare:  0.02069854736328125
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.008512496948242188
mini_batch_src_global generation:  0.004362821578979492
r_  generation:  0.040468692779541016
local_output_nid generation:  0.005151510238647461
local_in_edges_tensor generation:  0.006973981857299805
mini_batch_src_global generation:  0.01240682601928711
r_  generation:  0.11201310157775879
----------------------check_connections_block total spend ----------------------------- 0.253582239151001
generate_one_block  0.055193185806274414
generate_one_block  0.15689921379089355
time for parepare:  0.020098447799682617
local_output_nid generation:  0.00585627555847168
local_in_edges_tensor generation:  0.010080575942993164
mini_batch_src_global generation:  0.010457038879394531
r_  generation:  0.11263179779052734
local_output_nid generation:  0.01743292808532715
local_in_edges_tensor generation:  0.023043155670166016
mini_batch_src_global generation:  0.02245950698852539
r_  generation:  0.2460005283355713
----------------------check_connections_block total spend ----------------------------- 0.5516173839569092
generate_one_block  0.15741419792175293
generate_one_block  0.31291866302490234
----------===============-------------===============-------------the number of batches *****---- 17

original number of batches:  16
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  5.646886587142944
block generation total time  4.895702600479126
average batch blocks generation time:  0.3059814125299454
pseudo mini batch 0 input nodes size: 41407
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8251953125 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8466796875 GB
    Memory Allocated: 0.024975299835205078  GigaBytes
Max Memory Allocated: 0.024975299835205078  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8466796875 GB
    Memory Allocated: 0.02501678466796875  GigaBytes
Max Memory Allocated: 0.02501678466796875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8466796875 GB
    Memory Allocated: 0.02501678466796875  GigaBytes
Max Memory Allocated: 0.02501678466796875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8974609375 GB
    Memory Allocated: 0.027322769165039062  GigaBytes
Max Memory Allocated: 0.027322769165039062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8974609375 GB
    Memory Allocated: 0.027322769165039062  GigaBytes
Max Memory Allocated: 0.027322769165039062  GigaBytes

first layer input nodes number: 41407
first layer output nodes number: 22311
edges number: 157202
input nodes number: 22311
output nodes number: 10646
edges number: 102754
input nodes number: 10646
output nodes number: 5517
edges number: 49291
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5927734375 GB
    Memory Allocated: 3.5865650177001953  GigaBytes
Max Memory Allocated: 3.642526626586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5927734375 GB
    Memory Allocated: 3.5865659713745117  GigaBytes
Max Memory Allocated: 3.642526626586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8896484375 GB
    Memory Allocated: 0.03792238235473633  GigaBytes
Max Memory Allocated: 3.642526626586914  GigaBytes

pseudo mini batch 1 input nodes size: 58963
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8896484375 GB
    Memory Allocated: 0.031066417694091797  GigaBytes
Max Memory Allocated: 3.642526626586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8896484375 GB
    Memory Allocated: 0.031066417694091797  GigaBytes
Max Memory Allocated: 3.642526626586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8896484375 GB
    Memory Allocated: 0.059182167053222656  GigaBytes
Max Memory Allocated: 3.642526626586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8896484375 GB
    Memory Allocated: 0.05922508239746094  GigaBytes
Max Memory Allocated: 3.642526626586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8896484375 GB
    Memory Allocated: 0.03943920135498047  GigaBytes
Max Memory Allocated: 3.642526626586914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8896484375 GB
    Memory Allocated: 0.041996002197265625  GigaBytes
Max Memory Allocated: 3.642526626586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8896484375 GB
    Memory Allocated: 0.041996002197265625  GigaBytes
Max Memory Allocated: 3.642526626586914  GigaBytes

first layer input nodes number: 58963
first layer output nodes number: 26813
edges number: 192640
input nodes number: 26813
output nodes number: 11235
edges number: 101125
input nodes number: 11235
output nodes number: 5743
edges number: 49280
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3955078125 GB
    Memory Allocated: 3.8462166786193848  GigaBytes
Max Memory Allocated: 3.9033570289611816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.3955078125 GB
    Memory Allocated: 3.846217155456543  GigaBytes
Max Memory Allocated: 3.9033570289611816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.047063350677490234  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

pseudo mini batch 2 input nodes size: 57112
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.03947257995605469  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.03947257995605469  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.06670570373535156  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.06674861907958984  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.0385899543762207  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.04091024398803711  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.04091024398803711  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

first layer input nodes number: 57112
first layer output nodes number: 25946
edges number: 171920
input nodes number: 25946
output nodes number: 11573
edges number: 93470
input nodes number: 11573
output nodes number: 5722
edges number: 45738
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 3.5399770736694336  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 3.539977550506592  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.04559659957885742  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

pseudo mini batch 3 input nodes size: 49326
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.038587093353271484  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.038587093353271484  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.06210756301879883  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.062151432037353516  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.03487539291381836  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.03755903244018555  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6396484375 GB
    Memory Allocated: 0.03755903244018555  GigaBytes
Max Memory Allocated: 3.9237828254699707  GigaBytes

first layer input nodes number: 49326
first layer output nodes number: 25205
edges number: 174887
input nodes number: 25205
output nodes number: 12844
edges number: 125898
input nodes number: 12844
output nodes number: 5854
edges number: 59197
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.9404296875 GB
    Memory Allocated: 4.219348907470703  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.9404296875 GB
    Memory Allocated: 4.219349384307861  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.04292726516723633  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

pseudo mini batch 4 input nodes size: 42698
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.03489494323730469  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.03489494323730469  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.05525493621826172  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.055298805236816406  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.031734466552734375  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.03346729278564453  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.03346729278564453  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

first layer input nodes number: 42698
first layer output nodes number: 20519
edges number: 124984
input nodes number: 20519
output nodes number: 10531
edges number: 69876
input nodes number: 10531
output nodes number: 5854
edges number: 37506
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 2.7011332511901855  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 2.7011337280273438  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.03708171844482422  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

pseudo mini batch 5 input nodes size: 81399
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.031734466552734375  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.031734466552734375  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.07054853439331055  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.07059240341186523  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.050188541412353516  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.053578853607177734  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1845703125 GB
    Memory Allocated: 0.053578853607177734  GigaBytes
Max Memory Allocated: 4.286144256591797  GigaBytes

first layer input nodes number: 81399
first layer output nodes number: 37712
edges number: 271126
input nodes number: 37712
output nodes number: 14448
edges number: 132945
input nodes number: 14448
output nodes number: 5854
edges number: 50751
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6689453125 GB
    Memory Allocated: 5.008392810821533  GigaBytes
Max Memory Allocated: 5.067142009735107  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6689453125 GB
    Memory Allocated: 5.008393287658691  GigaBytes
Max Memory Allocated: 5.067142009735107  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9228515625 GB
    Memory Allocated: 0.06166553497314453  GigaBytes
Max Memory Allocated: 5.068472862243652  GigaBytes

pseudo mini batch 6 input nodes size: 87778
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9228515625 GB
    Memory Allocated: 0.050188541412353516  GigaBytes
Max Memory Allocated: 5.068472862243652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9228515625 GB
    Memory Allocated: 0.050188541412353516  GigaBytes
Max Memory Allocated: 5.068472862243652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9228515625 GB
    Memory Allocated: 0.09204435348510742  GigaBytes
Max Memory Allocated: 5.068472862243652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9228515625 GB
    Memory Allocated: 0.09208822250366211  GigaBytes
Max Memory Allocated: 5.068472862243652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9228515625 GB
    Memory Allocated: 0.05323028564453125  GigaBytes
Max Memory Allocated: 5.068472862243652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9228515625 GB
    Memory Allocated: 0.05703544616699219  GigaBytes
Max Memory Allocated: 5.068472862243652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9228515625 GB
    Memory Allocated: 0.05703544616699219  GigaBytes
Max Memory Allocated: 5.068472862243652  GigaBytes

first layer input nodes number: 87778
first layer output nodes number: 41507
edges number: 313671
input nodes number: 41507
output nodes number: 14104
edges number: 142573
input nodes number: 14104
output nodes number: 5854
edges number: 54312
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0732421875 GB
    Memory Allocated: 5.5002923011779785  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0732421875 GB
    Memory Allocated: 5.500292778015137  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.06427383422851562  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

pseudo mini batch 7 input nodes size: 77287
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.05323028564453125  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.05323028564453125  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.09008359909057617  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.09012746810913086  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.048227787017822266  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.051351070404052734  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.051351070404052734  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

first layer input nodes number: 77287
first layer output nodes number: 35992
edges number: 248278
input nodes number: 35992
output nodes number: 14318
edges number: 123063
input nodes number: 14318
output nodes number: 5854
edges number: 47706
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 4.627811431884766  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 4.627811908721924  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.057515621185302734  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

pseudo mini batch 8 input nodes size: 106693
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.048227787017822266  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.048227787017822266  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.09910297393798828  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.09914445877075195  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.062247276306152344  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.07131195068359375  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3994140625 GB
    Memory Allocated: 0.07131195068359375  GigaBytes
Max Memory Allocated: 5.562440395355225  GigaBytes

first layer input nodes number: 106693
first layer output nodes number: 75434
edges number: 607335
input nodes number: 75434
output nodes number: 34099
edges number: 528204
input nodes number: 34099
output nodes number: 5517
edges number: 80992
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3916015625 GB
    Memory Allocated: 13.860419750213623  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.3916015625 GB
    Memory Allocated: 13.860420227050781  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.2041015625 GB
    Memory Allocated: 0.08957815170288086  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

pseudo mini batch 9 input nodes size: 93700
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.2041015625 GB
    Memory Allocated: 0.062197208404541016  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.2041015625 GB
    Memory Allocated: 0.062197208404541016  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.2041015625 GB
    Memory Allocated: 0.10687685012817383  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.2041015625 GB
    Memory Allocated: 0.1069183349609375  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.2041015625 GB
    Memory Allocated: 0.05600166320800781  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.2041015625 GB
    Memory Allocated: 0.06445503234863281  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2041015625 GB
    Memory Allocated: 0.06445503234863281  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

first layer input nodes number: 93700
first layer output nodes number: 64354
edges number: 531537
input nodes number: 64354
output nodes number: 30574
edges number: 492059
input nodes number: 30574
output nodes number: 5517
edges number: 85593
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0849609375 GB
    Memory Allocated: 12.771403789520264  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.0849609375 GB
    Memory Allocated: 12.771404266357422  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.0849609375 GB
    Memory Allocated: 0.08179521560668945  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

pseudo mini batch 10 input nodes size: 97793
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.0849609375 GB
    Memory Allocated: 0.05600166320800781  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.0849609375 GB
    Memory Allocated: 0.05600166320800781  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.0849609375 GB
    Memory Allocated: 0.10263299942016602  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.0849609375 GB
    Memory Allocated: 0.1026768684387207  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.0849609375 GB
    Memory Allocated: 0.05795574188232422  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.0849609375 GB
    Memory Allocated: 0.06700277328491211  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0849609375 GB
    Memory Allocated: 0.06700277328491211  GigaBytes
Max Memory Allocated: 13.95914077758789  GigaBytes

first layer input nodes number: 97793
first layer output nodes number: 68578
edges number: 560355
input nodes number: 68578
output nodes number: 33187
edges number: 537488
input nodes number: 33187
output nodes number: 5852
edges number: 101599
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7939453125 GB
    Memory Allocated: 13.930036544799805  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7939453125 GB
    Memory Allocated: 13.930037021636963  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.2666015625 GB
    Memory Allocated: 0.08490371704101562  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

pseudo mini batch 11 input nodes size: 73354
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.2666015625 GB
    Memory Allocated: 0.058005332946777344  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.2666015625 GB
    Memory Allocated: 0.058005332946777344  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.2666015625 GB
    Memory Allocated: 0.09316158294677734  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.2666015625 GB
    Memory Allocated: 0.09320449829101562  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.2666015625 GB
    Memory Allocated: 0.046529293060302734  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.2666015625 GB
    Memory Allocated: 0.048886775970458984  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2666015625 GB
    Memory Allocated: 0.048886775970458984  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

first layer input nodes number: 73354
first layer output nodes number: 30397
edges number: 206661
input nodes number: 30397
output nodes number: 11382
edges number: 78264
input nodes number: 11382
output nodes number: 5735
edges number: 31336
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4814453125 GB
    Memory Allocated: 3.3949227333068848  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.4814453125 GB
    Memory Allocated: 3.394923210144043  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.4853515625 GB
    Memory Allocated: 0.05359029769897461  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

pseudo mini batch 12 input nodes size: 80551
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.4853515625 GB
    Memory Allocated: 0.04651212692260742  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.4853515625 GB
    Memory Allocated: 0.04651212692260742  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.4853515625 GB
    Memory Allocated: 0.08492183685302734  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.4853515625 GB
    Memory Allocated: 0.08496332168579102  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.4853515625 GB
    Memory Allocated: 0.049764156341552734  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.4853515625 GB
    Memory Allocated: 0.0527501106262207  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4853515625 GB
    Memory Allocated: 0.0527501106262207  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

first layer input nodes number: 80551
first layer output nodes number: 36681
edges number: 252479
input nodes number: 36681
output nodes number: 13575
edges number: 111629
input nodes number: 13575
output nodes number: 5517
edges number: 36432
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6455078125 GB
    Memory Allocated: 4.346391201019287  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6455078125 GB
    Memory Allocated: 4.346391677856445  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6494140625 GB
    Memory Allocated: 0.05859708786010742  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

pseudo mini batch 13 input nodes size: 91930
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6494140625 GB
    Memory Allocated: 0.04973173141479492  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6494140625 GB
    Memory Allocated: 0.04973173141479492  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6494140625 GB
    Memory Allocated: 0.0935673713684082  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6494140625 GB
    Memory Allocated: 0.09360885620117188  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6494140625 GB
    Memory Allocated: 0.05515766143798828  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6494140625 GB
    Memory Allocated: 0.06027984619140625  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6494140625 GB
    Memory Allocated: 0.06027984619140625  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

first layer input nodes number: 91930
first layer output nodes number: 53034
edges number: 413821
input nodes number: 53034
output nodes number: 19305
edges number: 228389
input nodes number: 19305
output nodes number: 5517
edges number: 45067
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.7001953125 GB
    Memory Allocated: 7.433815002441406  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.7001953125 GB
    Memory Allocated: 7.4338154792785645  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.7001953125 GB
    Memory Allocated: 0.07110214233398438  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

pseudo mini batch 14 input nodes size: 113258
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.7001953125 GB
    Memory Allocated: 0.05515766143798828  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.7001953125 GB
    Memory Allocated: 0.05515766143798828  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.7001953125 GB
    Memory Allocated: 0.10916328430175781  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.7001953125 GB
    Memory Allocated: 0.10920476913452148  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.7001953125 GB
    Memory Allocated: 0.06532764434814453  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.7001953125 GB
    Memory Allocated: 0.07326126098632812  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.7001953125 GB
    Memory Allocated: 0.07326126098632812  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

first layer input nodes number: 113258
first layer output nodes number: 74533
edges number: 592990
input nodes number: 74533
output nodes number: 28550
edges number: 405297
input nodes number: 28550
output nodes number: 5517
edges number: 66390
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 11.750399112701416  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 11.750399589538574  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.08930015563964844  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

pseudo mini batch 15 input nodes size: 82931
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.06532764434814453  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.06532764434814453  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.10487222671508789  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.10489320755004883  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.050846099853515625  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.053752899169921875  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.053752899169921875  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

first layer input nodes number: 82931
first layer output nodes number: 35803
edges number: 271152
input nodes number: 35803
output nodes number: 9873
edges number: 100461
input nodes number: 9873
output nodes number: 2766
edges number: 18341
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 3.994640350341797  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 3.994640827178955  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.05975484848022461  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

[23:57:09] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37273158 edges into 16 parts and get 10351414 edge cuts
pseudo mini batch 16 input nodes size: 110765
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.05043601989746094  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.05043601989746094  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.10325288772583008  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.10327339172363281  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.06370782852172852  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.07045793533325195  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.07045793533325195  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

first layer input nodes number: 110765
first layer output nodes number: 69150
edges number: 577092
input nodes number: 69150
output nodes number: 19110
edges number: 298456
input nodes number: 19110
output nodes number: 2751
edges number: 30225
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 9.477723121643066  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 9.477723598480225  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.08351707458496094  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.09396934509277344  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.09396934509277344  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05280132854686064 |0.029054894166834214 |0.3565809726715088 |0.00013337415807387407 |0.5659848661983714 |0.012090921401977539 |
----------------------------------------------------------pseudo_mini_loss sum 5.353246212005615
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2390268
Number of first layer input nodes during this epoch:  1346945
Number of first layer output nodes during this epoch:  743969
----------------------------------------before generate dataloader block 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.09396886825561523  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030877351760864258
global_2_local spend time (sec) 0.05043363571166992
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004959821701049805
A = g.adjacency_matrix() spent  0.0118865966796875
auxiliary_graph
Graph(num_nodes=158253, num_edges=37364099,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10533404350280762
remove nodes length
67312
auxiliary_graph.remove_nodes spent  2.226987361907959
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37364099,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.6646161079406738

the counter of shared neighbor distribution
Counter({1.0: 28442724, 2.0: 5934866, 3.0: 1749448, 4.0: 608950, 5.0: 251286, 6.0: 118122, 7.0: 62400, 8.0: 36188, 9.0: 21960, 10.0: 14378, 11.0: 9394, 12.0: 6446, 13.0: 4594, 14.0: 3290, 15.0: 2434, 16.0: 1740, 17.0: 1284, 18.0: 882, 19.0: 642, 20.0: 566, 21.0: 378, 22.0: 312, 23.0: 240, 24.0: 178, 25.0: 122, 26.0: 96, 27.0: 62, 29.0: 40, 28.0: 38, 30.0: 34, 31.0: 14, 32.0: 12, 33.0: 10, 34.0: 8, 40.0: 6, 35.0: 4, 37.0: 4, 38.0: 4, 49.0: 2})
37273158
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37273155, 37273156, 37273157])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28442724, 2.0: 5934866, 3.0: 1749448, 4.0: 608950, 5.0: 251286, 6.0: 118122, 7.0: 62400, 8.0: 36188, 9.0: 21960, 10.0: 14378, 11.0: 9394, 12.0: 6446, 13.0: 4594, 14.0: 3290, 15.0: 2434, 16.0: 1740, 17.0: 1284, 18.0: 882, 19.0: 642, 20.0: 566, 21.0: 378, 22.0: 312, 23.0: 240, 24.0: 178, 25.0: 122, 26.0: 96, 27.0: 62, 29.0: 40, 28.0: 38, 30.0: 34, 31.0: 14, 32.0: 12, 33.0: 10, 34.0: 8, 40.0: 6, 35.0: 4, 37.0: 4, 38.0: 4, 49.0: 2})
Convert a graph into a bidirected graph: 2.780 seconds
Metis partitioning: 8.063 seconds
Split the graph: 1.869 seconds
Construct subgraphs: 0.129 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  12.859783411026001
5525
5517
5517
5717
5523
5584
5818
5517
5563
5850
5854
5709
5797
5849
5823
5778
total k batches seeds list generation spend  30.56908106803894
after graph partition
graph partition algorithm spend time 30.705397129058838
5525
5517
5517
5717
5523
5584
5818
5517
5563
5850
5854
5709
5797
5849
5823
5778
partition_len_list
[30707, 36286, 32105, 35202, 16514, 14746, 19221, 27432, 11296, 11181, 13143, 13347, 10702, 13972, 14843, 13351]
shared_neighbor_graph_partition_s0 selection method  spend 30.82297110557556
time for parepare:  0.020836830139160156
local_output_nid generation:  0.001149892807006836
local_in_edges_tensor generation:  0.0016429424285888672
mini_batch_src_global generation:  0.0024118423461914062
r_  generation:  0.024507522583007812
local_output_nid generation:  0.0015358924865722656
local_in_edges_tensor generation:  0.0020537376403808594
mini_batch_src_global generation:  0.0034019947052001953
r_  generation:  0.03140377998352051
local_output_nid generation:  0.0016443729400634766
local_in_edges_tensor generation:  0.0015180110931396484
mini_batch_src_global generation:  0.002752542495727539
r_  generation:  0.036069393157958984
local_output_nid generation:  0.001856088638305664
local_in_edges_tensor generation:  0.0022034645080566406
mini_batch_src_global generation:  0.003822803497314453
r_  generation:  0.04069876670837402
local_output_nid generation:  0.0017557144165039062
local_in_edges_tensor generation:  0.0012891292572021484
mini_batch_src_global generation:  0.0019903182983398438
r_  generation:  0.017685651779174805
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0012483596801757812
mini_batch_src_global generation:  0.0013000965118408203
r_  generation:  0.015868186950683594
local_output_nid generation:  0.0015292167663574219
local_in_edges_tensor generation:  0.0012700557708740234
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.019140958786010742
local_output_nid generation:  0.0013349056243896484
local_in_edges_tensor generation:  0.001314401626586914
mini_batch_src_global generation:  0.0020723342895507812
r_  generation:  0.026633024215698242
local_output_nid generation:  0.0014948844909667969
local_in_edges_tensor generation:  0.0012149810791015625
mini_batch_src_global generation:  0.0017714500427246094
r_  generation:  0.01905655860900879
local_output_nid generation:  0.0016262531280517578
local_in_edges_tensor generation:  0.0013728141784667969
mini_batch_src_global generation:  0.0017609596252441406
r_  generation:  0.021796464920043945
local_output_nid generation:  0.0014786720275878906
local_in_edges_tensor generation:  0.00140380859375
mini_batch_src_global generation:  0.0019421577453613281
r_  generation:  0.023177146911621094
local_output_nid generation:  0.0014560222625732422
local_in_edges_tensor generation:  0.0012974739074707031
mini_batch_src_global generation:  0.001703023910522461
r_  generation:  0.01850271224975586
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.0012526512145996094
mini_batch_src_global generation:  0.0013928413391113281
r_  generation:  0.01597309112548828
local_output_nid generation:  0.0014314651489257812
local_in_edges_tensor generation:  0.0013234615325927734
mini_batch_src_global generation:  0.0014996528625488281
r_  generation:  0.019234180450439453
local_output_nid generation:  0.001405954360961914
local_in_edges_tensor generation:  0.0015735626220703125
mini_batch_src_global generation:  0.001832723617553711
r_  generation:  0.023755550384521484
local_output_nid generation:  0.0015177726745605469
local_in_edges_tensor generation:  0.0013148784637451172
mini_batch_src_global generation:  0.00164031982421875
r_  generation:  0.019205570220947266
----------------------check_connections_block total spend ----------------------------- 0.5569040775299072
generate_one_block  0.048072099685668945
generate_one_block  0.048775434494018555
generate_one_block  0.04964804649353027
generate_one_block  0.06909441947937012
generate_one_block  0.025862693786621094
generate_one_block  0.022979736328125
generate_one_block  0.028889179229736328
generate_one_block  0.040318965911865234
generate_one_block  0.025359630584716797
generate_one_block  0.030447959899902344
generate_one_block  0.032930612564086914
generate_one_block  0.025885820388793945
generate_one_block  0.021607637405395508
generate_one_block  0.02723217010498047
generate_one_block  0.032674312591552734
generate_one_block  0.02634882926940918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05948185920715332
gen group dst list time:  0.010883092880249023
time for parepare:  0.026299476623535156
local_output_nid generation:  0.005865812301635742
local_in_edges_tensor generation:  0.04446220397949219
mini_batch_src_global generation:  0.030144453048706055
r_  generation:  0.1848468780517578
local_output_nid generation:  0.00961446762084961
local_in_edges_tensor generation:  0.018461942672729492
mini_batch_src_global generation:  0.02516007423400879
r_  generation:  0.22722697257995605
local_output_nid generation:  0.008992671966552734
local_in_edges_tensor generation:  0.011623859405517578
mini_batch_src_global generation:  0.021689176559448242
r_  generation:  0.20012688636779785
local_output_nid generation:  0.008713006973266602
local_in_edges_tensor generation:  0.010483741760253906
mini_batch_src_global generation:  0.02427530288696289
r_  generation:  0.22207856178283691
local_output_nid generation:  0.0047454833984375
local_in_edges_tensor generation:  0.004517316818237305
mini_batch_src_global generation:  0.010627269744873047
r_  generation:  0.07253122329711914
local_output_nid generation:  0.004033327102661133
local_in_edges_tensor generation:  0.003900289535522461
mini_batch_src_global generation:  0.012669563293457031
r_  generation:  0.058756113052368164
local_output_nid generation:  0.005228996276855469
local_in_edges_tensor generation:  0.005133390426635742
mini_batch_src_global generation:  0.008165121078491211
r_  generation:  0.08542299270629883
local_output_nid generation:  0.006720781326293945
local_in_edges_tensor generation:  0.0076715946197509766
mini_batch_src_global generation:  0.015707015991210938
r_  generation:  0.15209460258483887
local_output_nid generation:  0.003211498260498047
local_in_edges_tensor generation:  0.0027925968170166016
mini_batch_src_global generation:  0.006726980209350586
r_  generation:  0.04273366928100586
local_output_nid generation:  0.0029754638671875
local_in_edges_tensor generation:  0.0029163360595703125
mini_batch_src_global generation:  0.004121541976928711
r_  generation:  0.04361391067504883
local_output_nid generation:  0.003197193145751953
local_in_edges_tensor generation:  0.003202676773071289
mini_batch_src_global generation:  0.004700422286987305
r_  generation:  0.05160689353942871
local_output_nid generation:  0.0033538341522216797
local_in_edges_tensor generation:  0.003398895263671875
mini_batch_src_global generation:  0.004759311676025391
r_  generation:  0.05103564262390137
local_output_nid generation:  0.0029523372650146484
local_in_edges_tensor generation:  0.002613544464111328
mini_batch_src_global generation:  0.0031518936157226562
r_  generation:  0.03175497055053711
local_output_nid generation:  0.003804445266723633
local_in_edges_tensor generation:  0.0032663345336914062
mini_batch_src_global generation:  0.003727436065673828
r_  generation:  0.048597097396850586
local_output_nid generation:  0.003823995590209961
local_in_edges_tensor generation:  0.003963470458984375
mini_batch_src_global generation:  0.012172460556030273
r_  generation:  0.06517291069030762
local_output_nid generation:  0.004876136779785156
local_in_edges_tensor generation:  0.008571386337280273
mini_batch_src_global generation:  0.015850067138671875
r_  generation:  0.08306622505187988
----------------------check_connections_block total spend ----------------------------- 2.396332263946533
generate_one_block  0.26786303520202637
generate_one_block  0.40534234046936035
generate_one_block  0.27135729789733887
generate_one_block  0.3064231872558594
generate_one_block  0.10042691230773926
generate_one_block  0.07960295677185059
generate_one_block  0.1317911148071289
generate_one_block  0.21659445762634277
generate_one_block  0.05767512321472168
generate_one_block  0.06038665771484375
generate_one_block  0.07198786735534668
generate_one_block  0.0687706470489502
generate_one_block  0.041509389877319336
generate_one_block  0.06554031372070312
generate_one_block  0.0883939266204834
generate_one_block  0.06730031967163086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0385890007019043
gen group dst list time:  0.028070926666259766
time for parepare:  0.020394086837768555
local_output_nid generation:  0.01584601402282715
local_in_edges_tensor generation:  0.03614616394042969
mini_batch_src_global generation:  0.02325153350830078
r_  generation:  0.2971687316894531
local_output_nid generation:  0.02028059959411621
local_in_edges_tensor generation:  0.0251772403717041
mini_batch_src_global generation:  0.028956890106201172
r_  generation:  0.29211950302124023
local_output_nid generation:  0.019637107849121094
local_in_edges_tensor generation:  0.027243614196777344
mini_batch_src_global generation:  0.028701066970825195
r_  generation:  0.27652692794799805
local_output_nid generation:  0.016230106353759766
local_in_edges_tensor generation:  0.021987438201904297
mini_batch_src_global generation:  0.024678468704223633
r_  generation:  0.24670171737670898
local_output_nid generation:  0.015749692916870117
local_in_edges_tensor generation:  0.016500234603881836
mini_batch_src_global generation:  0.01775836944580078
r_  generation:  0.17182040214538574
local_output_nid generation:  0.012659072875976562
local_in_edges_tensor generation:  0.013345003128051758
mini_batch_src_global generation:  0.015790462493896484
r_  generation:  0.1532752513885498
local_output_nid generation:  0.013148784637451172
local_in_edges_tensor generation:  0.014068841934204102
mini_batch_src_global generation:  0.016051054000854492
r_  generation:  0.17182445526123047
local_output_nid generation:  0.017806291580200195
local_in_edges_tensor generation:  0.02455735206604004
mini_batch_src_global generation:  0.025064706802368164
r_  generation:  0.25263404846191406
local_output_nid generation: [23:57:25] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5525 nodes and 413404 edges into 2 parts and get 6560 edge cuts
Using backend: pytorch
 0.007939815521240234
local_in_edges_tensor generation:  0.008084774017333984
mini_batch_src_global generation:  0.011730432510375977
r_  generation:  0.08815956115722656
local_output_nid generation:  0.006758451461791992
local_in_edges_tensor generation:  0.006305694580078125
mini_batch_src_global generation:  0.007877349853515625
r_  generation:  0.07864642143249512
local_output_nid generation:  0.006803750991821289
local_in_edges_tensor generation:  0.006526947021484375
mini_batch_src_global generation:  0.007391929626464844
r_  generation:  0.07640385627746582
local_output_nid generation:  0.008025646209716797
local_in_edges_tensor generation:  0.007828235626220703
mini_batch_src_global generation:  0.008528470993041992
r_  generation:  0.09199762344360352
local_output_nid generation:  0.006137847900390625
local_in_edges_tensor generation:  0.005357503890991211
mini_batch_src_global generation:  0.00635981559753418
r_  generation:  0.056922197341918945
local_output_nid generation:  0.008155107498168945
local_in_edges_tensor generation:  0.007854700088500977
mini_batch_src_global generation:  0.008033990859985352
r_  generation:  0.09374451637268066
local_output_nid generation:  0.011493444442749023
local_in_edges_tensor generation:  0.012381553649902344
mini_batch_src_global generation:  0.01329803466796875
r_  generation:  0.1453382968902588
local_output_nid generation:  0.009114265441894531
local_in_edges_tensor generation:  0.008752822875976562
mini_batch_src_global generation:  0.011217594146728516
r_  generation:  0.10448813438415527
----------------------check_connections_block total spend ----------------------------- 3.8019750118255615
generate_one_block  0.3946959972381592
generate_one_block  0.38302016258239746
generate_one_block  0.3301572799682617
generate_one_block  0.3381049633026123
generate_one_block  0.22510504722595215
generate_one_block  0.2186577320098877
generate_one_block  0.2191164493560791
generate_one_block  0.32303595542907715
generate_one_block  0.11261844635009766
generate_one_block  0.10236072540283203
generate_one_block  0.09753823280334473
generate_one_block  0.12546920776367188
generate_one_block  0.07855701446533203
generate_one_block  0.13137340545654297
generate_one_block  0.1993100643157959
generate_one_block  0.13648056983947754
global_2_local spend time (sec) 0.007646799087524414
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0011508464813232422
A = g.adjacency_matrix() spent  0.0010251998901367188
auxiliary_graph
Graph(num_nodes=30707, num_edges=418929,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.021551847457885742
remove nodes length
25182
auxiliary_graph.remove_nodes spent  0.016089916229248047
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5525, num_edges=418929,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.014232158660888672

the counter of shared neighbor distribution
Counter({1.0: 318138, 2.0: 63430, 3.0: 19152, 4.0: 6990, 5.0: 2762, 6.0: 1168, 7.0: 654, 8.0: 416, 9.0: 236, 10.0: 144, 11.0: 82, 12.0: 64, 13.0: 60, 14.0: 32, 16.0: 22, 15.0: 22, 17.0: 12, 20.0: 8, 21.0: 2, 22.0: 2, 26.0: 2, 28.0: 2, 19.0: 2, 27.0: 2})
413404
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.014 seconds
Metis partitioning: 0.042 seconds
Split the graph: 0.077 seconds
Construct subgraphs: 0.041 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.17397069931030273
2762
2763
total k batches seeds list generation spend  0.33524656295776367
after graph partition
graph partition algorithm spend time 0.3627185821533203
2762
2763
time for parepare:  0.026057004928588867
local_output_nid generation:  0.0006535053253173828
local_in_edges_tensor generation:  0.003808736801147461
mini_batch_src_global generation:  0.0009999275207519531
r_  generation:  0.007429599761962891
local_output_nid generation:  0.0005347728729248047
local_in_edges_tensor generation:  0.0014727115631103516
mini_batch_src_global generation:  0.002420186996459961
r_  generation:  0.015298843383789062
----------------------check_connections_block total spend ----------------------------- 0.06978893280029297
generate_one_block  0.013765335083007812
generate_one_block  0.024577856063842773
time for parepare:  0.021781206130981445
local_output_nid generation:  0.001836538314819336
local_in_edges_tensor generation:  0.009462118148803711
mini_batch_src_global generation:  0.005131959915161133
r_  generation:  0.04424715042114258
local_output_nid generation:  0.0058629512786865234
local_in_edges_tensor generation:  0.007874250411987305
mini_batch_src_global generation:  0.014182090759277344
r_  generation:  0.13519668579101562
----------------------check_connections_block total spend ----------------------------- 0.29242467880249023
generate_one_block  0.06377148628234863
generate_one_block  0.19283294677734375
time for parepare:  0.02104806900024414
local_output_nid generation:  0.007014036178588867
local_in_edges_tensor generation:  0.01725292205810547
mini_batch_src_global generation:  0.011411190032958984
r_  generation:  0.12395977973937988
local_output_nid generation:  0.017378807067871094
local_in_edges_tensor generation:  0.0193178653717041
mini_batch_src_global generation:  0.023062705993652344
r_  generation:  0.24093055725097656
----------------------check_connections_block total spend ----------------------------- 0.5672650337219238
generate_one_block  0.17217254638671875
generate_one_block  0.3248283863067627
----------===============-------------===============-------------the number of batches *****---- 17

original number of batches:  16
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.09396886825561523  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

connection checking time:  6.198307275772095
block generation total time  5.716566801071167
average batch blocks generation time:  0.35728542506694794
block dataloader generation time/epoch 46.53233098983765
pseudo mini batch 0 input nodes size: 118432
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.0741567611694336  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.0741567611694336  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.1306295394897461  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.13067102432250977  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.07783365249633789  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.08752012252807617  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9873046875 GB
    Memory Allocated: 0.08752012252807617  GigaBytes
Max Memory Allocated: 14.058067321777344  GigaBytes

first layer input nodes number: 118432
first layer output nodes number: 84942
edges number: 676068
input nodes number: 84942
output nodes number: 36286
edges number: 547981
Traceback (most recent call last):
  File "full_and_pseudo_mini_batch_arxiv_sage.py", line 508, in <module>
    main()
  File "full_and_pseudo_mini_batch_arxiv_sage.py", line 504, in main
    best_test = run(args, device, data)
  File "full_and_pseudo_mini_batch_arxiv_sage.py", line 274, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/new_gp_SAGE/OGBN-arxiv/graphsage_model_arxiv.py", line 211, in forward
    x = self.layers[-1](blocks[-1], x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/new_gp_SAGE/OGBN-arxiv/graphsage_model_arxiv.py", line 129, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/new_gp_SAGE/OGBN-arxiv/graphsage_model_arxiv.py", line 75, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 15.90 GiB total capacity; 14.27 GiB already allocated; 1.88 MiB free; 14.95 GiB reserved in total by PyTorch)
