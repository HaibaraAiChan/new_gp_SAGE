[05:43:36] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 510562 edges into 32 parts and get 40464 edge cuts
main start at this time 1651556600.9597983
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.019408464431762695
global_2_local spend time (sec) 0.03641176223754883
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.005065441131591797
A = g.adjacency_matrix() spent  0.007741689682006836
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08080458641052246
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.3263039588928223
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1958708763122559

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 0.028 seconds
Metis partitioning: 0.095 seconds
Split the graph: 0.035 seconds
Construct subgraphs: 0.146 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.3040049076080322
2841
2840
2878
2832
2913
2802
2838
2848
2926
2832
2841
2842
2859
2758
2927
2781
2868
2826
2836
2839
2835
2802
2832
2839
2851
2832
2838
2851
2837
2837
2832
2828
total k batches seeds list generation spend  11.185540199279785
after graph partition
graph partition algorithm spend time 11.279063940048218
2841
2840
2878
2832
2913
2802
2838
2848
2926
2832
2841
2842
2859
2758
2927
2781
2868
2826
2836
2839
2835
2802
2832
2839
2851
2832
2838
2851
2837
2837
2832
2828
partition_len_list
[11351, 11643, 13422, 12386, 11929, 12378, 13047, 13628, 16727, 15027, 11351, 13577, 18057, 18032, 16882, 16917, 12320, 14067, 13159, 13089, 13537, 12960, 13545, 13312, 12567, 13641, 13108, 14058, 13308, 14192, 13961, 13715]
shared_neighbor_graph_partition_s0 selection method  spend 11.371328592300415
time for parepare:  0.020726442337036133
local_output_nid generation:  0.0006482601165771484
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0013408660888671875
r_  generation:  0.008028745651245117
local_output_nid generation:  0.0007441043853759766
local_in_edges_tensor generation:  0.0013537406921386719
mini_batch_src_global generation:  0.0013644695281982422
r_  generation:  0.0074923038482666016
local_output_nid generation:  0.0007987022399902344
local_in_edges_tensor generation:  0.0007708072662353516
mini_batch_src_global generation:  0.0011682510375976562
r_  generation:  0.008461475372314453
local_output_nid generation:  0.0007967948913574219
local_in_edges_tensor generation:  0.0007679462432861328
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.006521463394165039
local_output_nid generation:  0.0008330345153808594
local_in_edges_tensor generation:  0.0007367134094238281
mini_batch_src_global generation:  0.0010111331939697266
r_  generation:  0.008779525756835938
local_output_nid generation:  0.0007786750793457031
local_in_edges_tensor generation:  0.0006480216979980469
mini_batch_src_global generation:  0.0009219646453857422
r_  generation:  0.007001638412475586
local_output_nid generation:  0.0007803440093994141
local_in_edges_tensor generation:  0.0006651878356933594
mini_batch_src_global generation:  0.0009367465972900391
r_  generation:  0.007837772369384766
local_output_nid generation:  0.0007538795471191406
local_in_edges_tensor generation:  0.0006308555603027344
mini_batch_src_global generation:  0.0008184909820556641
r_  generation:  0.006491899490356445
local_output_nid generation:  0.0008103847503662109
local_in_edges_tensor generation:  0.0007290840148925781
mini_batch_src_global generation:  0.0015659332275390625
r_  generation:  0.015262603759765625
local_output_nid generation:  0.0008251667022705078
local_in_edges_tensor generation:  0.000980377197265625
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.007929563522338867
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0006818771362304688
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.00853419303894043
local_output_nid generation:  0.0007963180541992188
local_in_edges_tensor generation:  0.0006246566772460938
mini_batch_src_global generation:  0.0008339881896972656
r_  generation:  0.00621485710144043
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0006756782531738281
mini_batch_src_global generation:  0.0010066032409667969
r_  generation:  0.011332511901855469
local_output_nid generation:  0.0008172988891601562
local_in_edges_tensor generation:  0.0007123947143554688
mini_batch_src_global generation:  0.0010423660278320312
r_  generation:  0.010890722274780273
local_output_nid generation:  0.0008547306060791016
local_in_edges_tensor generation:  0.0007832050323486328
mini_batch_src_global generation:  0.0011327266693115234
r_  generation:  0.013312101364135742
local_output_nid generation:  0.0008509159088134766
local_in_edges_tensor generation:  0.0007030963897705078
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.019603490829467773
local_output_nid generation:  0.0016872882843017578
local_in_edges_tensor generation:  0.0009829998016357422
mini_batch_src_global generation:  0.0012335777282714844
r_  generation:  0.007910013198852539
local_output_nid generation:  0.0015091896057128906
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0008196830749511719
r_  generation:  0.005332469940185547
local_output_nid generation:  0.001413583755493164
local_in_edges_tensor generation:  0.0007433891296386719
mini_batch_src_global generation:  0.0006921291351318359
r_  generation:  0.005361318588256836
local_output_nid generation:  0.0013489723205566406
local_in_edges_tensor generation:  0.0007016658782958984
mini_batch_src_global generation:  0.0006618499755859375
r_  generation:  0.005167722702026367
local_output_nid generation:  0.0013356208801269531
local_in_edges_tensor generation:  0.0007164478302001953
mini_batch_src_global generation:  0.0006580352783203125
r_  generation:  0.0052106380462646484
local_output_nid generation:  0.0012896060943603516
local_in_edges_tensor generation:  0.0006878376007080078
mini_batch_src_global generation:  0.0006048679351806641
r_  generation:  0.004456996917724609
local_output_nid generation:  0.0012860298156738281
local_in_edges_tensor generation:  0.0007004737854003906
mini_batch_src_global generation:  0.0006759166717529297
r_  generation:  0.0056955814361572266
local_output_nid generation:  0.0012269020080566406
local_in_edges_tensor generation:  0.0006868839263916016
mini_batch_src_global generation:  0.0006277561187744141
r_  generation:  0.00514674186706543
local_output_nid generation:  0.0012612342834472656
local_in_edges_tensor generation:  0.000774383544921875
mini_batch_src_global generation:  0.0007045269012451172
r_  generation:  0.0057146549224853516
local_output_nid generation:  0.0012066364288330078
local_in_edges_tensor generation:  0.008237600326538086
mini_batch_src_global generation:  0.0008289813995361328
r_  generation:  0.005038022994995117
local_output_nid generation:  0.0011286735534667969
local_in_edges_tensor generation:  0.0007138252258300781
mini_batch_src_global generation:  0.0007183551788330078
r_  generation:  0.005286216735839844
local_output_nid generation:  0.0011365413665771484
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0007436275482177734
r_  generation:  0.005340576171875
local_output_nid generation:  0.0011298656463623047
local_in_edges_tensor generation:  0.0006747245788574219
mini_batch_src_global generation:  0.0006303787231445312
r_  generation:  0.004627704620361328
local_output_nid generation:  0.0011327266693115234
local_in_edges_tensor generation:  0.0006906986236572266
mini_batch_src_global generation:  0.0007026195526123047
r_  generation:  0.0054721832275390625
local_output_nid generation:  0.0011255741119384766
local_in_edges_tensor generation:  0.0006663799285888672
mini_batch_src_global generation:  0.0006682872772216797
r_  generation:  0.0054399967193603516
local_output_nid generation:  0.0011119842529296875
local_in_edges_tensor generation:  0.0006799697875976562
mini_batch_src_global generation:  0.0006206035614013672
r_  generation:  0.004893064498901367
----------------------check_connections_block total spend ----------------------------- 0.42987871170043945
generate_one_block  0.021567583084106445
generate_one_block  0.013586997985839844
generate_one_block  0.013135671615600586
generate_one_block  0.010667085647583008
generate_one_block  0.01356363296508789
generate_one_block  0.012321233749389648
generate_one_block  0.012317180633544922
generate_one_block  0.010378122329711914
generate_one_block  0.018636465072631836
generate_one_block  0.013761281967163086
generate_one_block  0.013518810272216797
generate_one_block  0.009954214096069336
generate_one_block  0.017034292221069336
generate_one_block  0.017183780670166016
generate_one_block  0.019994258880615234
generate_one_block  0.01654219627380371
generate_one_block  0.012818336486816406
generate_one_block  0.00861215591430664
generate_one_block  0.008392095565795898
generate_one_block  0.008101224899291992
generate_one_block  0.008381128311157227
generate_one_block  0.0076351165771484375
generate_one_block  0.009123563766479492
generate_one_block  0.00804591178894043
generate_one_block  0.01265096664428711
generate_one_block  0.01479792594909668
generate_one_block  0.009134769439697266
generate_one_block  0.008682012557983398
generate_one_block  0.007689237594604492
generate_one_block  0.008888483047485352
generate_one_block  0.00867772102355957
generate_one_block  0.007988214492797852
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.061858415603637695
gen group dst list time:  0.012901782989501953
time for parepare:  0.025927305221557617
local_output_nid generation:  0.002397298812866211
local_in_edges_tensor generation:  0.014864921569824219
mini_batch_src_global generation:  0.0025777816772460938
r_  generation:  0.029226303100585938
local_output_nid generation:  0.003590822219848633
local_in_edges_tensor generation:  0.0032067298889160156
mini_batch_src_global generation:  0.0031654834747314453
r_  generation:  0.029334545135498047
local_output_nid generation:  0.0039014816284179688
local_in_edges_tensor generation:  0.003381013870239258
mini_batch_src_global generation:  0.0026640892028808594
r_  generation:  0.04213261604309082
local_output_nid generation:  0.0060918331146240234
local_in_edges_tensor generation:  0.004102230072021484
mini_batch_src_global generation:  0.0032007694244384766
r_  generation:  0.034247636795043945
local_output_nid generation:  0.0060732364654541016
local_in_edges_tensor generation:  0.0040972232818603516
mini_batch_src_global generation:  0.0030663013458251953
r_  generation:  0.03137660026550293
local_output_nid generation:  0.006106138229370117
local_in_edges_tensor generation:  0.004412412643432617
mini_batch_src_global generation:  0.010280847549438477
r_  generation:  0.03357124328613281
local_output_nid generation:  0.005808353424072266
local_in_edges_tensor generation:  0.0042307376861572266
mini_batch_src_global generation:  0.005026817321777344
r_  generation:  0.033658742904663086
local_output_nid generation:  0.004980564117431641
local_in_edges_tensor generation:  0.004363298416137695
mini_batch_src_global generation:  0.0030431747436523438
r_  generation:  0.036759138107299805
local_output_nid generation:  0.005371570587158203
local_in_edges_tensor generation:  0.004506111145019531
mini_batch_src_global generation:  0.005279064178466797
r_  generation:  0.05027484893798828
local_output_nid generation:  0.004700422286987305
local_in_edges_tensor generation:  0.0036339759826660156
mini_batch_src_global generation:  0.00813150405883789
r_  generation:  0.04612302780151367
local_output_nid generation:  0.005487203598022461
local_in_edges_tensor generation:  0.0037987232208251953
mini_batch_src_global generation:  0.0034906864166259766
r_  generation:  0.03011775016784668
local_output_nid generation:  0.006238222122192383
local_in_edges_tensor generation:  0.004075527191162109
mini_batch_src_global generation:  0.0033125877380371094
r_  generation:  0.03634524345397949
local_output_nid generation:  0.007775306701660156
local_in_edges_tensor generation:  0.005740642547607422
mini_batch_src_global generation:  0.005773782730102539
r_  generation:  0.05608797073364258
local_output_nid generation:  0.007966995239257812
local_in_edges_tensor generation:  0.005902528762817383
mini_batch_src_global generation:  0.006525754928588867
r_  generation:  0.056734561920166016
local_output_nid generation:  0.00751042366027832
local_in_edges_tensor generation:  0.005383491516113281
mini_batch_src_global generation:  0.006318092346191406
r_  generation:  0.05441570281982422
local_output_nid generation:  0.007718324661254883
local_in_edges_tensor generation:  0.005692481994628906
mini_batch_src_global generation:  0.006124973297119141
r_  generation:  0.0698251724243164
local_output_nid generation:  0.0058977603912353516
local_in_edges_tensor generation:  0.0036096572875976562
mini_batch_src_global generation:  0.004646778106689453
r_  generation:  0.03441190719604492
local_output_nid generation:  0.0054378509521484375
local_in_edges_tensor generation:  0.0036592483520507812
mini_batch_src_global generation:  0.003050088882446289
r_  generation:  0.037120819091796875
local_output_nid generation:  0.004667043685913086
local_in_edges_tensor generation:  0.0033216476440429688
mini_batch_src_global generation:  0.003178834915161133
r_  generation:  0.0355226993560791
local_output_nid generation:  0.004372119903564453
local_in_edges_tensor generation:  0.0032901763916015625
mini_batch_src_global generation:  0.0030486583709716797
r_  generation:  0.03579998016357422
local_output_nid generation:  0.004334211349487305
local_in_edges_tensor generation:  0.003600597381591797
mini_batch_src_global generation:  0.0031321048736572266
r_  generation:  0.038355112075805664
local_output_nid generation:  0.004084110260009766
local_in_edges_tensor generation:  0.003671884536743164
mini_batch_src_global generation:  0.0030651092529296875
r_  generation:  0.03453803062438965
local_output_nid generation:  0.004222869873046875
local_in_edges_tensor generation:  0.0033545494079589844
mini_batch_src_global generation:  0.003108501434326172
r_  generation:  0.03606295585632324
local_output_nid generation:  0.004033803939819336
local_in_edges_tensor generation:  0.0031995773315429688
mini_batch_src_global generation:  0.0031206607818603516
r_  generation:  0.03585672378540039
local_output_nid generation:  0.0037674903869628906
local_in_edges_tensor generation:  0.002966642379760742
mini_batch_src_global generation:  0.002812623977661133
r_  generation:  0.03279995918273926
local_output_nid generation:  0.003991842269897461
local_in_edges_tensor generation:  0.0032012462615966797
mini_batch_src_global generation:  0.00292205810546875
r_  generation:  0.03643012046813965
local_output_nid generation:  0.0038907527923583984
local_in_edges_tensor generation:  0.0032165050506591797
mini_batch_src_global generation:  0.0030138492584228516
r_  generation:  0.03493809700012207
local_output_nid generation:  0.004179716110229492
local_in_edges_tensor generation:  0.0033545494079589844
mini_batch_src_global generation:  0.0032062530517578125
r_  generation:  0.03751397132873535
local_output_nid generation:  0.003937721252441406
local_in_edges_tensor generation:  0.003207683563232422
mini_batch_src_global generation:  0.0031783580780029297
r_  generation:  0.036492109298706055
local_output_nid generation:  0.004157066345214844
local_in_edges_tensor generation:  0.003399372100830078
mini_batch_src_global generation:  0.0033943653106689453
r_  generation:  0.03853416442871094
local_output_nid generation:  0.004076719284057617
local_in_edges_tensor generation:  0.0033926963806152344
mini_batch_src_global generation:  0.003371000289916992
r_  generation:  0.03820204734802246
local_output_nid generation:  0.004004955291748047
local_in_edges_tensor generation:  0.003291606903076172
mini_batch_src_global generation:  0.0032808780670166016
r_  generation:  0.03625011444091797
----------------------check_connections_block total spend ----------------------------- 2.0024771690368652
generate_one_block  0.03880572319030762
generate_one_block  0.04041790962219238
generate_one_block  0.04627633094787598
generate_one_block  0.04186844825744629
generate_one_block  0.056561946868896484
generate_one_block  0.04485774040222168
generate_one_block  0.04648423194885254
generate_one_block  0.04689836502075195
generate_one_block  0.06899642944335938
generate_one_block  0.05461239814758301
generate_one_block  0.040126800537109375
generate_one_block  0.0612337589263916
generate_one_block  0.0749204158782959
generate_one_block  0.07395315170288086
generate_one_block  0.06875944137573242
generate_one_block  0.13053059577941895
generate_one_block  0.04212307929992676
generate_one_block  0.05917477607727051
generate_one_block  0.05099987983703613
generate_one_block  0.052350521087646484
generate_one_block  0.0488591194152832
generate_one_block  0.04652142524719238
generate_one_block  0.04571175575256348
generate_one_block  0.04501509666442871
generate_one_block  0.04115462303161621
generate_one_block  0.044283151626586914
generate_one_block  0.04400515556335449
generate_one_block  0.048435211181640625
generate_one_block  0.04569697380065918
generate_one_block  0.04838299751281738
generate_one_block  0.047553300857543945
generate_one_block  0.08350515365600586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  2.0024771690368652
block generation total time  1.7290759086608887
average batch blocks generation time:  0.05403362214565277
pseudo mini batch 0 input nodes size: 38158
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.020972728729248047  GigaBytes
Max Memory Allocated: 0.020972728729248047  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.020994186401367188  GigaBytes
Max Memory Allocated: 0.020994186401367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.020994186401367188  GigaBytes
Max Memory Allocated: 0.020994186401367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02183246612548828  GigaBytes
Max Memory Allocated: 0.02183246612548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02183246612548828  GigaBytes
Max Memory Allocated: 0.02183246612548828  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02183246612548828  GigaBytes
Max Memory Allocated: 0.02183246612548828  GigaBytes

torch.Size([38158, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02183246612548828  GigaBytes
Max Memory Allocated: 0.02183246612548828  GigaBytes

m.shape torch.Size([580, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06237459182739258  GigaBytes
Max Memory Allocated: 0.06332683563232422  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06237459182739258  GigaBytes
Max Memory Allocated: 0.06332683563232422  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.0629277229309082  GigaBytes
Max Memory Allocated: 0.06332683563232422  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06827116012573242  GigaBytes
Max Memory Allocated: 0.06854772567749023  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([811, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.06876802444458008  GigaBytes
Max Memory Allocated: 0.06878662109375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.06876802444458008  GigaBytes
Max Memory Allocated: 0.06878662109375  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.06954145431518555  GigaBytes
Max Memory Allocated: 0.06954145431518555  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.08114290237426758  GigaBytes
Max Memory Allocated: 0.08191633224487305  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([831, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.08194494247436523  GigaBytes
Max Memory Allocated: 0.08197307586669922  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.08194494247436523  GigaBytes
Max Memory Allocated: 0.08197307586669922  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.08273744583129883  GigaBytes
Max Memory Allocated: 0.08273744583129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.10020256042480469  GigaBytes
Max Memory Allocated: 0.10139131546020508  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([738, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.10121393203735352  GigaBytes
Max Memory Allocated: 0.10139131546020508  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.10121393203735352  GigaBytes
Max Memory Allocated: 0.10139131546020508  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.10191774368286133  GigaBytes
Max Memory Allocated: 0.10191774368286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.12285089492797852  GigaBytes
Max Memory Allocated: 0.12425851821899414  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([706, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.12418222427368164  GigaBytes
Max Memory Allocated: 0.12425851821899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.12418222427368164  GigaBytes
Max Memory Allocated: 0.12425851821899414  GigaBytes

 h.shape torch.Size([1, 706, 128]), torch.Size([1, 706, 128])
----------------------------------------3
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.12485551834106445  GigaBytes
Max Memory Allocated: 0.12485551834106445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.14919233322143555  GigaBytes
Max Memory Allocated: 0.15087556838989258  GigaBytes

rst.shape  torch.Size([1, 706, 128])
m.shape torch.Size([642, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.15069246292114258  GigaBytes
Max Memory Allocated: 0.15087556838989258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.15069246292114258  GigaBytes
Max Memory Allocated: 0.15087556838989258  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.1513047218322754  GigaBytes
Max Memory Allocated: 0.1513047218322754  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.17763185501098633  GigaBytes
Max Memory Allocated: 0.17946863174438477  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([601, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.17933177947998047  GigaBytes
Max Memory Allocated: 0.17946863174438477  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.17933177947998047  GigaBytes
Max Memory Allocated: 0.17946863174438477  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.17990493774414062  GigaBytes
Max Memory Allocated: 0.17990493774414062  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.20922327041625977  GigaBytes
Max Memory Allocated: 0.2112293243408203  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([479, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.21076393127441406  GigaBytes
Max Memory Allocated: 0.2112293243408203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.21076393127441406  GigaBytes
Max Memory Allocated: 0.2112293243408203  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.21122074127197266  GigaBytes
Max Memory Allocated: 0.2112293243408203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.2372589111328125  GigaBytes
Max Memory Allocated: 0.23908615112304688  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([446, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.23894453048706055  GigaBytes
Max Memory Allocated: 0.23908615112304688  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.23894453048706055  GigaBytes
Max Memory Allocated: 0.23908615112304688  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.23936986923217773  GigaBytes
Max Memory Allocated: 0.23936986923217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.26659154891967773  GigaBytes
Max Memory Allocated: 0.2685055732727051  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([5517, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.29268598556518555  GigaBytes
Max Memory Allocated: 0.2933034896850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.29268598556518555  GigaBytes
Max Memory Allocated: 0.2933034896850586  GigaBytes

 h.shape torch.Size([1, 5517, 128]), torch.Size([1, 5517, 128])
----------------------------------------3
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.29794740676879883  GigaBytes
Max Memory Allocated: 0.29794740676879883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.6715083122253418  GigaBytes
Max Memory Allocated: 0.6978154182434082  GigaBytes

rst.shape  torch.Size([1, 5517, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.634850025177002  GigaBytes
Max Memory Allocated: 0.6978154182434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.6456751823425293  GigaBytes
Max Memory Allocated: 0.6978154182434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.6565003395080566  GigaBytes
Max Memory Allocated: 0.6978154182434082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.6455903053283691  GigaBytes
Max Memory Allocated: 0.6978154182434082  GigaBytes

torch.Size([11351, 256])
first layer input nodes number: 38158
first layer output nodes number: 11351
edges number: 82252
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.6567869186401367  GigaBytes
Max Memory Allocated: 0.6978154182434082  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.6676120758056641  GigaBytes
Max Memory Allocated: 0.6978154182434082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.6712079048156738  GigaBytes
Max Memory Allocated: 0.6978154182434082  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.6712079048156738  GigaBytes
Max Memory Allocated: 0.6978154182434082  GigaBytes

m.shape torch.Size([273, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7011198997497559  GigaBytes
Max Memory Allocated: 0.7013249397277832  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7011198997497559  GigaBytes
Max Memory Allocated: 0.7013249397277832  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7016406059265137  GigaBytes
Max Memory Allocated: 0.7016406059265137  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7059578895568848  GigaBytes
Max Memory Allocated: 0.7062182426452637  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([240, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7061591148376465  GigaBytes
Max Memory Allocated: 0.7062182426452637  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7061591148376465  GigaBytes
Max Memory Allocated: 0.7062182426452637  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7066168785095215  GigaBytes
Max Memory Allocated: 0.7066168785095215  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7134833335876465  GigaBytes
Max Memory Allocated: 0.7139410972595215  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([216, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7138776779174805  GigaBytes
Max Memory Allocated: 0.7139410972595215  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7138776779174805  GigaBytes
Max Memory Allocated: 0.7139410972595215  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.714289665222168  GigaBytes
Max Memory Allocated: 0.714289665222168  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.723353385925293  GigaBytes
Max Memory Allocated: 0.7239713668823242  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([158, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.7237548828125  GigaBytes
Max Memory Allocated: 0.7239713668823242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.7237548828125  GigaBytes
Max Memory Allocated: 0.7239713668823242  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.7240562438964844  GigaBytes
Max Memory Allocated: 0.7240562438964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7327957153320312  GigaBytes
Max Memory Allocated: 0.7333984375  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([141, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7333230972290039  GigaBytes
Max Memory Allocated: 0.7333984375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7333230972290039  GigaBytes
Max Memory Allocated: 0.7333984375  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7335920333862305  GigaBytes
Max Memory Allocated: 0.7335920333862305  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9998779296875 GB
    Memory Allocated: 0.7432737350463867  GigaBytes
Max Memory Allocated: 0.7439460754394531  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7439870834350586  GigaBytes
Max Memory Allocated: 0.743990421295166  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7439870834350586  GigaBytes
Max Memory Allocated: 0.743990421295166  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.744267463684082  GigaBytes
Max Memory Allocated: 0.744267463684082  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7563238143920898  GigaBytes
Max Memory Allocated: 0.7571649551391602  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([151, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7572283744812012  GigaBytes
Max Memory Allocated: 0.757232666015625  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7572283744812012  GigaBytes
Max Memory Allocated: 0.757232666015625  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7575163841247559  GigaBytes
Max Memory Allocated: 0.7575163841247559  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7719168663024902  GigaBytes
Max Memory Allocated: 0.7730331420898438  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.772611141204834  GigaBytes
Max Memory Allocated: 0.7730331420898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.772611141204834  GigaBytes
Max Memory Allocated: 0.7730331420898438  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7728190422058105  GigaBytes
Max Memory Allocated: 0.7730331420898438  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.7846693992614746  GigaBytes
Max Memory Allocated: 0.7855010032653809  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.7854394912719727  GigaBytes
Max Memory Allocated: 0.7855010032653809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.7854394912719727  GigaBytes
Max Memory Allocated: 0.7855010032653809  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.7856321334838867  GigaBytes
Max Memory Allocated: 0.7856321334838867  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.7979612350463867  GigaBytes
Max Memory Allocated: 0.798828125  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([133, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.7993650436401367  GigaBytes
Max Memory Allocated: 0.799370288848877  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.7993650436401367  GigaBytes
Max Memory Allocated: 0.799370288848877  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.7996187210083008  GigaBytes
Max Memory Allocated: 0.7996187210083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.8176298141479492  GigaBytes
Max Memory Allocated: 0.8188982009887695  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.8187079429626465  GigaBytes
Max Memory Allocated: 0.8188982009887695  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.8187079429626465  GigaBytes
Max Memory Allocated: 0.8188982009887695  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.8189139366149902  GigaBytes
Max Memory Allocated: 0.8189139366149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0877685546875 GB
    Memory Allocated: 0.8349814414978027  GigaBytes
Max Memory Allocated: 0.8361773490905762  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([81, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.835813045501709  GigaBytes
Max Memory Allocated: 0.8361773490905762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.835813045501709  GigaBytes
Max Memory Allocated: 0.8361773490905762  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.8359675407409668  GigaBytes
Max Memory Allocated: 0.8361773490905762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.8490996360778809  GigaBytes
Max Memory Allocated: 0.8500266075134277  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([80, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.8501467704772949  GigaBytes
Max Memory Allocated: 0.8501510620117188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.8501467704772949  GigaBytes
Max Memory Allocated: 0.8501510620117188  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.8502993583679199  GigaBytes
Max Memory Allocated: 0.8502993583679199  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.8643374443054199  GigaBytes
Max Memory Allocated: 0.8654537200927734  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.8651361465454102  GigaBytes
Max Memory Allocated: 0.8654537200927734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.8651361465454102  GigaBytes
Max Memory Allocated: 0.8654537200927734  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.865260124206543  GigaBytes
Max Memory Allocated: 0.8654537200927734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.8775339126586914  GigaBytes
Max Memory Allocated: 0.8784017562866211  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.8782505989074707  GigaBytes
Max Memory Allocated: 0.8784017562866211  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.8782505989074707  GigaBytes
Max Memory Allocated: 0.8784017562866211  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.8783535957336426  GigaBytes
Max Memory Allocated: 0.8784017562866211  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.8892712593078613  GigaBytes
Max Memory Allocated: 0.8900437355041504  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.8899736404418945  GigaBytes
Max Memory Allocated: 0.8900437355041504  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.8899736404418945  GigaBytes
Max Memory Allocated: 0.8900437355041504  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.8900671005249023  GigaBytes
Max Memory Allocated: 0.8900671005249023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1522216796875 GB
    Memory Allocated: 0.9006280899047852  GigaBytes
Max Memory Allocated: 0.9013757705688477  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1522216796875 GB
    Memory Allocated: 0.9017062187194824  GigaBytes
Max Memory Allocated: 0.9017105102539062  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1522216796875 GB
    Memory Allocated: 0.9017062187194824  GigaBytes
Max Memory Allocated: 0.9017105102539062  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.1522216796875 GB
    Memory Allocated: 0.9018301963806152  GigaBytes
Max Memory Allocated: 0.9018301963806152  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1658935546875 GB
    Memory Allocated: 0.9167075157165527  GigaBytes
Max Memory Allocated: 0.9178237915039062  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.9175281524658203  GigaBytes
Max Memory Allocated: 0.9178237915039062  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.9175281524658203  GigaBytes
Max Memory Allocated: 0.9178237915039062  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.9176254272460938  GigaBytes
Max Memory Allocated: 0.9178237915039062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.9299793243408203  GigaBytes
Max Memory Allocated: 0.9308547973632812  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.9306797981262207  GigaBytes
Max Memory Allocated: 0.9308547973632812  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.9306797981262207  GigaBytes
Max Memory Allocated: 0.9308547973632812  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.930757999420166  GigaBytes
Max Memory Allocated: 0.9308547973632812  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.9412369728088379  GigaBytes
Max Memory Allocated: 0.9419798851013184  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.9421014785766602  GigaBytes
Max Memory Allocated: 0.9421052932739258  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.9421014785766602  GigaBytes
Max Memory Allocated: 0.9421052932739258  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.9421911239624023  GigaBytes
Max Memory Allocated: 0.9421911239624023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.9548311233520508  GigaBytes
Max Memory Allocated: 0.9557275772094727  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.9556946754455566  GigaBytes
Max Memory Allocated: 0.9557275772094727  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.9556946754455566  GigaBytes
Max Memory Allocated: 0.9557275772094727  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.9557805061340332  GigaBytes
Max Memory Allocated: 0.9557805061340332  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.9684834480285645  GigaBytes
Max Memory Allocated: 0.9693846702575684  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.9689903259277344  GigaBytes
Max Memory Allocated: 0.9693846702575684  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.9689903259277344  GigaBytes
Max Memory Allocated: 0.9693846702575684  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.9690399169921875  GigaBytes
Max Memory Allocated: 0.9693846702575684  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.9767265319824219  GigaBytes
Max Memory Allocated: 0.9772720336914062  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.9773874282836914  GigaBytes
Max Memory Allocated: 0.9773902893066406  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.9773874282836914  GigaBytes
Max Memory Allocated: 0.9773902893066406  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.9774465560913086  GigaBytes
Max Memory Allocated: 0.9774465560913086  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.987025260925293  GigaBytes
Max Memory Allocated: 0.9877052307128906  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.9875955581665039  GigaBytes
Max Memory Allocated: 0.9877052307128906  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.9875955581665039  GigaBytes
Max Memory Allocated: 0.9877052307128906  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.987645149230957  GigaBytes
Max Memory Allocated: 0.9877052307128906  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.9960260391235352  GigaBytes
Max Memory Allocated: 0.9966211318969727  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([403, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.0056848526000977  GigaBytes
Max Memory Allocated: 1.0057225227355957  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.0056848526000977  GigaBytes
Max Memory Allocated: 1.0057225227355957  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 1.006453514099121  GigaBytes
Max Memory Allocated: 1.006453514099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.144545078277588  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 403, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.117499828338623  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.1179232597351074  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.1183466911315918  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.1179018020629883  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

torch.Size([2841, 40])
input nodes number: 11351
output nodes number: 2841
edges number: 30163
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.118431568145752  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.1184325218200684  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.026667118072509766  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

pseudo mini batch 1 input nodes size: 39104
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.024193763732910156  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.024193763732910156  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.043725013732910156  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.0437464714050293  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.025529861450195312  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.02634716033935547  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.02634716033935547  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.02634716033935547  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

torch.Size([39104, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.02634716033935547  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

m.shape torch.Size([658, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.06687259674072266  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.06687259674072266  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.06750011444091797  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.07312202453613281  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([885, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.07365226745605469  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.07365226745605469  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 885, 128]), torch.Size([1, 885, 128])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.07449626922607422  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.08792495727539062  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 885, 128])
m.shape torch.Size([929, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.08883190155029297  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.08883190155029297  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.08971786499023438  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.10920906066894531  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([791, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.11038017272949219  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.11038017272949219  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.11113452911376953  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.1330108642578125  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([769, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.13446712493896484  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.13446712493896484  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.13520050048828125  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.16251897811889648  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([690, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.1650705337524414  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.1650705337524414  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.16572856903076172  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.19419384002685547  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([639, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.1959977149963379  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.1959977149963379  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.19660711288452148  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.22782659530639648  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([547, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.22960853576660156  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.22960853576660156  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.23013019561767578  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.26093435287475586  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([441, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.26256608963012695  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.26256608963012695  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.2629866600036621  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.2899031639099121  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([5294, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.31493663787841797  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.31493663787841797  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 5294, 128]), torch.Size([1, 5294, 128])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.31998538970947266  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.6784467697143555  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 5294, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.6420917510986328  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.6531953811645508  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.6642990112304688  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.6531085968017578  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

torch.Size([11643, 256])
first layer input nodes number: 39104
first layer output nodes number: 11643
edges number: 82122
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.6645922660827637  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.6756958961486816  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.6784720420837402  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.6784720420837402  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

m.shape torch.Size([306, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7052278518676758  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7052278518676758  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7058115005493164  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7118425369262695  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([261, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7120528221130371  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7120528221130371  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7125506401062012  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7226767539978027  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([231, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7230939865112305  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7230939865112305  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7235345840454102  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7332277297973633  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([175, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.733680248260498  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.733680248260498  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7340140342712402  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7436938285827637  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([163, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7443103790283203  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7443103790283203  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7446212768554688  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7558135986328125  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7565927505493164  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7565927505493164  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.756901741027832  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7701883316040039  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7709488868713379  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7709488868713379  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7712082862854004  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7841782569885254  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7850174903869629  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7850174903869629  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7852578163146973  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7989563941955566  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([114, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8004655838012695  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8004655838012695  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8006830215454102  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8145990371704102  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([106, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8161196708679199  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8161196708679199  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.816321849822998  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8306765556335449  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8322057723999023  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8322057723999023  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8324117660522461  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8484792709350586  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8491721153259277  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8491721153259277  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8493037223815918  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8604903221130371  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.862055778503418  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.862055778503418  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8622446060180664  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8796167373657227  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8813920021057129  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8813920021057129  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.881554126739502  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8976044654846191  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([58, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8983597755432129  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8983597755432129  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.898470401763916  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9101967811584473  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.911125659942627  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.911125659942627  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.911247730255127  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.925041675567627  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9258303642272949  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9258303642272949  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9259295463562012  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9378314018249512  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9386987686157227  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9386987686157227  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9387998580932617  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9516382217407227  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9521722793579102  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9521722793579102  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9522333145141602  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9604120254516602  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9613041877746582  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9613041877746582  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9613957405090332  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9743046760559082  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9747638702392578  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9747638702392578  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9748115539550781  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9818687438964844  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9824161529541016  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9824161529541016  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9824676513671875  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9904499053955078  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9908885955810547  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9908885955810547  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9909286499023438  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9974174499511719  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9979052543640137  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9979052543640137  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9979472160339355  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.0050387382507324  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([297, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.0121631622314453  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.0121631622314453  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.0127296447753906  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.119936466217041  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 297, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.0961589813232422  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.0965824127197266  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.097005844116211  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.0965609550476074  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

torch.Size([2840, 40])
input nodes number: 11643
output nodes number: 2840
edges number: 27402
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.0966691970825195  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.0966696739196777  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.027953624725341797  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

pseudo mini batch 2 input nodes size: 45625
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.025529861450195312  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.025529861450195312  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.04728555679321289  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.04730701446533203  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.02775430679321289  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.028682231903076172  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.028682231903076172  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.028682231903076172  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

torch.Size([45625, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.028682231903076172  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

m.shape torch.Size([713, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.07712364196777344  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.07712364196777344  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.0778036117553711  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.08324337005615234  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([942, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.0838017463684082  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.0838017463684082  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.08470010757446289  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.09911394119262695  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([968, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.1001729965209961  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.1001729965209961  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.10109615325927734  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.12204647064208984  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([959, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.1234140396118164  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.1234140396118164  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.12432861328125  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.15228748321533203  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([855, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.1538686752319336  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.1538686752319336  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.15468406677246094  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.1853775978088379  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([765, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.18715858459472656  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.18715858459472656  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.18788814544677734  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.22008037567138672  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([671, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.2219552993774414  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.2219552993774414  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.22259521484375  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.2549915313720703  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([607, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.2569870948791504  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.2569870948791504  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.257565975189209  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.2907223701477051  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([564, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.29285335540771484  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.29285335540771484  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.29339122772216797  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.3298630714416504  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([6378, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.36000680923461914  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.36000680923461914  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 6378, 128]), torch.Size([1, 6378, 128])
----------------------------------------3
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 0.3663468360900879  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.7982068061828613  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 6378, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.7563667297363281  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.7691669464111328  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.7819671630859375  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.7690668106079102  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

torch.Size([13422, 256])
first layer input nodes number: 45625
first layer output nodes number: 13422
edges number: 96611
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.7823090553283691  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.7951092720031738  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.798309326171875  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.798309326171875  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

m.shape torch.Size([311, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8262834548950195  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8262834548950195  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8268766403198242  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.831913948059082  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([301, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8321962356567383  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8321962356567383  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8327703475952148  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8424177169799805  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([213, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8427448272705078  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8427448272705078  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8431510925292969  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8520889282226562  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([207, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8526816368103027  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8526816368103027  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8530764579772949  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8645262718200684  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8651795387268066  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8651795387268066  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8655171394348145  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8776707649230957  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([125, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8782229423522949  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8782229423522949  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8784613609313965  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8887133598327637  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([154, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8897271156311035  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8897271156311035  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.8900208473205566  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9047074317932129  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9055371284484863  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9055371284484863  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9057793617248535  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9195866584777832  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9209804534912109  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9209804534912109  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9212055206298828  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9356098175048828  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([106, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9374308586120605  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9374308586120605  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9376330375671387  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9519877433776855  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([86, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9527959823608398  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9527959823608398  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9529600143432617  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.965754508972168  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([101, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9676070213317871  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9676070213317871  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9677996635437012  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9841742515563965  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9848527908325195  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9848527908325195  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9849710464477539  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9958505630493164  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.996760368347168  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.996760368347168  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.9968976974487305  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.010493278503418  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0112032890319824  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0112032890319824  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0113062858581543  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.022223949432373  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0230183601379395  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0230183601379395  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0231232643127441  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0349774360656738  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0358238220214844  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0358238220214844  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.035928726196289  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0485172271728516  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.049018383026123  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.049018383026123  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.049079418182373  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.056830883026123  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0575308799743652  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0575308799743652  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0576071739196777  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0678305625915527  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0683693885803223  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0683693885803223  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0684266090393066  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0764946937561035  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0770316123962402  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0770316123962402  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.077085018157959  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.084989070892334  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.085681438446045  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.085681438446045  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0857462882995605  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0957980155944824  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.096208095550537  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.096208095550537  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.0962462425231934  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.1024260520935059  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.103053092956543  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.103053092956543  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.1031064987182617  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.1121320724487305  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([342, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.1203231811523438  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.1203231811523438  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.1209754943847656  GigaBytes
Max Memory Allocated: 1.1541533470153809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.2443952560424805  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 342, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.22027587890625  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.2207050323486328  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.2211341857910156  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.2206835746765137  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([2878, 40])
input nodes number: 13422
output nodes number: 2878
edges number: 27782
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.220810890197754  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.220811367034912  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.030496597290039062  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

pseudo mini batch 3 input nodes size: 44421
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.027760028839111328  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.027760028839111328  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.048941612243652344  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.048963069915771484  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.027185916900634766  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.02798604965209961  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.02798604965209961  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.02798604965209961  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([44421, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.02798604965209961  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([864, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07051372528076172  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07051372528076172  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07133769989013672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07792949676513672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([984, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07845592498779297  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07845592498779297  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07939434051513672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09392833709716797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([1010, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09490394592285156  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09490394592285156  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09586715698242188  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.11769962310791016  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([945, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.11902046203613281  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.11902046203613281  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.11992168426513672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.147369384765625  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([868, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.14962530136108398  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.14962530136108398  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1504530906677246  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1805129051208496  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([729, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.18218469619750977  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.18218469619750977  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.18287992477416992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.21336984634399414  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 729, 128])
m.shape torch.Size([601, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2150282859802246  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2150282859802246  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.21560144424438477  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2450547218322754  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([566, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2473163604736328  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2473163604736328  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.24785614013671875  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2804698944091797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([474, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.28223419189453125  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.28223419189453125  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2826862335205078  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3116168975830078  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([5345, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.33687782287597656  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.33687782287597656  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 5345, 128]), torch.Size([1, 5345, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.34224414825439453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7060155868530273  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 5345, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.6681208610534668  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.6799330711364746  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.6917452812194824  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.6798405647277832  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([12386, 256])
first layer input nodes number: 44421
first layer output nodes number: 12386
edges number: 84807
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.6920785903930664  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7038908004760742  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7073211669921875  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7073211669921875  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([423, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.729485034942627  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.729485034942627  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7302918434143066  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7369766235351562  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([316, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7371807098388672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7371807098388672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7377834320068359  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7487354278564453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7492532730102539  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7492532730102539  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7497949600219727  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7644281387329102  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7650842666625977  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7650842666625977  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7655439376831055  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.778874397277832  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7796249389648438  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7796249389648438  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7800140380859375  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7940216064453125  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7948603630065918  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7948603630065918  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7951903343200684  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8093791007995605  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8101224899291992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8101224899291992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8103799819946289  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8232545852661133  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([144, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8242330551147461  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8242330551147461  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8245077133178711  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8401632308959961  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.840977668762207  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.840977668762207  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8411874771118164  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8546152114868164  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8552408218383789  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8552408218383789  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8553857803344727  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8656778335571289  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8662929534912109  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8662929534912109  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8664169311523438  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8760871887207031  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8767061233520508  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8767061233520508  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8768186569213867  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8863840103149414  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.886965274810791  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.886965274810791  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8870625495910645  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8960118293762207  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8965826034545898  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8965826034545898  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8966703414916992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9053564071655273  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.905846118927002  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.905846118927002  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.905916690826416  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9133973121643066  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9138698577880859  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9138698577880859  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9139328002929688  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9210453033447266  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9215207099914551  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9215207099914551  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9215798377990723  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9286751747131348  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9293203353881836  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9293203353881836  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9293947219848633  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9388418197631836  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9392795562744141  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9392795562744141  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9393291473388672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9459743499755859  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9462380409240723  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9462380409240723  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9462666511535645  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9503006935119629  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9507708549499512  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9507708549499512  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9508166313171387  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9575915336608887  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9579496383666992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9579496383666992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9579839706420898  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9633054733276367  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9637308120727539  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9637308120727539  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9637689590454102  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9699487686157227  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9703221321105957  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9703221321105957  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9703545570373535  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9758343696594238  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([245, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9826517105102539  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9826517105102539  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.983119010925293  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.065363883972168  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 245, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0462956428527832  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.046717643737793  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0471396446228027  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0466961860656738  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([2832, 40])
input nodes number: 12386
output nodes number: 2832
edges number: 22505
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0468029975891113  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0468034744262695  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.02958822250366211  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

pseudo mini batch 4 input nodes size: 37789
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.02717876434326172  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.02717876434326172  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.04519796371459961  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.04521989822387695  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.024016857147216797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.024890422821044922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.024890422821044922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.024890422821044922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([37789, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.024890422821044922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([597, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.06728076934814453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.06728076934814453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.06785011291503906  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07277822494506836  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([873, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07332611083984375  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07332611083984375  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.0741586685180664  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.08664703369140625  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([911, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.08753395080566406  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.08753395080566406  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.08840274810791016  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.10757875442504883  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([824, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.10871601104736328  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.10871601104736328  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.10950183868408203  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.13306140899658203  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([764, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1344900131225586  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1344900131225586  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.13521862030029297  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.16232013702392578  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([661, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1638469696044922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1638469696044922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.16447734832763672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.19217205047607422  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([625, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.19394302368164062  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.19394302368164062  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.19453907012939453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.22521734237670898  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([565, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.22707462310791016  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.22707462310791016  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2276134490966797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.26002025604248047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([480, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2618107795715332  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2618107795715332  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2622685432434082  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2915654182434082  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([5629, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3186802864074707  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3186802864074707  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 5629, 128]), torch.Size([1, 5629, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3240485191345215  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7086653709411621  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 5629, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.6704258918762207  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.6818022727966309  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.693178653717041  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.6817131042480469  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([11929, 256])
first layer input nodes number: 37789
first layer output nodes number: 11929
edges number: 85663
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.6934623718261719  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.704838752746582  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7079453468322754  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7079453468322754  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([259, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7384734153747559  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7384734153747559  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7389674186706543  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7432703971862793  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([265, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7435331344604492  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7435331344604492  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7440385818481445  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7517876625061035  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([208, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7521347999572754  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7521347999572754  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7525315284729004  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7612595558166504  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([159, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7616724967956543  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7616724967956543  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7619757652282715  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7707705497741699  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([134, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7712631225585938  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7712631225585938  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7715187072753906  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7807197570800781  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([132, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7813534736633301  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7813534736633301  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7816052436828613  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7924313545227051  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7932476997375488  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7932476997375488  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7935147285461426  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8068661689758301  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([144, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8078398704528809  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8078398704528809  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8081145286560059  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8237700462341309  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([125, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.824714183807373  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.824714183807373  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8249526023864746  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8402113914489746  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8410725593566895  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8410725593566895  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8412671089172363  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8550801277160645  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([103, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8564000129699707  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8564000129699707  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8565964698791504  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.871920108795166  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([106, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.873044490814209  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.873044490814209  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8732466697692871  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8904318809509277  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.891268253326416  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.891268253326416  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.891411304473877  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9045720100402832  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9056849479675293  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9056849479675293  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9058527946472168  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9224696159362793  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.923438549041748  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.923438549041748  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9235777854919434  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9383368492126465  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9390826225280762  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9390826225280762  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9391837120056152  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9506068229675293  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9517230987548828  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9517230987548828  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9518394470214844  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9658012390136719  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9665217399597168  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9665217399597168  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9666075706481934  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9775080680847168  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.978177547454834  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.978177547454834  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9782519340515137  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9882197380065918  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9892783164978027  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9892783164978027  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.989387035369873  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.004716396331787  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0054898262023926  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0054898262023926  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.005568027496338  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0171418190002441  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0176739692687988  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0176739692687988  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0177254676818848  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.025707721710205  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0262346267700195  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0262346267700195  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0262823104858398  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0340070724487305  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0347447395324707  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0347447395324707  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0348076820373535  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0454449653625488  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([419, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0554814338684082  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0554814338684082  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0562806129455566  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.2065720558166504  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 419, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1789612770080566  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1793956756591797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1798300743103027  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1793737411499023  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([2913, 40])
input nodes number: 11929
output nodes number: 2913
edges number: 31368
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.179497241973877  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1794977188110352  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.026593685150146484  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

pseudo mini batch 5 input nodes size: 42849
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.024029254913330078  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.024029254913330078  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.04446125030517578  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.04448223114013672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.026441097259521484  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.027286052703857422  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.027286052703857422  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.027286052703857422  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([42849, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.027286052703857422  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([719, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07084369659423828  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07084369659423828  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 719, 128]), torch.Size([1, 719, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07152938842773438  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07768726348876953  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 719, 128])
m.shape torch.Size([878, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07818174362182617  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07818174362182617  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07901906967163086  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09179210662841797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([955, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09273958206176758  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09273958206176758  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09365034103393555  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.11447668075561523  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 955, 128])
m.shape torch.Size([841, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.11562538146972656  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.11562538146972656  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.11642742156982422  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.14017677307128906  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([845, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.14187002182006836  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.14187002182006836  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.14267587661743164  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1725602149963379  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([665, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.17405986785888672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.17405986785888672  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.17469406127929688  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.20313215255737305  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([631, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.20492124557495117  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.20492124557495117  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 631, 128]), torch.Size([1, 631, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.20552301406860352  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.23649835586547852  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 631, 128])
m.shape torch.Size([534, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2382345199584961  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2382345199584961  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.23874378204345703  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.26907968521118164  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([442, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2707219123840332  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2707219123840332  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.27114343643188477  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.29812097549438477  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([5868, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.32589101791381836  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.32589101791381836  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 5868, 128]), torch.Size([1, 5868, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.33148717880249023  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7340788841247559  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 5868, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.6948575973510742  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7066621780395508  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7184667587280273  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7065696716308594  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([12378, 256])
first layer input nodes number: 42849
first layer output nodes number: 12378
edges number: 88266
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7187881469726562  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7305927276611328  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7343273162841797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7343273162841797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([386, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7589225769042969  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7589225769042969  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7596588134765625  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7674770355224609  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([318, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7677202224731445  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7677202224731445  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7683267593383789  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7781124114990234  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([264, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7785706520080566  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7785706520080566  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7790741920471191  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7930665016174316  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([200, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.793583869934082  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.793583869934082  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7939653396606445  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.805027961730957  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8056879043579102  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8056879043579102  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.806025505065918  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8181791305541992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.818852424621582  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.818852424621582  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8191308975219727  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8311052322387695  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8317737579345703  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8317737579345703  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8320026397705078  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8434467315673828  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8441705703735352  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8441705703735352  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8443784713745117  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8562288284301758  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8569555282592773  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8569555282592773  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8571386337280273  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8688573837280273  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8696117401123047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8696117401123047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8697795867919922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8816967010498047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8824057579040527  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8824057579040527  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8825488090515137  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8937067985534668  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.894350528717041  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.894350528717041  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8944687843322754  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9045205116271973  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9051113128662109  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9051113128662109  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9052104949951172  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9143352508544922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9149990081787109  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9149990081787109  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.91510009765625  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9251079559326172  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9258217811584473  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9258217811584473  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9259228706359863  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.936638355255127  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9372491836547852  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9372491836547852  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9373311996459961  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.946599006652832  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9472932815551758  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9472932815551758  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9473791122436523  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9576787948608398  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9582414627075195  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9582414627075195  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.958308219909668  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9667863845825195  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9673194885253906  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9673194885253906  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9673786163330078  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9753017425537109  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9759645462036133  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9759645462036133  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9760332107543945  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9857149124145508  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9863872528076172  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9863872528076172  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9864540100097656  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9963340759277344  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9966602325439453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9966602325439453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9966926574707031  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.001718521118164  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0021886825561523  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0021886825561523  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0022306442260742  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.009028434753418  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.009446144104004  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.009446144104004  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0094823837280273  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0156068801879883  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([320, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0239872932434082  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0239872932434082  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0245976448059082  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.132997989654541  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 320, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1113805770874023  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1117982864379883  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1122159957885742  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1117773056030273  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([2802, 40])
input nodes number: 12378
output nodes number: 2802
edges number: 25076
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1118741035461426  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1118745803833008  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.028929710388183594  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

pseudo mini batch 6 input nodes size: 44492
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.026424407958984375  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.026424407958984375  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.04763984680175781  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.04766130447387695  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.027208328247070312  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.028097152709960938  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.028097152709960938  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.028097152709960938  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([44492, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.028097152709960938  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([740, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07372283935546875  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07372283935546875  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 740, 128]), torch.Size([1, 740, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07442855834960938  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.08007431030273438  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 740, 128])
m.shape torch.Size([971, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.08064746856689453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.08064746856689453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.081573486328125  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09546375274658203  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([1012, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09645414352416992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09645414352416992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 1012, 128]), torch.Size([1, 1012, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.09741926193237305  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.11931753158569336  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 1012, 128])
m.shape torch.Size([963, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.12067174911499023  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.12067174911499023  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.12159013748168945  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.14943265914916992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([788, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.15085220336914062  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.15085220336914062  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.15160369873046875  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.17865753173828125  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([742, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1809825897216797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1809825897216797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 742, 128]), torch.Size([1, 742, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.18169021606445312  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.21291160583496094  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 742, 128])
m.shape torch.Size([679, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.21482419967651367  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.21482419967651367  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.21547174453735352  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.24816513061523438  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([608, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.25016069412231445  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.25016069412231445  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.25074052810668945  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.28467798233032227  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([555, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2867698669433594  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2867698669433594  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.28729915618896484  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.32201528549194336  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([5989, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3510475158691406  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3510475158691406  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 5989, 128]), torch.Size([1, 5989, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.35675907135009766  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7646446228027344  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 5989, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7236700057983398  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7361125946044922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7485551834106445  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7360153198242188  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([13047, 256])
first layer input nodes number: 44492
first layer output nodes number: 13047
edges number: 92464
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7488889694213867  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7613315582275391  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7644424438476562  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7644424438476562  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([367, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7905378341674805  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7905378341674805  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7912378311157227  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7980532646179199  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([327, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7983322143554688  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7983322143554688  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7989559173583984  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8101496696472168  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([249, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8105559349060059  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8105559349060059  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8110308647155762  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.821479320526123  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([209, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8220458030700684  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8220458030700684  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8224444389343262  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8340048789978027  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([157, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8345603942871094  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8345603942871094  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8348598480224609  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8456401824951172  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([120, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8461828231811523  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8461828231811523  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8464117050170898  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8562536239624023  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8568592071533203  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8568592071533203  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8570632934570312  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8672676086425781  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8680882453918457  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8680882453918457  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8683171272277832  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8813633918762207  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8822007179260254  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8822007179260254  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8824105262756348  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8958382606506348  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8966660499572754  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8966660499572754  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8968510627746582  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9099869728088379  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9107403755187988  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9107403755187988  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9108929634094238  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9227948188781738  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9235377311706543  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9235377311706543  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.923673152923584  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9351840019226074  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9357414245605469  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9357414245605469  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9358367919921875  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.944610595703125  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9454240798950195  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9454240798950195  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9455461502075195  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9576311111450195  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9583053588867188  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9583053588867188  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9584026336669922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9687137603759766  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9694342613220215  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9694342613220215  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9695296287536621  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9803061485290527  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9808797836303711  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9808797836303711  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.980952262878418  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.989649772644043  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.990236759185791  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.990236759185791  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9903054237365723  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.999025821685791  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9997406005859375  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9997406005859375  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9998188018798828  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0102977752685547  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0107011795043945  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0107011795043945  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0107450485229492  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0169305801391602  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0174741744995117  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0174741744995117  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0175275802612305  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0254316329956055  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0259971618652344  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0259971618652344  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0260505676269531  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0343284606933594  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0349211692810059  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0349211692810059  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0349745750427246  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.043626308441162  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.044107437133789  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.044107437133789  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.044149398803711  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0512409210205078  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([365, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.059990406036377  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.059990406036377  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0606865882873535  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1841702461242676  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 365, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1610393524169922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1614623069763184  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1618852615356445  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1614408493041992  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([2838, 40])
input nodes number: 13047
output nodes number: 2838
edges number: 26655
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.161564826965332  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1615653038024902  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.029846668243408203  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

pseudo mini batch 7 input nodes size: 47337
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.027213573455810547  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.027213573455810547  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.049785614013671875  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.049807071685791016  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.028570175170898438  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.029412269592285156  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.029412269592285156  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.029412269592285156  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([47337, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.029412269592285156  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([953, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.0747370719909668  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.0747370719909668  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.07564592361450195  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.0829167366027832  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([1192, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.0838479995727539  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.0838479995727539  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 1192, 128]), torch.Size([1, 1192, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.08498477935791016  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1023874282836914  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 1192, 128])
m.shape torch.Size([1187, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.10351705551147461  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.10351705551147461  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 1187, 128]), torch.Size([1, 1187, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.10464906692504883  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1309070587158203  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 1187, 128])
m.shape torch.Size([1074, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.13238954544067383  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.13238954544067383  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.13341379165649414  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1631169319152832  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([971, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.16491985321044922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.16491985321044922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.1658458709716797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2003955841064453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([801, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2022242546081543  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2022242546081543  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2029881477355957  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.23665094375610352  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([664, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.23848533630371094  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.23848533630371094  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2391185760498047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2714252471923828  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([595, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2733783721923828  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2733783721923828  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.27394580841064453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.30794715881347656  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([587, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3101825714111328  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3101825714111328  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3107423782348633  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3473353385925293  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([5604, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.37439918518066406  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.37439918518066406  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 5604, 128]), torch.Size([1, 5604, 128])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.3797435760498047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7645683288574219  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 5604, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.723839282989502  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7368359565734863  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7498326301574707  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7367343902587891  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([13628, 256])
first layer input nodes number: 47337
first layer output nodes number: 13628
edges number: 91586
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7501873970031738  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7631840705871582  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7664780616760254  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7664780616760254  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([447, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7875604629516602  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7875604629516602  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7884130477905273  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7965116500854492  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7968025207519531  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7968025207519531  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.7975139617919922  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8085803985595703  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([320, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8091473579406738  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8091473579406738  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8097577095031738  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8241925239562988  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8247909545898438  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8247909545898438  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8252391815185547  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8382377624511719  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8390517234802246  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8390517234802246  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8394637107849121  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8542952537536621  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8550238609313965  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8550238609313965  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8553328514099121  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.868619441986084  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.869326114654541  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.869326114654541  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.869570255279541  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.881777286529541  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.882378101348877  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.882378101348877  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8825573921203613  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8927769660949707  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8934402465820312  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8934402465820312  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.8936061859130859  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9042263031005859  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9049510955810547  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9049510955810547  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9051113128662109  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9164867401123047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9171257019042969  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9171257019042969  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9172554016113281  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9273719787597656  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9279994964599609  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9279994964599609  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9281139373779297  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9378414154052734  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9384841918945312  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9384841918945312  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9385910034179688  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9484176635742188  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9488353729248047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9488353729248047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9489021301269531  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9555110931396484  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9561557769775391  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9561557769775391  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9562454223632812  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9657478332519531  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9663181304931641  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9663181304931641  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9663944244384766  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9750156402587891  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9755821228027344  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9755821228027344  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9756526947021484  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9841213226318359  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9845881462097168  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9845881462097168  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9846434593200684  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9916682243347168  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9920792579650879  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9920792579650879  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9921250343322754  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9982590675354004  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9989285469055176  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9989285469055176  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.9989972114562988  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.008678913116455  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.009028434753418  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.009028434753418  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0090646743774414  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0144281387329102  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0146427154541016  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0146427154541016  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0146636962890625  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0179157257080078  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0183916091918945  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0183916091918945  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0184335708618164  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0252313613891602  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.025510311126709  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.025510311126709  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0255351066589355  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0297255516052246  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([205, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0346393585205078  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0346393585205078  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0350303649902344  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1038475036621094  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 205, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0859284400939941  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.086352825164795  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0867772102355957  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0863313674926758  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([2848, 40])
input nodes number: 13628
output nodes number: 2848
edges number: 21358
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.0864558219909668  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.086456298828125  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.031105518341064453  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

pseudo mini batch 8 input nodes size: 48977
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.028571605682373047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.028571605682373047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.0519256591796875  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.051947593688964844  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.029354095458984375  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.030710220336914062  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.030710220336914062  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.030710220336914062  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([48977, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.030710220336914062  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([471, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.0998530387878418  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.0998530387878418  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.10030221939086914  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.10389566421508789  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([628, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.10426998138427734  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.10426998138427734  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.10486888885498047  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.11424875259399414  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([657, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.11488914489746094  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.11488914489746094  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 657, 128]), torch.Size([1, 657, 128])
----------------------------------------3
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.11551570892333984  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.12990665435791016  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 657, 128])
m.shape torch.Size([651, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.13083505630493164  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.13083505630493164  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.1314558982849121  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.14996957778930664  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([611, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.15111589431762695  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.15111589431762695  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.15169858932495117  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.17314529418945312  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([560, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.17445611953735352  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.17445611953735352  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.17499017715454102  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.19812536239624023  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([532, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.19963407516479492  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.19963407516479492  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.20014142990112305  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.2267928123474121  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([543, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.22861051559448242  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.22861051559448242  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.22912836074829102  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.2593398094177246  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([523, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.2613253593444824  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.2613253593444824  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.2618241310119629  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.2955045700073242  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([11551, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.35033464431762695  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.35033464431762695  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 11551, 128]), torch.Size([1, 11551, 128])
----------------------------------------3
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.36135053634643555  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1498045921325684  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 11551, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.084014892578125  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.0999670028686523  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1159191131591797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.0998420715332031  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

torch.Size([16727, 256])
first layer input nodes number: 48977
first layer output nodes number: 16727
edges number: 141002
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.116286277770996  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1322383880615234  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1364541053771973  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1364541053771973  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

m.shape torch.Size([228, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1761565208435059  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1761565208435059  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.176591396331787  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.180070400238037  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([210, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1802568435668945  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1802568435668945  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1806573867797852  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1866655349731445  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([155, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1869125366210938  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1869125366210938  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1872081756591797  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1937122344970703  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([121, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1940298080444336  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.1940298080444336  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.194260597229004  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.200953483581543  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([127, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2014484405517578  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2014484405517578  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.201690673828125  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2104110717773438  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([92, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2108206748962402  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2108206748962402  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.210996150970459  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2185416221618652  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([81, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.218998908996582  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.218998908996582  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2191534042358398  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2268781661987305  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([67, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2273163795471191  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2273163795471191  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2274441719055176  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2347283363342285  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2353997230529785  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2353997230529785  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2355618476867676  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2459378242492676  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2466068267822266  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2466068267822266  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.246755599975586  GigaBytes
Max Memory Allocated: 1.253504753112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2573184967041016  GigaBytes
Max Memory Allocated: 1.2580623626708984  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2581219673156738  GigaBytes
Max Memory Allocated: 1.2581257820129395  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2581219673156738  GigaBytes
Max Memory Allocated: 1.2581257820129395  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2582802772521973  GigaBytes
Max Memory Allocated: 1.2582802772521973  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2706284523010254  GigaBytes
Max Memory Allocated: 1.2714991569519043  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.271322250366211  GigaBytes
Max Memory Allocated: 1.2714991569519043  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.271322250366211  GigaBytes
Max Memory Allocated: 1.2714991569519043  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2714500427246094  GigaBytes
Max Memory Allocated: 1.2714991569519043  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2823123931884766  GigaBytes
Max Memory Allocated: 1.2830791473388672  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2831482887268066  GigaBytes
Max Memory Allocated: 1.2831521034240723  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2831482887268066  GigaBytes
Max Memory Allocated: 1.2831521034240723  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2832856178283691  GigaBytes
Max Memory Allocated: 1.2832856178283691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2959198951721191  GigaBytes
Max Memory Allocated: 1.2968125343322754  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2966184616088867  GigaBytes
Max Memory Allocated: 1.2968125343322754  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2966184616088867  GigaBytes
Max Memory Allocated: 1.2968125343322754  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.296727180480957  GigaBytes
Max Memory Allocated: 1.2968125343322754  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.307490348815918  GigaBytes
Max Memory Allocated: 1.3082513809204102  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([64, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3083586692810059  GigaBytes
Max Memory Allocated: 1.3083624839782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3083586692810059  GigaBytes
Max Memory Allocated: 1.3083624839782715  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3084807395935059  GigaBytes
Max Memory Allocated: 1.3084807395935059  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3214201927185059  GigaBytes
Max Memory Allocated: 1.3223357200622559  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3222975730895996  GigaBytes
Max Memory Allocated: 1.3223357200622559  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3222975730895996  GigaBytes
Max Memory Allocated: 1.3223357200622559  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3224139213562012  GigaBytes
Max Memory Allocated: 1.3224139213562012  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3355612754821777  GigaBytes
Max Memory Allocated: 1.3364920616149902  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.336352825164795  GigaBytes
Max Memory Allocated: 1.3364920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.336352825164795  GigaBytes
Max Memory Allocated: 1.3364920616149902  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3364520072937012  GigaBytes
Max Memory Allocated: 1.3364920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3483538627624512  GigaBytes
Max Memory Allocated: 1.3491969108581543  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3492040634155273  GigaBytes
Max Memory Allocated: 1.349207878112793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3492040634155273  GigaBytes
Max Memory Allocated: 1.349207878112793  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3493032455444336  GigaBytes
Max Memory Allocated: 1.3493032455444336  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3618993759155273  GigaBytes
Max Memory Allocated: 1.3627920150756836  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3632640838623047  GigaBytes
Max Memory Allocated: 1.3632683753967285  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3632640838623047  GigaBytes
Max Memory Allocated: 1.3632683753967285  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3633785247802734  GigaBytes
Max Memory Allocated: 1.3633785247802734  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.378713607788086  GigaBytes
Max Memory Allocated: 1.3801193237304688  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3800711631774902  GigaBytes
Max Memory Allocated: 1.3801193237304688  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3800711631774902  GigaBytes
Max Memory Allocated: 1.3801193237304688  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3801817893981934  GigaBytes
Max Memory Allocated: 1.3801817893981934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.395780086517334  GigaBytes
Max Memory Allocated: 1.3971858024597168  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3966331481933594  GigaBytes
Max Memory Allocated: 1.3971858024597168  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3966331481933594  GigaBytes
Max Memory Allocated: 1.3971858024597168  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.396718978881836  GigaBytes
Max Memory Allocated: 1.3971858024597168  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4094219207763672  GigaBytes
Max Memory Allocated: 1.410323143005371  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4100980758666992  GigaBytes
Max Memory Allocated: 1.410323143005371  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4100980758666992  GigaBytes
Max Memory Allocated: 1.410323143005371  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4101629257202148  GigaBytes
Max Memory Allocated: 1.410323143005371  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4202146530151367  GigaBytes
Max Memory Allocated: 1.4209280014038086  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4208455085754395  GigaBytes
Max Memory Allocated: 1.4209280014038086  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4208455085754395  GigaBytes
Max Memory Allocated: 1.4209280014038086  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4209027290344238  GigaBytes
Max Memory Allocated: 1.4209280014038086  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4301724433898926  GigaBytes
Max Memory Allocated: 1.430830478668213  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4315581321716309  GigaBytes
Max Memory Allocated: 1.4315624237060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4315581321716309  GigaBytes
Max Memory Allocated: 1.4315624237060547  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4316496849060059  GigaBytes
Max Memory Allocated: 1.4316496849060059  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4471220970153809  GigaBytes
Max Memory Allocated: 1.4485278129577637  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([899, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4686779975891113  GigaBytes
Max Memory Allocated: 1.468761920928955  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4686779975891113  GigaBytes
Max Memory Allocated: 1.468761920928955  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.4703927040100098  GigaBytes
Max Memory Allocated: 1.4703927040100098  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.7735161781311035  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 899, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.7369403839111328  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.7373766899108887  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.7378129959106445  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.7373547554016113  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([2926, 40])
input nodes number: 16727
output nodes number: 2926
edges number: 40949
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.737513542175293  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.7375140190124512  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.033156394958496094  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

pseudo mini batch 9 input nodes size: 49814
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.029366016387939453  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.029366016387939453  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.05311918258666992  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.05314064025878906  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.029764652252197266  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.030787944793701172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.030787944793701172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.030787944793701172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([49814, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.030787944793701172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

m.shape torch.Size([814, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.0858769416809082  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.0858769416809082  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.08665323257446289  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.09310054779052734  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([983, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.09364986419677734  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.09364986419677734  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.09458732604980469  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.10881233215332031  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([968, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1106877326965332  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1106877326965332  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.11161088943481445  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13256120681762695  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([915, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13384485244750977  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13384485244750977  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 915, 128]), torch.Size([1, 915, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13471746444702148  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.16096735000610352  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 915, 128])
m.shape torch.Size([837, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.16252660751342773  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.16252660751342773  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.16332483291625977  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.19314813613891602  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([737, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.19485759735107422  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.19485759735107422  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 737, 128]), torch.Size([1, 737, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.19556045532226562  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2262563705444336  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 737, 128])
m.shape torch.Size([713, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2282848358154297  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2282848358154297  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.22896480560302734  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.26464176177978516  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([605, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.26660966873168945  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.26660966873168945  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.26718664169311523  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.301084041595459  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([557, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.3032827377319336  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.3032827377319336  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.3038139343261719  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.33795881271362305  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([7898, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.3753538131713867  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.3753538131713867  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 7898, 128]), torch.Size([1, 7898, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.3828859329223633  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9321060180664062  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 7898, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.881497859954834  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8958287239074707  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9101595878601074  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.895716667175293  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([15027, 256])
first layer input nodes number: 49814
first layer output nodes number: 15027
edges number: 111775
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9105329513549805  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9248638153076172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9285669326782227  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9285669326782227  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9535002708435059  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9535002708435059  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9543051719665527  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9607443809509277  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([357, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9610285758972168  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9610285758972168  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9617094993591309  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9727702140808105  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([240, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9731221199035645  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9731221199035645  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9735798835754395  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9836506843566895  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([187, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9841408729553223  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9841408729553223  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9844975471496582  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9948410987854004  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([162, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9954414367675781  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9954414367675781  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9957504272460938  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0068740844726562  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0076308250427246  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0076308250427246  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.007932186126709  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.020890712738037  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0215744972229004  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0215744972229004  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0218110084533691  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0336365699768066  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0343260765075684  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0343260765075684  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0345263481140137  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0459418296813965  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0465164184570312  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0465164184570312  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0466651916503906  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0561866760253906  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0569005012512207  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0569005012512207  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0570569038391113  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0681614875793457  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0688762664794922  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0688762664794922  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0690193176269531  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0801773071289062  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0809135437011719  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0809135437011719  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0810470581054688  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0923957824707031  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0931286811828613  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0931286811828613  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0932507514953613  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1044812202453613  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.105093002319336  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.105093002319336  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1051883697509766  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1146297454833984  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.11517333984375  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.11517333984375  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1152515411376953  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1235408782958984  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1241168975830078  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1241168975830078  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1241931915283203  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1328144073486328  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1332664489746094  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1332664489746094  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1333236694335938  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1401901245117188  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1408710479736328  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1408710479736328  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1409492492675781  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1508808135986328  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.151353359222412  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.151353359222412  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1514067649841309  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1585631370544434  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1589789390563965  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1589789390563965  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1590228080749512  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.165208339691162  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1658124923706055  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1658124923706055  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1658716201782227  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1746225357055664  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.175142765045166  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.175142765045166  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1751923561096191  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1828789710998535  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1833405494689941  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1833405494689941  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.183382511138916  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1901803016662598  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1907129287719727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1907129287719727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1907587051391602  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1984949111938477  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([352, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.2076444625854492  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.2076444625854492  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.2083158493041992  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.330946922302246  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 352, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.309028148651123  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.3094501495361328  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.3098721504211426  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.3094286918640137  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([2832, 40])
input nodes number: 15027
output nodes number: 2832
edges number: 25389
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.3095479011535645  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.3095483779907227  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.03272724151611328  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

pseudo mini batch 10 input nodes size: 38038
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.029750347137451172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.029750347137451172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.04788827896118164  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.04790973663330078  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.024135112762451172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.024965763092041016  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.024965763092041016  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.024965763092041016  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([38038, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.024965763092041016  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

m.shape torch.Size([626, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.06536483764648438  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.06536483764648438  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.06596183776855469  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.0709371566772461  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([786, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.07138824462890625  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.07138824462890625  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 786, 128]), torch.Size([1, 786, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.07213783264160156  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.08371734619140625  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 786, 128])
m.shape torch.Size([834, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.08453559875488281  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.08453559875488281  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.08533096313476562  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1028289794921875  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([824, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1040029525756836  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1040029525756836  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.10478878021240234  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.12895488739013672  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([757, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13036680221557617  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13036680221557617  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 757, 128]), torch.Size([1, 757, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1310887336730957  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.15724611282348633  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 757, 128])
m.shape torch.Size([595, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.15858745574951172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.15858745574951172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.15915489196777344  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.18393516540527344  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([566, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.18554067611694336  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.18554067611694336  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1860804557800293  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.21399259567260742  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([527, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.21573305130004883  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.21573305130004883  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.21623563766479492  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.24578237533569336  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([443, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.24820327758789062  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.24820327758789062  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2486257553100586  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2756643295288086  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([5393, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.30116891860961914  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.30116891860961914  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 5393, 128]), torch.Size([1, 5393, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.30631208419799805  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.6731047630310059  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 5393, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.636664867401123  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.6474900245666504  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.6583151817321777  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.6474051475524902  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([11351, 256])
first layer input nodes number: 38038
first layer output nodes number: 11351
edges number: 81446
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.6586008071899414  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.6694259643554688  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.6721324920654297  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.6721324920654297  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

m.shape torch.Size([273, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7020392417907715  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7020392417907715  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7025599479675293  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7075920104980469  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([246, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7078046798706055  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7078046798706055  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7082738876342773  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7153120040893555  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([194, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.71563720703125  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.71563720703125  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7160072326660156  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7241477966308594  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([169, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7246127128601074  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7246127128601074  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7249350547790527  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7342829704284668  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([157, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7348766326904297  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7348766326904297  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7351760864257812  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7459564208984375  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([125, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7465276718139648  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7465276718139648  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7467660903930664  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7570180892944336  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7577939033508301  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7577939033508301  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7580475807189941  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7707314491271973  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7715811729431152  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7715811729431152  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7718234062194824  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7856307029724121  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([142, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7869515419006348  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7869515419006348  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7872223854064941  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8045563697814941  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([122, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8058629035949707  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8058629035949707  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8060956001281738  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8226170539855957  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([102, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.823941707611084  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.823941707611084  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8241362571716309  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8393111228942871  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8406553268432617  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8406553268432617  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8408422470092773  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8567304611206055  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8580789566040039  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8580789566040039  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8582620620727539  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8751077651977539  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.875823974609375  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.875823974609375  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8759384155273438  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.88726806640625  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8880906105041504  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8880906105041504  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.888206958770752  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9005398750305176  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9010663032531738  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9010663032531738  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9011387825012207  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9093289375305176  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9100446701049805  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9100446701049805  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9101324081420898  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9206609725952148  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9214649200439453  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9214649200439453  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9215583801269531  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9334278106689453  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9341483116149902  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9341483116149902  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9342284202575684  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9449629783630371  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.945826530456543  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.945826530456543  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9459161758422852  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9585561752319336  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.959197998046875  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.959197998046875  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9592628479003906  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9688606262207031  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9695048332214355  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9695048332214355  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9695658683776855  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9790263175964355  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9794602394104004  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9794602394104004  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9795002937316895  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9859890937805176  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.986661434173584  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.986661434173584  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9867186546325684  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9963889122009277  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([397, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0058999061584473  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0058999061584473  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0066571235656738  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1428813934326172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 397, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1158452033996582  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1162686347961426  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.116692066192627  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1162471771240234  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([2841, 40])
input nodes number: 11351
output nodes number: 2841
edges number: 29860
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1163549423217773  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.1163554191589355  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.026591777801513672  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

pseudo mini batch 11 input nodes size: 47378
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.02413654327392578  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.02413654327392578  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.04757404327392578  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.04759550094604492  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.029436111450195312  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.030275344848632812  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.030275344848632812  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.030275344848632812  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([47378, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.030275344848632812  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

m.shape torch.Size([902, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.07579326629638672  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.07579326629638672  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.07665348052978516  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.08353519439697266  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([1116, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.08437299728393555  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.08437299728393555  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.08543729782104492  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.10140180587768555  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1148, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.10276174545288086  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.10276174545288086  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 1148, 128]), torch.Size([1, 1148, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.10385656356811523  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.12966680526733398  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 1148, 128])
m.shape torch.Size([1074, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13116788864135742  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13116788864135742  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13219213485717773  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1618952751159668  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1010, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.16379117965698242  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.16379117965698242  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.16475439071655273  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.19959020614624023  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([842, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.20151758193969727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.20151758193969727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.20232057571411133  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2378067970275879  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([688, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2397017478942871  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2397017478942871  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 688, 128]), torch.Size([1, 688, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2403578758239746  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2738652229309082  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 688, 128])
m.shape torch.Size([602, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2758336067199707  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.2758336067199707  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.27640771865844727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.30976343154907227  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([521, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.31171226501464844  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.31171226501464844  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.3122091293334961  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.34487199783325195  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([5674, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.3719673156738281  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.3719673156738281  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 5674, 128]), torch.Size([1, 5674, 128])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.3773784637451172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7707901000976562  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 5674, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7298192977905273  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.742767333984375  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7557153701782227  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7426657676696777  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([13577, 256])
first layer input nodes number: 47378
first layer output nodes number: 13577
edges number: 92037
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.756070613861084  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7690186500549316  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7722558975219727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7722558975219727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

m.shape torch.Size([442, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7924356460571289  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7924356460571289  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.793278694152832  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.800774097442627  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([395, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.801112174987793  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.801112174987793  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8018655776977539  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8148455619812012  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8153886795043945  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8153886795043945  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8159971237182617  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8302531242370605  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([258, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8309412002563477  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8309412002563477  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8314332962036133  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8474283218383789  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([227, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8482732772827148  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8482732772827148  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8487062454223633  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.864293098449707  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8649764060974121  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8649764060974121  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8652739524841309  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8780684471130371  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8788013458251953  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8788013458251953  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8790512084960938  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8915443420410156  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8921961784362793  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8921961784362793  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.8923888206481934  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9033694267272949  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9040260314941406  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9040260314941406  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9041919708251953  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9148120880126953  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9154500961303711  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9154500961303711  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.915593147277832  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9257497787475586  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9264926910400391  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9264926910400391  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9266395568847656  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9380950927734375  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9387598037719727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9387598037719727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9388818740844727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9492578506469727  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.949821949005127  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.949821949005127  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9499173164367676  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9586911201477051  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9591951370239258  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9591951370239258  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9592733383178711  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.967015266418457  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9675674438476562  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9675674438476562  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9676456451416016  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9759349822998047  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.976280689239502  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.976280689239502  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9763283729553223  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9817166328430176  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9821343421936035  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9821343421936035  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9821858406066895  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.988365650177002  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9887208938598633  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9887208938598633  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9887628555297852  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9940919876098633  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.994692325592041  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.994692325592041  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9947571754455566  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0034470558166504  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.003760814666748  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.003760814666748  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0037951469421387  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0086359977722168  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0089421272277832  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0089421272277832  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0089726448059082  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0134892463684082  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.013791561126709  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.013791561126709  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0138201713562012  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0182547569274902  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0184836387634277  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0184836387634277  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0185046195983887  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0219035148620605  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0222392082214355  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0222392082214355  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0222678184509277  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0271029472351074  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([195, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0317745208740234  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0317745208740234  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0321464538574219  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0976066589355469  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 195, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.081160545349121  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0815844535827637  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0820083618164062  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0815629959106445  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([2842, 40])
input nodes number: 13577
output nodes number: 2842
edges number: 20419
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0816864967346191  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0816869735717773  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.031958580017089844  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

pseudo mini batch 12 input nodes size: 54154
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.029436588287353516  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.029436588287353516  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.05525922775268555  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.05528068542480469  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.03182172775268555  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.03321409225463867  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.03321409225463867  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.03321409225463867  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([54154, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.03321409225463867  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

m.shape torch.Size([569, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.10755157470703125  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.10755157470703125  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.1080942153930664  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.11287117004394531  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([758, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.11332273483276367  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.11332273483276367  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 758, 128]), torch.Size([1, 758, 128])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.11404561996459961  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.1257624626159668  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 758, 128])
m.shape torch.Size([764, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.1264939308166504  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.1264939308166504  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.12722253799438477  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.1436772346496582  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([728, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.14470148086547852  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.14470148086547852  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 728, 128]), torch.Size([1, 728, 128])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.14539575576782227  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.16600275039672852  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 728, 128])
m.shape torch.Size([712, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.16765451431274414  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.16765451431274414  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 712, 128]), torch.Size([1, 712, 128])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.1683335304260254  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.1936326026916504  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 712, 128])
m.shape torch.Size([598, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.19550561904907227  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.19550561904907227  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.1960759162902832  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.22091150283813477  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([572, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.2232203483581543  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.2232203483581543  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.22376585006713867  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.2526583671569824  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([576, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.25458288192749023  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.25458288192749023  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.25513219833374023  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.2879157066345215  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([537, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.2899456024169922  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.2899456024169922  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.29045772552490234  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.32483720779418945  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([12243, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.38296031951904297  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.38296031951904297  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 12243, 128]), torch.Size([1, 12243, 128])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.3946361541748047  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2260451316833496  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 12243, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1561665534973145  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.173830509185791  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1910510063171387  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1732521057128906  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

torch.Size([18057, 256])
first layer input nodes number: 54154
first layer output nodes number: 18057
edges number: 150312
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1914567947387695  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2086772918701172  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2137389183044434  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2137389183044434  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

m.shape torch.Size([293, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.249143123626709  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.249143123626709  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.249701976776123  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.255781650543213  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([250, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2559828758239746  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2559828758239746  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2564597129821777  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2636122703552246  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([192, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2639274597167969  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2639274597167969  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2642936706542969  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2723503112792969  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([159, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2727785110473633  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2727785110473633  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2730817794799805  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.281876564025879  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([141, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2824029922485352  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2824029922485352  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2826719284057617  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.292353630065918  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([101, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.292801856994629  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.292801856994629  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.292994499206543  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3012781143188477  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([72, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.301666259765625  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.301666259765625  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3018035888671875  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3086700439453125  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([65, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3091015815734863  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3091015815734863  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3092255592346191  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3162922859191895  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3168964385986328  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3168964385986328  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3170433044433594  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3264427185058594  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3270230293273926  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3270230293273926  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3271527290344238  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3363614082336426  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3369417190551758  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3369417190551758  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3370580673217773  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3461332321166992  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.346663475036621  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.346663475036621  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3467607498168945  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3550291061401367  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3558177947998047  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3558177947998047  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3559455871582031  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3677024841308594  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3683114051818848  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3683114051818848  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3684067726135254  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3778481483459473  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3785934448242188  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3785934448242188  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3786983489990234  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3898181915283203  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3905653953552246  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3905653953552246  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3906645774841309  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.401872158050537  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4024925231933594  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4024925231933594  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4025707244873047  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4119548797607422  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4127984046936035  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4127984046936035  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.412895679473877  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4252495765686035  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4258766174316406  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4258766174316406  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4259471893310547  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.435403823852539  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4360222816467285  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4360222816467285  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4360871315002441  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4452309608459473  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4460463523864746  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4460463523864746  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4461264610290527  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4579825401306152  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4586191177368164  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4586191177368164  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4586801528930664  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4681406021118164  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.468883991241455  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.468883991241455  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4689507484436035  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4797654151916504  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4803318977355957  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4803318977355957  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4803814888000488  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.488762378692627  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([807, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.5084195137023926  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.5084195137023926  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

 h.shape torch.Size([1, 807, 256]), torch.Size([1, 807, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.5099587440490723  GigaBytes
Max Memory Allocated: 1.794950008392334  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7845478057861328  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 807, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7517080307006836  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7521343231201172  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7525606155395508  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.752112865447998  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

torch.Size([2859, 40])
input nodes number: 18057
output nodes number: 2859
edges number: 36412
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7522716522216797  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.752272129058838  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03572225570678711  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

pseudo mini batch 13 input nodes size: 54513
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03182411193847656  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03182411193847656  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.057817935943603516  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.05783891677856445  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03199481964111328  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03336906433105469  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03336906433105469  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03336906433105469  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

torch.Size([54513, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03336906433105469  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

m.shape torch.Size([511, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.10767555236816406  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.10767555236816406  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.10816287994384766  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.1120615005493164  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([723, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.11250734329223633  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.11250734329223633  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.11319684982299805  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.12353944778442383  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([753, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.12454462051391602  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.12454462051391602  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.12526273727416992  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.1416335105895996  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([764, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.14293956756591797  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.14293956756591797  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.14366817474365234  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.16485881805419922  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([710, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.16618728637695312  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.16618728637695312  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.16686439514160156  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.1922597885131836  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 710, 128])
m.shape torch.Size([666, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.19382667541503906  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.19382667541503906  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.19446182250976562  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.22264480590820312  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([656, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.2245168685913086  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.2245168685913086  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.2251424789428711  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.2579946517944336  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([642, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.2601308822631836  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.2601308822631836  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.2607431411743164  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.2976827621459961  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([652, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.3001747131347656  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.3001747131347656  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.3007965087890625  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.34187889099121094  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([11955, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.3985738754272461  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.3985738754272461  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 11955, 128]), torch.Size([1, 11955, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.4099750518798828  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.237083911895752  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 11955, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.167372703552246  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1845693588256836  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.201766014099121  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1844348907470703  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

torch.Size([18032, 256])
first layer input nodes number: 54513
first layer output nodes number: 18032
edges number: 149964
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.202174186706543  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2193708419799805  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.223912239074707  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.223912239074707  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

m.shape torch.Size([243, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2573223114013672  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2573223114013672  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2577857971191406  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2614936828613281  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([224, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2616925239562988  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2616925239562988  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2621197700500488  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2685284614562988  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([197, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.268883228302002  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.268883228302002  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.269258975982666  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2775254249572754  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([167, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.277979850769043  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.277979850769043  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2782983779907227  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2875356674194336  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([126, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2879819869995117  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2879819869995117  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.288222312927246  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2968740463256836  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([93, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.297290325164795  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.297290325164795  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2974677085876465  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3050951957702637  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([98, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3056659698486328  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3056659698486328  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3058528900146484  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3151988983154297  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([81, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3157286643981934  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3157286643981934  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3158831596374512  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3246893882751465  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3254342079162598  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3254342079162598  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.325615406036377  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.337212085723877  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.337881088256836  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.337881088256836  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3380317687988281  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3487300872802734  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3492894172668457  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3492894172668457  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3494038581848145  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.358330249786377  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3589882850646973  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3589882850646973  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3591065406799316  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3691582679748535  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.369823932647705  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.369823932647705  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3699345588684082  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3801121711730957  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3806896209716797  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3806896209716797  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3807792663574219  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3896541595458984  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([58, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3904457092285156  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3904457092285156  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3905563354492188  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.40228271484375  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.403027057647705  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.403027057647705  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4031262397766113  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4143338203430176  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4151015281677246  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4151015281677246  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4151968955993652  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4266409873962402  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4275450706481934  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4275450706481934  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.427649974822998  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4409728050231934  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4417786598205566  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4417786598205566  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4418683052062988  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.453880786895752  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4547972679138184  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4547972679138184  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.454892635345459  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.468339443206787  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4692206382751465  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4692206382751465  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4693083763122559  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4822936058044434  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.482926368713379  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.482926368713379  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.482987403869629  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.492447853088379  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4931249618530273  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4931249618530273  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4931859970092773  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.5030736923217773  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.5037121772766113  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.5037121772766113  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.503767490386963  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.513115406036377  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([677, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.5294742584228516  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.5294742584228516  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 677, 256]), torch.Size([1, 677, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.5307655334472656  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.758418083190918  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 677, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7275352478027344  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7279462814331055  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7283573150634766  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7279253005981445  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

torch.Size([2758, 40])
input nodes number: 18032
output nodes number: 2758
edges number: 34395
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7280654907226562  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.7280659675598145  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03582572937011719  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

pseudo mini batch 14 input nodes size: 47343
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03197956085205078  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.03197956085205078  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.05541706085205078  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.055438995361328125  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.029424190521240234  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.030823230743408203  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.030823230743408203  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.030823230743408203  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

torch.Size([47343, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.030823230743408203  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

m.shape torch.Size([445, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.10172367095947266  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.10172367095947266  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.10214805603027344  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.10554313659667969  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([555, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.10586023330688477  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.10586023330688477  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.10638952255249023  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.11444568634033203  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([572, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.11499929428100586  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.11499929428100586  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.11554479598999023  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.12845182418823242  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([588, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.12930059432983398  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.12930059432983398  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 588, 128]), torch.Size([1, 588, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.12986135482788086  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.14668798446655273  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 588, 128])
m.shape torch.Size([580, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.14779043197631836  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.14779043197631836  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.14834356307983398  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.16921567916870117  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([570, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.17056989669799805  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.17056989669799805  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.1711134910583496  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.1956191062927246  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([536, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.19713640213012695  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.19713640213012695  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.1976475715637207  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.22440767288208008  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([478, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.22597551345825195  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.22597551345825195  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.22643136978149414  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.25241518020629883  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([452, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.25412702560424805  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.25412702560424805  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.25455808639526367  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.28214597702026367  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([12106, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.34052419662475586  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.34052419662475586  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 12106, 128]), torch.Size([1, 12106, 128])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.3520693778991699  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.181236743927002  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 12106, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1140456199645996  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.13014554977417  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1462454795837402  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1300196647644043  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

torch.Size([16882, 256])
first layer input nodes number: 47343
first layer output nodes number: 16882
edges number: 144647
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1466002464294434  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1627001762390137  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1669535636901855  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.1669535636901855  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

m.shape torch.Size([201, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2085156440734863  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2085156440734863  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2088990211486816  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2119660377502441  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([171, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2121033668518066  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2121033668518066  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2124295234680176  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2173218727111816  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([153, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2176003456115723  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2176003456115723  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2178921699523926  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2243123054504395  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([128, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.224658489227295  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.224658489227295  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.224902629852295  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.231982707977295  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([114, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2324085235595703  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2324085235595703  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.232625961303711  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2404537200927734  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([107, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2409625053405762  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2409625053405762  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.241166591644287  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2499423027038574  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([89, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.250439167022705  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.250439167022705  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2506089210510254  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.259096622467041  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([68, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2595348358154297  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2595348358154297  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.259664535522461  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2670574188232422  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2676501274108887  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2676501274108887  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2677950859069824  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2770724296569824  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2776827812194824  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2776827812194824  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.277818202972412  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.28743314743042  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2880949974060059  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2880949974060059  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.28822660446167  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2984919548034668  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2991414070129395  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2991414070129395  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.2992596626281738  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3093113899230957  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3099894523620605  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3099894523620605  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3101019859313965  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3204550743103027  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.32124662399292  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.32124662399292  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.321366786956787  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3332629203796387  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3340106010437012  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3340106010437012  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3341174125671387  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3454394340515137  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.346170425415039  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.346170425415039  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3462677001953125  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.357259750366211  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.358109951019287  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.358109951019287  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3582148551940918  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3708033561706543  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.371920108795166  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.371920108795166  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.3720402717590332  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.387300968170166  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.388117790222168  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.388117790222168  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.388209342956543  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.400477409362793  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4022650718688965  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4022650718688965  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4023642539978027  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.416348934173584  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4175105094909668  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4175105094909668  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4176249504089355  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4345622062683105  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4353933334350586  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4353933334350586  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4354734420776367  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.447890281677246  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.448646068572998  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.448646068572998  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4487147331237793  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4598383903503418  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4607501029968262  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4607501029968262  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4608283042907715  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4740443229675293  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([992, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4979748725891113  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4979748725891113  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

 h.shape torch.Size([1, 992, 256]), torch.Size([1, 992, 256])
----------------------------------------3
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.4998669624328613  GigaBytes
Max Memory Allocated: 1.8040790557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4354248046875 GB
    Memory Allocated: 1.8424115180969238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 992, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4354248046875 GB
    Memory Allocated: 1.8047809600830078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4354248046875 GB
    Memory Allocated: 1.8052172660827637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4354248046875 GB
    Memory Allocated: 1.8056535720825195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4354248046875 GB
    Memory Allocated: 1.8051953315734863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2927, 40])
input nodes number: 16882
output nodes number: 2927
edges number: 42912
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4354248046875 GB
    Memory Allocated: 1.805368423461914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4354248046875 GB
    Memory Allocated: 1.8053689002990723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03333139419555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 15 input nodes size: 52673
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029449462890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029449462890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0545659065246582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05458688735961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.031127452850341797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03241395950317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03241395950317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03241395950317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([52673, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03241395950317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([549, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1007847785949707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1007847785949707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10130834579467773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10650968551635742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([719, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10693359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10693359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 719, 128]), torch.Size([1, 719, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1076192855834961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1179046630859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 719, 128])
m.shape torch.Size([747, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11863040924072266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11863040924072266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11934280395507812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13533592224121094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([710, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13633394241333008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13633394241333008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13701105117797852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1575322151184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 710, 128])
m.shape torch.Size([703, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15886974334716797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15886974334716797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15954017639160156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1842656135559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([638, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.18575572967529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.18575572967529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.18636417388916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2140493392944336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([629, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.21584463119506836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.21584463119506836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2164444923400879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24828004837036133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([577, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2501811981201172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2501811981201172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2507314682006836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28322649002075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([561, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28586578369140625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28586578369140625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28640079498291016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.32064151763916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([11084, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3732266426086426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3732266426086426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11084, 128]), torch.Size([1, 11084, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.38379716873168945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.137056827545166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11084, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0730838775634766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.089217185974121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1053504943847656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0890908241271973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([16917, 256])
first layer input nodes number: 52673
first layer output nodes number: 16917
edges number: 139319
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1057453155517578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1218786239624023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1261072158813477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1261072158813477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([265, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.158463954925537  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.158463954925537  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1589694023132324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.16316556930542  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([237, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1633687019348145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1633687019348145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.163820743560791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1706013679504395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([186, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1709117889404297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1709117889404297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1712665557861328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1790714263916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([151, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1794748306274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1794748306274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.179762840270996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.188115119934082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([120, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1885480880737305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1885480880737305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.188776969909668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.197016716003418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([115, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1975655555725098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1975655555725098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1977849006652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.207216739654541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([106, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2078204154968262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2078204154968262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2080225944519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2181315422058105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.21876859664917  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.21876859664917  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.21895170211792  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.22938871383667  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2300238609313965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2300238609313965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2301840782165527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2404379844665527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2411751747131348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2411751747131348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2413372993469238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2528481483459473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2535390853881836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2535390853881836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.253678321838379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2645387649536133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([89, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2656254768371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2656254768371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2657952308654785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.280224323272705  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([82, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2812957763671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2812957763671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2814521789550781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2958412170410156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2965302467346191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2965302467346191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2966389656066895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3074021339416504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3081121444702148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3081121444702148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.308213233947754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3189287185668945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3197393417358398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3197393417358398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3198461532592773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3319158554077148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.332810401916504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.332810401916504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.332921028137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.346196174621582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3469886779785156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3469886779785156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3470821380615234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3589515686035156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3597450256347656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3597450256347656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.359832763671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3715896606445312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.37229585647583  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.37229585647583  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3723702430725098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3828587532043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3836493492126465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3836493492126465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3837275505065918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.395301342010498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3958120346069336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3958120346069336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3958616256713867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.403548240661621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4041204452514648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4041204452514648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4041719436645508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4125146865844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4132733345031738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4132733345031738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4133381843566895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.42429780960083  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([606, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.438826560974121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.438826560974121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4399824142456055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.6457090377807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 606, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.6166791915893555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.6170940399169922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.617508888244629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.6170730590820312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2781, 40])
input nodes number: 16917
output nodes number: 2781
edges number: 33275
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.6171989440917969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.617199420928955  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03473091125488281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 16 input nodes size: 42190
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.031105995178222656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.031105995178222656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0512237548828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05124521255493164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0261077880859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.026927947998046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.026927947998046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.026927947998046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([42190, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.026927947998046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([773, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.06941080093383789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.06941080093383789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07014799118041992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0764164924621582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([1013, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07701396942138672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07701396942138672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07798004150390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.09305477142333984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([989, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.09398651123046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.09398651123046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.09492969512939453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11650609970092773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 989, 128])
m.shape torch.Size([888, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11832141876220703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11832141876220703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 888, 128]), torch.Size([1, 888, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11916828155517578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.14372730255126953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 888, 128])
m.shape torch.Size([884, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.14541149139404297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.14541149139404297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 884, 128]), torch.Size([1, 884, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1462545394897461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1766042709350586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 884, 128])
m.shape torch.Size([722, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17824840545654297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17824840545654297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 722, 128]), torch.Size([1, 722, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17893695831298828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20998477935791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 722, 128])
m.shape torch.Size([701, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.21198034286499023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.21198034286499023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.21264886856079102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24607515335083008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([595, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24801063537597656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24801063537597656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24857807159423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2820553779602051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([536, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2840719223022461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2840719223022461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28458309173583984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31847095489501953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([5219, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.34310150146484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.34310150146484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5219, 128]), torch.Size([1, 5219, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.34807872772216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7016253471374512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5219, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.663759708404541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.675508975982666  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.687258243560791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6754169464111328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([12320, 256])
first layer input nodes number: 42190
first layer output nodes number: 12320
edges number: 84751
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6875748634338379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6993241310119629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.703026294708252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.703026294708252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([366, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7276492118835449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7276492118835449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7283473014831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7350363731384277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([347, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7353544235229492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7353544235229492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7360162734985352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7492809295654297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([241, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7496452331542969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7496452331542969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7501049041748047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7602176666259766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([187, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.760706901550293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.760706901550293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7610635757446289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7714071273803711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([180, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7720942497253418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7720942497253418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.772437572479248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.784797191619873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.785548210144043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.785548210144043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.785853385925293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.798975944519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7996845245361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7996845245361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7999286651611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8121356964111328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([143, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8132510185241699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8132510185241699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8135237693786621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8290705680847168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8298773765563965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8298773765563965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.830085277557373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.843390941619873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8442673683166504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8442673683166504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8444619178771973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8582749366760254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([87, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8590974807739258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8590974807739258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8592634201049805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8722066879272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([80, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8730463981628418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8730463981628418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8731989860534668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8861689567565918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8869800567626953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8869800567626953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.887115478515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8995742797851562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9001932144165039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9001932144165039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9002904891967773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9099206924438477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9106650352478027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9106650352478027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9107699394226074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9218897819519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9226832389831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9226832389831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.922788143157959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9346423149108887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.935178279876709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.935178279876709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9352469444274902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9434866905212402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.944023609161377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.944023609161377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9440865516662598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.952080249786377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9529070854187012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9529070854187012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9529967308044434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9650092124938965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9655413627624512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9655413627624512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9655985832214355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9736666679382324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9742236137390137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9742236137390137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9742789268493652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9824652671813965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9830508232116699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9830508232116699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9831061363220215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9916796684265137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9921607971191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9921607971191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9922046661376953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9993114471435547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9997282028198242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9997282028198242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9997644424438477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0058889389038086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([260, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0121183395385742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0121183395385742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0126142501831055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1063499450683594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 260, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0848078727722168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.085235595703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0856633186340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0852141380310059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2868, 40])
input nodes number: 12320
output nodes number: 2868
edges number: 25122
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0853404998779297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.085340976715088  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.028572559356689453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 17 input nodes size: 51281
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.026120662689208984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.026120662689208984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05057334899902344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05059480667114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030455589294433594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03127574920654297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03127574920654297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03127574920654297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([51281, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03127574920654297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1037, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07778310775756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07778310775756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07877206802368164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08771419525146484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([1268, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08842897415161133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08842897415161133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1268, 128]), torch.Size([1, 1268, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08963823318481445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10777711868286133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1268, 128])
m.shape torch.Size([1217, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10891342163085938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10891342163085938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1217, 128]), torch.Size([1, 1217, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11007404327392578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13612127304077148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1217, 128])
m.shape torch.Size([1101, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13764095306396484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13764095306396484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13869094848632812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16969585418701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1049, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17167186737060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17167186737060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1049, 128]), torch.Size([1, 1049, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17267227172851562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20868682861328125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1049, 128])
m.shape torch.Size([805, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.21048974990844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.21048974990844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2112574577331543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24640607833862305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([661, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24852848052978516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24852848052978516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2491588592529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2814369201660156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([591, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28337621688842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28337621688842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28393983840942383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31687498092651367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([528, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3188591003417969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3188591003417969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3193626403808594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3536543846130371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([5810, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3811068534851074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3811068534851074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5810, 128]), torch.Size([1, 5810, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.38664770126342773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7839245796203613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5810, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7428112030029297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7562265396118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7696418762207031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7561216354370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([14067, 256])
first layer input nodes number: 51281
first layer output nodes number: 14067
edges number: 93910
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7700262069702148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7834415435791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7867956161499023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7867956161499023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([534, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8029079437255859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8029079437255859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8039264678955078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8131809234619141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([451, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8135390281677246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8135390281677246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.814399242401123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8273453712463379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([370, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8281979560852051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8281979560852051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8289036750793457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8447146415710449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([268, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8456439971923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8456439971923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8461551666259766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8629398345947266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([270, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8639822006225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8639822006225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.864497184753418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8832464218139648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8840022087097168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8840022087097168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.884335994720459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.898688793182373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.899329662322998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.899329662322998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8995585441589355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9110026359558105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9117803573608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9117803573608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9120016098022461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9246129989624023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.925142765045166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.925142765045166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9252839088439941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9343171119689941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([58, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9348044395446777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9348044395446777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9349150657653809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9427695274353027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.943232536315918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.943232536315918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9433259963989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9506158828735352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9510769844055176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9510769844055176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9511609077453613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9582943916320801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9586524963378906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9586524963378906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9587135314941406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9643287658691406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([16, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9645137786865234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9645137786865234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9645442962646484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9675655364990234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9678821563720703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9678821563720703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.967926025390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9725761413574219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.972815990447998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.972815990447998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9728484153747559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9765124320983887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9767904281616211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9767904281616211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9768247604370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9809446334838867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9811697006225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9811697006225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.981196403503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9845876693725586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9848666191101074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9848666191101074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9848971366882324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9889864921569824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9892406463623047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9892406463623047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9892673492431641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9930324554443359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9931607246398926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9931607246398926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9931740760803223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.995150089263916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9953975677490234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9953975677490234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9954204559326172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9989681243896484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9990673065185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9990673065185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9990768432617188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0006217956542969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0007095336914062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0007095336914062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0007171630859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0020065307617188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([119, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0048623085021973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0048623085021973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.005089282989502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.045036792755127  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 119, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0325579643249512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0329794883728027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0334010124206543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0329580307006836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2826, 40])
input nodes number: 14067
output nodes number: 2826
edges number: 16095
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0330781936645508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.033078670501709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03293943405151367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 18 input nodes size: 48382
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030449390411376953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030449390411376953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05388689041137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.053908348083496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0294342041015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030200958251953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030200958251953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030200958251953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48382, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030200958251953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1004, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0731344223022461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0731344223022461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1004, 128]), torch.Size([1, 1004, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07409191131591797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08175182342529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1004, 128])
m.shape torch.Size([1236, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0830082893371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0830082893371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1236, 128]), torch.Size([1, 1236, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08418703079223633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10224199295043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1236, 128])
m.shape torch.Size([1221, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10339927673339844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10339927673339844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1221, 128]), torch.Size([1, 1221, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10456371307373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13085508346557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1221, 128])
m.shape torch.Size([1028, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1322336196899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1322336196899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13321399688720703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16164493560791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([905, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16331243515014648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16331243515014648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16417551040649414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19655418395996094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([806, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19842863082885742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19842863082885742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19919729232788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23416471481323242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([620, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23584985733032227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23584985733032227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23644113540649414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26635026931762695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([593, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26831674575805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26831674575805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26888227462768555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3017754554748535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([523, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30373716354370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30373716354370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30423593521118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.33803844451904297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([5223, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.36269426345825195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.36269426345825195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5223, 128]), torch.Size([1, 5223, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3676753044128418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7215862274169922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5223, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6838068962097168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6972823143005371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.709831714630127  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6962580680847168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13159, 256])
first layer input nodes number: 48382
first layer output nodes number: 13159
edges number: 86633
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7101941108703613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7227435111999512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7260379791259766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7260379791259766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([532, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7422237396240234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7422237396240234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7432384490966797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7515606880187988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([456, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7519302368164062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7519302368164062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7527999877929688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7659492492675781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([352, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.766545295715332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.766545295715332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.767216682434082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.783350944519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([260, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7841191291809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7841191291809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7846150398254395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8004031181335449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([221, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8012175559997559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8012175559997559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8016390800476074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8168139457702637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([192, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8177103996276855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8177103996276855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8180766105651855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8338236808776855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([145, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8346161842346191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8346161842346191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.834892749786377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8487210273742676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8494439125061035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8494439125061035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8496575355529785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8618340492248535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8625926971435547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8625926971435547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8627834320068359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8749904632568359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8755202293395996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8755202293395996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8756442070007324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8844466209411621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8850507736206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8850507736206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8851709365844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8945436477661133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8949799537658691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8949799537658691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8950619697570801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9020333290100098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9023923873901367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9023923873901367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9024534225463867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9080686569213867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9085092544555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9085092544555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9085760116577148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9151849746704102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9155411720275879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9155411720275879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9155926704406738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9210515022277832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9213643074035645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9213643074035645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9214062690734863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9261479377746582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9263720512390137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9263720512390137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9264006614685059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9298338890075684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9301314353942871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9301314353942871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9301657676696777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9345259666442871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9347100257873535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9347100257873535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9347310066223145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9375424385070801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9377245903015137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9377245903015137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9377436637878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9404330253601074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9405851364135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9405851364135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9406003952026367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9428586959838867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9430418014526367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9430418014526367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.943058967590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9457197189331055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9457998275756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9457998275756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9458074569702148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9470434188842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9471321105957031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9471321105957031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9471397399902344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9484291076660156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([100, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9508285522460938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9508285522460938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.951019287109375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.984588623046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 100, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9716987609863281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9721217155456543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9725446701049805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9721002578735352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2836, 40])
input nodes number: 13159
output nodes number: 2836
edges number: 16172
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9722213745117188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.972221851348877  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03177785873413086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 19 input nodes size: 48216
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.02943563461303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.02943563461303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05287313461303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05289459228515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.02943563461303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030192852020263672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030192852020263672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030192852020263672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48216, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030192852020263672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([994, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07281923294067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07281923294067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 994, 128]), torch.Size([1, 994, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07376718521118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08135080337524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 994, 128])
m.shape torch.Size([1229, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08204889297485352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08204889297485352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1229, 128]), torch.Size([1, 1229, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0832209587097168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10097265243530273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1229, 128])
m.shape torch.Size([1192, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10272884368896484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10272884368896484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1192, 128]), torch.Size([1, 1192, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1038656234741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1292257308959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1192, 128])
m.shape torch.Size([1098, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13128185272216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13128185272216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13232898712158203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16269588470458984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([931, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16439199447631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16439199447631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16527986526489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19724321365356445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([774, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19901371002197266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19901371002197266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1997518539428711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23212194442749023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([664, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23396921157836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23396921157836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2346024513244629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26787805557250977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([568, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2697281837463379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2697281837463379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.27026987075805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30306100845336914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([466, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30479001998901367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30479001998901367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.305234432220459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.333676815032959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([5173, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.358121395111084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.358121395111084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5173, 128]), torch.Size([1, 5173, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3632650375366211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7137436866760254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5173, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6760401725769043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6885228157043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7010054588317871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6884250640869141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13089, 256])
first layer input nodes number: 48216
first layer output nodes number: 13089
edges number: 85835
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7013669013977051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7138495445251465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7172727584838867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7172727584838867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([532, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7329568862915039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7329568862915039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7339715957641602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7427945137023926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([458, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7431678771972656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7431678771972656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7440414428710938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7577576637268066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([371, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7583937644958496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7583937644958496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.759101390838623  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7779068946838379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([275, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7786259651184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7786259651184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7791504859924316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7950997352600098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([233, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7959575653076172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7959575653076172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7964019775390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8124008178710938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([187, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8132572174072266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8132572174072266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8136138916015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8289508819580078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8296809196472168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8296809196472168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8299384117126465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8428130149841309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8435535430908203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8435535430908203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8437690734863281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8560543060302734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8567080497741699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8567080497741699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8568758964538574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8676180839538574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8682551383972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8682551383972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8683981895446777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8785548210144043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.879096508026123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.879096508026123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8792071342468262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8878359794616699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.888369083404541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.888369083404541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8884663581848145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8967347145080566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([26, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8970112800598145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8970112800598145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8970608711242676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9016232490539551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9020967483520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9020967483520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9021673202514648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.909153938293457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9094791412353516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9094791412353516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9095268249511719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.914581298828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9148497581481934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9148497581481934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9148859977722168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9189810752868652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.919224739074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.919224739074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.919255256652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.922917366027832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9230751991271973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9230751991271973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9230942726135254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9255166053771973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9257445335388184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9257445335388184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9257693290710449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9290919303894043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9292144775390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9292144775390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9292278289794922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9311103820800781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9312653541564941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9312653541564941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9312806129455566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9335389137268066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9336795806884766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9336795806884766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9336929321289062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9357624053955078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9358444213867188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9358444213867188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.93585205078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9370880126953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9371304512023926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9371304512023926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9371342658996582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9377789497375488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([89, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.939915657043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.939915657043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9400854110717773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9699621200561523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 89, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9575834274291992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9580068588256836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.958430290222168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9579854011535645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2839, 40])
input nodes number: 13089
output nodes number: 2839
edges number: 15650
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9581050872802734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9581055641174316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0317535400390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 20 input nodes size: 49609
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029436111450195312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029436111450195312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05309152603149414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05311298370361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.02965402603149414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030452251434326172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030452251434326172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030452251434326172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49609, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030452251434326172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1032, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07542800903320312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07542800903320312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1032, 128]), torch.Size([1, 1032, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07641220092773438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08428573608398438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1032, 128])
m.shape torch.Size([1197, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08540678024291992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08540678024291992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1197, 128]), torch.Size([1, 1197, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0865483283996582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10428953170776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1197, 128])
m.shape torch.Size([1160, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1054387092590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1054387092590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1160, 128]), torch.Size([1, 1160, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10654497146606445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13205385208129883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1160, 128])
m.shape torch.Size([1033, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13347101211547852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13347101211547852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1033, 128]), torch.Size([1, 1033, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13445615768432617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1630253791809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1033, 128])
m.shape torch.Size([963, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16482877731323242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16482877731323242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16574716567993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20023584365844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([753, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20193099975585938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20193099975585938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20264911651611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23419713973999023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([648, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23600101470947266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23600101470947266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2366189956665039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2688112258911133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([565, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2706575393676758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2706575393676758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2711963653564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30379390716552734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([494, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30564451217651367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30564451217651367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30611562728881836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.33626699447631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([5692, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.363375186920166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.363375186920166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5692, 128]), torch.Size([1, 5692, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.36922216415405273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7643923759460449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5692, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7240471839904785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7369570732116699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7498669624328613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7368559837341309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13537, 256])
first layer input nodes number: 49609
first layer output nodes number: 13537
edges number: 90793
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7502388954162598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7631487846374512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.766395092010498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.766395092010498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([558, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7826452255249023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7826452255249023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7837095260620117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7924060821533203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([460, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7927584648132324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7927584648132324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7936358451843262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8073782920837402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([352, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8079547882080078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8079547882080078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8086261749267578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8240146636962891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([276, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8247480392456055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8247480392456055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8252744674682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8412656784057617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.842315673828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.842315673828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8427314758300781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8577003479003906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8584442138671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8584442138671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8587589263916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8722915649414062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([109, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8728675842285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8728675842285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8730754852294922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8834705352783203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8842358589172363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8842358589172363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8844513893127441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8967366218566895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8974509239196777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8974509239196777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8976321220397949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9092288017272949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9098882675170898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9098882675170898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9100370407104492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9205999374389648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.921234130859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.921234130859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9213619232177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9313297271728516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9318194389343262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9318194389343262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9319109916687012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9396929740905762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([33, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9400596618652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9400596618652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9401226043701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9459133148193359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9461779594421387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9461779594421387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9462199211120605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9503741264343262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9506993293762207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9506993293762207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9507451057434082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9555974006652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.955866813659668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.955866813659668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9559030532836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9599981307983398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9603886604309082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9603886604309082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9604363441467285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.966158390045166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9663596153259277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9663596153259277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9663844108581543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9695334434509277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9696674346923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9696674346923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9696826934814453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9717273712158203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9719891548156738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9719891548156738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9720158576965332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9757809638977051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9758687019348145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9758687019348145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9758782386779785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9772896766662598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.977412223815918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.977412223815918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9774236679077148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9791975021362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.979346752166748  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.979346752166748  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9793601036071777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9815230369567871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9817242622375488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9817242622375488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9817414283752441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.984642505645752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([111, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9873013496398926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9873013496398926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9875130653381348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0247750282287598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 111, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0118341445922852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0122566223144531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.012679100036621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.012235164642334  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2835, 40])
input nodes number: 13537
output nodes number: 2835
edges number: 16214
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0123567581176758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.012357234954834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.032076358795166016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 21 input nodes size: 48340
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029653072357177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029653072357177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.053090572357177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05311155319213867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029434680938720703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03018045425415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03018045425415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03018045425415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48340, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03018045425415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([979, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07279205322265625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07279205322265625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07372570037841797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08119487762451172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([1192, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08186483383178711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08186483383178711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1192, 128]), torch.Size([1, 1192, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08300161361694336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10048627853393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1192, 128])
m.shape torch.Size([1103, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10149574279785156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10149574279785156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10254764556884766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.12568950653076172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1052, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.12717008590698242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.12717008590698242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1281733512878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15726804733276367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([952, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15903615951538086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15903615951538086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1599440574645996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1942763328552246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([827, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19618844985961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19618844985961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1969771385192871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23201227188110352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([647, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23377752304077148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23377752304077148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23439455032348633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2673149108886719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([563, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26915407180786133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26915407180786133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26969099044799805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30057477951049805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([481, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.302370548248291  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.302370548248291  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3028292655944824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3321871757507324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([5164, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3565816879272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3565816879272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5164, 128]), torch.Size([1, 5164, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.36176395416259766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7121148109436035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5164, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6743102073669434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6866698265075684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6990294456481934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6865730285644531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([12960, 256])
first layer input nodes number: 48340
first layer output nodes number: 12960
edges number: 85604
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6993918418884277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7117514610290527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7152533531188965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7152533531188965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([542, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7297043800354004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7297043800354004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7307381629943848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7396893501281738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([479, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7400932312011719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7400932312011719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7410068511962891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7549629211425781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([385, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7557435035705566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7557435035705566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7564778327941895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7748246192932129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([285, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.775810718536377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.775810718536377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7763543128967285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7926640510559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([253, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7936081886291504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7936081886291504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.794090747833252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8114628791809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.812201976776123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.812201976776123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8125262260437012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8264689445495605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8272490501403809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8272490501403809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8275160789489746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8408675193786621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8415646553039551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8415646553039551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8417706489562988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8535122871398926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8542051315307617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8542051315307617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8543806076049805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8656110763549805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([59, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8660907745361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8660907745361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8662033081054688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8741931915283203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([41, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8745708465576172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8745708465576172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8746490478515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8807487487792969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8810329437255859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8810329437255859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8810863494873047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8856258392333984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8860864639282227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8860864639282227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8861608505249023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8930044174194336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([21, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8932499885559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8932499885559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8932900428771973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8972554206848145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8974518775939941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8974518775939941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8974804878234863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9005131721496582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9007296562194824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9007296562194824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9007582664489746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9039912223815918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9041895866394043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9041895866394043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9042143821716309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9071898460388184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9073681831359863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9073681831359863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9073891639709473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9100537300109863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9101347923278809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9101347923278809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9101443290710449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9114222526550293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9115524291992188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9115524291992188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9115657806396484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9134483337402344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9135627746582031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9135627746582031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.91357421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9152679443359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9153261184692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9153261184692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9153318405151367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9162187576293945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9162826538085938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9162826538085938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9162883758544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9172153472900391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([82, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9191832542419434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9191832542419434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.919339656829834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.946866512298584  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 82, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9356908798217773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9361085891723633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9365262985229492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9360876083374023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2802, 40])
input nodes number: 12960
output nodes number: 2802
edges number: 14360
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9362006187438965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9362010955810547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03171205520629883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 22 input nodes size: 48812
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029429912567138672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029429912567138672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05286741256713867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05288887023925781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029430389404296875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03024005889892578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03024005889892578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03024005889892578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48812, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03024005889892578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([937, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07511377334594727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07511377334594727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 937, 128]), torch.Size([1, 937, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07600736618041992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08321809768676758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 937, 128])
m.shape torch.Size([1229, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08394336700439453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08394336700439453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1229, 128]), torch.Size([1, 1229, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08511543273925781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10269641876220703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1229, 128])
m.shape torch.Size([1156, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10383749008178711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10383749008178711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1156, 128]), torch.Size([1, 1156, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10493993759155273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13016462326049805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1156, 128])
m.shape torch.Size([1121, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13175153732299805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13175153732299805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13282060623168945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1647181510925293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1006, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1665821075439453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1665821075439453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1006, 128]), torch.Size([1, 1006, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16754150390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2022857666015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1006, 128])
m.shape torch.Size([775, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2040233612060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2040233612060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20476245880126953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2379894256591797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([634, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23973608016967773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23973608016967773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2403407096862793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.27190065383911133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([594, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2738642692565918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2738642692565918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2744307518005371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3074984550476074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([469, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30922794342041016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30922794342041016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3096752166748047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3383007049560547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([5624, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3654208183288574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3654208183288574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5624, 128]), torch.Size([1, 5624, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.37078428268432617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7559123039245605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5624, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7154321670532227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7283496856689453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.741267204284668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7282485961914062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13545, 256])
first layer input nodes number: 48812
first layer output nodes number: 13545
edges number: 90678
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7416329383850098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7545504570007324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7579913139343262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7579913139343262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([488, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7757267951965332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7757267951965332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7766575813293457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.785193920135498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([423, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7855420112609863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7855420112609863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.786348819732666  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7993297576904297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([357, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7999625205993652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7999625205993652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8006434440612793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8159832954406738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8166790008544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8166790008544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8171825408935547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8328685760498047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([238, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8337607383728027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8337607383728027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8342146873474121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8505568504333496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([184, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8513913154602051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8513913154602051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8517422676086426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8668332099914551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8674654960632324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8674654960632324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8676943778991699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8791384696960449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8799700736999512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8799700736999512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8802046775817871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8935770988464355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8941173553466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8941173553466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8942623138427734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9035396575927734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9042458534240723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9042458534240723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9044003486633301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9153695106506348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9158420562744141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9158420562744141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9159412384033203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9236774444580078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([38, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9240665435791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9240665435791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9241390228271484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9302997589111328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9307384490966797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9307384490966797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9308109283447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9374790191650391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.937981128692627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.937981128692627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9380574226379395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.945610523223877  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9460916519165039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9460916519165039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9461603164672852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9534387588500977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9536662101745605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9536662101745605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9536986351013184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9573626518249512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9576082229614258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9576082229614258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9576387405395508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9613008499145508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9617185592651367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9617185592651367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.961766242980957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9678220748901367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9680905342102051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9680905342102051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9681210517883301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9722104072570801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9725222587585449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9725222587585449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9725546836853027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9771265983581543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9773125648498535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9773125648498535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9773316383361816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9801545143127441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9802508354187012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9802508354187012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9802603721618652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9817385673522949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9818668365478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9818668365478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9818782806396484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9837322235107422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9839572906494141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9839572906494141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9839763641357422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9871997833251953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([152, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9908428192138672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9908428192138672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9911327362060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0421581268310547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 152, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.028337001800537  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0287590026855469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0291810035705566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0287375450134277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2832, 40])
input nodes number: 13545
output nodes number: 2832
edges number: 17831
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0288643836975098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.028864860534668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.031887054443359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 23 input nodes size: 49204
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029434680938720703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029434680938720703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.052896976470947266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.052918434143066406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029459476470947266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03022623062133789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03022623062133789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03022623062133789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49204, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03022623062133789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1044, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07357549667358398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07357549667358398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07457113265991211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08253622055053711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1189, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0832366943359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0832366943359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1189, 128]), torch.Size([1, 1189, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08437061309814453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10175895690917969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1189, 128])
m.shape torch.Size([1235, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10308218002319336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10308218002319336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10425996780395508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13019990921020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1090, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13190746307373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13190746307373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13294696807861328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16309261322021484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([972, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16489028930664062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16489028930664062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 972, 128]), torch.Size([1, 972, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1658172607421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20037841796875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 972, 128])
m.shape torch.Size([776, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2021350860595703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2021350860595703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20287513732910156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2346973419189453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([665, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23654699325561523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23654699325561523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2371811866760254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2699613571166992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([571, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.271822452545166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.271822452545166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.272367000579834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3048825263977051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([487, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3067002296447754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3067002296447754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30716466903686523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.33688879013061523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([5283, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3618478775024414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3618478775024414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5283, 128]), torch.Size([1, 5283, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3668861389160156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7246026992797852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5283, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6864805221557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6998414993286133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7125368118286133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6990766525268555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13312, 256])
first layer input nodes number: 49204
first layer output nodes number: 13312
edges number: 87439
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7129054069519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7256007194519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7287745475769043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7287745475769043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([530, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7441220283508301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7441220283508301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 530, 256]), torch.Size([1, 530, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7451329231262207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7533507347106934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 530, 256])
m.shape torch.Size([463, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7537355422973633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7537355422973633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7546186447143555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7686285972595215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([382, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7698378562927246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7698378562927246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.770566463470459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7880759239196777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([306, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7888884544372559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7888884544372559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7894721031188965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.807793140411377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([248, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8086934089660645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8086934089660645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.809166431427002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.826195240020752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.826927661895752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.826927661895752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8272480964660645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.841026782989502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8417816162109375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8417816162109375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.842041015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.855010986328125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8557119369506836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8557119369506836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8559179306030273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8676595687866211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8683180809020996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8683180809020996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8684859275817871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8792281150817871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([59, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8797116279602051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8797116279602051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.879824161529541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8878140449523926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8884344100952148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8884344100952148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8885564804077148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8980779647827148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8984670639038086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8984670639038086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8985414505004883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9048643112182617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.905177116394043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.905177116394043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9052305221557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9101438522338867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.910588264465332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.910588264465332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9106550216674805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9172639846801758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([18, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9174904823303223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9174904823303223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9175248146057129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9211640357971191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9214239120483398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9214239120483398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9214582443237305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9253377914428711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9254841804504395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9254841804504395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9255032539367676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9277920722961426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9279384613037109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9279384613037109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9279556274414062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9301357269287109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9302186965942383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9302186965942383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9302282333374023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9315061569213867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9316554069519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9316554069519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9316706657409668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9338221549987793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9339356422424316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9339356422424316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9339470863342285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.935640811920166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9357624053955078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9357624053955078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9357738494873047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9375476837158203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9377632141113281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9377632141113281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9377822875976562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9408721923828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9409322738647461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9409322738647461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9409379959106445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9419050216674805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([92, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9441127777099609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9441127777099609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9442882537841797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9751720428466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 92, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9631223678588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9635457992553711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9639692306518555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.963524341583252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2839, 40])
input nodes number: 13312
output nodes number: 2839
edges number: 15303
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.963646411895752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9636468887329102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03180646896362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 24 input nodes size: 44832
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029460906982421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029460906982421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.050838470458984375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.050859928131103516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.027376174926757812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.028130531311035156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.028130531311035156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.028130531311035156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([44832, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.028130531311035156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([961, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.06878185272216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.06878185272216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.06969833374023438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07733392715454102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([1223, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07804203033447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07804203033447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1223, 128]), torch.Size([1, 1223, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0792083740234375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.09670352935791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1223, 128])
m.shape torch.Size([1145, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.09784173965454102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.09784173965454102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1145, 128]), torch.Size([1, 1145, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.09893369674682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.12410879135131836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1145, 128])
m.shape torch.Size([1052, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.12556934356689453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.12556934356689453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1265726089477539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15566730499267578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([891, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15728998184204102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15728998184204102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15813970565795898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.18872976303100586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([743, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1904306411743164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1904306411743164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19113922119140625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.22263240814208984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([637, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.22440433502197266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.22440433502197266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.22501182556152344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2572336196899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([536, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.258974552154541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.258974552154541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.25948572158813477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.289517879486084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([489, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.29136085510253906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.29136085510253906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2918272018432617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3216733932495117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([4890, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3448777198791504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3448777198791504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4890, 128]), torch.Size([1, 4890, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.34954118728637695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6899619102478027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4890, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6542758941650391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6662607192993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6782455444335938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6661667823791504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([12567, 256])
first layer input nodes number: 44832
first layer output nodes number: 12567
edges number: 82011
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.678581714630127  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6905665397644043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6935629844665527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6935629844665527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([485, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7125811576843262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7125811576843262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7135062217712402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7212724685668945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([422, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7216215133666992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7216215133666992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7224264144897461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7344999313354492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([324, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7350320816040039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7350320816040039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7356500625610352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7497282028198242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([236, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7503266334533691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7503266334533691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7507767677307129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7638306617736816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7645764350891113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7645764350891113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7649617195129395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.778831958770752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([174, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.779754638671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.779754638671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7800865173339844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7943572998046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([146, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7951736450195312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7951736450195312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7954521179199219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8093757629394531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8101439476013184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8101439476013184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8103690147399902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8231978416442871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8239936828613281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8239936828613281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8241939544677734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8370113372802734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8376517295837402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8376517295837402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8377985954284668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8482260704040527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([43, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8486075401306152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8486075401306152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8486895561218262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8550868034362793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8557724952697754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8557724952697754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8558926582336426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8661065101623535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8665838241577148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8665838241577148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8666658401489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.874211311340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8747897148132324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8747897148132324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8748774528503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8835635185241699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8840389251708984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8840389251708984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8841075897216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8913860321044922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8918132781982422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8918132781982422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8918704986572266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8983364105224609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.898684024810791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.898684024810791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8987278938293457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9039921760559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9044203758239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9044203758239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9044699668884277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9107680320739746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9112730026245117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9112730026245117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9113283157348633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9187402725219727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9191551208496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9191551208496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9191989898681641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.925384521484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9257059097290039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9257059097290039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9257383346557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.930537223815918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9307327270507812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9307327270507812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9307518005371094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9337081909179688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9339418411254883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9339418411254883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9339628219604492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9373617172241211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9376511573791504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9376511573791504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.937675952911377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.941866397857666  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([149, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9454345703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9454345703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9457187652587891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9957370758056641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 149, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9799590110778809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9803838729858398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9808087348937988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9803624153137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2851, 40])
input nodes number: 12567
output nodes number: 2851
edges number: 19169
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9804792404174805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9804797172546387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0296783447265625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 25 input nodes size: 49525
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.027377605438232422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.027377605438232422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05099296569824219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05101442337036133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029615402221679688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030397415161132812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030397415161132812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030397415161132812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49525, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030397415161132812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1018, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07456207275390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07456207275390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07553291320800781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08379125595092773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([1305, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08509254455566406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08509254455566406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1305, 128]), torch.Size([1, 1305, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08633708953857422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10500526428222656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1305, 128])
m.shape torch.Size([1273, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10620403289794922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10620403289794922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1273, 128]), torch.Size([1, 1273, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10741806030273438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13419008255004883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1273, 128])
m.shape torch.Size([1146, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13576889038085938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13576889038085938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1146, 128]), torch.Size([1, 1146, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13686180114746094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1701984405517578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1146, 128])
m.shape torch.Size([961, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17194318771362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17194318771362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17285966873168945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20674753189086914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([826, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20884323120117188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20884323120117188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20963096618652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2452387809753418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([682, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24712133407592773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24712133407592773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 682, 128]), torch.Size([1, 682, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2477717399597168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2803034782409668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 682, 128])
m.shape torch.Size([620, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28234338760375977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28234338760375977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28293466567993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31676721572875977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([497, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3186044692993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3186044692993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3190784454345703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3494129180908203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([5313, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3745102882385254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3745102882385254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5313, 128]), torch.Size([1, 5313, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3795771598815918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7399616241455078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5313, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7015328407287598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7145419120788574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7275509834289551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.714439868927002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13641, 256])
first layer input nodes number: 49525
first layer output nodes number: 13641
edges number: 89129
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7279219627380371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7409310340881348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7441835403442383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7441835403442383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([539, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7599124908447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7599124908447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7609405517578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7704792022705078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([474, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.770876407623291  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.770876407623291  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7717804908752441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7855429649353027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([360, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7861747741699219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7861747741699219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7868614196777344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8040852546691895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([314, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8050594329833984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8050594329833984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8056583404541016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8242254257202148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([227, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8250226974487305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8250226974487305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8254556655883789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8410425186157227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8417549133300781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8417549133300781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8420619964599609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8552665710449219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8560013771057129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8560013771057129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8562531471252441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8688416481018066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8695616722106934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8695616722106934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8697714805603027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8817305564880371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([68, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8822140693664551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8822140693664551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8823437690734863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8906445503234863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8913202285766602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8913202285766602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8914670944213867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9018945693969727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([43, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9022760391235352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9022760391235352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9023580551147461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9087553024291992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9093375205993652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9093375205993652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9094405174255371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9181952476501465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([25, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9184565544128418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9184565544128418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9185042381286621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9228911399841309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9232172966003418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9232172966003418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9232668876647949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9281764030456543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9284257888793945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9284257888793945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.928462028503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9323034286499023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9325623512268066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9325623512268066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9325966835021973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9364762306213379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.936704158782959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.936704158782959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9367327690124512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9401659965515137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9403767585754395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9403767585754395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.940401554107666  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9435505867004395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9437394142150879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9437394142150879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9437603950500488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9465718269348145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9468116760253906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9468116760253906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9468364715576172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9503326416015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9506030082702637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9506030082702637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.950629711151123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9545817375183105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.954674243927002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.954674243927002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.954683780670166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9561619758605957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9562678337097168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9562678337097168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9562773704528809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.957822322845459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9579329490661621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9579329490661621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9579424858093262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9595541954040527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([104, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9620485305786133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9620485305786133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9622468948364258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9971590042114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 104, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9847211837768555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9851431846618652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.985565185546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9851217269897461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2832, 40])
input nodes number: 13641
output nodes number: 2832
edges number: 15690
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9852423667907715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9852428436279297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.032001495361328125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 26 input nodes size: 48236
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.02961254119873047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.02961254119873047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05305004119873047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05307149887084961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029434680938720703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030199527740478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030199527740478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030199527740478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48236, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030199527740478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([977, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07304096221923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07304096221923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07397270202636719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08147621154785156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([1218, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08217191696166992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08217191696166992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1218, 128]), torch.Size([1, 1218, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08333349227905273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10075712203979492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1218, 128])
m.shape torch.Size([1257, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1019744873046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1019744873046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1257, 128]), torch.Size([1, 1257, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10317325592041016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13002538681030273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1257, 128])
m.shape torch.Size([1065, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13155460357666016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13155460357666016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1325702667236328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16248798370361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([893, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1641092300415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1641092300415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1649608612060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1956195831298828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([754, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19735097885131836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19735097885131836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19807004928588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.22951269149780273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([610, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23118925094604492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23118925094604492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23177099227905273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26118993759155273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([551, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2630009651184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2630009651184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26352643966674805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.29401683807373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([465, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2957496643066406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2957496643066406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.29619312286376953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.32457447052001953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([5318, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.34971094131469727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.34971094131469727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5318, 128]), torch.Size([1, 5318, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3547825813293457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7148690223693848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5318, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6770973205566406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6895980834960938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7020988464355469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6895003318786621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13108, 256])
first layer input nodes number: 48236
first layer output nodes number: 13108
edges number: 86476
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7024602890014648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.714961051940918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7180986404418945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7180986404418945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([509, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7342014312744141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7342014312744141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7351722717285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7429828643798828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([441, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7433452606201172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7433452606201172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7441864013671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7571964263916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([366, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7578492164611816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7578492164611816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.758547306060791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.775489330291748  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([334, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7767257690429688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7767257690429688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7773628234863281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7962656021118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7969479560852051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7969479560852051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7973427772521973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.811556339263916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8123335838317871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8123335838317871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8126559257507324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8265166282653809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8272438049316406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8272438049316406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8274955749511719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8400840759277344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8408041000366211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8408041000366211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8410139083862305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8529729843139648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8537507057189941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8537507057189941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.853945255279541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.866396427154541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8670105934143066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8670105934143066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8671517372131348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8771729469299316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8777790069580078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8777790069580078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8779010772705078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8874225616455078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8878231048583984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8878231048583984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8878993988037109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8943843841552734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8948464393615723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8948464393615723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8949227333068848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9019417762756348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9023208618164062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9023208618164062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9023799896240234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.908233642578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9085793495178223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9085793495178223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9086289405822754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9138855934143066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9141225814819336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9141225814819336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9141550064086914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9178190231323242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9180808067321777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9180808067321777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9181132316589355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.922004222869873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.922213077545166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.922213077545166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9222378730773926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.925386905670166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9255571365356445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9255571365356445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9255762100219727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9281320571899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9283342361450195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9283342361450195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9283552169799805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9313135147094727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9315252304077148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9315252304077148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9315462112426758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9346513748168945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9347681999206543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9347681999206543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9347796440124512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9365534782409668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9367027282714844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9367027282714844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9367160797119141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9388790130615234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9390339851379395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9390339851379395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9390473365783691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9413037300109863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([94, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9435558319091797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9435558319091797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9437351226806641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9752902984619141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 94, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9624676704406738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.962890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9633135795593262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9628691673278809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2838, 40])
input nodes number: 13108
output nodes number: 2838
edges number: 16111
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.962989330291748  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9629898071289062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.031771183013916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 27 input nodes size: 51407
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.02943563461303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.02943563461303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.053948402404785156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0539698600769043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030510902404785156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.031342506408691406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.031342506408691406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.031342506408691406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([51407, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.031342506408691406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([982, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0783233642578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0783233642578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 982, 128]), torch.Size([1, 982, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07925987243652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08770990371704102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 982, 128])
m.shape torch.Size([1206, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08884286880493164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08884286880493164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1206, 128]), torch.Size([1, 1206, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08999300003051758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10724496841430664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1206, 128])
m.shape torch.Size([1261, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1084737777709961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1084737777709961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1261, 128]), torch.Size([1, 1261, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10967636108398438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13674211502075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1261, 128])
m.shape torch.Size([1101, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13824081420898438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13824081420898438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13929080963134766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1697406768798828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([974, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1715378761291504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1715378761291504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17246675491333008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20753145217895508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([790, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20932722091674805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20932722091674805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.21008062362670898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24289464950561523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([664, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2447342872619629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2447342872619629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24536752700805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.27837228775024414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([595, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28032541275024414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28032541275024414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28089284896850586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31402158737182617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([503, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31589651107788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31589651107788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3163762092590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3470768928527832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([5982, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.37613391876220703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.37613391876220703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5982, 128]), torch.Size([1, 5982, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3818387985229492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7896661758422852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5982, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7479743957519531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7613811492919922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7747879028320312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7612762451171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([14058, 256])
first layer input nodes number: 51407
first layer output nodes number: 14058
edges number: 94946
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7751731872558594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7885799407958984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7919316291809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7919316291809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([529, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8084440231323242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8084440231323242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.809453010559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8181633949279785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([426, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8184781074523926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8184781074523926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8192906379699707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8362278938293457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([387, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8372488021850586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8372488021850586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.837986946105957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.856447696685791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([271, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8571586608886719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8571586608886719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8576755523681641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8746843338012695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([234, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8755507469177246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8755507469177246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8759970664978027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8920645713806152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8928623199462891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8928623199462891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8931999206542969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9077167510986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9085168838500977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9085168838500977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9087915420532227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9225244522094727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([128, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9233713150024414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9233713150024414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9236154556274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9375314712524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9381880760192871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9381880760192871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9383597373962402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9493460655212402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.949894905090332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.949894905090332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9500207901000977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.958958625793457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([45, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9593715667724609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9593715667724609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9594573974609375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9661521911621094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9666748046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9666748046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9667682647705078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9747123718261719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9750657081604004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9750657081604004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9751267433166504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9807419776916504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9812097549438477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9812097549438477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9812803268432617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9882669448852539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9885344505310059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9885344505310059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9885745048522949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9928202629089355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9931235313415527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9931235313415527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9931635856628418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9976897239685059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9978823661804199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9978823661804199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9979071617126465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.000882625579834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.001112461090088  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.001112461090088  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0011391639709473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.004530429840088  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.00469970703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.00469970703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0047187805175781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0072746276855469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0074000358581543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0074000358581543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.007413387298584  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.00929594039917  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0094709396362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0094709396362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0094881057739258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.012028694152832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0121259689331055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0121259689331055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0121355056762695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0136137008666992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0137639045715332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0137639045715332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.013777256011963  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0159401893615723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0159797668457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0159797668457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0159835815429688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0166282653808594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([127, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0196781158447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0196781158447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0199203491210938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0625534057617188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 127, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0494980812072754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0499229431152344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0503478050231934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0499014854431152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2851, 40])
input nodes number: 14058
output nodes number: 2851
edges number: 16514
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0500297546386719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.05003023147583  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03303050994873047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 28 input nodes size: 49905
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03051280975341797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03051280975341797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05430936813354492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05433082580566406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029796600341796875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030565261840820312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030565261840820312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030565261840820312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49905, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030565261840820312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([980, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0744624137878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0744624137878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07539701461791992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08374452590942383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([1190, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08495521545410156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08495521545410156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1190, 128]), torch.Size([1, 1190, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.086090087890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10348320007324219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1190, 128])
m.shape torch.Size([1221, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10466241836547852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10466241836547852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1221, 128]), torch.Size([1, 1221, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10582685470581055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1322345733642578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1221, 128])
m.shape torch.Size([1056, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1336665153503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1336665153503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1346735954284668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1638789176940918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([914, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16555452346801758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16555452346801758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1664261817932129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19780588150024414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([739, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19948434829711914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.19948434829711914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20018911361694336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23139429092407227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([696, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23336505889892578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23336505889892578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23402881622314453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26722240447998047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([579, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26909923553466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.26909923553466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2696514129638672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.30211544036865234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([447, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3037576675415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3037576675415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3041839599609375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3314666748046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([5486, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.35741281509399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.35741281509399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5486, 128]), torch.Size([1, 5486, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.36264467239379883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7352910041809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5486, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.6964998245239258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7094736099243164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7221651077270508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7090921401977539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13308, 256])
first layer input nodes number: 49905
first layer output nodes number: 13308
edges number: 88638
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.722538948059082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7352304458618164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7384033203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7384033203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([578, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7529492378234863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7529492378234863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.754051685333252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7639050483703613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([497, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7643094062805176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7643094062805176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7652573585510254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7796506881713867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([379, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7802839279174805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7802839279174805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7810068130493164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7976894378662109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([302, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7985215187072754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7985215187072754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7990975379943848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.816896915435791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([237, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8178730010986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8178730010986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8183250427246094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8345985412597656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8354010581970215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8354010581970215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8357348442077637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8500876426696777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8508563041687012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8508563041687012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8511214256286621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.864377498626709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8649754524230957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8649754524230957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8651566505432129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8754849433898926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([67, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.875974178314209  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.875974178314209  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8761019706726074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8842806816101074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([57, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8847646713256836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8847646713256836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8848733901977539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8925924301147461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8932147026062012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8932147026062012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8933367729187012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9028582572937012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([35, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9032011032104492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9032011032104492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9032678604125977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9089422225952148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9092588424682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9092588424682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9093122482299805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9142255783081055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9144549369812012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9144549369812012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9144911766052246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9180788993835449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9183058738708496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9183058738708496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9183382987976074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9217753410339355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9219746589660645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9219746589660645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9220013618469238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9250187873840332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9251689910888672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9251689910888672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9251880645751953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9274768829345703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9275712966918945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9275712966918945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9275827407836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9290361404418945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9291400909423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9291400909423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9291515350341797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9306850433349609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9307756423950195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9307756423950195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9307851791381836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9321298599243164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9322061538696289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9322061538696289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9322137832641602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9333429336547852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9334239959716797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9334239959716797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9334316253662109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9346141815185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9346771240234375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9346771240234375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9346828460693359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9356098175048828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.935699462890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.935699462890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9357070922851562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9369964599609375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([92, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9392032623291016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9392032623291016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9393787384033203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9702625274658203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 92, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9590520858764648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.959475040435791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9598979949951172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9594535827636719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2837, 40])
input nodes number: 13308
output nodes number: 2837
edges number: 14420
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9595723152160645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9595727920532227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.032141685485839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 29 input nodes size: 51421
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029794692993164062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029794692993164062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05431413650512695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.054335594177246094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030517578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03136444091796875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03136444091796875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03136444091796875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([51421, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03136444091796875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([968, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0787510871887207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0787510871887207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07967424392700195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08705949783325195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([1256, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08779764175415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08779764175415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1256, 128]), torch.Size([1, 1256, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08899545669555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10780191421508789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1256, 128])
m.shape torch.Size([1198, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1089167594909668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1089167594909668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1198, 128]), torch.Size([1, 1198, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11005926132202148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13602113723754883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1198, 128])
m.shape torch.Size([1084, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13751745223999023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13751745223999023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1385512351989746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16925954818725586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1015, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17116260528564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17116260528564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1015, 128]), torch.Size([1, 1015, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17213058471679688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.207183837890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1015, 128])
m.shape torch.Size([867, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20918035507202148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20918035507202148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2100071907043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2466740608215332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([702, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24860382080078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24860382080078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24927330017089844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28337621688842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([646, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2855057716369629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2855057716369629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.28612184524536133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.32291269302368164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([541, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.32492637634277344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.32492637634277344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3254423141479492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3597722053527832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([5915, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.38771915435791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.38771915435791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5915, 128]), torch.Size([1, 5915, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3933601379394531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7978010177612305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5915, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7558016777038574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7693362236022949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7828707695007324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7692303657531738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([14192, 256])
first layer input nodes number: 51421
first layer output nodes number: 14192
edges number: 95788
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7832560539245605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.796790599822998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8001742362976074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8001742362976074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([487, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8177947998046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8177947998046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8187236785888672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8277931213378906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([447, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8281879425048828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8281879425048828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.82904052734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8472480773925781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([336, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8477907180786133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8477907180786133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8484315872192383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8630657196044922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([260, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8637604713439941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8637604713439941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8642563819885254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8799433708190918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([225, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8807768821716309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8807768821716309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8812060356140137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8966555595397949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8974390029907227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8974390029907227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8977689743041992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9119577407836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9126811027526855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9126811027526855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9129328727722168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9255213737487793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9262723922729492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9262723922729492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9264898300170898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9388837814331055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9395017623901367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9395017623901367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.939661979675293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.949915885925293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9506049156188965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9506049156188965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9507575035095215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9615912437438965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9622340202331543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9622340202331543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9623637199401855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.972480297088623  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9730615615844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9730615615844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9731683731079102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9822473526000977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9828314781188965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9828314781188965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9829287528991699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9918780326843262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9923005104064941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9923005104064941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9923672676086426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9989762306213379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.999476432800293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.999476432800293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.999547004699707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0070276260375977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0073156356811523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0073156356811523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0073556900024414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0118818283081055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0122380256652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0122380256652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.012281894683838  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0175461769104004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0178532600402832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0178532600402832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0178894996643066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0224919319152832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0227112770080566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0227112770080566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0227360725402832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0260586738586426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0261812210083008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0261812210083008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0261945724487305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0280771255493164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.028252124786377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.028252124786377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0282692909240723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0308098793029785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.030970573425293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.030970573425293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0309858322143555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.033350944519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.033520221710205  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.033520221710205  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0335354804992676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0360074043273926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0361614227294922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0361614227294922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0361747741699219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.038431167602539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([137, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0426530838012695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0426530838012695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0429143905639648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0889043807983398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.07464599609375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0750689506530762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0754919052124023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.075047492980957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2837, 40])
input nodes number: 14192
output nodes number: 2837
edges number: 17710
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0751748085021973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0751752853393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.033077239990234375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 30 input nodes size: 50840
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030517578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030517578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.054759979248046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.054781436920166016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030240535736083984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03107309341430664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03107309341430664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03107309341430664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([50840, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03107309341430664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([945, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07804584503173828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07804584503173828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07894706726074219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08615684509277344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([1212, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0870051383972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0870051383972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1212, 128]), torch.Size([1, 1212, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08816099166870117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1054987907409668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1212, 128])
m.shape torch.Size([1137, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10654735565185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10654735565185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10763168334960938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13236236572265625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1085, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13388967514038086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13388967514038086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13492441177368164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1649317741394043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1011, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1668248176574707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1668248176574707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1011, 128]), torch.Size([1, 1011, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.16778898239135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20279645919799805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1011, 128])
m.shape torch.Size([796, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2045917510986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2045917510986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2053508758544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.23839521408081055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([658, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24021196365356445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24021196365356445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24083948135375977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.27400970458984375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([607, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2766294479370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2766294479370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2772083282470703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31050777435302734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([540, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31253576278686523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31253576278686523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3130507469177246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.34728193283081055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([5970, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.37632131576538086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.37632131576538086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5970, 128]), torch.Size([1, 5970, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.38201475143432617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7895674705505371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5970, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7478246688842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.761138916015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7744531631469727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7610344886779785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13961, 256])
first layer input nodes number: 50840
first layer output nodes number: 13961
edges number: 94973
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.774834156036377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7881484031677246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7914772033691406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7914772033691406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([510, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8081011772155762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8081011772155762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 510, 256]), torch.Size([1, 510, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8090739250183105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8180384635925293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 510, 256])
m.shape torch.Size([484, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8184828758239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8184828758239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 484, 256]), torch.Size([1, 484, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8194060325622559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.836881160736084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 484, 256])
m.shape torch.Size([329, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8373684883117676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8373684883117676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8379960060119629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8522658348083496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([263, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8530106544494629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8530106544494629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8535122871398926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8691544532775879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([245, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8700814247131348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8700814247131348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8705487251281738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8873715400695801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8880953788757324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8880953788757324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8884119987487793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9020266532897949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([153, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.902897834777832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.902897834777832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9031896591186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.917780876159668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.918419361114502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.918419361114502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9186139106750488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9297032356262207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9303412437438965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9303412437438965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9305033683776855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9408793449401855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.941490650177002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.941490650177002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9416279792785645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.951378345489502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9518914222717285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9518914222717285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9519963264465332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9601788520812988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9607377052307129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9607377052307129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.960838794708252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9694314002990723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.969855785369873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.969855785369873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9699282646179199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9765963554382324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([24, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9768834114074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9768834114074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9769291877746582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9814610481262207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9816832542419434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9816832542419434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9817156791687012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9851527214050293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9855670928955078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9855670928955078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9856204986572266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9916553497314453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9919719696044922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9919719696044922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9920120239257812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9968185424804688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9970064163208008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9970064163208008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9970293045043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9999361038208008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0001072883605957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0001072883605957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0001263618469238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0026822090148926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0029230117797852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0029230117797852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0029478073120117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.006443977355957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0065526962280273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0065526962280273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0065641403198242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0082578659057617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0083580017089844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0083580017089844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0083675384521484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0098457336425781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.009995937347412  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.009995937347412  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0100092887878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0121722221374512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0122580528259277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0122580528259277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.012265682220459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0135550498962402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([130, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0166749954223633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0166749954223633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.016922950744629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.060563087463379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 130, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0473394393920898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0477614402770996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0481834411621094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0477399826049805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2832, 40])
input nodes number: 13961
output nodes number: 2832
edges number: 16650
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.0478649139404297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.047865390777588  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03275489807128906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 31 input nodes size: 49991
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030239582061767578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030239582061767578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0540771484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05409860610961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.029834747314453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030618667602539062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030618667602539062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030618667602539062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49991, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.030618667602539062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1068, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07516288757324219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07516288757324219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.07618141174316406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08432960510253906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([1293, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08528947830200195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08528947830200195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1293, 128]), torch.Size([1, 1293, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.08652257919311523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10501909255981445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1293, 128])
m.shape torch.Size([1243, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10639667510986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10639667510986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1243, 128]), torch.Size([1, 1243, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10758209228515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13366127014160156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1243, 128])
m.shape torch.Size([1159, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13530397415161133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13530397415161133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1159, 128]), torch.Size([1, 1159, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13640928268432617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1698918342590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1159, 128])
m.shape torch.Size([993, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1717066764831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1717066764831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 993, 128]), torch.Size([1, 993, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1726536750793457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20715570449829102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 993, 128])
m.shape torch.Size([773, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2088937759399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2088937759399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20963096618652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24208784103393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([644, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24386882781982422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24386882781982422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.24448299407958984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2766733169555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([601, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2786588668823242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2786588668823242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2792320251464844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31241321563720703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([498, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31426382064819336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31426382064819336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.31473875045776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.34513425827026367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([5443, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3708510398864746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3708510398864746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5443, 128]), torch.Size([1, 5443, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.37604188919067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7459816932678223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5443, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7068314552307129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7199110984802246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7329907417297363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7198085784912109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13715, 256])
first layer input nodes number: 49991
first layer output nodes number: 13715
edges number: 89850
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.733365535736084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7464451789855957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.750403881072998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.750403881072998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([570, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.765805721282959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.765805721282959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7668929100036621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7764468193054199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([487, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7768397331237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7768397331237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.777768611907959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7919421195983887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([365, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7925667762756348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7925667762756348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.7932629585266113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8093743324279785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([295, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8102922439575195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8102922439575195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8108549118041992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8298177719116211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([241, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.830935001373291  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.830935001373291  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8313946723937988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8479428291320801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8486242294311523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8486242294311523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8489255905151367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8618841171264648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8626017570495605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8626017570495605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8628478050231934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.875150203704834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([76, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8756117820739746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8756117820739746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8757567405700684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8840193748474121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8845353126525879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8845353126525879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8846650123596191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8929657936096191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8935451507568359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8935451507568359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.8936729431152344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9027462005615234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9031796455383301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9031796455383301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9032692909240723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9102616310119629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9107246398925781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9107246398925781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9108085632324219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9179420471191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9182376861572266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9182376861572266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9182891845703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9230270385742188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9233512878417969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9233512878417969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.92340087890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9283103942871094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9288191795349121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9288191795349121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9288897514343262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9363703727722168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9366121292114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9366121292114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9366464614868164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.940526008605957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9407706260681152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9407706260681152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9408011436462402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9444632530212402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9446210861206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9446210861206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9446401596069336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9470624923706055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9472355842590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9472355842590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9472546577453613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9498105049133301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9499549865722656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9499549865722656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9499702453613281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9521217346191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9522757530212402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9522757530212402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9522910118103027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9545493125915527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9547324180603027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9547324180603027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.954749584197998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9574103355407715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9575347900390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9575347900390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9575462341308594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9594001770019531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9595098495483398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9595098495483398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9595193862915039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9611310958862305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([101, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9635534286499023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9635534286499023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9637460708618164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9976511001586914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 101, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9855661392211914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.985987663269043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9864091873168945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9859662055969238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2828, 40])
input nodes number: 13715
output nodes number: 2828
edges number: 15319
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9860897064208984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.9860901832580566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03222990036010742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0377802848815918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.0377802848815918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010779082775115967 |0.014384366571903229 |0.1301421970129013 |9.396672248840332e-05 |0.0758642852306366 |0.005938529968261719 |
----------------------------------------------------------pseudo_mini_loss sum 5.311779022216797
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1955749
Number of first layer input nodes during this epoch:  1514856
Number of first layer output nodes during this epoch:  440893
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.037779808044433594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.019470691680908203
global_2_local spend time (sec) 0.0473630428314209
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004379987716674805
A = g.adjacency_matrix() spent  0.007695674896240234
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08087992668151855
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3180816173553467
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent [05:44:00] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 512748 edges into 32 parts and get 33787 edge cuts
 1.174983263015747

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 0.025 seconds
Metis partitioning: 0.101 seconds
Split the graph: 0.033 seconds
Construct subgraphs: 0.066 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.22491121292114258
2848
2927
2777
2821
2910
2836
2840
2830
2836
2869
2839
2861
2860
2837
2857
2827
2836
2835
2831
2849
2829
2828
2825
2837
2850
2831
2840
2853
2816
2831
2852
2823
total k batches seeds list generation spend  10.77861213684082
after graph partition
graph partition algorithm spend time 10.871551752090454
2848
2927
2777
2821
2910
2836
2840
2830
2836
2869
2839
2861
2860
2837
2857
2827
2836
2835
2831
2849
2829
2828
2825
2837
2850
2831
2840
2853
2816
2831
2852
2823
partition_len_list
[16922, 17013, 18074, 16992, 16051, 14558, 12638, 13130, 12017, 10923, 11130, 12757, 13435, 12229, 13830, 13931, 13301, 13623, 13481, 13093, 13591, 13495, 13570, 13316, 12831, 13638, 13551, 13483, 13357, 13438, 13636, 13300]
shared_neighbor_graph_partition_s0 selection method  spend 10.972736120223999
time for parepare:  0.017181396484375
local_output_nid generation:  0.0007870197296142578
local_in_edges_tensor generation:  0.0010104179382324219
mini_batch_src_global generation:  0.0016677379608154297
r_  generation:  0.012342453002929688
local_output_nid generation:  0.0008599758148193359
local_in_edges_tensor generation:  0.00091552734375
mini_batch_src_global generation:  0.0015172958374023438
r_  generation:  0.011659622192382812
local_output_nid generation:  0.0008339881896972656
local_in_edges_tensor generation:  0.0007865428924560547
mini_batch_src_global generation:  0.00131988525390625
r_  generation:  0.009392976760864258
local_output_nid generation:  0.0008904933929443359
local_in_edges_tensor generation:  0.00074005126953125
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.009294748306274414
local_output_nid generation:  0.0009279251098632812
local_in_edges_tensor generation:  0.0008130073547363281
mini_batch_src_global generation:  0.0012307167053222656
r_  generation:  0.013271331787109375
local_output_nid generation:  0.0009028911590576172
local_in_edges_tensor generation:  0.0007307529449462891
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.007519960403442383
local_output_nid generation:  0.0009505748748779297
local_in_edges_tensor generation:  0.00070953369140625
mini_batch_src_global generation:  0.0009059906005859375
r_  generation:  0.007344722747802734
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0006422996520996094
mini_batch_src_global generation:  0.0007061958312988281
r_  generation:  0.006668567657470703
local_output_nid generation:  0.0009210109710693359
local_in_edges_tensor generation:  0.00092315673828125
mini_batch_src_global generation:  0.0008518695831298828
r_  generation:  0.007340669631958008
local_output_nid generation:  0.0009200572967529297
local_in_edges_tensor generation:  0.0007028579711914062
mini_batch_src_global generation:  0.0009586811065673828
r_  generation:  0.008627653121948242
local_output_nid generation:  0.0009088516235351562
local_in_edges_tensor generation:  0.0007059574127197266
mini_batch_src_global generation:  0.0010297298431396484
r_  generation:  0.008785247802734375
local_output_nid generation:  0.0009129047393798828
local_in_edges_tensor generation:  0.00067901611328125
mini_batch_src_global generation:  0.0010075569152832031
r_  generation:  0.008569002151489258
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0006949901580810547
mini_batch_src_global generation:  0.0011372566223144531
r_  generation:  0.009205818176269531
local_output_nid generation:  0.0008933544158935547
local_in_edges_tensor generation:  0.0006878376007080078
mini_batch_src_global generation:  0.0009722709655761719
r_  generation:  0.008156776428222656
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0006611347198486328
mini_batch_src_global generation:  0.0008873939514160156
r_  generation:  0.00642085075378418
local_output_nid generation:  0.0008542537689208984
local_in_edges_tensor generation:  0.0006248950958251953
mini_batch_src_global generation:  0.0007565021514892578
r_  generation:  0.005567312240600586
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0006582736968994141
mini_batch_src_global generation:  0.0007994174957275391
r_  generation:  0.007174491882324219
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.0006482601165771484
mini_batch_src_global generation:  0.0007593631744384766
r_  generation:  0.006108760833740234
local_output_nid generation:  0.0008397102355957031
local_in_edges_tensor generation:  0.0006103515625
mini_batch_src_global generation:  0.0006270408630371094
r_  generation:  0.004935026168823242
local_output_nid generation:  0.0008525848388671875
local_in_edges_tensor generation:  0.0006058216094970703
mini_batch_src_global generation:  0.0005657672882080078
r_  generation:  0.005107402801513672
local_output_nid generation:  0.0008292198181152344
local_in_edges_tensor generation:  0.0006296634674072266
mini_batch_src_global generation:  0.0005805492401123047
r_  generation:  0.005175590515136719
local_output_nid generation:  0.0008184909820556641
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0005753040313720703
r_  generation:  0.0051915645599365234
local_output_nid generation:  0.0007953643798828125
local_in_edges_tensor generation:  0.0006077289581298828
mini_batch_src_global generation:  0.0005562305450439453
r_  generation:  0.004906177520751953
local_output_nid generation:  0.0008325576782226562
local_in_edges_tensor generation:  0.0006103515625
mini_batch_src_global generation:  0.0006189346313476562
r_  generation:  0.0055561065673828125
local_output_nid generation:  0.0008451938629150391
local_in_edges_tensor generation:  0.0006835460662841797
mini_batch_src_global generation:  0.0007829666137695312
r_  generation:  0.007224321365356445
local_output_nid generation:  0.0008087158203125
local_in_edges_tensor generation:  0.0006122589111328125
mini_batch_src_global generation:  0.0006482601165771484
r_  generation:  0.005061149597167969
local_output_nid generation:  0.0008022785186767578
local_in_edges_tensor generation:  0.0006122589111328125
mini_batch_src_global generation:  0.0006434917449951172
r_  generation:  0.005476236343383789
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0006113052368164062
mini_batch_src_global generation:  0.0005793571472167969
r_  generation:  0.005016803741455078
local_output_nid generation:  0.0007688999176025391
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.0005602836608886719
r_  generation:  0.004960060119628906
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.000591278076171875
mini_batch_src_global generation:  0.0005402565002441406
r_  generation:  0.004735469818115234
local_output_nid generation:  0.0007965564727783203
local_in_edges_tensor generation:  0.0006086826324462891
mini_batch_src_global generation:  0.0006144046783447266
r_  generation:  0.005311489105224609
local_output_nid generation:  0.00080108642578125
local_in_edges_tensor generation:  0.0006020069122314453
mini_batch_src_global generation:  0.0005843639373779297
r_  generation:  0.005353212356567383
----------------------check_connections_block total spend ----------------------------- 0.39475584030151367
generate_one_block  0.0394742488861084
generate_one_block  0.020452499389648438
generate_one_block  0.01705455780029297
generate_one_block  0.015366554260253906
generate_one_block  0.018904924392700195
generate_one_block  0.01293182373046875
generate_one_block  0.011937141418457031
generate_one_block  0.008791446685791016
generate_one_block  0.011574268341064453
generate_one_block  0.013261795043945312
generate_one_block  0.013622522354125977
generate_one_block  0.013293743133544922
generate_one_block  0.013995170593261719
generate_one_block  0.012383460998535156
generate_one_block  0.010242938995361328
generate_one_block  0.008956193923950195
generate_one_block  0.015716552734375
generate_one_block  0.010269880294799805
generate_one_block  0.008260965347290039
generate_one_block  0.008291959762573242
generate_one_block  0.008492231369018555
generate_one_block  0.008548974990844727
generate_one_block  0.007977724075317383
generate_one_block  0.008994579315185547
generate_one_block  0.011182308197021484
generate_one_block  0.008453845977783203
generate_one_block  0.008846282958984375
generate_one_block  0.008289337158203125
generate_one_block  0.008160591125488281
generate_one_block  0.00793147087097168
generate_one_block  0.008620977401733398
generate_one_block  0.00901651382446289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033791542053222656
gen group dst list time:  0.013063907623291016
time for parepare:  0.02131485939025879
local_output_nid generation:  0.0033652782440185547
local_in_edges_tensor generation:  0.013016700744628906
mini_batch_src_global generation:  0.00483393669128418
r_  generation:  0.04939889907836914
local_output_nid generation:  0.0051076412200927734
local_in_edges_tensor generation:  0.004967689514160156
mini_batch_src_global generation:  0.005451202392578125
r_  generation:  0.048553466796875
local_output_nid generation:  0.005304813385009766
local_in_edges_tensor generation:  0.00442957878112793
mini_batch_src_global generation:  0.005247354507446289
r_  generation:  0.05304312705993652
local_output_nid generation:  0.0050623416900634766
local_in_edges_tensor generation:  0.004344940185546875
mini_batch_src_global generation:  0.005065441131591797
r_  generation:  0.04939866065979004
local_output_nid generation:  0.004713773727416992
local_in_edges_tensor generation:  0.003911733627319336
mini_batch_src_global generation:  0.005050182342529297
r_  generation:  0.04673409461975098
local_output_nid generation:  0.004385709762573242
local_in_edges_tensor generation:  0.0036773681640625
mini_batch_src_global generation:  0.004073619842529297
r_  generation:  0.040239810943603516
local_output_nid generation:  0.003943443298339844
local_in_edges_tensor generation:  0.003171205520629883
mini_batch_src_global generation:  0.0031740665435791016
r_  generation:  0.035062313079833984
local_output_nid generation:  0.003984928131103516
local_in_edges_tensor generation:  0.0031435489654541016
mini_batch_src_global generation:  0.0028700828552246094
r_  generation:  0.03569984436035156
local_output_nid generation:  0.003701925277709961
local_in_edges_tensor generation:  0.0032286643981933594
mini_batch_src_global generation:  0.0028600692749023438
r_  generation:  0.031519174575805664
local_output_nid generation:  0.0033080577850341797
local_in_edges_tensor generation:  0.0026612281799316406
mini_batch_src_global generation:  0.0026564598083496094
r_  generation:  0.02909684181213379
local_output_nid generation:  0.003342151641845703
local_in_edges_tensor generation:  0.0026853084564208984
mini_batch_src_global generation:  0.002545595169067383
r_  generation:  0.03001713752746582
local_output_nid generation:  0.003721475601196289
local_in_edges_tensor generation:  0.0029935836791992188
mini_batch_src_global generation:  0.0028543472290039062
r_  generation:  0.03372001647949219
local_output_nid generation:  0.00395965576171875
local_in_edges_tensor generation:  0.003198862075805664
mini_batch_src_global generation:  0.0033469200134277344
r_  generation:  0.03589487075805664
local_output_nid generation:  0.003698587417602539
local_in_edges_tensor generation:  0.003025531768798828
mini_batch_src_global generation:  0.0029311180114746094
r_  generation:  0.03208637237548828
local_output_nid generation:  0.004065990447998047
local_in_edges_tensor generation:  0.003223419189453125
mini_batch_src_global generation:  0.0030972957611083984
r_  generation:  0.03781771659851074
local_output_nid generation:  0.004151821136474609
local_in_edges_tensor generation:  0.0032508373260498047
mini_batch_src_global generation:  0.0033044815063476562
r_  generation:  0.037636518478393555
local_output_nid generation:  0.004087686538696289
local_in_edges_tensor generation:  0.0031828880310058594
mini_batch_src_global generation:  0.003207683563232422
r_  generation:  0.03753018379211426
local_output_nid generation:  0.004123210906982422
local_in_edges_tensor generation:  0.0033054351806640625
mini_batch_src_global generation:  0.0031974315643310547
r_  generation:  0.036177873611450195
local_output_nid generation:  0.004061460494995117
local_in_edges_tensor generation:  0.003155231475830078
mini_batch_src_global generation:  0.003098726272583008
r_  generation:  0.0357966423034668
local_output_nid generation:  0.003999233245849609
local_in_edges_tensor generation:  0.003092527389526367
mini_batch_src_global generation:  0.003013134002685547
r_  generation:  0.035058021545410156
local_output_nid generation:  0.00406336784362793
local_in_edges_tensor generation:  0.0032460689544677734
mini_batch_src_global generation:  0.0030298233032226562
r_  generation:  0.03540849685668945
local_output_nid generation:  0.0040283203125
local_in_edges_tensor generation:  0.0031728744506835938
mini_batch_src_global generation:  0.00308990478515625
r_  generation:  0.0358281135559082
local_output_nid generation:  0.004096031188964844
local_in_edges_tensor generation:  0.0031054019927978516
mini_batch_src_global generation:  0.003009796142578125
r_  generation:  0.03628253936767578
local_output_nid generation:  0.004035472869873047
local_in_edges_tensor generation:  0.0031180381774902344
mini_batch_src_global generation:  0.0030794143676757812
r_  generation:  0.036368370056152344
local_output_nid generation:  0.003965139389038086
local_in_edges_tensor generation:  0.0031113624572753906
mini_batch_src_global generation:  0.0030286312103271484
r_  generation:  0.033795833587646484
local_output_nid generation:  0.004096269607543945
local_in_edges_tensor generation:  0.0031807422637939453
mini_batch_src_global generation:  0.0030167102813720703
r_  generation:  0.035897254943847656
local_output_nid generation:  0.004085063934326172
local_in_edges_tensor generation:  0.0031692981719970703
mini_batch_src_global generation:  0.0030329227447509766
r_  generation:  0.03571462631225586
local_output_nid generation:  0.0040585994720458984
local_in_edges_tensor generation:  0.0031321048736572266
mini_batch_src_global generation:  0.0030159950256347656
r_  generation:  0.036104440689086914
local_output_nid generation:  0.00404810905456543
local_in_edges_tensor generation:  0.0034949779510498047
mini_batch_src_global generation:  0.0030748844146728516
r_  generation:  0.03494119644165039
local_output_nid generation:  0.004031181335449219
local_in_edges_tensor generation:  0.0030410289764404297
mini_batch_src_global generation:  0.003000020980834961
r_  generation:  0.03540539741516113
local_output_nid generation:  0.004145383834838867
local_in_edges_tensor generation:  0.0031571388244628906
mini_batch_src_global generation:  0.003124237060546875
r_  generation:  0.03700113296508789
local_output_nid generation:  0.003984689712524414
local_in_edges_tensor generation:  0.003236532211303711
mini_batch_src_global generation:  0.003133535385131836
r_  generation:  0.03647208213806152
----------------------check_connections_block total spend ----------------------------- 1.865121603012085
generate_one_block  0.08381962776184082
generate_one_block  0.07750201225280762
generate_one_block  0.07155871391296387
generate_one_block  0.06670451164245605
generate_one_block  0.0628499984741211
generate_one_block  0.0519108772277832
generate_one_block  0.04387354850769043
generate_one_block  0.04378771781921387
generate_one_block  0.04239654541015625
generate_one_block  0.03839588165283203
generate_one_block  0.03950190544128418
generate_one_block  0.04623913764953613
generate_one_block  0.04895949363708496
generate_one_block  0.0434720516204834
generate_one_block  0.04837632179260254
generate_one_block  0.04834485054016113
generate_one_block  0.05149960517883301
generate_one_block  0.04731178283691406
generate_one_block  0.048528432846069336
generate_one_block  0.044059038162231445
generate_one_block  0.047310829162597656
generate_one_block  0.04614996910095215
generate_one_block  0.04618358612060547
generate_one_block  0.04507589340209961
generate_one_block  0.04487037658691406
generate_one_block  0.07170319557189941
generate_one_block  0.047696590423583984
generate_one_block  0.045371294021606445
generate_one_block  0.053893327713012695
generate_one_block  0.047699689865112305
generate_one_block  0.0462183952331543
generate_one_block  0.04496884346008301
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.037779808044433594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

connection checking time:  1.865121603012085
block generation total time  1.6362340450286865
average batch blocks generation time:  0.051132313907146454
block dataloader generation time/epoch 15.527838706970215
pseudo mini batch 0 input nodes size: 47291
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03538370132446289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03538370132446289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05882120132446289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.05884265899658203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03498363494873047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03636741638183594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03636741638183594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03636741638183594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([47291, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.03636741638183594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([443, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10709047317504883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.10709047317504883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.1075129508972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11089277267456055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([593, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11124706268310547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11124706268310547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.11181259155273438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.12036991119384766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([623, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.12097835540771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.12097835540771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.12157249450683594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13465118408203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([610, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13551759719848633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13551759719848633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.13609933853149414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15300416946411133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([586, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15411043167114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15411043167114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.15466928482055664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17536306381225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([562, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17669153213500977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17669153213500977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.17722749710083008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20069169998168945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([516, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20214605331420898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.20214605331420898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2026381492614746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.22741270065307617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([480, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.22904348373413086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.22904348373413086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.22950124740600586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.25559377670288086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([502, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2575192451477051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.2575192451477051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.257997989654541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.288637638092041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([12007, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.34565210342407227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.34565210342407227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12007, 128]), torch.Size([1, 12007, 128])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 0.3571028709411621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1847124099731445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12007, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1176681518554688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.133829116821289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1499671936035156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1336798667907715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([16922, 256])
first layer input nodes number: 47291
first layer output nodes number: 16922
edges number: 144280
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1503214836120605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.166459560394287  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1709017753601074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.1709017753601074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([206, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2108783721923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2108783721923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2112712860107422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2144145965576172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([191, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.214585304260254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.214585304260254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.214949607849121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.220414161682129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([162, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2206993103027344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2206993103027344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.22100830078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2278060913085938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([121, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2281169891357422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2281169891357422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2283477783203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2350406646728516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([94, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.235377311706543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.235377311706543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2355566024780273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2420110702514648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([102, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2425098419189453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2425098419189453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2427043914794922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2510700225830078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([68, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2514305114746094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2514305114746094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2515602111816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2580451965332031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2585573196411133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2585573196411133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2587003707885742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2668542861938477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([70, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2673883438110352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2673883438110352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.267521858215332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.276066780090332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.276644229888916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.276644229888916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2767720222473145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2858452796936035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2865324020385742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2865324020385742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.286667823791504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2972307205200195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2979011535644531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2979011535644531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.2980232238769531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3083992004394531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3089632987976074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3089632987976074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.309058666229248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3178324699401855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.318659782409668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.318659782409668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3187837600708008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3310575485229492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3318610191345215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3318610191345215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3319754600524902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3441061973571777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3448028564453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3448028564453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3448963165283203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3554573059082031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3563423156738281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3563423156738281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3564510345458984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.369497299194336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3707919120788574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3707919120788574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3709158897399902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3866610527038574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3873114585876465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3873114585876465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3873858451843262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3973536491394043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3982586860656738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3982586860656738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.3983521461486816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4115300178527832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4126543998718262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4126543998718262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4127650260925293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4291377067565918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4305520057678223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4305520057678223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.43064546585083  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.445131778717041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4458370208740234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4458370208740234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.445901870727539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4564075469970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4572978019714355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4572978019714355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.457374095916748  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4702677726745605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([942, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4928641319274902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4928641319274902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 942, 256]), torch.Size([1, 942, 256])
----------------------------------------3
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.4946608543395996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.8186273574829102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 942, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.7814092636108398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.7818336486816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.7822580337524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.7818121910095215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2848, 40])
input nodes number: 16922
output nodes number: 2848
edges number: 41257
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.7819628715515137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 1.78196382522583  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03882741928100586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 1 input nodes size: 50430
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.034987449645996094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.034987449645996094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.05903434753417969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.05905628204345703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03559732437133789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03694486618041992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03694486618041992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03694486618041992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([50430, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03694486618041992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([532, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.10726451873779297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.10726451873779297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1077718734741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11208343505859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([641, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1124410629272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1124410629272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1130523681640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1222219467163086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([663, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1228647232055664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1228647232055664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.12349700927734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.13799667358398438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([651, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.13892221450805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.13892221450805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1395430564880371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.15849733352661133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([666, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1597747802734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1597747802734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.16040992736816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1835613250732422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([606, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.18497753143310547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.18497753143310547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 606, 128]), torch.Size([1, 606, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.18555545806884766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2112560272216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 606, 128])
m.shape torch.Size([581, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2129063606262207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2129063606262207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.21346044540405273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.24292373657226562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([523, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.24464178085327148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.24464178085327148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.24514055252075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2748408317565918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([545, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2769303321838379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2769303321838379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2774500846862793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.31155872344970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([11605, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.366635799407959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.366635799407959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11605, 128]), torch.Size([1, 11605, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.3777031898498535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1693501472473145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11605, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1025910377502441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1188158988952637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1350407600402832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1186890602111816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([17013, 256])
first layer input nodes number: 50430
first layer output nodes number: 17013
edges number: 142579
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.13541841506958  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1516432762145996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1557493209838867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1557493209838867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([259, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1928257942199707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1928257942199707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1933197975158691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1982159614562988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([198, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.198349952697754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.198349952697754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1987276077270508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.204392433166504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([154, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2046480178833008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2046480178833008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.204941749572754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2114038467407227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([131, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2117609977722168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2117609977722168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2120108604431152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.21925687789917  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([118, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2196993827819824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2196993827819824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2199244499206543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2280268669128418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([113, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2285661697387695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2285661697387695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2287817001342773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2380495071411133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([93, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.23856782913208  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.23856782913208  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2387452125549316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2476143836975098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2482719421386719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2482719421386719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2484569549560547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.259002685546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2597322463989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2597322463989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.259913444519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.271510124206543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2723422050476074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2723422050476074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2725253105163574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2855257987976074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2862906455993652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2862906455993652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.286445140838623  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2984957695007324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.299295425415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.299295425415039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2994403839111328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3117618560791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.313002109527588  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.313002109527588  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3131909370422363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3305630683898926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([68, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3313837051391602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3313837051391602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3315134048461914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3443536758422852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.345139503479004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.345139503479004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3452520370483398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3571805953979492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([62, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3580780029296875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3580780029296875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3581962585449219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3715591430664062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([69, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3728117942810059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3728117942810059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.37294340133667  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3887362480163574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3899812698364258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3899812698364258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.390089988708496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4038972854614258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4051547050476074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4051547050476074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.405271053314209  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4208617210388184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([67, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4221162796020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4221162796020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4222440719604492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.440262794494629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([53, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4415102005004883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4415102005004883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4416112899780273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4565725326538086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4572834968566895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4572834968566895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4573521614074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4679951667785645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4687790870666504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4687790870666504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4688496589660645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4802823066711426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4811930656433105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4811930656433105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4812712669372559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4944872856140137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([707, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.5114364624023438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.5114364624023438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 707, 256]), torch.Size([1, 707, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.5127849578857422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7595882415771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 707, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7255873680114746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7260236740112305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7264599800109863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7260017395019531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2927, 40])
input nodes number: 17013
output nodes number: 2927
edges number: 38183
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7261624336242676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7261629104614258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03937864303588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 2 input nodes size: 55565
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03560924530029297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03560924530029297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.06295299530029297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.0629739761352539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03890514373779297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.04025840759277344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.04025840759277344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.04025840759277344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([55565, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.04025840759277344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([614, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11326837539672852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11326837539672852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11385393142700195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11870670318603516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([817, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11919307708740234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11919307708740234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11997222900390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.13168621063232422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([793, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1324310302734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1324310302734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.13318729400634766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1498250961303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([807, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1509861946105957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1509861946105957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.15175580978393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1750187873840332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([721, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.17635297775268555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.17635297775268555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.17704057693481445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.20269060134887695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([648, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.20420074462890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.20420074462890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2048187255859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.23198699951171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([568, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.23357391357421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.23357391357421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2341156005859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2627830505371094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([548, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2646026611328125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2646026611328125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2651252746582031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2951641082763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([545, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2972416877746582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2972416877746582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2977614402770996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.3315610885620117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([12013, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.3885836601257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.3885836601257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12013, 128]), torch.Size([1, 12013, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.4003024101257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2282686233520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12013, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1598882675170898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1771249771118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.194361686706543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.176990032196045  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([18074, 256])
first layer input nodes number: 55565
first layer output nodes number: 18074
edges number: 148743
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1947779655456543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2120146751403809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2164454460144043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2164454460144043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([324, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.248274803161621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.248274803161621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2488927841186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2539119720458984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([283, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2541470527648926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2541470527648926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2546868324279785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2633686065673828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([215, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.263719081878662  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.263719081878662  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2641291618347168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.27315092086792  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([179, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.273634433746338  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.273634433746338  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2739758491516113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.283876895904541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([136, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2843599319458008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2843599319458008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2846193313598633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2939577102661133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([99, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2943992614746094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2943992614746094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2945880889892578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3027076721191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([86, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.303192138671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.303192138671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3033561706542969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3115577697753906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([61, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3119449615478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3119449615478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3120613098144531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3186931610107422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3192925453186035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3192925453186035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3194375038146973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3287148475646973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([57, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3291902542114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3291902542114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.329298973083496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3370180130004883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.337545394897461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.337545394897461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3376502990722656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3458328247070312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.346461296081543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.346461296081543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.346573829650879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3561391830444336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3567204475402832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3567204475402832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3568177223205566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.365767002105713  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3662700653076172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3662700653076172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3663482666015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3740901947021484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3745989799499512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3745989799499512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.374671459197998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3823542594909668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3830409049987793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3830409049987793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3831305503845215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3932604789733887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3938040733337402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3938040733337402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3938727378845215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4021124839782715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4029607772827148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4029607772827148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4030580520629883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4154119491577148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4160208702087402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4160208702087402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4160895347595215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.425290584564209  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4258713722229004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4258713722229004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4259324073791504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4345383644104004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.435234546661377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.435234546661377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4353032112121582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4454655647277832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4459810256958008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4459810256958008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.446030616760254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4537172317504883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.454289436340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.454289436340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.454340934753418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4626836776733398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4633269309997559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4633269309997559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4633822441101074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4727301597595215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([697, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.489450454711914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.489450454711914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 697, 256]), torch.Size([1, 697, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4907798767089844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7331056594848633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 697, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7038683891296387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.704282283782959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7046961784362793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.704261302947998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2777, 40])
input nodes number: 18074
output nodes number: 2777
edges number: 32665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.704394817352295  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7043952941894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.04268455505371094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 3 input nodes size: 53383
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03888273239135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03888273239135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.06433773040771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.06435918807983398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03699445724487305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03826570510864258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03826570510864258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03826570510864258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([53383, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03826570510864258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([633, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.10600471496582031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.10600471496582031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.10660839080810547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11229372024536133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([810, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11276435852050781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11276435852050781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11353683471679688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1251239776611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([807, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.12589216232299805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.12589216232299805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1266617774963379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.14453744888305664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([758, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1455984115600586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1455984115600586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 758, 128]), torch.Size([1, 758, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.14632129669189453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.16743755340576172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 758, 128])
m.shape torch.Size([737, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.16883325576782227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.16883325576782227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 737, 128]), torch.Size([1, 737, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.16953611373901367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.19496631622314453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 737, 128])
m.shape torch.Size([665, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1965174674987793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1965174674987793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.19715166091918945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.22629928588867188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([555, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.22783470153808594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.22783470153808594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2283639907836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.25524187088012695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([556, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2570981979370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2570981979370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2576284408569336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2879610061645508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([494, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.28981590270996094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.28981590270996094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2902870178222656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.3204383850097656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([10977, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.3725452423095703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.3725452423095703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10977, 128]), torch.Size([1, 10977, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.3830137252807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1262760162353516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10977, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.0630521774291992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.0792570114135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.0954618453979492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.0791301727294922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([16992, 256])
first layer input nodes number: 53383
first layer output nodes number: 16992
edges number: 137930
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.0958619117736816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1120667457580566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1163630485534668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1163630485534668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([324, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1481046676635742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1481046676635742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1487226486206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1537094116210938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([300, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.153977394104004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.153977394104004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1545495986938477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1635346412658691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([215, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1638689041137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1638689041137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1642789840698242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1733007431030273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([190, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1738262176513672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1738262176513672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1741886138916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1846981048583984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([147, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1852235794067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1852235794067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1855039596557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1955976486206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([108, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1960806846618652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1960806846618652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.196286678314209  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2051444053649902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([79, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2055730819702148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2055730819702148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.205723762512207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2132577896118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([76, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2137670516967773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2137670516967773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.213912010192871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2221746444702148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([59, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2226128578186035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2226128578186035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2227253913879395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2299275398254395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2305922508239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2305922508239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2307353019714355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.240891933441162  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2414445877075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2414445877075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2415571212768555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2503347396850586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2508783340454102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2508783340454102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2509775161743164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2594079971313477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2599706649780273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2599706649780273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2600641250610352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.268662452697754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.269181251525879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.269181251525879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.269261360168457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2771921157836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2780027389526367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2780027389526367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2781152725219727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.290043830871582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.29071044921875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.29071044921875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2908000946044922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3009300231933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.301506519317627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.301506519317627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3015789985656738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3102765083312988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3109149932861328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3109149932861328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3109893798828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3204364776611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3211665153503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3211665153503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.32124662399292  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3319811820983887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3323450088500977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3323450088500977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3323850631713867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3380327224731445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3386993408203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3386993408203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3387641906738281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3483619689941406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.34881591796875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.34881591796875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3488597869873047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3556594848632812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.356278896331787  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.356278896331787  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3563342094421387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3652949333190918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3657517433166504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3657517433166504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3657917976379395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.372560977935791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([693, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3891925811767578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3891925811767578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 693, 256]), torch.Size([1, 693, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3905143737792969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.6282076835632324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 693, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.599104404449463  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.599524974822998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.5999455451965332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.599503517150879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2821, 40])
input nodes number: 16992
output nodes number: 2821
edges number: 32571
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.599658489227295  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.5996589660644531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.04059791564941406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 4 input nodes size: 44730
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03700113296508789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03700113296508789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.05833005905151367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.058351993560791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03287553787231445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03421163558959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03421163558959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03421163558959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([44730, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.03421163558959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([424, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1009669303894043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1009669303894043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.10137128829956055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.10460615158081055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([572, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1049494743347168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1049494743347168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.10549497604370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1138296127319336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([621, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11444520950317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11444520950317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.11503744125366211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1281275749206543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([595, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1289663314819336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1289663314819336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1295337677001953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.14630985260009766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([571, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.14738750457763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.14738750457763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1479320526123047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.16873598098754883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([543, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.17001724243164062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.17001724243164062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.17053508758544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.19364643096923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([479, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1957850456237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1957850456237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.1962418556213379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.21908235549926758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([511, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.22080326080322266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.22080326080322266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.22129058837890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2490682601928711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([538, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.25113344192504883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.25113344192504883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.2516465187072754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.28519201278686523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([11197, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.33832693099975586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.33832693099975586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11197, 128]), torch.Size([1, 11197, 128])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 0.34900522232055664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1097559928894043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11197, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.0468316078186035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.0621390342712402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.077446460723877  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.0620193481445312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([16051, 256])
first layer input nodes number: 44730
first layer output nodes number: 16051
edges number: 136177
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.0777816772460938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.0930891036987305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.097154140472412  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.097154140472412  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([200, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1388812065124512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1388812065124512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1392626762390137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1423144340515137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([177, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1424641609191895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1424641609191895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1428017616271973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1478657722473145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([180, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1482162475585938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1482162475585938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1485595703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1561126708984375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([92, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.156294822692871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.156294822692871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1564702987670898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1615591049194336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([94, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1619234085083008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1619234085083008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1621026992797852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1685571670532227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([83, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1689462661743164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1689462661743164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1691045761108398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1759119033813477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([71, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1763105392456055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1763105392456055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1764459609985352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1832170486450195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([72, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1837029457092285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1837029457092285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.183840274810791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1916680335998535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([73, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1922311782836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1922311782836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1923704147338867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2012815475463867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2019233703613281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2019233703613281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2020645141601562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2120857238769531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.212850570678711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.212850570678711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2130012512207031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2247543334960938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2255558967590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2255558967590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.225700855255127  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2380223274230957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2387871742248535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2387871742248535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.238914966583252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2506718635559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.251509666442871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.251509666442871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2516374588012695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2642889022827148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2650179862976074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2650179862976074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.265122890472412  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.276242733001709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2771286964416504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2771286964416504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.277245044708252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2903923988342285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2912492752075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.2912492752075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.291356086730957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.304173469543457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.305168628692627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.305168628692627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3052830696105957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.319817066192627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3208374977111816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3208374977111816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3209500312805176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3360295295715332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3380632400512695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3380632400512695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3381757736206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3540430068969727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3549556732177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3549556732177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3550472259521484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3685970306396484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3694396018981934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3694396018981934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3695197105407715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3819365501403809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3824715614318848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3824715614318848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.382521152496338  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3905549049377441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([47, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3916144371032715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3916144371032715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.3917040824890137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.4068541526794434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([992, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.43064546585083  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.43064546585083  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 992, 256]), torch.Size([1, 992, 256])
----------------------------------------3
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.43253755569458  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7753396034240723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 992, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7364845275878906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7369184494018555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7373523712158203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7368965148925781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2910, 40])
input nodes number: 16051
output nodes number: 2910
edges number: 43082
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7370514869689941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.7370519638061523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.036608219146728516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 5 input nodes size: 48857
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03288888931274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03288888931274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.05632638931274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.05634784698486328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.034996986389160156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03596687316894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03596687316894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03596687316894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48857, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03596687316894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([821, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08838081359863281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08838081359863281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08916378021240234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.0954275131225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([1026, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.0962986946105957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.0962986946105957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1026, 128]), torch.Size([1, 1026, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.09727716445922852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1119542121887207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1026, 128])
m.shape torch.Size([939, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.11339902877807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.11339902877807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 939, 128]), torch.Size([1, 939, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.11429452896118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.13480234146118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 939, 128])
m.shape torch.Size([984, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1362314224243164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1362314224243164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.13716983795166016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.16564273834228516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([868, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.16750812530517578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.16750812530517578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1683359146118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1983957290649414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([748, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.20012187957763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.20012187957763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2008352279663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2326040267944336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([699, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.23458051681518555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.23458051681518555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 699, 128]), torch.Size([1, 699, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.23524713516235352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2694969177246094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 699, 128])
m.shape torch.Size([620, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2715287208557129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2715287208557129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.27211999893188477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.30629587173461914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([553, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.30837345123291016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.30837345123291016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.3089008331298828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.3433356285095215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([7300, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.3778810501098633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.3778810501098633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7300, 128]), torch.Size([1, 7300, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.38561534881591797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8799047470092773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7300, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8324074745178223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8462910652160645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8601746559143066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8461823463439941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([14558, 256])
first layer input nodes number: 48857
first layer output nodes number: 14558
edges number: 106284
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8605408668518066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8744244575500488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8778953552246094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8778953552246094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9020476341247559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9020476341247559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9028658866882324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9108824729919434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([366, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9111771583557129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9111771583557129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9118752479553223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.926729679107666  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([247, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9270930290222168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9270930290222168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9275641441345215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9379286766052246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9386544227600098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9386544227600098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9391312599182129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9529595375061035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9536104202270508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9536104202270508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9539632797241211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9666662216186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([132, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9672513008117676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9672513008117676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9675030708312988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9783291816711426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9789505004882812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9789505004882812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9791622161865234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9897480010986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9904880523681641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9904880523681641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9906978607177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0026569366455078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0033740997314453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0033740997314453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0035552978515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0151519775390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0158882141113281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0158882141113281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.01605224609375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0276985168457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0284204483032227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0284204483032227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0285654067993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.039872169494629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0405726432800293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0405726432800293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0407004356384277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.051562786102295  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.052086353302002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.052086353302002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0521759986877441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0604233741760254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0609841346740723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0609841346740723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0610699653625488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0695672035217285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.07008695602417  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.07008695602417  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0701613426208496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0780463218688965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0786552429199219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0786552429199219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0787353515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0877876281738281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0882377624511719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0882377624511719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0882949829101562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0951614379882812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0958251953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0958251953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0959014892578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1055908203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1061553955078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1061553955078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1062183380126953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1146526336669922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1151790618896484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1151790618896484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.115234375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1230335235595703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.123490333557129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.123490333557129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1235361099243164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1303110122680664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1305842399597168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1305842399597168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1306109428405762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1347498893737793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.135289192199707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.135289192199707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1353368759155273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.143061637878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1435222625732422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1435222625732422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1435623168945312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1503314971923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([293, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1573519706726074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1573519706726074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1579108238220215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.2609643936157227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 293, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.2398810386657715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.2403039932250977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.2407269477844238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.2402825355529785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2836, 40])
input nodes number: 14558
output nodes number: 2836
edges number: 23782
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.2404017448425293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.2404022216796875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.0378260612487793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 6 input nodes size: 45089
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.034986019134521484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.034986019134521484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.05648612976074219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.05650758743286133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03304862976074219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.033885955810546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.033885955810546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.033885955810546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([45089, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.033885955810546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([778, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07736921310424805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07736921310424805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07811117172241211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08450031280517578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([1031, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08606100082397461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08606100082397461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08704423904418945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10179281234741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([980, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10318756103515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10318756103515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10412216186523438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1250896453857422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([935, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1264057159423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1264057159423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 935, 128]), torch.Size([1, 935, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.12729740142822266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.15383148193359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 935, 128])
m.shape torch.Size([888, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1561875343322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1561875343322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 888, 128]), torch.Size([1, 888, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.15703439712524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.18752145767211914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 888, 128])
m.shape torch.Size([678, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.18903779983520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.18903779983520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.18968439102172852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.21891260147094727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([652, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2207655906677246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2207655906677246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.22138738632202148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2541689872741699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([527, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.25586843490600586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.25586843490600586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.25637102127075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.28635549545288086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([469, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2881169319152832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2881169319152832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.28856420516967773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.31718969345092773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([5700, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.34430980682373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.34430980682373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5700, 128]), torch.Size([1, 5700, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.3497457504272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7463521957397461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5700, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.706934928894043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7189874649047852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7310400009155273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7188930511474609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([12638, 256])
first layer input nodes number: 45089
first layer output nodes number: 12638
edges number: 88029
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7313780784606934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7434306144714355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7464437484741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7464437484741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([372, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7705459594726562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7705459594726562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7712554931640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7769317626953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7772655487060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7772655487060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7779483795166016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7883343696594238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([271, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7887744903564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7887744903564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7892913818359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8020415306091309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8026828765869141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8026828765869141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8031291961669922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8160724639892578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8168010711669922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8168010711669922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8171787261962891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8307743072509766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8314275741577148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8314275741577148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8317060470581055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8436803817749023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8444023132324219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8444023132324219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8446464538574219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8568534851074219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8575925827026367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8575925827026367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8578062057495117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8699827194213867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8706374168395996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8706374168395996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8708052635192871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8815474510192871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8823385238647461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8823385238647461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.882512092590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8948354721069336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8955526351928711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8955526351928711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8956975936889648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9070043563842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([80, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9078545570373535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9078545570373535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9080071449279785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9209771156311035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9216132164001465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9216132164001465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9217219352722168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9317240715026855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9322891235351562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9322891235351562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9323768615722656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9410629272460938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9415240287780762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9415240287780762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9415907859802246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.948667049407959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9490799903869629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9490799903869629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9491353034973145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.955385684967041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9559793472290039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9559793472290039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9560518264770508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9647493362426758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9652152061462402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9652152061462402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9652705192565918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9722952842712402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9729619026184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9729619026184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9730343818664551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9827466011047363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9831528663635254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9831528663635254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9831967353820801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.989382266998291  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9899659156799316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9899659156799316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.990023136138916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9984917640686035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9989495277404785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9989495277404785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9989933967590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0057930946350098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0062575340270996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0062575340270996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0062994956970215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0130972862243652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.013537883758545  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.013537883758545  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0135760307312012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0200228691101074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([296, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.027116298675537  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.027116298675537  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0276808738708496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1351752281188965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 296, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1140918731689453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1145153045654297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.114938735961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1144938468933105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2840, 40])
input nodes number: 12638
output nodes number: 2840
edges number: 24239
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.114610195159912  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1146106719970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.035556793212890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 7 input nodes size: 47694
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03304910659790039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03304910659790039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.05648660659790039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.05650806427001953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03498649597167969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03575706481933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03575706481933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03575706481933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([47694, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03575706481933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([975, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07844781875610352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07844781875610352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07937765121459961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08702993392944336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([1221, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08772945404052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08772945404052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1221, 128]), torch.Size([1, 1221, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08889389038085938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10636043548583984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1221, 128])
m.shape torch.Size([1228, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10753488540649414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10753488540649414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1228, 128]), torch.Size([1, 1228, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10870599746704102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.13509798049926758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1228, 128])
m.shape torch.Size([1056, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.13652658462524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.13652658462524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.13753366470336914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.16673898696899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([980, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.16857194900512695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.16857194900512695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.16950654983520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.20369195938110352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([778, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.20545053482055664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.20545053482055664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2061924934387207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.23895692825317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([653, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.24076557159423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.24076557159423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.24138832092285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2737889289855957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([590, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2757282257080078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2757282257080078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2762908935546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.30940723419189453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([518, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.31134891510009766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.31134891510009766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.3118429183959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.34503936767578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([5131, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.3692588806152344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.3692588806152344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5131, 128]), torch.Size([1, 5131, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.37458276748657227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.722437858581543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5131, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6844840049743652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6970057487487793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7095274925231934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6969075202941895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13130, 256])
first layer input nodes number: 47694
first layer output nodes number: 13130
edges number: 86156
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7098851203918457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7224068641662598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7258906364440918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7258906364440918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([497, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7429299354553223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7429299354553223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7438778877258301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7515702247619629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([413, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7518901824951172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7518901824951172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7526779174804688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7675323486328125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([345, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.768183708190918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.768183708190918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7688417434692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7836651802062988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([286, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7844738960266113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7844738960266113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7850193977355957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8008785247802734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([235, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8017354011535645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8017354011535645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8021836280822754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8183197975158691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8191204071044922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8191204071044922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8194561004638672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8338909149169922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8347334861755371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8347334861755371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.835019588470459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8493247032165527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8499736785888672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8499736785888672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8501701354980469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8613681793212891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8621525764465332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8621525764465332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8623471260070801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8747982978820801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8755183219909668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8755183219909668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8756804466247559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8871912956237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8878188133239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8878188133239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.887946605682373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8979144096374512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8983006477355957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8983006477355957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8983750343322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9046978950500488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9051856994628906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9051856994628906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9052658081054688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9126358032226562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9131073951721191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9131073951721191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.913179874420166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9203553199768066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9206218719482422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9206218719482422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9206619262695312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9249076843261719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9252109527587891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9252109527587891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9252510070800781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9297771453857422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9300189018249512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9300189018249512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9300494194030762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9337115287780762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9339385032653809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9339385032653809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9339652061462402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9373564720153809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.937617301940918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.937617301940918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9376459121704102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9414796829223633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9417157173156738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9417157173156738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9417405128479004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9452366828918457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9454665184020996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9454665184020996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9454894065856934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9488768577575684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9489712715148926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9489712715148926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9489808082580566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9504590034484863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9505648612976074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9505648612976074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9505743980407715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9521193504333496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9522991180419922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9522991180419922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9523143768310547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9548931121826172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([122, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9578170776367188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9578170776367188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9580497741699219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9990043640136719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 122, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9852070808410645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9856290817260742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.986051082611084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9856076240539551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2830, 40])
input nodes number: 13130
output nodes number: 2830
edges number: 17097
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9857258796691895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9857263565063477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03733682632446289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 8 input nodes size: 41212
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03498506546020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03498506546020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.054636478424072266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.054657936096191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.031198978424072266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.032018184661865234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.032018184661865234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.032018184661865234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([41212, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.032018184661865234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([717, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07445859909057617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07445859909057617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07514238357543945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.0806126594543457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([887, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.0811166763305664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.0811166763305664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08196258544921875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.09485149383544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([907, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.09572601318359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.09572601318359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.09659099578857422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1156620979309082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([922, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1169881820678711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1169881820678711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.11786746978759766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.14336681365966797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([831, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.14490842819213867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.14490842819213867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.14570093154907227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.17547845840454102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([713, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1771221160888672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1771221160888672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.17780208587646484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2080392837524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([646, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2098555564880371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2098555564880371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.21047163009643555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.24247980117797852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([565, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.24526548385620117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.24526548385620117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2458043098449707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.2785320281982422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([484, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.28033971786499023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.28033971786499023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.28080129623413086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.31034231185913086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([5345, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.3355984687805176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.3355984687805176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5345, 128]), torch.Size([1, 5345, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.340695858001709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7044672966003418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5345, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6664018630981445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6778621673583984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6893224716186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6777725219726562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([12017, 256])
first layer input nodes number: 41212
first layer output nodes number: 12017
edges number: 84181
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6901483535766602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7016086578369141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7057318687438965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7057318687438965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([334, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7308287620544434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7308287620544434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7314658164978027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.737311840057373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([291, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7375531196594238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7375531196594238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7381081581115723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7489171028137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([209, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7492423057556152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7492423057556152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.749640941619873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7584109306335449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([204, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7589960098266602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7589960098266602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7593851089477539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7706689834594727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7714357376098633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7714357376098633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7718172073364258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7855501174926758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7862129211425781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7862129211425781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7864952087402344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7986335754394531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7995514869689941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7995514869689941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7998337745666504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8139481544494629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.814760684967041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.814760684967041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8149971961975098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8284783363342285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([123, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.829892635345459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.829892635345459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8301272392272949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8451418876647949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([109, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8467235565185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8467235565185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8469314575195312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8616924285888672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([111, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.863288402557373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.863288402557373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8635001182556152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8800139427185059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8807735443115234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8807735443115234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8809165954589844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8930759429931641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([82, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8947029113769531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8947029113769531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8948593139648438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9092483520507812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9101123809814453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9101123809814453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9102458953857422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9234638214111328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9241323471069336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9241323471069336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.924229621887207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9345407485961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9352765083312988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9352765083312988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9353737831115723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9463658332824707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9468894004821777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9468894004821777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9469561576843262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9549670219421387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9556951522827148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9556951522827148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9557790756225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9664373397827148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9669981002807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9669981002807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9670610427856445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9754953384399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9762716293334961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9762716293334961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9763517379760742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9876470565795898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9880914688110352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9880914688110352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9881372451782227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9949121475219727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9954180717468262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9954180717468262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9954657554626465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.002856731414795  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0032310485839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0032310485839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.003265380859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0088272094726562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0093178749084473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0093178749084473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0093598365783691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.016451358795166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([263, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0232672691345215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0232672691345215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0237689018249512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.1169185638427734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 263, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0948424339294434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0952653884887695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0956883430480957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0952439308166504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2836, 40])
input nodes number: 12017
output nodes number: 2836
edges number: 25645
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0953559875488281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0953564643859863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.03363847732543945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 9 input nodes size: 34892
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.031199932098388672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.031199932098388672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.04783773422241211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.04785919189453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.028186321258544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.029007434844970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.029007434844970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.029007434844970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([34892, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.029007434844970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([509, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.06799602508544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.06799602508544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.0684814453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07236480712890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([738, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07282590866088867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07282590866088867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.07352972030639648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08416509628295898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([776, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08513545989990234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.08513545989990234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.0858755111694336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1023244857788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([784, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10344982147216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10344982147216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.10419750213623047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.12588024139404297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([738, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.12726593017578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.12726593017578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.12796974182128906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1537647247314453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([646, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.15526103973388672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.15526103973388672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.15587711334228516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.18348026275634766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([582, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.18511486053466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.18511486053466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.1856698989868164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.21437740325927734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([504, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.21602249145507812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.21602249145507812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.21650314331054688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.24390029907226562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([434, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.24568557739257812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.24568557739257812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.24609947204589844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.27258872985839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([5212, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.29723453521728516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.29723453521728516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5212, 128]), torch.Size([1, 5212, 128])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.30221080780029297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.655125617980957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5212, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6198916435241699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6303086280822754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6407256126403809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6302270889282227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([10923, 256])
first layer input nodes number: 34892
first layer output nodes number: 10923
edges number: 79147
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6409878730773926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.651404857635498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6540093421936035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6540093421936035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([246, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6840529441833496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6840529441833496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6845221519470215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6882758140563965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([216, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6884565353393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6884565353393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.688868522644043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.6950483322143555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([176, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.695350170135498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.695350170135498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.695685863494873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.703071117401123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([163, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7035303115844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7035303115844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7038412094116211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7128572463989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([161, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7134757041931152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7134757041931152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.713782787322998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7248377799987793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7255148887634277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7255148887634277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7257895469665527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7375998497009277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7387161254882812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7387161254882812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7390117645263672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7537937164306641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7548995018005371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7548995018005371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7551589012145996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7699446678161621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([116, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7716002464294434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7716002464294434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7718214988708496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7859816551208496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([140, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7876591682434082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.7876591682434082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.787926197052002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8068852424621582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([120, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8085393905639648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8085393905639648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8087682723999023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8266210556030273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8274755477905273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8274755477905273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8276357650756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8412542343139648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8429603576660156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8429603576660156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8431282043457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8585700988769531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8602719306945801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8602719306945801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8604168891906738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8747677803039551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8755893707275391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8755893707275391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8757076263427734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8882427215576172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([65, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8899693489074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8899693489074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.8900933265686035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9041028022766113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.905827522277832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.905827522277832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9059629440307617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9222135543823242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.923011302947998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.923011302947998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9231066703796387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.935218334197998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9359011650085449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9359011650085449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9359774589538574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9462008476257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9479489326477051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9479489326477051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9480538368225098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9628453254699707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9637618064880371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9637618064880371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9638533592224121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9774031639099121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9780340194702148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9780340194702148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9780950546264648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9875555038452148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.988011360168457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.988011360168457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9880533218383789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9948511123657227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9954991340637207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9954991340637207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.9955544471740723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0049023628234863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([374, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.014059066772461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.014059066772461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 1.0147724151611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4530029296875 GB
    Memory Allocated: 1.1455731391906738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 374, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4530029296875 GB
    Memory Allocated: 1.1184301376342773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4530029296875 GB
    Memory Allocated: 1.1188578605651855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4549560546875 GB
    Memory Allocated: 1.1192855834960938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4549560546875 GB
    Memory Allocated: 1.1188364028930664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2869, 40])
input nodes number: 10923
output nodes number: 2869
edges number: 30881
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4549560546875 GB
    Memory Allocated: 1.1189441680908203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4549560546875 GB
    Memory Allocated: 1.1189446449279785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.030601978302001953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 10 input nodes size: 34893
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.028191089630126953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.028191089630126953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.044829368591308594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.044850826263427734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.028191566467285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.029039382934570312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.029039382934570312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.029039382934570312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([34893, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.029039382934570312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([522, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.06947755813598633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.06947755813598633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.06997537612915039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07572460174560547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([690, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07613372802734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07613372802734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07679176330566406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08666229248046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([725, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08737039566040039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08737039566040039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 725, 128]), torch.Size([1, 725, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08806180953979492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10329246520996094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 725, 128])
m.shape torch.Size([744, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10498571395874023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10498571395874023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10569524765014648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12663793563842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([720, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12799978256225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12799978256225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12868642807006836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1543440818786621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 720, 128])
m.shape torch.Size([635, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.15581750869750977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.15581750869750977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.15642309188842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18405675888061523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([598, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18575000762939453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18575000762939453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18632030487060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21532249450683594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([530, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21705913543701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21705913543701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21756458282470703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2480154037475586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([435, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24962949752807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24962949752807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2500443458557129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2765946388244629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([5531, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.30373096466064453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.30373096466064453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5531, 128]), torch.Size([1, 5531, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3090057373046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6844844818115234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5531, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6477847099304199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6583991050720215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.669013500213623  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6583161354064941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([11130, 256])
first layer input nodes number: 34893
first layer output nodes number: 11130
edges number: 82114
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6692757606506348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6798901557922363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6825437545776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6825437545776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([247, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7132787704467773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7132787704467773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.713749885559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7175188064575195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([205, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7176775932312012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7176775932312012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7180685997009277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7239336967468262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([154, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7241826057434082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7241826057434082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7244763374328613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7309384346008301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([152, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7313761711120605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7313761711120605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.731666088104248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7400736808776855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([154, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7406692504882812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7406692504882812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7409629821777344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7515373229980469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([122, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7520942687988281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7520942687988281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7523269653320312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7623329162597656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7631721496582031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7631721496582031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7634429931640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7769851684570312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([139, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7779278755187988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7779278755187988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7781929969787598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7933049201965332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([132, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7943506240844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7943506240844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7946023941040039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8107156753540039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([119, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8117680549621582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8117680549621582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8119950294494629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8281102180480957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8295507431030273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8295507431030273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8297662734985352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8465776443481445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([106, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8476924896240234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8476924896240234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8478946685791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8650798797607422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8661003112792969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8661003112792969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8662681579589844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8817100524902344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8828105926513672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8828105926513672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8829784393310547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8995952606201172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9006896018981934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9006896018981934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9008421897888184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9170165061950684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9178013801574707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9178013801574707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9179081916809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9299778938293457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9309282302856445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9309282302856445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9310445785522461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9450063705444336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9458136558532715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9458136558532715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9459090232849121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9580206871032715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9585943222045898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9585943222045898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9586591720581055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9673490524291992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9682779312133789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9682779312133789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9683732986450195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9818201065063477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9827413558959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9827413558959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9828329086303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9963827133178711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9969291687011719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9969291687011719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9969825744628906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0052604675292969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0058088302612305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0058088302612305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0058584213256836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0138921737670898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0145363807678223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0145363807678223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0145916938781738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.023939609527588  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([416, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0339078903198242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0339078903198242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0347013473510742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.175262451171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 416, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1483197212219238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1487431526184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1491665840148926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.148721694946289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2839, 40])
input nodes number: 11130
output nodes number: 2839
edges number: 31601
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1488218307495117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.14882230758667  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.030660152435302734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 11 input nodes size: 42745
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.028187274932861328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.028187274932861328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.048569679260253906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.04859113693237305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.031931400299072266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03285360336303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03285360336303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03285360336303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([42745, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03285360336303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([658, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07908391952514648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07908391952514648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0797114372253418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08616209030151367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([859, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08666753768920898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08666753768920898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08748674392700195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09977483749389648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([884, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10125350952148438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10125350952148438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 884, 128]), torch.Size([1, 884, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1020965576171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12064361572265625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 884, 128])
m.shape torch.Size([829, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12182426452636719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12182426452636719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12261486053466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1465282440185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([731, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14787578582763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14787578582763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 731, 128]), torch.Size([1, 731, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1485729217529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17426347732543945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 731, 128])
m.shape torch.Size([682, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17586612701416016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17586612701416016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 682, 128]), torch.Size([1, 682, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17651653289794922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2050638198852539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 682, 128])
m.shape torch.Size([596, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2067279815673828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2067279815673828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20729637145996094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23620986938476562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([553, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2380352020263672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2380352020263672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23856258392333984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2695350646972656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([522, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2715115547180176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2715115547180176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27200937271118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.30515432357788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([6443, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.33615541458129883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.33615541458129883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6443, 128]), torch.Size([1, 6443, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3422999382019043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7785611152648926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6443, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7365927696228027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7487587928771973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7609248161315918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7486634254455566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([12757, 256])
first layer input nodes number: 42745
first layer output nodes number: 12757
edges number: 93815
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7612452507019043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7734112739562988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7764530181884766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7764530181884766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([336, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8064212799072266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8064212799072266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8070621490478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8127865791320801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([283, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8130102157592773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8130102157592773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8135499954223633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8217554092407227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([219, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8221173286437988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8221173286437988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8225350379943848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8317246437072754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([173, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8321809768676758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8321809768676758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8325109481811523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8420801162719727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([130, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8425402641296387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8425402641296387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8427882194519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8517146110534668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([135, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8523693084716797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8523693084716797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8526268005371094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8636989593505859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([102, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8642568588256836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8642568588256836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8644514083862305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8741788864135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8749046325683594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8749046325683594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8751087188720703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8867416381835938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([115, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8877453804016113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8877453804016113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8879647254943848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9020028114318848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([101, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9028639793395996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9028639793395996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9030566215515137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9167342185974121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9177436828613281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9177436828613281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9179248809814453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9320583343505859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9329366683959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9329366683959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9330968856811523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9467153549194336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9474725723266602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9474725723266602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9476003646850586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9593572616577148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9600872993469238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9600872993469238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9601998329162598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9713406562805176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9720921516418457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9720921516418457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9721989631652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9835209846496582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9841904640197754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9841904640197754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9842801094055176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9944100379943848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9952478408813477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9952478408813477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9953508377075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0077104568481445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0084896087646484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0084896087646484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0085811614990234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0202083587646484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.020911693572998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.020911693572998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0209898948669434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0314688682556152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.032179832458496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.032179832458496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0322542190551758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0427427291870117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0434322357177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0434322357177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0435009002685547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0536632537841797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0542211532592773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0542211532592773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.054274559020996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0625524520874023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0634102821350098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0634102821350098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0634865760803223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0758461952209473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0764541625976562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0764541625976562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.076507568359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0855331420898438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([438, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0967369079589844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0967369079589844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0975723266601562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.249669075012207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 438, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.222611904144287  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.223038673400879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2234654426574707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2230172157287598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2861, 40])
input nodes number: 12757
output nodes number: 2861
edges number: 29923
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.223137378692627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2231378555297852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03463935852050781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 12 input nodes size: 43022
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03193473815917969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03193473815917969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05244922637939453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05247068405151367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03206682205200195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03304433822631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03304433822631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03304433822631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([43022, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03304433822631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([652, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08204507827758789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08204507827758789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08266687393188477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08807706832885742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([842, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08856916427612305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08856916427612305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08937215805053711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10141706466674805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([921, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10255002975463867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10255002975463867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10342836380004883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12275171279907227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([847, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12392807006835938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12392807006835938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12473583221435547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14857101440429688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([806, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.15008878707885742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.15008878707885742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.15085744857788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18062639236450195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([747, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18237924575805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18237924575805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1830916404724121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21410036087036133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([656, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21593379974365234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21593379974365234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21655941009521484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24861621856689453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([594, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2512636184692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2512636184692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2518301010131836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2848978042602539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([557, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2870049476623535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2870049476623535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2875361442565918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3221445083618164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([6813, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.35436582565307617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.35436582565307617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6813, 128]), torch.Size([1, 6813, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.36094141006469727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8240399360656738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6813, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7797212600708008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7925338745117188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8053464889526367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7924337387084961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13435, 256])
first layer input nodes number: 43022
first layer output nodes number: 13435
edges number: 99486
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8056693077087402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8184819221496582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8216853141784668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8216853141784668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([249, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8524312973022461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8524312973022461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8529062271118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8567056655883789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([242, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.85693359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.85693359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8573951721191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.86431884765625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([204, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8646764755249023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8646764755249023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8650655746459961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8736257553100586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([171, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8740887641906738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8740887641906738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8744149208068848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.883873462677002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8844361305236816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8844361305236816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8847241401672363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8950924873352051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8957386016845703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8957386016845703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8959999084472656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9072360992431641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9080410003662109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9080410003662109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9083061218261719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9215621948242188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9222989082336426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9222989082336426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9225144386291504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9347996711730957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9355831146240234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9355831146240234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9357795715332031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9483528137207031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([127, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9494752883911133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9494752883911133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9497175216674805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9669160842895508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9676094055175781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9676094055175781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9677562713623047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9792118072509766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([87, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9801793098449707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9801793098449707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9803452491760254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9944500923156738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([78, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9953417778015137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9953417778015137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.995490550994873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0091776847839355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.010058879852295  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.010058879852295  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0101943016052246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0236010551452637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0246868133544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0246868133544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0248394012451172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0410137176513672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0417680740356445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0417680740356445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0418710708618164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0535097122192383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0543408393859863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0543408393859863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0544438362121582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0668034553527832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0674614906311035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0674614906311035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0675396919250488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0774712562561035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0781264305114746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0781264305114746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0781989097595215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0879111289978027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.088740348815918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.088740348815918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0888261795043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1009283065795898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1015114784240723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1015114784240723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1015706062316895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1103215217590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1109051704406738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1109051704406738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1109604835510254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1195340156555176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.119992733001709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.119992733001709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1200346946716309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1268324851989746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1275267601013184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1275267601013184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1275858879089355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1375784873962402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([486, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1493582725524902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1493582725524902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.150285243988037  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3202548027038574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 486, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.292783260345459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2932095527648926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2936358451843262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2931880950927734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2860, 40])
input nodes number: 13435
output nodes number: 2860
edges number: 31610
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.293309211730957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2933096885681152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03491067886352539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 13 input nodes size: 41163
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03206634521484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03206634521484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.051694393157958984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.051715850830078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03117990493774414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03203916549682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03203916549682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03203916549682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([41163, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03203916549682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([696, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07524490356445312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07524490356445312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07590866088867188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08121871948242188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([894, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08173942565917969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08173942565917969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08259201049804688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09575939178466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([859, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09656190872192383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09656190872192383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0973811149597168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11604595184326172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([868, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11729192733764648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11729192733764648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11811971664428711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14225530624389648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([767, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14367008209228516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14367008209228516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14440155029296875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17107200622558594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([668, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17261743545532227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17261743545532227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17325448989868164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20178842544555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([637, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2035961151123047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2035961151123047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20420360565185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23633146286010742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([583, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2382516860961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2382516860961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23880767822265625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2717399597167969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([495, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2735862731933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2735862731933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27405834197998047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.30427074432373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([5762, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.331510066986084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.331510066986084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5762, 128]), torch.Size([1, 5762, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3370051383972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7363638877868652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5762, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.697455883026123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7091183662414551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.720893383026123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.709139347076416  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([12229, 256])
first layer input nodes number: 41163
first layer output nodes number: 12229
edges number: 87574
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7212023735046387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7328648567199707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7357807159423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7357807159423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([328, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7627272605895996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7627272605895996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7633528709411621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7695522308349609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([295, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7698068618774414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7698068618774414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7703695297241211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7800049781799316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([182, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7802486419677734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7802486419677734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7805957794189453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7882328033447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([174, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7887282371520996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7887282371520996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.789060115814209  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7986845970153809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([166, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.79931640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.79931640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7996330261230469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8110313415527344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8117384910583496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8117384910583496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8120245933532715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8243269920349121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([154, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8252363204956055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8252363204956055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8255300521850586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8402166366577148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8410158157348633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8410158157348633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8412504196166992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8546228408813477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([143, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8561000823974609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8561000823974609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8563728332519531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8738288879394531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8746728897094727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8746728897094727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8748674392700195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8886804580688477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([95, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8895878791809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8895878791809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8897690773010254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.903902530670166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9047808647155762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9047808647155762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9049410820007324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9185595512390137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9194045066833496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9194045066833496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9195456504821777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9325308799743652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9331469535827637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9331469535827637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9332442283630371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9428744316101074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9435901641845703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9435901641845703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9436912536621094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.95440673828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9550790786743164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9550790786743164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9551687240600586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9652986526489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9661035537719727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9661035537719727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9662027359008789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9781045913696289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9786262512207031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9786262512207031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9786891937255859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9866828918457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9874186515808105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9874186515808105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9874987602233887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9982333183288574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.998866081237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.998866081237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9989328384399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.008345603942871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0088372230529785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0088372230529785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0088868141174316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0162262916564941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.016983985900879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.016983985900879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.017054557800293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0279932022094727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0284442901611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0284442901611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0284862518310547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0352840423583984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0358400344848633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0358400344848633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0358877182006836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0439462661743164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([344, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.052527904510498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.052527904510498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0531840324401855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1766929626464844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 344, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1526994705200195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1531224250793457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1535453796386719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1531009674072266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2837, 40])
input nodes number: 12229
output nodes number: 2837
edges number: 27577
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1532106399536133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1532111167907715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.033715248107910156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 14 input nodes size: 49388
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03117656707763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03117656707763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.054726600646972656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0547480583190918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03509855270385742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0359644889831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0359644889831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0359644889831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49388, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0359644889831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([889, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08302927017211914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08302927017211914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0838770866394043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09106206893920898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([1119, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09210538864135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09210538864135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09317255020141602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10917997360229492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1147, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11028718948364258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11028718948364258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1147, 128]), torch.Size([1, 1147, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11138105392456055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13622617721557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1147, 128])
m.shape torch.Size([1041, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.137664794921875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.137664794921875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1386575698852539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1674480438232422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([968, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16925954818725586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16925954818725586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1701827049255371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20423650741577148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([797, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2060551643371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2060551643371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20681524276733398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24057340621948242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([658, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24238967895507812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24238967895507812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24301719665527344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2758297920227051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([629, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27791547775268555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27791547775268555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2785153388977051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.315305233001709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([585, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31751585006713867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31751585006713867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31807374954223633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3550148010253906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([5997, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3840327262878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3840327262878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5997, 128]), torch.Size([1, 5997, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3897519111633301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.798337459564209  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5997, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7564001083374023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7695894241333008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7827787399291992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7694859504699707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13830, 256])
first layer input nodes number: 49388
first layer output nodes number: 13830
edges number: 95227
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7831487655639648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7963380813598633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7996354103088379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7996354103088379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([442, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8202610015869141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8202610015869141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8211040496826172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8289837837219238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([385, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8293027877807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8293027877807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8300371170043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8445911407470703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([329, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8451728820800781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8451728820800781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8458003997802734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8596057891845703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([258, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8603110313415527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8603110313415527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8608031272888184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8761897087097168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8769965171813965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8769965171813965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8774142265319824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8924517631530762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8931832313537598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8931832313537598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8934941291809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.906862735748291  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9074339866638184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9074339866638184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9076399803161621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9179396629333496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9185829162597656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9185829162597656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9187679290771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9293136596679688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([120, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9302592277526855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9302592277526855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.930488109588623  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.945136547088623  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9457335472106934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9457335472106934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9458746910095215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9558959007263184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9564914703369141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9564914703369141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9566116333007812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9659843444824219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9665818214416504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9665818214416504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9666905403137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9759316444396973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9765896797180176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9765896797180176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9766983985900879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9867005348205566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9872655868530273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9872655868530273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9873533248901367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9960393905639648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9966878890991211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9966878890991211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9967794418334961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.006484031677246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0068998336791992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0068998336791992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0069570541381836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.013422966003418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.013770580291748  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.013770580291748  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0138144493103027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0190787315368652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0195069313049316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0195069313049316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0195565223693848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0258545875549316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0262317657470703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0262317657470703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0262737274169922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0318965911865234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0321640968322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0321640968322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0321927070617676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.036226749420166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0365962982177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0365962982177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0366325378417969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0419960021972656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0424222946166992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0424222946166992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0424623489379883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.048670768737793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.049048900604248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.049048900604248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0490832328796387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.05464506149292  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0548820495605469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0548820495605469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0549030303955078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0584487915039062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([206, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0633883476257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0633883476257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0637812614440918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1329340934753418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 206, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1159286499023438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1163544654846191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1167802810668945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1163330078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2857, 40])
input nodes number: 13830
output nodes number: 2857
edges number: 20884
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1164608001708984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1164612770080566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03770112991333008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 15 input nodes size: 50496
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03510141372680664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03510141372680664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05917978286743164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05920124053955078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0356297492980957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036458492279052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036458492279052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036458492279052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([50496, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036458492279052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([984, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08285140991210938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08285140991210938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08378982543945312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09159660339355469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([1206, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09251594543457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09251594543457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1206, 128]), torch.Size([1, 1206, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09366607666015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11155891418457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1206, 128])
m.shape torch.Size([1211, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1127161979675293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1127161979675293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1211, 128]), torch.Size([1, 1211, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11387109756469727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1402149200439453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1211, 128])
m.shape torch.Size([1117, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1417679786682129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1417679786682129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14283323287963867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17443323135375977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([969, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17621088027954102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17621088027954102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17713499069213867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21119976043701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 969, 128])
m.shape torch.Size([805, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21304082870483398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21304082870483398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21380853652954102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24924898147583008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([702, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2512083053588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2512083053588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2518777847290039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2861042022705078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([598, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28805065155029297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28805065155029297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2886209487915039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3214406967163086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([520, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.32338714599609375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.32338714599609375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.323883056640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.357696533203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([5819, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3851957321166992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3851957321166992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5819, 128]), torch.Size([1, 5819, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3907451629638672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7883954048156738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5819, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7472987174987793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7605843544006348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7738699913024902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7604804039001465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13931, 256])
first layer input nodes number: 50496
first layer output nodes number: 13931
edges number: 93740
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7742481231689453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7875337600708008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7908554077148438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7908554077148438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([516, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8081841468811035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8081841468811035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8091683387756348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8186855316162109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([443, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8190450668334961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8190450668334961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.819890022277832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8328046798706055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([380, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8336305618286133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8336305618286133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.834355354309082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8512277603149414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.852057933807373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.852057933807373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8525633811950684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.867795467376709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8685379028320312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8685379028320312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8689327239990234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8831462860107422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8837909698486328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8837909698486328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8840694427490234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8960437774658203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8968262672424316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8968262672424316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.897087574005127  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9101529121398926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9108219146728516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9108219146728516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9110202789306641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9223270416259766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9228510856628418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9228510856628418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9229884147644043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9317774772644043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9324493408203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9324493408203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9325962066650391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.943023681640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9434895515441895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9434895515441895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9435868263244629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.951174259185791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9517831802368164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9517831802368164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9518918991088867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9611330032348633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9615788459777832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9615788459777832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9616551399230957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9686741828918457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9691071510314941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9691071510314941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9691739082336426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9757828712463379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9762110710144043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9762110710144043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9762721061706543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9827418327331543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9830803871154785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9830803871154785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.983126163482666  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9882988929748535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.988619327545166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.988619327545166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9886593818664551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9934659004211426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9936537742614746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9936537742614746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9936766624450684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9965834617614746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9969010353088379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9969010353088379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9969353675842285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0015358924865723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0017495155334473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0017495155334473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.001772403717041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0049996376037598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.005190372467041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.005190372467041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0052094459533691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0080323219299316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0081076622009277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0081076622009277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.008115291595459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0092978477478027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0094046592712402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0094046592712402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0094141960144043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0109591484069824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0111160278320312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0111160278320312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.011129379272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0133857727050781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([152, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0178203582763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0178203582763672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0181102752685547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0691356658935547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 152, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.055382251739502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0558037757873535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.056225299835205  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0557823181152344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2827, 40])
input nodes number: 13931
output nodes number: 2827
edges number: 17377
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.055903434753418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0559039115905762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03813314437866211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 16 input nodes size: 46668
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035625457763671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035625457763671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05787849426269531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05789995193481445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03380012512207031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03466320037841797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03466320037841797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03466320037841797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([46668, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03466320037841797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([802, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08041048049926758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08041048049926758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08117532730102539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08729410171508789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([1075, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08808469772338867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08808469772338867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08910989761352539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10494565963745117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1063, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10595369338989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10595369338989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10696744918823242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12928485870361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([974, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13063573837280273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13063573837280273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13156461715698242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.15947675704956055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([896, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1611485481262207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1611485481262207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1620030403137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19350481033325195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([747, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19521474838256836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19521474838256836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19592714309692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22711706161499023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([685, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22904729843139648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22904729843139648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22970056533813477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.26253223419189453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([601, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.26477861404418945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.26477861404418945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2653517723083496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2986912727355957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([546, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3007478713989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3007478713989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3012685775756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3356914520263672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([5912, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.36362171173095703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.36362171173095703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5912, 128]), torch.Size([1, 5912, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3692598342895508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7735490798950195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5912, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7326459884643555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.745330810546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7580156326293945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7452316284179688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13301, 256])
first layer input nodes number: 46668
first layer output nodes number: 13301
edges number: 92636
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7583656311035156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7710504531860352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7742218971252441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7742218971252441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([372, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7969183921813965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7969183921813965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7976279258728027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8052678108215332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([371, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.805626392364502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.805626392364502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8063340187072754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.816948413848877  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8174195289611816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8174195289611816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.817965030670166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8310542106628418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.831627368927002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.831627368927002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8320469856262207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8442158699035645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8449530601501465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8449530601501465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8453288078308105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8588557243347168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8595676422119141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8595676422119141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8598651885986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8726596832275391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8733992576599121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8733992576599121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8736510276794434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8862395286560059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8870058059692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8870058059692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8872270584106445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8998384475708008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9006447792053223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9006447792053223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9008469581604004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9137864112854004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9145407676696777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9145407676696777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.914710521697998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9267630577087402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.927556037902832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.927556037902832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9277143478393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9400625228881836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([79, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.940894603729248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.940894603729248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9410452842712402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9538531303405762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9544029235839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9544029235839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.954498291015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9632720947265625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9637088775634766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9637088775634766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9637775421142578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9705753326416016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9712333679199219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9712333679199219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9713249206542969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9810295104980469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9817218780517578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9817218780517578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9818134307861328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9921588897705078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9926362037658691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9926362037658691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9926972389221191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0000214576721191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0005273818969727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0005273818969727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0005865097045898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0080957412719727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.008741855621338  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.008741855621338  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.008812427520752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0182690620422363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0188875198364258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0188875198364258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0189523696899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0280961990356445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0284271240234375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0284271240234375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0284614562988281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0335426330566406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0338850021362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0338850021362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0339174270629883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0389432907104492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0393033027648926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0393033027648926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0393357276916504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.044588565826416  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0448956489562988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0448956489562988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0449223518371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0494351387023926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([247, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0553569793701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0553569793701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0558280944824219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1387443542480469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 247, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1191010475158691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1195240020751953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1199469566345215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1195025444030762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2836, 40])
input nodes number: 13301
output nodes number: 2836
edges number: 23111
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1196246147155762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1196250915527344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03637838363647461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 17 input nodes size: 48578
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03380155563354492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03380155563354492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05723905563354492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05726051330566406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034986019134521484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03582048416137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03582048416137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03582048416137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48578, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03582048416137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([922, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08138227462768555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08138227462768555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08226156234741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08929586410522461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([1126, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09005260467529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09005260467529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1126, 128]), torch.Size([1, 1126, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0911264419555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10723400115966797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1126, 128])
m.shape torch.Size([1213, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10845565795898438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10845565795898438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1213, 128]), torch.Size([1, 1213, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10961246490478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13586139678955078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1213, 128])
m.shape torch.Size([1107, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13739442825317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13739442825317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13845014572143555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16982316970825195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([983, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17163896560668945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17163896560668945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1725764274597168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20679473876953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([747, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20846319198608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20846319198608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20917558670043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24110651016235352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([678, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2430133819580078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2430133819580078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24365997314453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27634143829345703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([617, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27837181091308594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27837181091308594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2789602279663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3129291534423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([513, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3148365020751953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3148365020751953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3153257369995117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3489537239074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([5717, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3760528564453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3760528564453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5717, 128]), torch.Size([1, 5717, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.38169145584106445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7760076522827148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5717, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7355961799621582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7485880851745605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7615799903869629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7484865188598633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13623, 256])
first layer input nodes number: 48578
first layer output nodes number: 13623
edges number: 92107
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7619442939758301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7749361991882324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7781844139099121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7781844139099121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([447, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7977209091186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7977209091186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7985734939575195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8062458038330078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([393, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8065752983093262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8065752983093262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8073248863220215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8195796012878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.820124626159668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.820124626159668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8207330703735352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8343048095703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([258, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8350520133972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8350520133972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8355441093444824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8498702049255371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([227, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8513703346252441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8513703346252441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8518033027648926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8673901557922363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8679871559143066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8679871559143066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8682560920715332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8798203468322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([152, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8807086944580078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8807086944580078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8809986114501953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8954944610595703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([133, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8963723182678223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8963723182678223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8966259956359863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9110856056213379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9117722511291504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9117722511291504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9119515419006348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9234261512756348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9241342544555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9241342544555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9242925643920898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9355325698852539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9360775947570801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9360775947570801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.936190128326416  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9449677467346191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9455575942993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9455575942993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9456644058227539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9547433853149414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9552273750305176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9552273750305176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9553093910217285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9628548622131348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9634060859680176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9634060859680176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9634900093078613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9717984199523926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9723477363586426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9723477363586426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9724259376525879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.980715274810791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.981137752532959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.981137752532959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9811949729919434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9876608848571777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9879918098449707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9879918098449707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9880337715148926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9930691719055176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9935154914855957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9935154914855957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9935669898986816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0001072883605957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0004653930664062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0004653930664062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0005054473876953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0058727264404297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0061602592468262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0061602592468262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0061907768249512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0104937553405762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0108418464660645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0108418464660645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.010876178741455  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0159573554992676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0162787437438965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0162787437438965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0163092613220215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0210394859313965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0212898254394531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0212898254394531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0213127136230469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0250205993652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0253090858459473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0253090858459473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0253338813781738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.029524326324463  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([170, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0335969924926758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0335969924926758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.033921241760254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.090989112854004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 170, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.075141429901123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.075563907623291  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.075986385345459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0755424499511719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2835, 40])
input nodes number: 13623
output nodes number: 2835
edges number: 19745
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.07566499710083  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0756654739379883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.037502288818359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 18 input nodes size: 49878
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03498554229736328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03498554229736328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05876922607421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05879068374633789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03533172607421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03611183166503906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03611183166503906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03611183166503906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49878, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03611183166503906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1031, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08045434951782227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08045434951782227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08143758773803711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08957386016845703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([1207, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09067583084106445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09067583084106445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1207, 128]), torch.Size([1, 1207, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0918269157409668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10930109024047852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1207, 128])
m.shape torch.Size([1208, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11045360565185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11045360565185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1208, 128]), torch.Size([1, 1208, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11160564422607422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1379251480102539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1208, 128])
m.shape torch.Size([1063, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13937664031982422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13937664031982422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14039039611816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16978931427001953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([931, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17150211334228516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17150211334228516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17238998413085938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20435333251953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([830, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2062840461730957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2062840461730957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2070755958557129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24323701858520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([650, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2450108528137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2450108528137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24563074111938477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2779254913330078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([579, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27982425689697266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27982425689697266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2803764343261719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31333446502685547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([469, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31507110595703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31507110595703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3155183792114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3441438674926758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([5513, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3702082633972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3702082633972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5513, 128]), torch.Size([1, 5513, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37546586990356445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7498116493225098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5513, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7106795310974121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7236018180847168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7364583015441895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7234354019165039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13481, 256])
first layer input nodes number: 49878
first layer output nodes number: 13481
edges number: 89489
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7368321418762207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7496886253356934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7529029846191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7529029846191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([576, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7681002616882324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7681002616882324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7691988945007324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7797446250915527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([476, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7801103591918945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7801103591918945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7810182571411133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7946405410766602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([382, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7953248023986816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7953248023986816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.796053409576416  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8123784065246582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([295, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8131527900695801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8131527900695801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8137154579162598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8309130668640137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8316121101379395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8316121101379395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8320012092590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8460087776184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([204, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8478856086730957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8478856086730957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8482747077941895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8650059700012207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8655586242675781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8655586242675781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8657703399658203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8763561248779297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.876988410949707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.876988410949707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.877171516418457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.887608528137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([70, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.88812255859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.88812255859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8882560729980469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8968009948730469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8973302841186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8973302841186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8974485397338867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9058446884155273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([42, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9062299728393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9062299728393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9063100814819336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9125585556030273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9130954742431641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9130954742431641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9131908416748047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9212970733642578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([29, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9216117858886719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9216117858886719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9216670989990234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9267559051513672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9270915985107422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9270915985107422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9271430969238281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9322414398193359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9325332641601562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9325332641601562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9325752258300781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9370231628417969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9372329711914062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9372329711914062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9372615814208984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9404945373535156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9407744407653809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9407744407653809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9408087730407715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9449286460876465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9451537132263184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9451537132263184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9451804161071777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9485716819763184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.948704719543457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.948704719543457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9487199783325195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9507646560668945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9509496688842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9509496688842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9509687423706055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9536581039428711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.953911304473877  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.953911304473877  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9539361000061035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9576058387756348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9576783180236816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9576783180236816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9576859474182129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9588685035705566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9591078758239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9591078758239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9591288566589355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9625277519226074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9625635147094727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9625635147094727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9625673294067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9632120132446289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([90, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9653730392456055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9653730392456055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9655447006225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9957571029663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 90, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.983893871307373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9843158721923828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9847378730773926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9842944145202637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2831, 40])
input nodes number: 13481
output nodes number: 2831
edges number: 15102
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9844160079956055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9844164848327637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03771066665649414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 19 input nodes size: 47936
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03533124923706055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03533124923706055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05876874923706055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05879020690917969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03498506546020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035738468170166016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035738468170166016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035738468170166016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([47936, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035738468170166016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1017, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07837247848510742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07837247848510742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1017, 128]), torch.Size([1, 1017, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07934236526489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08710145950317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1017, 128])
m.shape torch.Size([1244, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08780288696289062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08780288696289062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0889892578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10678482055664062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1244, 128])
m.shape torch.Size([1187, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10841941833496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10841941833496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1187, 128]), torch.Size([1, 1187, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10955142974853516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13482189178466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1187, 128])
m.shape torch.Size([1091, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1369185447692871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1369185447692871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13795900344848633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16813230514526367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1000, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1699962615966797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1699962615966797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1000, 128]), torch.Size([1, 1000, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17094993591308594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20583152770996094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1000, 128])
m.shape torch.Size([778, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20758056640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20758056640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20832252502441406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24039268493652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([657, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24283695220947266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24283695220947266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 657, 128]), torch.Size([1, 657, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24346351623535156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27553749084472656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 657, 128])
m.shape torch.Size([579, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.277432918548584  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.277432918548584  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2779850959777832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.311398983001709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([464, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3131141662597656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3131141662597656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3135566711425781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3418769836425781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([5076, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3658599853515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3658599853515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5076, 128]), torch.Size([1, 5076, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37141990661621094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7178535461425781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5076, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6796889305114746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6921753883361816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7046618461608887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.69207763671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13093, 256])
first layer input nodes number: 47936
first layer output nodes number: 13093
edges number: 85265
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7050209045410156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7175073623657227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7206292152404785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7206292152404785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([534, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7363696098327637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7363696098327637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7373881340026855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7455363273620605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([470, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7459306716918945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7459306716918945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7468271255493164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7621221542358398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([315, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7625823020935059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7625823020935059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7631831169128418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7791686058044434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([306, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7800450325012207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7800450325012207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7806286811828613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7979679107666016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([255, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7989015579223633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7989015579223633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7993879318237305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8168973922729492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([187, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8177328109741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8177328109741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.818089485168457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8334264755249023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8341498374938965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8341498374938965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8344054222106934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8471846580505371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8479795455932617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8479795455932617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8482084274291992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8612546920776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.861936092376709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.861936092376709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8621115684509277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8733420372009277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.873927116394043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.873927116394043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8740606307983398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.883540153503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8839707374572754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8839707374572754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8840603828430176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8910527229309082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8915848731994629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8915848731994629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8916802406311035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8997864723205566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9002513885498047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9002513885498047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.90032958984375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9075241088867188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9078755378723145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9078755378723145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.907930850982666  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9134068489074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9137973785400391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9137973785400391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9138526916503906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9197158813476562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9198884963989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9198884963989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9199132919311523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9227151870727539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.922980785369873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.922980785369873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9230132102966309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9269042015075684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9270787239074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9270787239074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9270997047424316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9297642707824707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9299182891845703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9299182891845703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9299354553222656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9322357177734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9323234558105469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9323234558105469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9323329925537109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9336776733398438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9338951110839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9338951110839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9339160919189453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9370212554931641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9372014999389648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9372014999389648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9372186660766602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9398794174194336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.940025806427002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.940025806427002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9400391578674316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.942202091217041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9423108100891113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9423108100891113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9423203468322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.943932056427002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([83, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9459218978881836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9459218978881836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.946080207824707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.973942756652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 83, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9615249633789062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9619498252868652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9623746871948242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9619283676147461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2849, 40])
input nodes number: 13093
output nodes number: 2849
edges number: 15708
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9620504379272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9620509147644043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03729534149169922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 20 input nodes size: 49601
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0349879264831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0349879264831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0586395263671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05866098403930664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0352020263671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035991668701171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035991668701171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035991668701171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49601, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035991668701171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1036, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08040952682495117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08040952682495117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08139753341674805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08948469161987305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([1224, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09070682525634766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09070682525634766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1224, 128]), torch.Size([1, 1224, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0918741226196289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10942935943603516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1224, 128])
m.shape torch.Size([1222, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11059379577636719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11059379577636719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1222, 128]), torch.Size([1, 1222, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11175918579101562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1381063461303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1222, 128])
m.shape torch.Size([1086, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13959503173828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13959503173828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14063072204589844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17066574096679688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([998, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17252731323242188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17252731323242188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 998, 128]), torch.Size([1, 998, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1734790802001953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20833778381347656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 998, 128])
m.shape torch.Size([823, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21021652221679688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21021652221679688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21100139617919922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24672603607177734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([711, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24870681762695312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24870681762695312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 711, 128]), torch.Size([1, 711, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24938488006591797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2858147621154785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 711, 128])
m.shape torch.Size([599, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28776073455810547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28776073455810547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2883319854736328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.32148075103759766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([479, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.32325077056884766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.32325077056884766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.32370758056640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.35294342041015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([5413, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3785262107849121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3785262107849121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5413, 128]), torch.Size([1, 5413, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.38391542434692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7521743774414062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5413, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7130727767944336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7260341644287109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7389955520629883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7259325981140137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13591, 256])
first layer input nodes number: 49601
first layer output nodes number: 13591
edges number: 89632
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7393674850463867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7523288726806641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7555694580078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7555694580078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([507, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7717657089233398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7717657089233398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7727327346801758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7820529937744141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([456, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7824463844299316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7824463844299316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7833161354064941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7963624000549316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([368, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.796989917755127  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.796989917755127  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.797691822052002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.813601016998291  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8142786026000977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8142786026000977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8147821426391602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8325777053833008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([232, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8334412574768066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8334412574768066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8338837623596191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8498139381408691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([187, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8506712913513184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8506712913513184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8510279655456543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8663649559020996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8672294616699219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8672294616699219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8675251007080078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8823070526123047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8830051422119141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8830051422119141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8832149505615234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8951740264892578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8957438468933105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8957438468933105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8958926200866699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9054141044616699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9060029983520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9060029983520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9061346054077148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9154787063598633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.915931224822998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.915931224822998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9160246849060059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9233145713806152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9237871170043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9237871170043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9238729476928711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9311685562133789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9316506385803223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9316506385803223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9317307472229004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9391007423400879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9395856857299805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9395856857299805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9396600723266602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9470243453979492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9474053382873535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9474053382873535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9474606513977051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9533238410949707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9536194801330566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9536194801330566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9536595344543457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9581856727600098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9583783149719238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9583783149719238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9584031105041504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9613785743713379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9616951942443848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9616951942443848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9617314338684082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9663338661193848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9664802551269531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9664802551269531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9664974212646484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9687976837158203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9689817428588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9689817428588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9690008163452148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9716901779174805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9717817306518555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9717817306518555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9717912673950195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9732027053833008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9733037948608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9733037948608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9733133316040039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9747915267944336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9750080108642578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9750080108642578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9750270843505859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9781169891357422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9781999588012695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9781999588012695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9782075881958008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.979496955871582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([103, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9824872016906738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9824872016906738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9826836585998535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0172600746154785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 103, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0043258666992188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0047478675842285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0051698684692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0047264099121094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2829, 40])
input nodes number: 13591
output nodes number: 2829
edges number: 16210
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0048465728759766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0048470497131348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03760719299316406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 21 input nodes size: 48580
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03519916534423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03519916534423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05863666534423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05865812301635742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03498506546020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03577089309692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03577089309692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03577089309692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48580, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03577089309692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([964, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07980108261108398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07980108261108398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 964, 128]), torch.Size([1, 964, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08072042465209961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08887815475463867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 964, 128])
m.shape torch.Size([1282, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08964109420776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08964109420776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1282, 128]), torch.Size([1, 1282, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09086370468139648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10920286178588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1282, 128])
m.shape torch.Size([1240, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11036539077758789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11036539077758789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1240, 128]), torch.Size([1, 1240, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11154794692993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13780832290649414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1240, 128])
m.shape torch.Size([1091, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13947534561157227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13947534561157227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14051580429077148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1708664894104004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([986, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1726970672607422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1726970672607422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 986, 128]), torch.Size([1, 986, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17363739013671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2083587646484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 986, 128])
m.shape torch.Size([795, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21016311645507812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21016311645507812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2109212875366211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24399757385253906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([670, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24585485458374023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24585485458374023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24649381637573242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27963685989379883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([625, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2820906639099121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2820906639099121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.282686710357666  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31666135787963867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([514, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3185691833496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3185691833496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3190593719482422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3528432846069336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([5328, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3780040740966797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3780040740966797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5328, 128]), torch.Size([1, 5328, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3830852508544922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7463588714599609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5328, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7075972557067871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7208724021911621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7337422370910645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7203664779663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13495, 256])
first layer input nodes number: 48580
first layer output nodes number: 13495
edges number: 88908
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7341065406799316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.746976375579834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7501940727233887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7501940727233887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([533, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.766603946685791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.766603946685791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7676205635070801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.777554988861084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([477, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7779636383056641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7779636383056641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 477, 256]), torch.Size([1, 477, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7788734436035156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7931175231933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 477, 256])
m.shape torch.Size([401, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7942280769348145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7942280769348145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7949929237365723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8128228187561035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8133864402770996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8133864402770996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8138556480407715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8274626731872559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8281941413879395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8281941413879395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8285775184631348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.842379093170166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8430294990539551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8430294990539551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8433079719543457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8552823066711426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8559508323669434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8559508323669434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8561797142028809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8676238059997559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8692646026611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8692646026611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8695144653320312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8837566375732422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8843584060668945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8843584060668945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8845186233520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8947725296020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8953366279602051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8953366279602051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8954644203186035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9045376777648926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9050450325012207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9050450325012207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9051480293273926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9131817817687988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9135918617248535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9135918617248535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.913668155670166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9201531410217285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9205899238586426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9205899238586426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9206624031066895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.927330493927002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9276714324951172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9276714324951172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9277248382568359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9330120086669922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9333748817443848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9333748817443848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9334263801574707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9388852119445801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9392595291137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9392595291137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9393091201782227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9449129104614258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9452805519104004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9452805519104004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9453263282775879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9508194923400879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9510388374328613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9510388374328613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9510655403137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9544568061828613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9545350074768066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9545350074768066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9545445442199707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9558224678039551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9560871124267578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9560871124267578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9561138153076172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9598789215087891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9600071907043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9600071907043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9600205421447754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9619965553283691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9621591567993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9621591567993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9621744155883789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9645395278930664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9647312164306641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9647312164306641  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9647483825683594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.967529296875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9677748680114746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9677748680114746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9677958488464355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.971341609954834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([117, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9741425514221191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9741425514221191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9743657112121582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0136418342590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 117, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.00050687789917  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0009284019470215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.001349925994873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0009069442749023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2828, 40])
input nodes number: 13495
output nodes number: 2828
edges number: 16404
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0010285377502441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0010290145874023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03737640380859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 22 input nodes size: 50188
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034984588623046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034984588623046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05891609191894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05893754959106445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03547859191894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036255836486816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036255836486816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036255836486816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([50188, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036255836486816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1014, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0805668830871582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0805668830871582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1014, 128]), torch.Size([1, 1014, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08153390884399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0896291732788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1014, 128])
m.shape torch.Size([1203, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09062385559082031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09062385559082031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09177112579345703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10922622680664062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([1251, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1104421615600586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1104421615600586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1251, 128]), torch.Size([1, 1251, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11163520812988281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13835859298706055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1251, 128])
m.shape torch.Size([1139, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1399364471435547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1399364471435547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1139, 128]), torch.Size([1, 1139, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1410226821899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17380905151367188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1139, 128])
m.shape torch.Size([993, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17629480361938477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17629480361938477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 993, 128]), torch.Size([1, 993, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17724180221557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21204328536987305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 993, 128])
m.shape torch.Size([816, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21390438079833984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21390438079833984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21468257904052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2503824234008789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([661, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.252199649810791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.252199649810791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25283002853393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2848167419433594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([603, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28739500045776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28739500045776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28797006607055664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3211836814880371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([502, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.32305049896240234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.32305049896240234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3235292434692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3541688919067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([5388, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3796215057373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3796215057373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5388, 128]), torch.Size([1, 5388, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.38475990295410156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7515525817871094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5388, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7125473022460938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7254886627197266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7384300231933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7253870964050293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13570, 256])
first layer input nodes number: 50188
first layer output nodes number: 13570
edges number: 89439
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7388062477111816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7517476081848145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7549829483032227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7549829483032227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([549, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7698154449462891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7698154449462891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7708625793457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.780919075012207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 549, 256])
m.shape torch.Size([451, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7812628746032715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7812628746032715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7821230888366699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7950353622436523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([416, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7960567474365234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7960567474365234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7968502044677734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8151569366455078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([302, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8160891532897949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8160891532897949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8166651725769043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8365836143493652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([248, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8374876976013184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8374876976013184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8379607200622559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8549895286560059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8556699752807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8556699752807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8559732437133789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.869013786315918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8696832656860352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8696832656860352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8699159622192383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8815507888793945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8823113441467285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8823113441467285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8825287818908691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8949227333068848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.895540714263916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.895540714263916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8957009315490723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9059548377990723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9065670967102051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9065670967102051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9067044258117676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9164547920227051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([38, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9167881011962891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9167881011962891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9168605804443359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9225139617919922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9228239059448242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9228239059448242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9228811264038086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9277448654174805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9281539916992188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9281539916992188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9282207489013672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9343624114990234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9347062110900879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9347062110900879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9347596168518066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9400467872619629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9402651786804199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9402651786804199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9402976036071777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9437346458435059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9438877105712891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9438877105712891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.94390869140625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9462795257568359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.946497917175293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.946497917175293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9465246200561523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9497289657592773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9499754905700684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9499754905700684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9500041007995605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9536375999450684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.953824520111084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.953824520111084  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9538455009460449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9566569328308105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9568390846252441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9568390846252441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9568581581115723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9595475196838379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9596190452575684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9596190452575684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9596266746520996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9607558250427246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9608578681945801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9608578681945801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9608674049377441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9623456001281738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9624514579772949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9624514579772949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.962460994720459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9640059471130371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9640707969665527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9640707969665527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9640765190124512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9650435447692871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([82, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9676504135131836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9676504135131836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9678068161010742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9953336715698242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 82, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9838094711303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9842305183410645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9846515655517578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9842090606689453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2825, 40])
input nodes number: 13570
output nodes number: 2825
edges number: 14747
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9843316078186035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9843320846557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03785514831542969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 23 input nodes size: 48345
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03547811508178711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03547811508178711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05891561508178711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05893707275390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03498411178588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035784244537353516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035784244537353516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035784244537353516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48345, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035784244537353516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1013, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08013486862182617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08013486862182617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0811009407043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08914613723754883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([1120, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08973121643066406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08973121643066406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09079933166503906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10699462890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1163, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1081242561340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1081242561340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1163, 128]), torch.Size([1, 1163, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10923337936401367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1342616081237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1163, 128])
m.shape torch.Size([1030, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13567161560058594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13567161560058594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13665390014648438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16514015197753906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([923, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16684961318969727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16684961318969727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16772985458374023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20040512084960938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([749, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20210790634155273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20210790634155273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20282220840454102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23416757583618164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([646, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23596668243408203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23596668243408203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23658275604248047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.26891565322875977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([586, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2708430290222168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2708430290222168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27140188217163086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3042635917663574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([505, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3061513900756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3061513900756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.30663299560546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.33745574951171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([5581, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.36455869674682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.36455869674682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5581, 128]), torch.Size([1, 5581, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37006521224975586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.753204345703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5581, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7130393981933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7258319854736328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7385311126708984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7256388664245605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13316, 256])
first layer input nodes number: 48345
first layer output nodes number: 13316
edges number: 89536
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7388935089111328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7515926361083984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7551565170288086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7551565170288086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([516, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7728581428527832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7728581428527832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7738423347473145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7828526496887207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([387, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7831048965454102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7831048965454102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7838430404663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7950143814086914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([328, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7955913543701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7955913543701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7962169647216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8106842041015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([270, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8114533424377441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8114533424377441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8119683265686035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8275589942932129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([242, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8284645080566406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8284645080566406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8289260864257812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8455429077148438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([178, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8463387489318848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8463387489318848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8466782569885254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8612771034240723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8619756698608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8619756698608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8622217178344727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8745241165161133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8754467964172363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8754467964172363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8757061958312988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8904919624328613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8911843299865723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8911843299865723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8913655281066895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9029622077941895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9035444259643555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9035444259643555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9036779403686523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9131574630737305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9138097763061523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9138097763061523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9139394760131836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9240560531616211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9245681762695312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9245681762695312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9246635437011719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.932769775390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9331345558166504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9331345558166504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9331974983215332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.938988208770752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9394950866699219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9394950866699219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9395713806152344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9471244812011719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9475045204162598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9475045204162598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9475598335266113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.953423023223877  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9537801742553711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9537801742553711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9538278579711914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9592161178588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9594864845275879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9594864845275879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9595208168029785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9636406898498535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.963986873626709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.963986873626709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.964026927947998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.969113826751709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.969459056854248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.969459056854248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9694972038269043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9746088981628418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9748973846435547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9748973846435547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9749279022216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9792308807373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9795589447021484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9795589447021484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9795913696289062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9843902587890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9846067428588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9846067428588867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9846277236938477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.987879753112793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9879579544067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9879579544067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9879655838012695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.989201545715332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9894518852233887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9894518852233887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9894728660583496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.993018627166748  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([123, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9959640502929688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9959640502929688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9961986541748047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0374889373779297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 123, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0230584144592285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0234813690185547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0239043235778809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0234599113464355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2837, 40])
input nodes number: 13316
output nodes number: 2837
edges number: 17764
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.023582935333252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0235834121704102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03741121292114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 24 input nodes size: 44864
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034986019134521484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034986019134521484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.056378841400146484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.056400299072265625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.032941341400146484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03378725051879883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03378725051879883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03378725051879883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([44864, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03378725051879883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([791, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0779123306274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0779123306274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07866668701171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08523750305175781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([991, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08580541610717773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08580541610717773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08675050735473633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10130453109741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([1020, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10229110717773438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10229110717773438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1020, 128]), torch.Size([1, 1020, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10326385498046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1251964569091797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1020, 128])
m.shape torch.Size([967, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1265544891357422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1265544891357422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 967, 128]), torch.Size([1, 967, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12747669219970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.155120849609375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 967, 128])
m.shape torch.Size([850, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.15715646743774414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.15715646743774414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.15796709060668945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18788957595825195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([751, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18963289260864258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18963289260864258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 751, 128]), torch.Size([1, 751, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19034910202026367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22219228744506836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 751, 128])
m.shape torch.Size([658, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2240304946899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2240304946899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22465801239013672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25688791275024414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([621, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2589430809020996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2589430809020996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2595353126525879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2932925224304199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([522, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.29523658752441406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.29523658752441406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2957344055175781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3291149139404297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([5660, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.35620975494384766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.35620975494384766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5660, 128]), torch.Size([1, 5660, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.36160755157470703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7548627853393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5660, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7148008346557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7270374298095703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7392740249633789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7269415855407715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([12831, 256])
first layer input nodes number: 44864
first layer output nodes number: 12831
edges number: 89329
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7396101951599121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7518467903137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7551846504211426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7551846504211426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([374, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7792882919311523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7792882919311523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7800016403198242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7870397567749023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([337, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7873311042785645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7873311042785645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7879738807678223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7976617813110352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.798133373260498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.798133373260498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7986578941345215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8107852935791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([231, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8114113807678223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8114113807678223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.811851978302002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8246293067932129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8253173828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8253173828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8256778717041016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8386554718017578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8393344879150391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8393344879150391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8396186828613281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8518390655517578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8524980545043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8524980545043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8527250289916992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8640737533569336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([133, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.864983081817627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.864983081817627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.865236759185791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8796963691711426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8804349899291992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8804349899291992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8806257247924805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8928327560424805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8936505317687988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8936505317687988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.893831729888916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9066967964172363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9074311256408691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9074311256408691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9075798988342285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9191842079162598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([82, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9200558662414551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9200558662414551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9202122688293457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9335064888000488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9339780807495117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9339780807495117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9340620040893555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9417829513549805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9425349235534668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9425349235534668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9426474571228027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9537882804870605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9545397758483887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9545397758483887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9546465873718262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9659686088562012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9666075706481934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9666075706481934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9666934013366699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9763922691345215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9770030975341797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9770030975341797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9770793914794922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9862346649169922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9867501258850098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9867501258850098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9868111610412598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9945626258850098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9951348304748535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9951348304748535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9951977729797363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0036320686340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0040621757507324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0040621757507324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.00410795211792  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0105624198913574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0111050605773926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0111050605773926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0111584663391113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0190625190734863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0195221900939941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0195221900939941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0195660591125488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0263657569885254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0268745422363281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0268745422363281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0269203186035156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0343360900878906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0346593856811523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0346593856811523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0346879959106445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0395231246948242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([265, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0458765029907227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0458765029907227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.046381950378418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.141378402709961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 265, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.120915412902832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.121340274810791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.12176513671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1213188171386719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2850, 40])
input nodes number: 12831
output nodes number: 2850
edges number: 24177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1214380264282227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1214385032653809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035470008850097656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 25 input nodes size: 49985
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0329432487487793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0329432487487793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0567779541015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05679941177368164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0353851318359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03618621826171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03618621826171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03618621826171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49985, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03618621826171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([988, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08133888244628906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08133888244628906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08228111267089844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08981895446777344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([1241, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09085321426391602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09085321426391602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1241, 128]), torch.Size([1, 1241, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09203672409057617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11015558242797852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1241, 128])
m.shape torch.Size([1170, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1112375259399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1112375259399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1170, 128]), torch.Size([1, 1170, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11235332489013672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13830947875976562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1170, 128])
m.shape torch.Size([1084, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13981914520263672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13981914520263672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1408529281616211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17083263397216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([958, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17259979248046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17259979248046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 958, 128]), torch.Size([1, 958, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17351341247558594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2074575424194336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 958, 128])
m.shape torch.Size([785, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20924663543701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20924663543701172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20999526977539062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2429804801940918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([681, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24487924575805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24487924575805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2455286979675293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27819395065307617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([616, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28021907806396484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28021907806396484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2808065414428711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3148989677429199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([466, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3166050910949707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3166050910949707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.317049503326416  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.345491886138916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([5649, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37261343002319336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37261343002319336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5649, 128]), torch.Size([1, 5649, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37800073623657227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7718381881713867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5649, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7312254905700684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7442317008972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7572379112243652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7441296577453613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13638, 256])
first layer input nodes number: 49985
first layer output nodes number: 13638
edges number: 91195
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7576127052307129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7706189155578613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7739882469177246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7739882469177246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([538, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7901778221130371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7901778221130371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7912039756774902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7998156547546387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([450, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8001680374145508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8001680374145508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8010263442993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8149795532226562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([351, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8156113624572754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8156113624572754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8162808418273926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8317322731018066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([275, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8325505256652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8325505256652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8330750465393066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8490033149719238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([244, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8499140739440918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8499140739440918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.850379467010498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.867133617401123  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([182, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8679509162902832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8679509162902832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8682980537414551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8832249641418457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8840608596801758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8840608596801758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8843469619750977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8986520767211914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8993244171142578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8993244171142578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8995265960693359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9110507965087891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([65, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9115123748779297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9115123748779297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9116363525390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9195709228515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9200282096862793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9200282096862793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9201312065124512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9274439811706543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9280691146850586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9280691146850586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9281911849975586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9377126693725586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([44, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9381594657897949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9381594657897949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9382433891296387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9453768730163574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9458222389221191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9458222389221191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9458966255187988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9527401924133301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9532012939453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9532012939453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9532718658447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9602584838867188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.960540771484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.960540771484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9605827331542969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9650306701660156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9652867317199707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9652867317199707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9653210639953613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.969200611114502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.969477653503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.969477653503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9695119857788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9736318588256836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.973874568939209  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.973874568939209  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9739031791687012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.977536678314209  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9777050018310547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9777050018310547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9777240753173828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9802799224853516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9805588722229004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9805588722229004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9805874824523926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.984621524810791  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9847283363342285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9847283363342285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9847397804260254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9864335060119629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9864702224731445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9864702224731445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9864740371704102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.987065315246582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9871740341186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9871740341186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9871835708618164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9887285232543945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9888625144958496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9888625144958496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9888739585876465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9908080101013184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([115, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9942760467529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9942760467529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9944953918457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0331001281738281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 115, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0208501815795898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0212721824645996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0216941833496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0212507247924805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2831, 40])
input nodes number: 13638
output nodes number: 2831
edges number: 16171
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0213713645935059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.021371841430664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03781700134277344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 26 input nodes size: 48845
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03538227081298828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03538227081298828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05881977081298828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05884122848510742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03498506546020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035779476165771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035779476165771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035779476165771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48845, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035779476165771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1051, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0799551010131836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0799551010131836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08095741271972656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08934307098388672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1234, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09001874923706055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09001874923706055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1234, 128]), torch.Size([1, 1234, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09119558334350586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10884809494018555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1234, 128])
m.shape torch.Size([1262, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11006498336791992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11006498336791992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1262, 128]), torch.Size([1, 1262, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11126852035522461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13819169998168945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1262, 128])
m.shape torch.Size([1118, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13972234725952148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13972234725952148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14078855514526367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1717085838317871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([968, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17348337173461914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17348337173461914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1744065284729004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2094101905822754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([761, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21112585067749023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21112585067749023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 761, 128]), torch.Size([1, 761, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2118515968322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24402284622192383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 761, 128])
m.shape torch.Size([673, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24590635299682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24590635299682617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 673, 128]), torch.Size([1, 673, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24654817581176758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27897119522094727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 673, 128])
m.shape torch.Size([561, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2807903289794922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2807903289794922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2813253402709961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3121151924133301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([486, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3139333724975586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3139333724975586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31439685821533203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.34405994415283203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([5437, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3697538375854492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3697538375854492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5437, 128]), torch.Size([1, 5437, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3751068115234375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7446689605712891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5437, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7058877944946289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7189550399780273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7318782806396484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7187099456787109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13551, 256])
first layer input nodes number: 48845
first layer output nodes number: 13551
edges number: 89126
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7322444915771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7451677322387695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7491436004638672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7491436004638672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([519, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7664542198181152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7664542198181152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7674441337585449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.776695728302002  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([447, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7770600318908691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7770600318908691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7779126167297363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7907013893127441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([374, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7916321754455566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7916321754455566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7923455238342285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8096203804016113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8102326393127441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8102326393127441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8107132911682129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8246521949768066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([242, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8257694244384766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8257694244384766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8262310028076172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8428478240966797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([178, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8436436653137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8436436653137207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8439831733703613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8585820198059082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8592333793640137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8592333793640137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8594660758972168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.871100902557373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8717150688171387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8717150688171387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8718962669372559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8822245597839355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8828692436218262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8828692436218262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8830313682556152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8934073448181152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8939800262451172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8939800262451172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8941097259521484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9033184051513672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9037928581237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9037928581237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9038901329040527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9114775657653809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9119596481323242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9119596481323242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9120473861694336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9195051193237305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9199113845825195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9199113845825195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9199800491333008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9262971878051758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9266128540039062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9266128540039062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9266624450683594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9315719604492188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9319653511047363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9319653511047363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9320206642150879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9378838539123535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9381179809570312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9381179809570312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9381504058837891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9418144226074219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9421091079711914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9421091079711914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9421453475952148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9464941024780273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9467010498046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9467010498046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9467258453369141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9498748779296875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9501185417175293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9501185417175293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9501452445983887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9537234306335449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9540753364562988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9540753364562988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9541115760803223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.959221363067627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9593448638916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9593448638916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9593582153320312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.961334228515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9614758491516113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9614758491516113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.961489200592041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9635586738586426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.963773250579834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.963773250579834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9637923240661621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9668822288513184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9670572280883789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9670572280883789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9670724868774414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9696512222290039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([156, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9733920097351074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9733920097351074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9736895561218262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0260577201843262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 156, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0119895935058594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0124130249023438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0128364562988281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0123915672302246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2840, 40])
input nodes number: 13551
output nodes number: 2840
edges number: 17358
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0125155448913574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0125160217285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03740501403808594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 27 input nodes size: 49274
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03498649597167969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03498649597167969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05848217010498047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05850362777709961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03504467010498047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03582191467285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03582191467285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03582191467285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49274, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03582191467285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([987, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07960224151611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07960224151611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08054351806640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08815670013427734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([1275, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08890199661254883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08890199661254883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1275, 128]), torch.Size([1, 1275, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0901179313659668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10835695266723633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1275, 128])
m.shape torch.Size([1271, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1097402572631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1097402572631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1271, 128]), torch.Size([1, 1271, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11095237731933594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1376190185546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1271, 128])
m.shape torch.Size([1066, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13904619216918945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13904619216918945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14006280899047852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16992425918579102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([1027, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17186450958251953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17186450958251953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17284393310546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20821380615234375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([790, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20998430252075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20998430252075195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2107377052307129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24460744857788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([696, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24655389785766602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24655389785766602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24721765518188477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28054141998291016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([594, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28247547149658203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28247547149658203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28304195404052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3166971206665039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([507, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3185896873474121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3185896873474121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3190732002258301  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3500180244445801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([5270, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3749055862426758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3749055862426758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5270, 128]), torch.Size([1, 5270, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3799314498901367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7376389503479004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5270, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6991562843322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7125420570373535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.725400447845459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7119140625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13483, 256])
first layer input nodes number: 49274
first layer output nodes number: 13483
edges number: 88376
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7257695198059082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7386279106140137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7418427467346191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7418427467346191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([512, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7576231956481934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7576231956481934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7585997581481934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7666735649108887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 512, 256])
m.shape torch.Size([481, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7671103477478027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7671103477478027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7680277824401855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.782294750213623  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([360, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7829413414001465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7829413414001465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.783627986907959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.801084041595459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([285, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8018465042114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8018465042114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8023900985717773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8187046051025391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([246, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.819615364074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.819615364074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8200845718383789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8369760513305664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8377795219421387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8377795219421387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8381228446960449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8528857231140137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8537101745605469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8537101745605469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8539924621582031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8681068420410156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8688883781433105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8688883781433105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.869117259979248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8821635246276855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8828539848327637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8828539848327637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8830313682556152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8943839073181152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([54, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8948144912719727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8948144912719727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8949174880981445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9022302627563477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9027814865112305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9027814865112305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9028902053833008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9113702774047852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9117660522460938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9117660522460938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9118404388427734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9181632995605469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9186010360717773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9186010360717773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9186735153198242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9253416061401367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.925722599029541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.925722599029541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9257817268371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9316353797912598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([17, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9318509101867676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9318509101867676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9318833351135254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9353203773498535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.935704231262207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.935704231262207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9357538223266602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9413576126098633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9416923522949219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9416923522949219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9417343139648438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9467697143554688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9469394683837891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9469394683837891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.94696044921875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9496250152587891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.949925422668457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.949925422668457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9499578475952148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9543027877807617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9544405937194824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9544405937194824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9544558525085449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9566073417663574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9567813873291016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9567813873291016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9567985534667969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9593391418457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9593729972839355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9593729972839355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9593768119812012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.959968090057373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.960054874420166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.960054874420166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9600625038146973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9612984657287598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9613642692565918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9613642692565918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9613699913024902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9623370170593262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([90, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9653782844543457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9653782844543457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9655499458312988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9957623481750488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 90, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.983281135559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9837064743041992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9841318130493164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9836850166320801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2853, 40])
input nodes number: 13483
output nodes number: 2853
edges number: 15773
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9838089942932129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9838094711303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.037421226501464844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 28 input nodes size: 49086
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03504657745361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03504657745361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05848407745361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05850505828857422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0349879264831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03575944900512695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03575944900512695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03575944900512695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49086, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03575944900512695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1011, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07929372787475586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07929372787475586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1011, 128]), torch.Size([1, 1011, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08025789260864258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08797121047973633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1011, 128])
m.shape torch.Size([1256, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08868694305419922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08868694305419922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1256, 128]), torch.Size([1, 1256, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08988475799560547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10785198211669922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1256, 128])
m.shape torch.Size([1217, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1089940071105957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1089940071105957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1217, 128]), torch.Size([1, 1217, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11015462875366211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13627052307128906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1217, 128])
m.shape torch.Size([1061, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13771390914916992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13771390914916992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13872575759887695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1687769889831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([965, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17057180404663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17057180404663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1714920997619629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20532989501953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([795, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20738554000854492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20738554000854492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2081437110900879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24091291427612305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([656, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2427234649658203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2427234649658203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2433490753173828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.275482177734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([620, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27753448486328125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27753448486328125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2781257629394531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31249237060546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([473, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3142266273498535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3142266273498535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31467771530151367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.34354734420776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([5303, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3686084747314453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3686084747314453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5303, 128]), torch.Size([1, 5303, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37366580963134766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7334160804748535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5303, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.6951088905334473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7078471183776855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7205853462219238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7077474594116211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13357, 256])
first layer input nodes number: 49086
first layer output nodes number: 13357
edges number: 87852
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7209529876708984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7336912155151367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7368760108947754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7368760108947754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([538, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7524256706237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7524256706237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7534518241882324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7616658210754395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([472, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7620601654052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7620601654052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7629604339599609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7766566276550293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([361, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7772903442382812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7772903442382812  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7779788970947266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7949428558349609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7955751419067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7955751419067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7960596084594727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8101091384887695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([223, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8109512329101562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8109512329101562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8113765716552734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8266887664794922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([188, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8275890350341797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8275890350341797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8279476165771484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8433666229248047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([164, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8443002700805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8443002700805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8446130752563477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8602533340454102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8608965873718262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8608965873718262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8610949516296387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8724017143249512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8730378150939941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8730378150939941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8731999397277832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8835759162902832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([58, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8840527534484863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8840527534484863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8841633796691895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8920178413391113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8925232887268066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8925232887268066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8926243782043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9005093574523926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9010124206542969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9010124206542969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9011039733886719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9088859558105469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([29, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9092025756835938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9092025756835938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9092578887939453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9143466949462891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9147229194641113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9147229194641113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9147801399230957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9204449653625488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9208202362060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9208202362060547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9208736419677734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9265346527099609  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9267697334289551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9267697334289551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9268021583557129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9304661750793457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9306464195251465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9306464195251465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9306693077087402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9334158897399902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9337162971496582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9337162971496582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9337506294250488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9381108283996582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9382948875427246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9382948875427246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9383158683776855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9411273002624512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9413094520568848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9413094520568848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9413285255432129  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9440178871154785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9441094398498535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9441094398498535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9441189765930176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9455304145812988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.945589542388916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.945589542388916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9455952644348145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9464821815490723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.946678638458252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.946678638458252  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9466958045959473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9494767189025879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9495606422424316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9495606422424316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9495682716369629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9508576393127441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([92, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9530644416809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9530644416809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.953239917755127  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.984123706817627  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 92, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.972449779510498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9728693962097168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9732890129089355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9728484153747559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2816, 40])
input nodes number: 13357
output nodes number: 2816
edges number: 15508
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9729633331298828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.972963809967041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0373387336730957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 29 input nodes size: 49345
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03498220443725586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03498220443725586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05851173400878906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0585331916809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035074710845947266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03584432601928711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03584432601928711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03584432601928711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49345, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03584432601928711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1016, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07963943481445312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07963943481445312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08060836791992188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08921527862548828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([1260, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0906071662902832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0906071662902832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1260, 128]), torch.Size([1, 1260, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09180879592895508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1098332405090332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1260, 128])
m.shape torch.Size([1217, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11133813858032227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11133813858032227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1217, 128]), torch.Size([1, 1217, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11249876022338867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13814496994018555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1217, 128])
m.shape torch.Size([1087, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13983440399169922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13983440399169922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1408710479736328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17179012298583984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([983, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1736154556274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1736154556274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17455291748046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20923995971679688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([782, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21100854873657227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21100854873657227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21175432205200195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24469614028930664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([693, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24663639068603516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24663639068603516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2472972869873047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28037261962890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([549, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2821364402770996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2821364402770996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28266000747680664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31348276138305664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([513, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31551551818847656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31551551818847656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31600475311279297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3492269515991211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([5338, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3744359016418457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3744359016418457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5338, 128]), torch.Size([1, 5338, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37952661514282227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7433867454528809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5338, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7048478126525879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7181038856506348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.730919361114502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7175631523132324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13438, 256])
first layer input nodes number: 49345
first layer output nodes number: 13438
edges number: 88382
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7312893867492676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7441048622131348  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7473087310791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7473087310791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([541, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7621636390686035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7621636390686035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7631955146789551  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7732071876525879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([499, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7736506462097168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7736506462097168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 499, 256]), torch.Size([1, 499, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7746024131774902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7888789176940918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 499, 256])
m.shape torch.Size([388, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7899489402770996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7899489402770996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7906889915466309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8080143928527832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([287, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8093667030334473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8093667030334473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8099141120910645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8279290199279785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([241, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8288135528564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8288135528564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8292732238769531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8458213806152344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([185, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8466587066650391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8466587066650391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8470115661621094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8621845245361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8629770278930664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8629770278930664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8632516860961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8769845962524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8775472640991211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8775472640991211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.877720832824707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8876142501831055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8882112503051758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8882112503051758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.888361930847168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.898005485534668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([48, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8983917236328125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8983917236328125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8984832763671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9049835205078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9054241180419922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9054241180419922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9055118560791016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9123554229736328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9127731323242188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9127731323242188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9128494262695312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9193344116210938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9197211265563965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9197211265563965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9197859764099121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9257521629333496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([18, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.925961971282959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.925961971282959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9259963035583496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9293951988220215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9296088218688965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9296088218688965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9296393394470215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9328742027282715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.93316650390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.93316650390625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9332046508789062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9375152587890625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9377412796020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9377412796020508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.937769889831543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9412031173706055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9415178298950195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9415178298950195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.941554069519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9461565017700195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9463210105895996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9463210105895996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9463400840759277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9488959312438965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9490017890930176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9490017890930176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9490132331848145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9506268501281738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.950843334197998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.950843334197998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.950864315032959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9539694786071777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9540228843688965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9540228843688965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9540286064147949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9549155235290527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9549570083618164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9549570083618164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.954960823059082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9555788040161133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9556922912597656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9556922912597656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9557018280029297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9573135375976562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([83, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9600872993469238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9600872993469238  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9602456092834473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9881081581115723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 83, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9765586853027344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9769806861877441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9774026870727539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.976959228515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2831, 40])
input nodes number: 13438
output nodes number: 2831
edges number: 14778
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9770832061767578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.977083683013916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03742790222167969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 30 input nodes size: 49872
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03507709503173828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03507709503173828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05885791778564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05887937545776367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03532838821411133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03612852096557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03612852096557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03612852096557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49872, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03612852096557617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([972, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08102560043334961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08102560043334961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 972, 128]), torch.Size([1, 972, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08195257186889648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08936834335327148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 972, 128])
m.shape torch.Size([1298, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09061384201049805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09061384201049805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1298, 128]), torch.Size([1, 1298, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09185171127319336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11041975021362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1298, 128])
m.shape torch.Size([1210, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11158323287963867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11158323287963867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1210, 128]), torch.Size([1, 1210, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11273717880249023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13843297958374023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1210, 128])
m.shape torch.Size([1035, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13983964920043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13983964920043945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1035, 128]), torch.Size([1, 1035, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14082670211791992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16945123672485352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1035, 128])
m.shape torch.Size([962, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1712512969970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1712512969970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17216873168945312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20662879943847656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([796, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20844745635986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20844745635986328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20920658111572266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24185943603515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([717, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24387311935424805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24387311935424805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24455690383911133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2795243263244629  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([595, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2814521789550781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2814521789550781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28201961517333984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3152313232421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([535, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3172435760498047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3172435760498047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31775379180908203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.35205841064453125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([5516, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37810564041137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37810564041137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5516, 128]), torch.Size([1, 5516, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3842911720275879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7588257789611816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5516, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7191953659057617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7321996688842773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.745203971862793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7320976257324219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13636, 256])
first layer input nodes number: 49872
first layer output nodes number: 13636
edges number: 90678
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7455778121948242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7585821151733398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7618331909179688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7618331909179688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([522, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7784461975097656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7784461975097656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7794418334960938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7888450622558594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([453, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7892184257507324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7892184257507324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7900824546813965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8036179542541504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([376, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.804314136505127  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.804314136505127  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8050312995910645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8221755027770996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([268, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8228664398193359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8228664398193359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8233776092529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8396434783935547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8404359817504883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8404359817504883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8408517837524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8558206558227539  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8566317558288574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8566317558288574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8569598197937012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8710665702819824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([146, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.871884822845459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.871884822845459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8721632957458496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8860869407653809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8868398666381836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8868398666381836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8870611190795898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8996725082397461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9002714157104492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9002714157104492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9004278182983398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9104375839233398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9110612869262695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9110612869262695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9112005233764648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.921086311340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9216723442077637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9216723442077637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.921790599822998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9310145378112793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9314746856689453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9314746856689453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9315605163574219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9388561248779297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.939338207244873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.939338207244873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9394183158874512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9467883110046387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.947084903717041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.947084903717041  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9471325874328613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9518532752990723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.952204704284668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.952204704284668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9522542953491211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9575109481811523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.957855224609375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.957855224609375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9579010009765625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.96307373046875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9633779525756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9633779525756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9634160995483398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9679937362670898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9682345390319824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9682345390319824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9682631492614746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9718966484069824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9721016883850098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9721016883850098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9721245765686035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.975191593170166  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9754304885864258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9754304885864258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9754552841186523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9789514541625977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9791412353515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9791412353515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9791603088378906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9819831848144531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9821429252624512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9821429252624512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9821581840515137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9845232963562012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9846487045288086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9846487045288086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9846601486206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9865140914916992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9866237640380859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9866237640380859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.98663330078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9882450103759766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([113, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9913191795349121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9913191795349121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9915347099304199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.029468059539795  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 113, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0169978141784668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.017423152923584  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0178484916687012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0174016952514648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2852, 40])
input nodes number: 13636
output nodes number: 2852
edges number: 16627
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0175285339355469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.017529010772705  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.037766456604003906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 31 input nodes size: 48911
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03533172607421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03533172607421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05876922607421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05879068374633789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0349884033203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03577136993408203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03577136993408203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03577136993408203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([48911, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03577136993408203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([1028, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07952213287353516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07952213287353516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08050251007080078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08920049667358398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([1216, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08986997604370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08986997604370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1216, 128]), torch.Size([1, 1216, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09102964401245117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10842466354370117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1216, 128])
m.shape torch.Size([1162, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10950708389282227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10950708389282227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1162, 128]), torch.Size([1, 1162, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11061525344848633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13651418685913086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1162, 128])
m.shape torch.Size([1060, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13798189163208008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13798189163208008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1389927864074707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16830873489379883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([908, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1699681282043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1699681282043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17083406448364258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20261240005493164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([794, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20523881912231445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20523881912231445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 794, 128]), torch.Size([1, 794, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20599603652954102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23887300491333008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 794, 128])
m.shape torch.Size([643, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24064064025878906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24064064025878906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24125385284423828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27339601516723633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([545, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27516841888427734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27516841888427734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27568817138671875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.30614376068115234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([504, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.308046817779541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.308046817779541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.30852746963500977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.33928918838500977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([5440, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3649888038635254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3649888038635254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5440, 128]), torch.Size([1, 5440, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3701767921447754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7399277687072754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5440, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7013211250305176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7143826484680176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7270665168762207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7139058113098145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13300, 256])
first layer input nodes number: 48911
first layer output nodes number: 13300
edges number: 88287
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7274332046508789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.740117073059082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7432880401611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7432880401611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([541, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7599806785583496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7599806785583496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7610125541687012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7707667350769043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([440, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7710967063903809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7710967063903809  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7719359397888184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7858920097351074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([335, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7864384651184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7864384651184082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7870774269104004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8017182350158691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8024330139160156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8024330139160156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8029365539550781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8196334838867188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.820429801940918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.820429801940918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8208456039428711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8358144760131836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8365988731384277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8365988731384277  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8369269371032715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8510336875915527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.851717472076416  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.851717472076416  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8519577980041504  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8639740943908691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8646383285522461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8646383285522461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.864832878112793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8759222030639648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8767075538635254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8767075538635254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8769021034240723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8893532752990723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8900923728942871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8900923728942871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8902583122253418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9020400047302246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.902623176574707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.902623176574707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9027433395385742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9121160507202148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9125866889953613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9125866889953613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9126744270324707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9201321601867676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9206757545471191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9206757545471191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9207653999328613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9290127754211426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9293584823608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9293584823608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9294137954711914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9348897933959961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9352226257324219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9352226257324219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9352703094482422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9403247833251953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9406547546386719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9406547546386719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9406986236572266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9456558227539062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9458789825439453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9458789825439453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9459075927734375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9493408203125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9495687484741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9495687484741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9495954513549805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9529867172241211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9533023834228516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9533023834228516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9533367156982422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9579372406005859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9581317901611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9581317901611328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9581527709960938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9611110687255859  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9613227844238281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9613227844238281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9613437652587891  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9644489288330078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9646711349487305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9646711349487305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9646921157836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9679441452026367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9680666923522949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9680666923522949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9680781364440918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9699320793151855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.970088005065918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.970088005065918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9701013565063477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9723577499389648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([110, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9749941825866699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9749941825866699  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9752039909362793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0121302604675293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 110, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9987239837646484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9991450309753418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes
[05:44:21] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 510472 edges into 32 parts and get 36849 edge cuts

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9995660781860352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9991235733032227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2823, 40])
input nodes number: 13300
output nodes number: 2823
edges number: 16693
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9992399215698242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9992403984069824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.037369728088378906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.037369728088378906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.037369728088378906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011407092213630676 |0.0019383877515792847 |0.11567288637161255 |8.890777826309204e-05 |0.07658740878105164 |0.0047037601470947266 |
----------------------------------------------------------pseudo_mini_loss sum 4.3084611892700195
Total (block generation + training)time/epoch 22.271122694015503
Training time/epoch 6.7430174350738525
Training time without block to device /epoch 6.680989027023315
Training time without total dataloading part /epoch 6.159878253936768
load block tensor time/epoch 0.36502695083618164
block to device time/epoch 0.06202840805053711
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1951140
Number of first layer input nodes during this epoch:  1510806
Number of first layer output nodes during this epoch:  440334
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0373692512512207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02322077751159668
global_2_local spend time (sec) 0.05078744888305664
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0042574405670166016
A = g.adjacency_matrix() spent  0.010786771774291992
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08430957794189453
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.2982664108276367
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1590185165405273

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 0.018 seconds
Metis partitioning: 0.091 seconds
Split the graph: 0.034 seconds
Construct subgraphs: 0.052 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.19488906860351562
2906
2903
2885
2851
2884
2792
2914
2901
2786
2779
2822
2789
2820
2889
2778
2820
2823
2880
2868
2868
2868
2908
2851
2794
2846
2801
2825
2901
2810
2784
2778
2817
total k batches seeds list generation spend  10.421205520629883
after graph partition
graph partition algorithm spend time 10.501489877700806
2906
2903
2885
2851
2884
2792
2914
2901
2786
2779
2822
2789
2820
2889
2778
2820
2823
2880
2868
2868
2868
2908
2851
2794
2846
2801
2825
2901
2810
2784
2778
2817
partition_len_list
[17052, 16191, 13786, 12559, 17971, 15402, 17454, 17018, 13029, 13679, 13360, 13516, 14101, 13979, 13419, 13121, 11032, 12187, 11458, 12299, 12050, 13002, 13400, 13882, 12772, 13177, 13613, 13046, 13935, 13281, 13149, 13114]
shared_neighbor_graph_partition_s0 selection method  spend 10.605427265167236
time for parepare:  0.01718306541442871
local_output_nid generation:  0.0007445812225341797
local_in_edges_tensor generation:  0.0009856224060058594
mini_batch_src_global generation:  0.0015769004821777344
r_  generation:  0.014629125595092773
local_output_nid generation:  0.0023412704467773438
local_in_edges_tensor generation:  0.0012257099151611328
mini_batch_src_global generation:  0.001312255859375
r_  generation:  0.010420799255371094
local_output_nid generation:  0.0009429454803466797
local_in_edges_tensor generation:  0.0007982254028320312
mini_batch_src_global generation:  0.0010328292846679688
r_  generation:  0.007535696029663086
local_output_nid generation:  0.0009379386901855469
local_in_edges_tensor generation:  0.000762939453125
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.00826406478881836
local_output_nid generation:  0.0009000301361083984
local_in_edges_tensor generation:  0.0008378028869628906
mini_batch_src_global generation:  0.0010304450988769531
r_  generation:  0.011599063873291016
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0007104873657226562
mini_batch_src_global generation:  0.0010442733764648438
r_  generation:  0.007832050323486328
local_output_nid generation:  0.0009372234344482422
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.0010516643524169922
r_  generation:  0.011816978454589844
local_output_nid generation:  0.0009636878967285156
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0013744831085205078
r_  generation:  0.013881921768188477
local_output_nid generation:  0.0009038448333740234
local_in_edges_tensor generation:  0.0006525516510009766
mini_batch_src_global generation:  0.0008599758148193359
r_  generation:  0.0054171085357666016
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0006244182586669922
mini_batch_src_global generation:  0.0006239414215087891
r_  generation:  0.004937410354614258
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0006246566772460938
mini_batch_src_global generation:  0.000614166259765625
r_  generation:  0.005135059356689453
local_output_nid generation:  0.0008363723754882812
local_in_edges_tensor generation:  0.0006020069122314453
mini_batch_src_global generation:  0.0005674362182617188
r_  generation:  0.004877567291259766
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.000667572021484375
mini_batch_src_global generation:  0.0007252693176269531
r_  generation:  0.006796598434448242
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0006115436553955078
mini_batch_src_global generation:  0.0006465911865234375
r_  generation:  0.005029439926147461
local_output_nid generation:  0.0008194446563720703
local_in_edges_tensor generation:  0.0006062984466552734
mini_batch_src_global generation:  0.0006048679351806641
r_  generation:  0.0052394866943359375
local_output_nid generation:  0.0008265972137451172
local_in_edges_tensor generation:  0.0006031990051269531
mini_batch_src_global generation:  0.0005552768707275391
r_  generation:  0.00504302978515625
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0006749629974365234
mini_batch_src_global generation:  0.0008769035339355469
r_  generation:  0.008533000946044922
local_output_nid generation:  0.0008580684661865234
local_in_edges_tensor generation:  0.0006821155548095703
mini_batch_src_global generation:  0.001035451889038086
r_  generation:  0.008194923400878906
local_output_nid generation:  0.00091552734375
local_in_edges_tensor generation:  0.000713348388671875
mini_batch_src_global generation:  0.0010819435119628906
r_  generation:  0.009116649627685547
local_output_nid generation:  0.00090789794921875
local_in_edges_tensor generation:  0.0007998943328857422
mini_batch_src_global generation:  0.0010802745819091797
r_  generation:  0.009137630462646484
local_output_nid generation:  0.0009002685546875
local_in_edges_tensor generation:  0.0006701946258544922
mini_batch_src_global generation:  0.0009601116180419922
r_  generation:  0.00771784782409668
local_output_nid generation:  0.0009024143218994141
local_in_edges_tensor generation:  0.0006725788116455078
mini_batch_src_global generation:  0.0008852481842041016
r_  generation:  0.007191181182861328
local_output_nid generation:  0.0008616447448730469
local_in_edges_tensor generation:  0.0006430149078369141
mini_batch_src_global generation:  0.0007758140563964844
r_  generation:  0.006174325942993164
local_output_nid generation:  0.0008256435394287109
local_in_edges_tensor generation:  0.0005939006805419922
mini_batch_src_global generation:  0.0006585121154785156
r_  generation:  0.005379199981689453
local_output_nid generation:  0.0008568763732910156
local_in_edges_tensor generation:  0.0006494522094726562
mini_batch_src_global generation:  0.0007145404815673828
r_  generation:  0.006043672561645508
local_output_nid generation:  0.0008118152618408203
local_in_edges_tensor generation:  0.0005915164947509766
mini_batch_src_global generation:  0.000637054443359375
r_  generation:  0.005318164825439453
local_output_nid generation:  0.0008251667022705078
local_in_edges_tensor generation:  0.0008032321929931641
mini_batch_src_global generation:  0.0006055831909179688
r_  generation:  0.005136966705322266
local_output_nid generation:  0.0008451938629150391
local_in_edges_tensor generation:  0.0006258487701416016
mini_batch_src_global generation:  0.0006399154663085938
r_  generation:  0.005970954895019531
local_output_nid generation:  0.00080108642578125
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0006232261657714844
r_  generation:  0.005230903625488281
local_output_nid generation:  0.0007877349853515625
local_in_edges_tensor generation:  0.0006108283996582031
mini_batch_src_global generation:  0.0005891323089599609
r_  generation:  0.005308866500854492
local_output_nid generation:  0.000782012939453125
local_in_edges_tensor generation:  0.0005986690521240234
mini_batch_src_global generation:  0.0005431175231933594
r_  generation:  0.004387378692626953
local_output_nid generation:  0.0008289813995361328
local_in_edges_tensor generation:  0.0005972385406494141
mini_batch_src_global generation:  0.0005636215209960938
r_  generation:  0.005258798599243164
----------------------check_connections_block total spend ----------------------------- 0.39952754974365234
generate_one_block  0.026542186737060547
generate_one_block  0.01817917823791504
generate_one_block  0.01343536376953125
generate_one_block  0.013385772705078125
generate_one_block  0.017261981964111328
generate_one_block  0.01364588737487793
generate_one_block  0.017928361892700195
generate_one_block  0.021701812744140625
generate_one_block  0.009512186050415039
generate_one_block  0.008941888809204102
generate_one_block  0.008453845977783203
generate_one_block  0.008167743682861328
generate_one_block  0.010869979858398438
generate_one_block  0.00843191146850586
generate_one_block  0.008546113967895508
generate_one_block  0.008112907409667969
generate_one_block  0.01789546012878418
generate_one_block  0.01357126235961914
generate_one_block  0.014197349548339844
generate_one_block  0.013738632202148438
generate_one_block  0.012119531631469727
generate_one_block  0.011054515838623047
generate_one_block  0.009747982025146484
generate_one_block  0.008775711059570312
generate_one_block  0.009702205657958984
generate_one_block  0.008519887924194336
generate_one_block  0.00836038589477539
generate_one_block  0.009448528289794922
generate_one_block  0.008650541305541992
generate_one_block  0.00835418701171875
generate_one_block  0.007731199264526367
generate_one_block  0.00851583480834961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029873132705688477
gen group dst list time:  0.012970924377441406
time for parepare:  0.01882314682006836
local_output_nid generation:  0.0033769607543945312
local_in_edges_tensor generation:  0.01456594467163086
mini_batch_src_global generation:  0.004594326019287109
r_  generation:  0.04856157302856445
local_output_nid generation:  0.00495600700378418
local_in_edges_tensor generation:  0.005072593688964844
mini_batch_src_global generation:  0.0053141117095947266
r_  generation:  0.046503305435180664
local_output_nid generation:  0.004456281661987305
local_in_edges_tensor generation:  0.0037653446197509766
mini_batch_src_global generation:  0.003717660903930664
r_  generation:  0.03717994689941406
local_output_nid generation:  0.0039060115814208984
local_in_edges_tensor generation:  0.003755331039428711
mini_batch_src_global generation:  0.0029892921447753906
r_  generation:  0.03261208534240723
local_output_nid generation:  0.005103588104248047
local_in_edges_tensor generation:  0.004552125930786133
mini_batch_src_global generation:  0.0049555301666259766
r_  generation:  0.053122758865356445
local_output_nid generation:  0.004713535308837891
local_in_edges_tensor generation:  0.004647493362426758
mini_batch_src_global generation:  0.004514217376708984
r_  generation:  0.04338788986206055
local_output_nid generation:  0.005146980285644531
local_in_edges_tensor generation:  0.004662752151489258
mini_batch_src_global generation:  0.0051538944244384766
r_  generation:  0.05293989181518555
local_output_nid generation:  0.004882335662841797
local_in_edges_tensor generation:  0.005068063735961914
mini_batch_src_global generation:  0.005579471588134766
r_  generation:  0.05064654350280762
local_output_nid generation:  0.004209041595458984
local_in_edges_tensor generation:  0.003641366958618164
mini_batch_src_global generation:  0.0038673877716064453
r_  generation:  0.03514862060546875
local_output_nid generation:  0.004215717315673828
local_in_edges_tensor generation:  0.0035583972930908203
mini_batch_src_global generation:  0.0030252933502197266
r_  generation:  0.035794973373413086
local_output_nid generation:  0.004086971282958984
local_in_edges_tensor generation:  0.0035037994384765625
mini_batch_src_global generation:  0.0029442310333251953
r_  generation:  0.035386085510253906
local_output_nid generation:  0.004215240478515625
local_in_edges_tensor generation:  0.003542184829711914
mini_batch_src_global generation:  0.0030570030212402344
r_  generation:  0.036182403564453125
local_output_nid generation:  0.004283905029296875
local_in_edges_tensor generation:  0.0036258697509765625
mini_batch_src_global generation:  0.004255771636962891
r_  generation:  0.03898787498474121
local_output_nid generation:  0.004277467727661133
local_in_edges_tensor generation:  0.0036427974700927734
mini_batch_src_global generation:  0.0034041404724121094
r_  generation:  0.03707766532897949
local_output_nid generation:  0.004217624664306641
local_in_edges_tensor generation:  0.0034868717193603516
mini_batch_src_global generation:  0.00330352783203125
r_  generation:  0.036270856857299805
local_output_nid generation:  0.004024982452392578
local_in_edges_tensor generation:  0.0032858848571777344
mini_batch_src_global generation:  0.0029954910278320312
r_  generation:  0.034935951232910156
local_output_nid generation:  0.0034437179565429688
local_in_edges_tensor generation:  0.002998828887939453
mini_batch_src_global generation:  0.0027065277099609375
r_  generation:  0.047220706939697266
local_output_nid generation:  0.006490945816040039
local_in_edges_tensor generation:  0.005105257034301758
mini_batch_src_global generation:  0.008908748626708984
r_  generation:  0.03281235694885254
local_output_nid generation:  0.00409388542175293
local_in_edges_tensor generation:  0.002925395965576172
mini_batch_src_global generation:  0.002801179885864258
r_  generation:  0.03079843521118164
local_output_nid generation:  0.003906965255737305
local_in_edges_tensor generation:  0.0031223297119140625
mini_batch_src_global generation:  0.002787351608276367
r_  generation:  0.03206300735473633
local_output_nid generation:  0.0037364959716796875
local_in_edges_tensor generation:  0.003076791763305664
mini_batch_src_global generation:  0.0028448104858398438
r_  generation:  0.031551361083984375
local_output_nid generation:  0.003934144973754883
local_in_edges_tensor generation:  0.003301858901977539
mini_batch_src_global generation:  0.002966165542602539
r_  generation:  0.03543996810913086
local_output_nid generation:  0.00410914421081543
local_in_edges_tensor generation:  0.003435373306274414
mini_batch_src_global generation:  0.003177642822265625
r_  generation:  0.035874366760253906
local_output_nid generation:  0.004210233688354492
local_in_edges_tensor generation:  0.003534078598022461
mini_batch_src_global generation:  0.0031723976135253906
r_  generation:  0.03686261177062988
local_output_nid generation:  0.003917694091796875
local_in_edges_tensor generation:  0.0033485889434814453
mini_batch_src_global generation:  0.0030431747436523438
r_  generation:  0.034241676330566406
local_output_nid generation:  0.00402379035949707
local_in_edges_tensor generation:  0.0033218860626220703
mini_batch_src_global generation:  0.0030181407928466797
r_  generation:  0.03517866134643555
local_output_nid generation:  0.004097461700439453
local_in_edges_tensor generation:  0.003453969955444336
mini_batch_src_global generation:  0.0031731128692626953
r_  generation:  0.03658699989318848
local_output_nid generation:  0.003998517990112305
local_in_edges_tensor generation:  0.003307342529296875
mini_batch_src_global generation:  0.0030527114868164062
r_  generation:  0.03539323806762695
local_output_nid generation:  0.004195451736450195
local_in_edges_tensor generation:  0.0036573410034179688
mini_batch_src_global generation:  0.0031540393829345703
r_  generation:  0.03709268569946289
local_output_nid generation:  0.004007577896118164
local_in_edges_tensor generation:  0.0033676624298095703
mini_batch_src_global generation:  0.0031630992889404297
r_  generation:  0.03548002243041992
local_output_nid generation:  0.003946065902709961
local_in_edges_tensor generation:  0.0034170150756835938
mini_batch_src_global generation:  0.003021717071533203
r_  generation:  0.0351717472076416
local_output_nid generation:  0.003931999206542969
local_in_edges_tensor generation:  0.0033571720123291016
mini_batch_src_global generation:  0.0029883384704589844
r_  generation:  0.0350797176361084
----------------------check_connections_block total spend ----------------------------- 1.9020164012908936
generate_one_block  0.06513714790344238
generate_one_block  0.07233500480651855
generate_one_block  0.04977536201477051
generate_one_block  0.04451870918273926
generate_one_block  0.08907222747802734
generate_one_block  0.05817818641662598
generate_one_block  0.06857562065124512
generate_one_block  0.06825542449951172
generate_one_block  0.04496455192565918
generate_one_block  0.04557228088378906
generate_one_block  0.04444599151611328
generate_one_block  0.04657888412475586
generate_one_block  0.04884052276611328
generate_one_block  0.04669785499572754
generate_one_block  0.045943260192871094
generate_one_block  0.04333233833312988
generate_one_block  0.03964805603027344
generate_one_block  0.04264020919799805
generate_one_block  0.04067230224609375
generate_one_block  0.043112754821777344
generate_one_block  0.04260516166687012
generate_one_block  0.04490351676940918
generate_one_block  0.04667830467224121
generate_one_block  0.04616689682006836
generate_one_block  0.042600393295288086
generate_one_block  0.05126476287841797
generate_one_block  0.045680999755859375
generate_one_block  0.04420042037963867
generate_one_block  0.04826784133911133
generate_one_block  0.0446619987487793
generate_one_block  0.04363751411437988
generate_one_block  0.04337620735168457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0373692512512207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

connection checking time:  1.9020164012908936
block generation total time  1.5923407077789307
average batch blocks generation time:  0.04976064711809158
block dataloader generation time/epoch 15.332393884658813
pseudo mini batch 0 input nodes size: 50678
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034983158111572266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034983158111572266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.059148311614990234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05917024612426758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03571128845214844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03703498840332031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03703498840332031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03703498840332031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([50678, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03703498840332031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([559, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10606098175048828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10606098175048828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10659408569335938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1110835075378418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([711, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1114950180053711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1114950180053711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 711, 128]), torch.Size([1, 711, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11217308044433594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1223440170288086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 711, 128])
m.shape torch.Size([754, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12308359146118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12308359146118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12380266189575195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13983583450317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([709, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14082860946655273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14082860946655273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14150476455688477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16201353073120117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([686, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16331100463867188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16331100463867188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 686, 128]), torch.Size([1, 686, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16396522521972656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18822193145751953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 686, 128])
m.shape torch.Size([637, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18971729278564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18971729278564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1903247833251953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21819114685058594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([624, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2199702262878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2199702262878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2205653190612793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2503199577331543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([583, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2522463798522949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2522463798522949  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25280237197875977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28557920455932617  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([600, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2878761291503906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2878761291503906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2884483337402344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3258342742919922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([11189, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37890148162841797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37890148162841797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11189, 128]), torch.Size([1, 11189, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3895721435546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1491904258728027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11189, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0845932960510254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1008553504943848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1171174049377441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1007280349731445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([17052, 256])
first layer input nodes number: 50678
first layer output nodes number: 17052
edges number: 140653
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1174969673156738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1337590217590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1386113166809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1386113166809082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([284, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1745572090148926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1745572090148926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1750988960266113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1805024147033691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([254, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1807198524475098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1807198524475098  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1812043190002441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1884713172912598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([186, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.188765525817871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.188765525817871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1891202926635742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.196925163269043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([142, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.197293758392334  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.197293758392334  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1975646018981934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2054190635681152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([135, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2059326171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2059326171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2061901092529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2154598236083984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([100, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2159080505371094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2159080505371094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2160987854003906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2243003845214844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([87, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2247905731201172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2247905731201172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2249565124511719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2332534790039062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([66, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2336783409118652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2336783409118652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2338042259216309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2409796714782715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.241626262664795  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.241626262664795  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2417826652526855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2517924308776855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2524447441101074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2524447441101074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2525897026062012  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2628817558288574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([87, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2637290954589844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2637290954589844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.263895034790039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2768383026123047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.277470588684082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.277470588684082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2775888442993164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2876405715942383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2884063720703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2884063720703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2885322570800781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3001136779785156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.300804615020752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.300804615020752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3009114265441895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.311485767364502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3122544288635254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3122544288635254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3123631477355957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3238873481750488  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3247404098510742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3247404098510742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3248529434204102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.337569236755371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3382973670959473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3382973670959473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3383889198303223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3493752479553223  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3502812385559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3502812385559082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.350386142730713  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3637089729309082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3645515441894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3645515441894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.364645004272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3771686553955078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3780641555786133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3780641555786133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.378157615661621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3913354873657227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.392076015472412  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.392076015472412  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3921504020690918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4031596183776855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.403841495513916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.403841495513916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4039063453674316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4139580726623535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4144563674926758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4144563674926758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4145021438598633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4219179153442383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([46, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.422968864440918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.422968864440918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4230566024780273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4378843307495117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([763, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.456174373626709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.456174373626709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.457629680633545  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7149338722229004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 763, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.6816353797912598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.6820688247680664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.682502269744873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.682046890258789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2906, 40])
input nodes number: 17052
output nodes number: 2906
edges number: 36985
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.68220853805542  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.6822094917297363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03944063186645508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 1 input nodes size: 49803
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035724639892578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.035724639892578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05947256088256836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0594944953918457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03530740737915039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03653097152709961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03653097152709961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03653097152709961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([49803, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03653097152709961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([597, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10062932968139648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10062932968139648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10119867324829102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10593318939208984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([805, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10641622543334961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10641622543334961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10718393325805664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11869955062866211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([805, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11983776092529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11983776092529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12060546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13846588134765625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([749, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1395106315612793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1395106315612793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14022493362426758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16122961044311523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([716, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16257953643798828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16257953643798828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 716, 128]), torch.Size([1, 716, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16326236724853516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18890094757080078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 716, 128])
m.shape torch.Size([635, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19037628173828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19037628173828125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19098186492919922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21880054473876953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([564, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22038030624389648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22038030624389648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2209181785583496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2494349479675293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([543, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2512373924255371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2512373924255371  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2517552375793457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2819705009460449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([562, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28412342071533203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28412342071533203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28465938568115234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.31969261169433594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([10215, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.368133544921875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.368133544921875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10215, 128]), torch.Size([1, 10215, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.37787532806396484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.07049560546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10215, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0108060836791992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0262470245361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0416879653930664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0261263847351074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([16191, 256])
first layer input nodes number: 49803
first layer output nodes number: 16191
edges number: 130508
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0420613288879395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.057502269744873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0614562034606934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0614562034606934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([311, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0941872596740723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0941872596740723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.094780445098877  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1018977165222168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([287, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1021528244018555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1021528244018555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1027002334594727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1162042617797852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([232, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1165995597839355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1165995597839355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.117042064666748  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.126777172088623  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([158, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1271634101867676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1271634101867676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.127464771270752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1362042427062988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([147, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1367602348327637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1367602348327637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.137040615081787  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1471343040466309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([133, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.147761344909668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.147761344909668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.148015022277832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1589231491088867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([101, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1594762802124023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1594762802124023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1596689224243164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1693010330200195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1698737144470215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1698737144470215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1700396537780762  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1794981956481934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1800384521484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1800384521484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.18017578125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.18896484375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1896171569824219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1896171569824219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1897602081298828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1999168395996094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2005858421325684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2005858421325684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2007193565368652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2111334800720215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2119550704956055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2119550704956055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.212101936340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2245855331420898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2252492904663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2252492904663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2253618240356445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2357149124145508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2363181114196777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2363181114196777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2364115715026855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.245664119720459  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.246222972869873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.246222972869873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2463030815124512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2547945976257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2554926872253418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2554926872253418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2555842399597168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2659296989440918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2664070129394531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2664070129394531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2664680480957031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2737922668457031  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2746095657348633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2746095657348633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.274703025817871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2865724563598633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.28731107711792  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.28731107711792  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2873930931091309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2983832359313965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.299034595489502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.299034595489502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2991032600402832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3087849617004395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3094978332519531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3094978332519531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3095684051513672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3200130462646484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3206543922424316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3206543922424316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3207154273986816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3301758766174316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3306541442871094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3306541442871094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.330698013305664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3378047943115234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.338475227355957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.338475227355957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3385324478149414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3482027053833008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([673, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3643450736999512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3643450736999512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 673, 256]), torch.Size([1, 673, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.365628719329834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5953855514526367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 673, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5653858184814453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5658187866210938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5662517547607422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5657968521118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2903, 40])
input nodes number: 16191
output nodes number: 2903
edges number: 33610
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.565938949584961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5659394264221191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.038771629333496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 2 input nodes size: 47180
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03530693054199219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03530693054199219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05874443054199219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05876636505126953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03499650955200195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03591775894165039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03591775894165039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03591775894165039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([47180, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03591775894165039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([755, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08440351486206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08440351486206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 755, 128]), torch.Size([1, 755, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08512353897094727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09088373184204102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 755, 128])
m.shape torch.Size([1021, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09149742126464844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09149742126464844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1021, 128]), torch.Size([1, 1021, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09247112274169922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10707664489746094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1021, 128])
m.shape torch.Size([1083, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10814619064331055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10814619064331055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10917901992797852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13190126419067383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([957, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1332101821899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1332101821899414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1341228485107422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16164302825927734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([913, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16336345672607422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16336345672607422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16423416137695312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1961665153503418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([778, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19795703887939453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19795703887939453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1986989974975586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23119258880615234  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([681, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2330946922302246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2330946922302246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23374414443969727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.26712512969970703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([670, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.26935625076293945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.26935625076293945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.26999521255493164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3068509101867676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([565, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3089561462402344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3089561462402344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3094949722290039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.34639787673950195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([6363, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3773784637451172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3773784637451172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 6363, 128]), torch.Size([1, 6363, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.38344669342041016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8142910003662109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 6363, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7723350524902344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7854824066162109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7986297607421875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7853794097900391  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([13786, 256])
first layer input nodes number: 47180
first layer output nodes number: 13786
edges number: 97949
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7989835739135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8121309280395508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8154177665710449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8154177665710449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([368, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8403868675231934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8403868675231934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8410887718200684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8477821350097656  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([349, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8481020927429199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8481020927429199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8487677574157715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8592500686645508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8597307205200195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8597307205200195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8602685928344727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.874359130859375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([194, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8748364448547363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8748364448547363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.875206470489502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8859372138977051  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.886627197265625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.886627197265625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8869743347167969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8994712829589844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9001226425170898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9001226425170898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.900395393371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9121236801147461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9129161834716797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9129161834716797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9131793975830078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9263401031494141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9271082878112793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9271082878112793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9273314476013184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9400515556335449  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([114, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9412746429443359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9412746429443359  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9414920806884766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9554080963134766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9561357498168945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9561357498168945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9563016891479492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.968083381652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9688148498535156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9688148498535156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9689617156982422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9804172515869141  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9813127517700195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9813127517700195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9814729690551758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.995091438293457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9957361221313477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9957361221313477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9958467483520508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0060243606567383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0068302154541016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0068302154541016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0069522857666016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0190372467041016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.019639492034912  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.019639492034912  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0197272300720215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0290274620056152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.029691219329834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.029691219329834  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0297789573669434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0396933555603027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.040205478668213  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.040205478668213  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0402703285217285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0480523109436035  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.048591136932373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.048591136932373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0486540794372559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.056647777557373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0572919845581055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0572919845581055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0573625564575195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.066819190979004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0672264099121094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0672264099121094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.067270278930664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.073455810546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.074019432067871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.074019432067871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0740747451782227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.082261085510254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0827832221984863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0827832221984863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0828328132629395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0905194282531738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0911140441894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0911140441894531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0911674499511719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0998191833496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1001849174499512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1001849174499512  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.100217342376709  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1056971549987793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([309, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.113133430480957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.113133430480957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.113722801208496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2229399681091309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 309, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2010269165039062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2014570236206055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2018871307373047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2014350891113281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2885, 40])
input nodes number: 13786
output nodes number: 2885
edges number: 25478
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2015571594238281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2015576362609863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.037720680236816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 3 input nodes size: 41685
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034993648529052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034993648529052734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05487060546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05489206314086914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0314326286315918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03230905532836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03230905532836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03230905532836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([41685, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03230905532836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([704, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07620668411254883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07620668411254883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 704, 128]), torch.Size([1, 704, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.07687807083129883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08312416076660156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 704, 128])
m.shape torch.Size([950, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0836944580078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0836944580078125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 950, 128]), torch.Size([1, 950, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.08460044860839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0981903076171875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 950, 128])
m.shape torch.Size([915, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09904623031616211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09904623031616211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 915, 128]), torch.Size([1, 915, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09991884231567383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11911630630493164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 915, 128])
m.shape torch.Size([881, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1203603744506836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1203603744506836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 881, 128]), torch.Size([1, 881, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1212005615234375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14556598663330078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 881, 128])
m.shape torch.Size([868, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1472153663635254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1472153663635254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14804315567016602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17810297012329102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([720, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1797490119934082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1797490119934082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1804356575012207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21107149124145508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 720, 128])
m.shape torch.Size([666, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2129511833190918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2129511833190918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21358633041381836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24624013900756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([629, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2483220100402832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2483220100402832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.24892187118530273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28571367263793945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([522, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28765392303466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28765392303466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28815174102783203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3210926055908203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([5704, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3481874465942383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3481874465942383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 5704, 128]), torch.Size([1, 5704, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.35362720489501953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7483301162719727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 5704, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7084436416625977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7204208374023438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7323980331420898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7203269004821777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([12559, 256])
first layer input nodes number: 41685
first layer output nodes number: 12559
edges number: 88965
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7327108383178711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7446880340576172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7479000091552734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7479000091552734  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([307, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7758779525756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7758779525756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.776463508605957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7819762229919434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7822489738464355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7822489738464355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7828097343444824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7916412353515625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([211, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7919692993164062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7919692993164062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.7923717498779297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8012256622314453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([157, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8016281127929688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8016281127929688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8019275665283203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8106117248535156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([175, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8113031387329102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8113031387329102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8116369247436523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8236532211303711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([130, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8242363929748535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8242363929748535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8244843482971191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.835146427154541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8359107971191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8359107971191406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8361625671386719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8487510681152344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([139, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8496942520141602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8496942520141602  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8499593734741211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8650712966918945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8658385276794434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8658385276794434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8660368919372559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8787322044372559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([113, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8797192573547363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8797192573547363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8799347877502441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8952374458312988  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([101, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8971657752990723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8971657752990723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8973584175109863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9123845100402832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9131536483764648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9131536483764648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9132966995239258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9254560470581055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9263219833374023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9263219833374023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9264650344848633  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9396257400512695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9403214454650879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9403214454650879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9404301643371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9511933326721191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9520044326782227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9520044326782227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9521188735961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9642496109008789  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([72, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9652996063232422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9652996063232422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9654369354248047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9809551239013672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.981719970703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.981719970703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9818172454833984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9934902191162109  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9942202568054199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9942202568054199  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9943060874938965  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.00520658493042  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0062055587768555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0062055587768555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.006312370300293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.020625114440918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0214176177978516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0214176177978516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0215015411376953  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.033334732055664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0337772369384766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0337772369384766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.033823013305664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.040597915649414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0410404205322266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0410404205322266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0410823822021484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.047586441040039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0481624603271484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0481624603271484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0482139587402344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0565567016601562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.056992530822754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.056992530822754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0570306777954102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0634775161743164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([360, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0721774101257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0721774101257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.072864055633545  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1992793083190918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 360, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.174238681793213  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1746635437011719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1750884056091309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1746420860290527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2851, 40])
input nodes number: 12559
output nodes number: 2851
edges number: 28459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1747522354125977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1747527122497559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034018516540527344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 4 input nodes size: 54271
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03142738342285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03142738342285156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05730581283569336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0573277473449707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0374293327331543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03881502151489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03881502151489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03881502151489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([54271, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03881502151489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([580, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11180257797241211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11180257797241211  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11235570907592773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11737537384033203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([771, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11783409118652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11783409118652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 771, 128]), torch.Size([1, 771, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11856937408447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12959861755371094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 771, 128])
m.shape torch.Size([802, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13102006912231445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13102006912231445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13178491592407227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14861154556274414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([745, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14965009689331055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14965009689331055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 745, 128]), torch.Size([1, 745, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1503605842590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1710982322692871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 745, 128])
m.shape torch.Size([685, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1725149154663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1725149154663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17316818237304688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.196685791015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([654, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19893217086791992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19893217086791992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1995558738708496  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22688627243041992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([594, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22855710983276367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22855710983276367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22912359237670898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25911569595336914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([563, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.26098012924194336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.26098012924194336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2615170478820801  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2929835319519043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([551, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.29584312438964844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.29584312438964844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2963685989379883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.33031558990478516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([12026, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.38739728927612305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.38739728927612305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12026, 128]), torch.Size([1, 12026, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3995957374572754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.228003978729248  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12026, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1593222618103027  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1774001121520996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1945385932922363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1763267517089844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([17971, 256])
first layer input nodes number: 54271
first layer output nodes number: 17971
edges number: 148738
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1949448585510254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.212083339691162  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.216489315032959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.216489315032959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([277, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2524652481079102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2524652481079102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2529935836791992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2576923370361328  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([257, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.257922649383545  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.257922649383545  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2584128379821777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2668452262878418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([194, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2671599388122559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2671599388122559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2675299644470215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2756705284118652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([158, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2760930061340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2760930061340332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2763943672180176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2851338386535645  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([112, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2855215072631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2855215072631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2857351303100586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2934255599975586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([100, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2938957214355469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2938957214355469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2940864562988281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3022880554199219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([75, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3026976585388184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3026976585388184  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3028407096862793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3099932670593262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3104987144470215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3104987144470215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3106417655944824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3187956809997559  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3194594383239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3194594383239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3196215629577637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3299975395202637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.330714225769043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.330714225769043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3308725357055664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3421125411987305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3427739143371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3427739143371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.342907428741455  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3533215522766113  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3539471626281738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3539471626281738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3540616035461426  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3637890815734863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.364394187927246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.364394187927246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3644952774047852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.373795509338379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3743643760681152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3743643760681152  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3744521141052246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3831381797790527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3840746879577637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3840746879577637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.384204387664795  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3979525566101074  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3987488746643066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3987488746643066  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3988556861877441  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4109253883361816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4115419387817383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4115419387817383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4116201400756836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.421004295349121  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4217958450317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4217958450317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4218873977661133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4335145950317383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4342360496520996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4342360496520996  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4343161582946777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4450507164001465  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.445760726928711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.445760726928711  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4458351135253906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4563236236572266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4571342468261719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4571342468261719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.45721435546875  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4690704345703125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4697070121765137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4697070121765137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4697680473327637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4792284965515137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4800162315368652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4800162315368652  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4800868034362793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4915194511413574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4921765327453613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4921765327453613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4922337532043457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.501904010772705  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([804, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5215568542480469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5215568542480469  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5230903625488281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7929878234863281  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 804, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7597603797912598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.760190486907959  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7606205940246582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7601685523986816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2884, 40])
input nodes number: 17971
output nodes number: 2884
edges number: 37020
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7603297233581543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7603302001953125  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.04132223129272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 5 input nodes size: 53337
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03743457794189453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03743457794189453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.06286764144897461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.06288862228393555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036988258361816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03801536560058594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03801536560058594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03801536560058594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([53337, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03801536560058594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09447908401489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09447908401489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.09526777267456055  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10233926773071289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([1034, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10293102264404297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10293102264404297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1034, 128]), torch.Size([1, 1034, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10391712188720703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11870861053466797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1034, 128])
m.shape torch.Size([1022, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11967754364013672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11967754364013672  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1206521987915039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14258193969726562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([960, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14392566680908203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14392566680908203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 960, 128]), torch.Size([1, 960, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14484119415283203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17285633087158203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 960, 128])
m.shape torch.Size([853, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17443227767944336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17443227767944336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1752457618713379  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20486116409301758  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([702, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20646286010742188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20646286010742188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.20713233947753906  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2364516258239746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([694, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2384629249572754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2384629249572754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 694, 128]), torch.Size([1, 694, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.23912477493286133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2722172737121582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 694, 128])
m.shape torch.Size([579, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2740950584411621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2740950584411621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.27464723587036133  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3076910972595215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([501, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.30956506729125977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.30956506729125977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3100428581237793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3406214714050293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([8230, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3796262741088867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3796262741088867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 8230, 128]), torch.Size([1, 8230, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.38747501373291016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9447355270385742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 8230, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.8940739631652832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9087624549865723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9234509468078613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9086475372314453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([15402, 256])
first layer input nodes number: 53337
first layer output nodes number: 15402
edges number: 114577
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9238505363464355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9385390281677246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.942354679107666  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.942354679107666  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([447, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9650797843933105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9650797843933105  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9659323692321777  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9729089736938477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([374, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9732017517089844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9732017517089844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9739151000976562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9865503311157227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9870157241821289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9870157241821289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.9875593185424805  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0008411407470703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0014920234680176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0014920234680176  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0019497871398926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0152249336242676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.015904426574707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.015904426574707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0162649154663086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0292425155639648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.029881477355957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.029881477355957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0301523208618164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0417985916137695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0424776077270508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0424776077270508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.042708396911621  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0542478561401367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0548324584960938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0548324584960938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0550060272216797  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0648994445800781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0654702186584473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0654702186584473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.065615177154541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.074892520904541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([54, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0753393173217773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0753393173217773  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0754423141479492  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0827550888061523  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0833168029785156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0833168029785156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0834274291992188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0920562744140625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0927047729492188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0927047729492188  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.0928211212158203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1027107238769531  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1032023429870605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1032023429870605  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1032862663269043  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1110072135925293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1113958358764648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1113958358764648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1114568710327148  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1174993515014648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1180024147033691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1180024147033691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1180729866027832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1255536079406738  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.12599515914917  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.12599515914917  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.126054286956787  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1327357292175293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.133000373840332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.133000373840332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1330347061157227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1371545791625977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1376047134399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1376047134399414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1376562118530273  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1441965103149414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1446642875671387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1446642875671387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1447157859802246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1516165733337402  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1519370079040527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1519370079040527  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1519713401794434  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1568121910095215  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.157158374786377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.157158374786377  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1571927070617676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.16227388381958  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.162510871887207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.162510871887207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1625337600708008  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.166081428527832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1662912368774414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1662912368774414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1663103103637695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1694002151489258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1697368621826172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1697368621826172  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1697654724121094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.174600601196289  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([365, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.183403491973877  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.183403491973877  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1840996742248535  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.308973789215088  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 365, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2892179489135742  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2896342277526855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2900505065917969  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2896132469177246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2792, 40])
input nodes number: 15402
output nodes number: 2792
edges number: 23069
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2897353172302246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2897357940673828  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.039975643157958984  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 6 input nodes size: 51917
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036974430084228516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036974430084228516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.061730384826660156  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0617523193359375  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.036298274993896484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03766965866088867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03766965866088867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03766965866088867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([51917, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.03766965866088867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([507, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1093454360961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1093454360961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10982894897460938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11369705200195312  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([675, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11409902572631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11409902572631836  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 675, 128]), torch.Size([1, 675, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11474275588989258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.12441492080688477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 675, 128])
m.shape torch.Size([656, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1250314712524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1250314712524414  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1256570816040039  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13980579376220703  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([706, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1408395767211914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1408395767211914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 706, 128]), torch.Size([1, 706, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14151287078857422  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16103839874267578  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 706, 128])
m.shape torch.Size([687, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.162994384765625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.162994384765625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1636495590209961  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.18723583221435547  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([633, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1894545555114746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1894545555114746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19005823135375977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21689748764038086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([635, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21871519088745117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21871519088745117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.21932077407836914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2512669563293457  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([570, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25313854217529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25313854217529297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25368213653564453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2859482765197754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([592, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2886977195739746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2886977195739746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.2892622947692871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.3262495994567871  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([11793, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.38260793685913086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.38260793685913086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 11793, 128]), torch.Size([1, 11793, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.39432668685913086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2159724235534668  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 11793, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1481804847717285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1648259162902832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.181471347808838  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1646957397460938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([17454, 256])
first layer input nodes number: 51917
first layer output nodes number: 17454
edges number: 146145
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1818604469299316  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.1985058784484863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2033562660217285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2033562660217285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([238, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2400197982788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2400197982788086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.240473747253418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.244105339050293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([223, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.244307041168213  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.244307041168213  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.24473237991333  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.251112461090088  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([159, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2513585090637207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2513585090637207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.251661777496338  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.258333683013916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([150, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2587590217590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2587590217590332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.259045124053955  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2673420906066895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([114, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.267746925354004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.267746925354004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2679643630981445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.275792121887207  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([104, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2762832641601562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2762832641601562  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2764816284179688  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2850112915039062  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([92, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2855315208435059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2855315208435059  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2857069969177246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.294480800628662  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2951159477233887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.2951159477233887  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.295295238494873  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3055148124694824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3061952590942383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3061952590942383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3063650131225586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3172292709350586  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3180961608886719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3180961608886719  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3182849884033203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3316917419433594  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.332453727722168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.332453727722168  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3326082229614258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3446588516235352  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([83, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3455390930175781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3455390930175781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3456974029541016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3591537475585938  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3602633476257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3602633476257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.36043119430542  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.37587308883667  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3766236305236816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3766236305236816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.376741886138916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3884491920471191  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([58, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3892264366149902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3892264366149902  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.3893370628356934  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4010634422302246  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([57, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4018850326538086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4018850326538086  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.401993751525879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4142789840698242  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4154133796691895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4154133796691895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.415541172027588  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4308762550354004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4320011138916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4320011138916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4321231842041016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4476261138916016  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([68, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4494519233703613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4494519233703613  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4495816230773926  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.46696138381958  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([64, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4681267738342285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4681267738342285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4682488441467285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4854607582092285  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4863286018371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4863286018371582  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.4864163398742676  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.499401569366455  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5001192092895508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5001192092895508  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.500187873840332  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5108308792114258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.511681079864502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.511681079864502  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5117573738098145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5241169929504395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.524909496307373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.524909496307373  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5249781608581543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5365824699401855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([702, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5534162521362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5534162521362305  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 702, 256]), torch.Size([1, 702, 256])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.5547552108764648  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7979731559753418  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 702, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7639851570129395  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7644195556640625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7648539543151855  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7643976211547852  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([2914, 40])
input nodes number: 17454
output nodes number: 2914
edges number: 37778
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7645678520202637  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 1.7645683288574219  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.040152549743652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

pseudo mini batch 7 input nodes size: 45268
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0363163948059082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.0363163948059082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.057901859283447266  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.05792379379272461  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.033145904541015625  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034583091735839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034583091735839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034583091735839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([45268, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.034583091735839844  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([392, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1071324348449707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1071324348449707  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.10750627517700195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11049699783325195  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 392, 128])
m.shape torch.Size([500, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11078691482543945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11078691482543945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11126375198364258  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11841630935668945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([509, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11890602111816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11890602111816406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.11939144134521484  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13007068634033203  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([517, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13147592544555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13147592544555664  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.13196897506713867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14800500869750977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([556, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14908409118652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.14908409118652344  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1496143341064453  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.16955184936523438  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([524, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17078590393066406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17078590393066406  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.17128562927246094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19435691833496094  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([521, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1958460807800293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.1958460807800293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.19634294509887695  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22199344635009766  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([480, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22357606887817383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22357606887817383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.22403383255004883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25012636184692383  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([492, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25200891494750977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25200891494750977  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.25247812271118164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.28250741958618164  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([12527, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.34200620651245117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.34200620651245117  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 12527, 128]), torch.Size([1, 12527, 128])
----------------------------------------3
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 0.35395288467407227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.20216703414917  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 12527, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.133366584777832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.1504888534545898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.1667184829711914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.1494693756103516  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

torch.Size([17018, 256])
first layer input nodes number: 45268
first layer output nodes number: 17018
edges number: 148096
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.167057991027832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.1832876205444336  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.1881213188171387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.1881213188171387  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

m.shape torch.Size([189, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.231471061706543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.231471061706543  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2318315505981445  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.234715461730957  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([160, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2348427772521973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2348427772521973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2351479530334473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2397255897521973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([122, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2399249076843262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2399249076843262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2401576042175293  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.245276927947998  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([105, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2455644607543945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2455644607543945  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2457647323608398  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.251572608947754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([94, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2519245147705078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2519245147705078  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2521038055419922  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2585582733154297  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([66, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2588496208190918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2588496208190918  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2589755058288574  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2643885612487793  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([84, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2648911476135254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2648911476135254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2650513648986816  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2730622291564941  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([61, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.273451328277588  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.273451328277588  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2735676765441895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2801995277404785  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.280850887298584  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.280850887298584  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2810072898864746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2910170555114746  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2916021347045898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.2916021347045898  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.291733741760254  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3010778427124023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3016996383666992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3016996383666992  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.301823616027832  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3114938735961914  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3122162818908691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3122162818908691  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3123459815979004  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3233704566955566  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3241305351257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3241305351257324  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.324256420135498  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3358378410339355  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3366498947143555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3366498947143555  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3367738723754883  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3490476608276367  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3498940467834473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3498940467834473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3500142097473145  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3627514839172363  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.363537311553955  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.363537311553955  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3636422157287598  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3754963874816895  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.376835823059082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.376835823059082  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3769617080688477  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3920679092407227  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([77, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3935127258300781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3935127258300781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.3936595916748047  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4123115539550781  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4130234718322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4130234718322754  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4131054878234863  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.424095630645752  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4255609512329102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4255609512329102  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.425675392150879  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4418115615844727  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([68, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4432625770568848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4432625770568848  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.443392276763916  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.462587833404541  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4640288352966309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4640288352966309  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4641242027282715  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4789061546325684  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4798312187194824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4798312187194824  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4799151420593262  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4935107231140137  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4949746131896973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4949746131896973  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.4950661659240723  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.5105385780334473  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([1031, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.5352659225463867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.5352659225463867  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

 h.shape torch.Size([1, 1031, 256]), torch.Size([1, 1031, 256])
----------------------------------------3
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.5382604598999023  GigaBytes
Max Memory Allocated: 1.8660626411437988  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.909316062927246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1031, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.8685030937194824  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.8689355850219727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.869368076324463  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.8689136505126953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2901, 40])
input nodes number: 17018
output nodes number: 2901
edges number: 44781
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.8690605163574219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8475341796875 GB
    Memory Allocated: 1.86906099319458  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03710317611694336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 8 input nodes size: 48318
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03314399719238281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03314399719238281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05658149719238281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05660247802734375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.034995079040527344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.035765647888183594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.035765647888183594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.035765647888183594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([48318, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.035765647888183594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([941, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0789031982421875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0789031982421875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 941, 128]), torch.Size([1, 941, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07980060577392578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08697986602783203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 941, 128])
m.shape torch.Size([1213, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0879521369934082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0879521369934082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1213, 128]), torch.Size([1, 1213, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08910894393920898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1064610481262207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1213, 128])
m.shape torch.Size([1135, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1075897216796875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1075897216796875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1086721420288086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13367938995361328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([988, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13502264022827148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13502264022827148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13596487045288086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.16370153427124023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([885, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1655268669128418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1655268669128418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 885, 128]), torch.Size([1, 885, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.16637086868286133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.19675493240356445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 885, 128])
m.shape torch.Size([784, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1985759735107422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1985759735107422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1993236541748047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.23166465759277344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([659, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2334904670715332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2334904670715332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.23411893844604492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2670316696166992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([567, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.26888036727905273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.26888036727905273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2694211006164551  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3018641471862793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([440, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3034820556640625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3034820556640625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.30390167236328125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.33075714111328125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([5417, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.35637760162353516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.35637760162353516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5417, 128]), torch.Size([1, 5417, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3615436553955078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7298469543457031  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5417, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6916804313659668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7047858238220215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7172112464904785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7040085792541504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13029, 256])
first layer input nodes number: 48318
first layer output nodes number: 13029
edges number: 87132
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7175731658935547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7299985885620117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7331051826477051  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7331051826477051  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([461, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7492737770080566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7492737770080566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7501530647277832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7576889991760254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([454, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.758122444152832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.758122444152832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7589883804321289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7728743553161621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([369, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7736778259277344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7736778259277344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7743816375732422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7901411056518555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7910251617431641  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7910251617431641  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7915306091308594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8099164962768555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.810701847076416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.810701847076416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8111138343811035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8259453773498535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([192, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8276724815368652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8276724815368652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8280386924743652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8437857627868652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([159, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.844672679901123  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.844672679901123  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8449759483337402  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8601393699645996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8607873916625977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8607873916625977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8609857559204102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8722925186157227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8729720115661621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8729720115661621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8731436729431152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8841300010681152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8847169876098633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8847169876098633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8848505020141602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8943300247192383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8949398994445801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8949398994445801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8950619697570801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9045834541320801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9049839973449707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9049839973449707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9050602912902832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9115452766418457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9120197296142578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9120197296142578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9120979309082031  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9192924499511719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9197244644165039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9197244644165039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9197912216186523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9264001846313477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9266843795776367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9266843795776367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9267263412475586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9311742782592773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9315223693847656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9315223693847656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9315681457519531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9367408752441406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9370288848876953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9370288848876953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9370651245117188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9414138793945312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9416379928588867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9416379928588867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9416646957397461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9450559616088867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9452071189880371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9452071189880371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9452242851257324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9475245475769043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9476509094238281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9476509094238281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9476642608642578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9495468139648438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9497218132019043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9497218132019043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9497389793395996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9522795677185059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9524402618408203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9524402618408203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9524555206298828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9548206329345703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9549236297607422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9549236297607422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9549331665039062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9564781188964844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9566121101379395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9566121101379395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9566235542297363  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9585576057434082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([103, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9610271453857422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9610271453857422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9612236022949219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9958000183105469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 103, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9828071594238281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.983222484588623  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.983637809753418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9832015037536621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2786, 40])
input nodes number: 13029
output nodes number: 2786
edges number: 16229
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9833025932312012  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9833030700683594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0373234748840332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 9 input nodes size: 49748
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03497791290283203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03497791290283203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.058699607849121094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05872058868408203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.035262107849121094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03604602813720703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03604602813720703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03604602813720703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([49748, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03604602813720703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([1042, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08069610595703125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08069610595703125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08168983459472656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08963966369628906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([1258, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09081172943115234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09081172943115234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1258, 128]), torch.Size([1, 1258, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0920114517211914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11096477508544922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1258, 128])
m.shape torch.Size([1265, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11248588562011719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11248588562011719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1265, 128]), torch.Size([1, 1265, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1136922836303711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14023303985595703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1265, 128])
m.shape torch.Size([1124, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14177370071411133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14177370071411133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14284563064575195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17466211318969727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([1020, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17726945877075195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17726945877075195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1020, 128]), torch.Size([1, 1020, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17824220657348633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21359682083129883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1020, 128])
m.shape torch.Size([816, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21544504165649414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21544504165649414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21622323989868164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.25133371353149414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([680, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.25321435928344727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.25321435928344727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 680, 128]), torch.Size([1, 680, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2538628578186035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.28670358657836914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 680, 128])
m.shape torch.Size([592, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.288637638092041  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.288637638092041  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2892022132873535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.32303857803344727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([516, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.32497072219848633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.32497072219848633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.32546281814575195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3583664894104004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([5366, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.38370752334594727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.38370752334594727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5366, 128]), torch.Size([1, 5366, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3888249397277832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7547364234924316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5366, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7154707908630371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7285161018371582  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7415614128112793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7284140586853027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13679, 256])
first layer input nodes number: 49748
first layer output nodes number: 13679
edges number: 89645
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7419342994689941  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7549796104431152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7582411766052246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7582411766052246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([508, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7736968994140625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7736968994140625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7746658325195312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7844219207763672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([441, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.784785270690918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.784785270690918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7856264114379883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7984294891357422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([352, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7995009422302246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7995009422302246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8001723289489746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.816617488861084  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([328, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8175430297851562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8175430297851562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8181686401367188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8368492126464844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([249, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.837733268737793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.837733268737793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8382081985473633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8553056716918945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([189, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8569297790527344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8569297790527344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8572902679443359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8727912902832031  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8734121322631836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8734121322631836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8736391067504883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8849878311157227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8856897354125977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8856897354125977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8858919143676758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8974161148071289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8980417251586914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8980417251586914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8982019424438477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9084558486938477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([57, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9089236259460449  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9089236259460449  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9090323448181152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9167513847351074  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9172153472900391  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9172153472900391  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9173088073730469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9245986938476562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([33, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9249329566955566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9249329566955566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9249958992004395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9303460121154785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9305520057678223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9305520057678223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9305882453918457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.933922290802002  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9341869354248047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9341869354248047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9342269897460938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9381923675537109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9384899139404297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9384899139404297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9385318756103516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9429798126220703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9431896209716797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9431896209716797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9432182312011719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9464511871337891  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9467639923095703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9467639923095703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9468021392822266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9513797760009766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.951568603515625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.951568603515625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9515914916992188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.954498291015625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9546151161193848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9546151161193848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9546284675598145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9564175605773926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9566802978515625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9566802978515625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9567070007324219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9604721069335938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.960721492767334  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.960721492767334  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9607462882995605  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9644160270690918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([1, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9644250869750977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9644250869750977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9644269943237305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9647226333618164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9648103713989258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9648103713989258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.964818000793457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9660539627075195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9661197662353516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9661197662353516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.96612548828125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9670925140380859  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([113, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9698052406311035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9698052406311035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9700207710266113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0079541206359863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 113, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.995697021484375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9961113929748535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.996525764465332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9960904121398926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2779, 40])
input nodes number: 13679
output nodes number: 2779
edges number: 15443
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9962124824523926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9962129592895508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03765296936035156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 10 input nodes size: 48653
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03526115417480469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03526115417480469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05869865417480469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05872011184692383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03497743606567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03574991226196289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03574991226196289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03574991226196289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([48653, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03574991226196289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([1036, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07909488677978516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07909488677978516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08008289337158203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08798694610595703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([1250, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08876848220825195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08876848220825195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1250, 128]), torch.Size([1, 1250, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08996057510375977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10784196853637695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1250, 128])
m.shape torch.Size([1214, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10942792892456055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10942792892456055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1214, 128]), torch.Size([1, 1214, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11058568954467773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13619756698608398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1214, 128])
m.shape torch.Size([1070, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1380753517150879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1380753517150879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13909578323364258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.16868829727172852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([988, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1705336570739746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1705336570739746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17147588729858398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20622014999389648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([789, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2080063819885254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2080063819885254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20875883102416992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24119329452514648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([674, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24306678771972656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24306678771972656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24370956420898438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27614593505859375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([646, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2782888412475586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2782888412475586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27890491485595703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3152799606323242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([511, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31716489791870117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31716489791870117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31765222549438477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.34884119033813477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([5182, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.37398815155029297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.37398815155029297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5182, 128]), torch.Size([1, 5182, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.37893009185791016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7298078536987305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5182, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6917581558227539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7044992446899414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7172403335571289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.704399585723877  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13360, 256])
first layer input nodes number: 48653
first layer output nodes number: 13360
edges number: 87437
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7176051139831543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7303462028503418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7336230278015137  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7336230278015137  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([535, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7497239112854004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7497239112854004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7507443428039551  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7593669891357422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([470, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7597603797912598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7597603797912598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7606568336486816  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.774355411529541  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([366, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7750134468078613  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7750134468078613  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7757115364074707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7941346168518066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7948160171508789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7948160171508789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7953100204467773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.811650276184082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([225, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8124847412109375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8124847412109375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8129138946533203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8283634185791016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([164, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8290948867797852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8290948867797852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8294076919555664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8428583145141602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8436374664306641  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8436374664306641  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.843902587890625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8571586608886719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.857933521270752  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.857933521270752  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8581585884094238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8709874153137207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8715152740478516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8715152740478516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8716564178466797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8806896209716797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8813400268554688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8813400268554688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8814830780029297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8916397094726562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([43, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8920230865478516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8920230865478516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8921051025390625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8985023498535156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8990497589111328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8990497589111328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8991470336914062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9074153900146484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([29, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9077291488647461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9077291488647461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9077844619750977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9128732681274414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9133167266845703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9133167266845703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9133834838867188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9199924468994141  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9204206466674805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9204206466674805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9204816818237305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9269514083862305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9272284507751465  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9272284507751465  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9272665977478027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.931577205657959  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9318690299987793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9318690299987793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9319052696228027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9362540245056152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9364089965820312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9364089965820312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9364280700683594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9388504028320312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.939023494720459  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.939023494720459  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9390425682067871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9415984153747559  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.941800594329834  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.941800594329834  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9418215751647949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9447798728942871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9448904991149902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9448904991149902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9449019432067871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9465956687927246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9466538429260254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9466538429260254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9466595649719238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9475464820861816  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9477429389953613  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9477429389953613  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9477601051330566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9505410194396973  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9507403373718262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9507403373718262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9507575035095215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9536585807800293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([110, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9562931060791016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9562931060791016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9565029144287109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9934291839599609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 110, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9806032180786133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9810237884521484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9814443588256836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9810023307800293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2822, 40])
input nodes number: 13360
output nodes number: 2822
edges number: 16081
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9811296463012695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9811301231384277  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.037343502044677734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 11 input nodes size: 50591
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03498363494873047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03498363494873047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.059107303619384766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0591282844543457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03566932678222656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03645896911621094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03645896911621094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03645896911621094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([50591, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03645896911621094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([1013, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08130025863647461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08130025863647461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08226633071899414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08999490737915039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([1171, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09077882766723633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09077882766723633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1171, 128]), torch.Size([1, 1171, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09189558029174805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10864686965942383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1171, 128])
m.shape torch.Size([1196, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10985851287841797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10985851287841797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1196, 128]), torch.Size([1, 1196, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11099910736083984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13686084747314453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1196, 128])
m.shape torch.Size([1053, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13829898834228516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13829898834228516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13930320739746094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1684255599975586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([961, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17021465301513672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17021465301513672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17113113403320312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2051081657409668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([755, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20680999755859375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20680999755859375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 755, 128]), torch.Size([1, 755, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20753002166748047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.23994922637939453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 755, 128])
m.shape torch.Size([657, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24178218841552734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24178218841552734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 657, 128]), torch.Size([1, 657, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24240875244140625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2753167152404785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 657, 128])
m.shape torch.Size([570, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2771778106689453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2771778106689453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2777214050292969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3098468780517578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([509, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31259632110595703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31259632110595703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3130817413330078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3441486358642578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([5631, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3712496757507324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3712496757507324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5631, 128]), torch.Size([1, 5631, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.376619815826416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7613358497619629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5631, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7216653823852539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7345552444458008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7474451065063477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7344541549682617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13516, 256])
first layer input nodes number: 50591
first layer output nodes number: 13516
edges number: 90540
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7478241920471191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.760714054107666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7639365196228027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7639365196228027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([581, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7793292999267578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7793292999267578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7804374694824219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7895622253417969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([440, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7898540496826172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7898540496826172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7906932830810547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.803680419921875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([394, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8049435615539551  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8049435615539551  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8056950569152832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.822227954864502  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8231363296508789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8231363296508789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8236455917358398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8397989273071289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([214, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8405728340148926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8405728340148926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8409810066223145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.855675220489502  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([164, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.856417179107666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.856417179107666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8567299842834473  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.870180606842041  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([110, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8707647323608398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8707647323608398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8709745407104492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.881464958190918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8821754455566406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8821754455566406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8823776245117188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8939018249511719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8945879936218262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8945879936218262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8947615623474121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9058699607849121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9063887596130371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9063887596130371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9065089225769043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9150404930114746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([48, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9154882431030273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9154882431030273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9155797958374023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9227209091186523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([34, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.923067569732666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.923067569732666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9231324195861816  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9286446571350098  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.929112434387207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.929112434387207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9291887283325195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9362077713012695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([19, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9364256858825684  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9364256858825684  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9364619255065918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9400496482849121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9404354095458984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9404354095458984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9404888153076172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9461498260498047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9463539123535156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9463539123535156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9463825225830078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.949615478515625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9497647285461426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9497647285461426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9497838020324707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9520726203918457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9521670341491699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9521670341491699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9521784782409668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9536318778991699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9537906646728516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9537906646728516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9538078308105469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9561080932617188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9562344551086426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9562344551086426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9562478065490723  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9581303596496582  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.958345890045166  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.958345890045166  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.958366870880127  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9614720344543457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9615674018859863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9615674018859863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9615769386291504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9630551338195801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9631834030151367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9631834030151367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9631948471069336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9650487899780273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.965181827545166  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.965181827545166  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9651932716369629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9671273231506348  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([115, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9698848724365234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9698848724365234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9701042175292969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0087089538574219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 115, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9969239234924316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9973397254943848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9977555274963379  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9973187446594238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2789, 40])
input nodes number: 13516
output nodes number: 2789
edges number: 15301
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9974360466003418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9974365234375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0380702018737793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 12 input nodes size: 49429
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03566455841064453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03566455841064453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0592341423034668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05925559997558594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0351109504699707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03601503372192383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03601503372192383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03601503372192383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([49429, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03601503372192383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([854, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08485937118530273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08485937118530273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08567380905151367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09238147735595703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([1086, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09300994873046875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09300994873046875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09404563903808594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10958099365234375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([1108, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11064815521240234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11064815521240234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11170482635498047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13495159149169922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1047, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13642024993896484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13642024993896484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1374187469482422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.16637516021728516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([919, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.16806697845458984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.16806697845458984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1689434051513672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2008652687072754  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([793, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20338153839111328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20338153839111328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20413780212402344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.23709964752197266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([711, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.23909473419189453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.23909473419189453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 711, 128]), torch.Size([1, 711, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.23977279663085938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27631139755249023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 711, 128])
m.shape torch.Size([623, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2783489227294922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2783489227294922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2789430618286133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31375885009765625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([540, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3157792091369629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3157792091369629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31629419326782227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3504185676574707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([6420, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.381411075592041  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.381411075592041  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6420, 128]), torch.Size([1, 6420, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.38753366470336914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.822237491607666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6420, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7795882225036621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7930359840393066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8064837455749512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7929306030273438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([14101, 256])
first layer input nodes number: 49429
first layer output nodes number: 14101
edges number: 98912
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.806854248046875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8203020095825195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8245267868041992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8245267868041992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([438, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8465895652770996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8465895652770996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8474249839782715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8553910255432129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([363, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8556714057922363  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8556714057922363  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8563637733459473  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8669095039367676  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([325, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8675007820129395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8675007820129395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8681206703186035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8817582130432129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([244, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8823866844177246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8823866844177246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8828520774841309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8963484764099121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([173, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8969473838806152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8969473838806152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8972773551940918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.909156322479248  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([135, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9097700119018555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9097700119018555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9100275039672852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9210996627807617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9218659400939941  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9218659400939941  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9221196174621582  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9348034858703613  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9354844093322754  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9354844093322754  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9356846809387207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9471001625061035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9477095603942871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9477095603942871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9478659629821777  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9578757286071777  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9585857391357422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9585857391357422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9587421417236328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9698467254638672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9704346656799316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9704346656799316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9705548286437988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9799275398254395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9804673194885254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9804673194885254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9805665016174316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9889969825744629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9895224571228027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9895224571228027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9896101951599121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9976820945739746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9982171058654785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9982171058654785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9982991218566895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0064187049865723  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.006998062133789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.006998062133789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.007080078125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0157737731933594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0161328315734863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0161328315734863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0161824226379395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0217862129211426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.022268295288086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.022268295288086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0223274230957031  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0294227600097656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0300335884094238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0300335884094238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.030104160308838  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0390667915344238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.039433479309082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.039433479309082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.039475440979004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0450983047485352  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0455965995788574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0455965995788574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0456480979919434  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0529093742370605  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0533480644226074  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0533480644226074  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.053391933441162  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0598845481872559  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0602645874023438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0602645874023438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0603008270263672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.06591796875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.066408634185791  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.066408634185791  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0664525032043457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.073559284210205  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0739526748657227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0739526748657227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0739870071411133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.079789161682129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([267, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0871081352233887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0871081352233887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0876173973083496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1820111274719238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 267, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.16302490234375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1634454727172852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1638660430908203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.163424015045166  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2820, 40])
input nodes number: 14101
output nodes number: 2820
edges number: 22385
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.16355562210083  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1635560989379883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03780841827392578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 13 input nodes size: 50811
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.035115718841552734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.035115718841552734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05934429168701172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05936622619628906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.035775184631347656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03658008575439453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03658008575439453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03658008575439453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([50811, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03658008575439453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([1074, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08221817016601562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08221817016601562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08324241638183594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09235286712646484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1283, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0930643081665039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0930643081665039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1283, 128]), torch.Size([1, 1283, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09428787231445312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1126413345336914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1283, 128])
m.shape torch.Size([1271, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11395978927612305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11395978927612305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1271, 128]), torch.Size([1, 1271, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11517190933227539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14183855056762695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1271, 128])
m.shape torch.Size([1171, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14346599578857422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14346599578857422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1171, 128]), torch.Size([1, 1171, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14458274841308594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17788028717041016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1171, 128])
m.shape torch.Size([1016, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.18010663986206055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.18010663986206055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1810755729675293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2163081169128418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([797, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21810388565063477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21810388565063477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21886396408081055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.25154733657836914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([661, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2533736228942871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2533736228942871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.25400400161743164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2869844436645508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([557, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.28879404067993164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.28879404067993164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2893252372741699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3202657699584961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([486, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3220858573913574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3220858573913574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.32254934310913086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.35221242904663086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([5663, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.37932443618774414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.37932443618774414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5663, 128]), torch.Size([1, 5663, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.38472509384155273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7780790328979492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5663, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7372374534606934  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7505688667297363  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7639002799987793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7504644393920898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13979, 256])
first layer input nodes number: 50811
first layer output nodes number: 13979
edges number: 92086
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7642807960510254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7776122093200684  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7809453010559082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7809453010559082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([570, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7968716621398926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7968716621398926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7979588508605957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8066563606262207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([486, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8070473670959473  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8070473670959473  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8079743385314941  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8231892585754395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([375, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8238892555236816  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8238892555236816  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8246045112609863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8410816192626953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([295, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8418583869934082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8418583869934082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8424210548400879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8601384162902832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([241, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8610153198242188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8610153198242188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8614749908447266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8780231475830078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([183, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.878849983215332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.878849983215332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8791990280151367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8942079544067383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8948879241943359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8948879241943359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8951301574707031  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9072418212890625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([92, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9078283309936523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9078283309936523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9080038070678711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9180059432983398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9185757637023926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9185757637023926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9187207221984863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9279980659484863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([54, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9284448623657227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9284448623657227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9285478591918945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9358606338500977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9363589286804199  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9363589286804199  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9364581108093262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9441943168640137  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9446754455566406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9446754455566406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.94476318359375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9522209167480469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9525647163391113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9525647163391113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9526238441467285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9580636024475098  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9584646224975586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9584646224975586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9585256576538086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9645681381225586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9648551940917969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9648551940917969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9648971557617188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9693450927734375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9695701599121094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9695701599121094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9696006774902344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9730491638183594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9733281135559082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9733281135559082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9733624458312988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9774823188781738  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9777073860168457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9777073860168457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9777340888977051  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9811253547668457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9814043045043945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9814043045043945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9814348220825195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9855241775512695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9857206344604492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9857206344604492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9857416152954102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9886999130249023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9888510704040527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9888510704040527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9888663291931152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9911246299743652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9912862777709961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9912862777709961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9913015365600586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9936666488647461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9938139915466309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9938139915466309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9938273429870605  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9959902763366699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9960989952087402  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9960989952087402  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9961085319519043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9977202415466309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([104, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0002145767211914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0002145767211914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.000412940979004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.035325050354004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 104, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.022775650024414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0232062339782715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.023636817932129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0231842994689941  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2889, 40])
input nodes number: 13979
output nodes number: 2889
edges number: 15867
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0233206748962402  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0233211517333984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.038238525390625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 14 input nodes size: 49402
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03578519821166992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03578519821166992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0593419075012207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05936288833618164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03511238098144531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03590965270996094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03590965270996094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03590965270996094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([49402, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03590965270996094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([931, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0806417465209961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0806417465209961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08152961730957031  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08890724182128906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([1185, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08959341049194336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08959341049194336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1185, 128]), torch.Size([1, 1185, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09072351455688477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10767507553100586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1185, 128])
m.shape torch.Size([1189, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1088109016418457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1088109016418457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1189, 128]), torch.Size([1, 1189, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10994482040405273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1362323760986328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1189, 128])
m.shape torch.Size([1065, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1376967430114746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1376967430114746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13871240615844727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1681666374206543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([954, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.16993331909179688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.16993331909179688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 954, 128]), torch.Size([1, 954, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17084312438964844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2047433853149414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 954, 128])
m.shape torch.Size([760, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20646286010742188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20646286010742188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 760, 128]), torch.Size([1, 760, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20718765258789062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.23961544036865234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 760, 128])
m.shape torch.Size([605, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2412724494934082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2412724494934082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24184942245483398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2710566520690918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([565, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27292346954345703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27292346954345703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27346229553222656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.30599498748779297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([461, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.30770397186279297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.30770397186279297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.30814361572265625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.33628082275390625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([5704, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3634047508239746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3634047508239746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5704, 128]), torch.Size([1, 5704, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3693990707397461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7649412155151367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5704, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.724764347076416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7375617027282715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.750359058380127  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7374615669250488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13419, 256])
first layer input nodes number: 49402
first layer output nodes number: 13419
edges number: 90402
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7507290840148926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.763526439666748  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7667384147644043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7667384147644043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([499, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7832136154174805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7832136154174805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 499, 256]), torch.Size([1, 499, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7841653823852539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7924785614013672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 499, 256])
m.shape torch.Size([451, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.792870044708252  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.792870044708252  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7937302589416504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8072600364685059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([366, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8078856468200684  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8078856468200684  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8085837364196777  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.824216365814209  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([284, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8249592781066895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8249592781066895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8255009651184082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8416523933410645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([209, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8423914909362793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8423914909362793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8427901268005371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8571410179138184  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([184, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8580183982849121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8580183982849121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8583693504333496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8734602928161621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([103, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8739781379699707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8739781379699707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8741745948791504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8839974403381348  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8846454620361328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8846454620361328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8848304748535156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8953762054443359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8959412574768066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8959412574768066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8960862159729004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9053635597229004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9059257507324219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9059257507324219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9060516357421875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9149894714355469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9156246185302734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9156246185302734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9157505035400391  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9255695343017578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9260029792785645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9260029792785645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9260849952697754  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9330563545227051  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9335155487060547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9335155487060547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9335918426513672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9406108856201172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9410305023193359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9410305023193359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9410953521728516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9475154876708984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9478726387023926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9478726387023926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9479241371154785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9533829689025879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9535574913024902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9535574913024902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9535822868347168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9563841819763184  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9566497802734375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9566497802734375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9566822052001953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9605731964111328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9607648849487305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9607648849487305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9607877731323242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9636945724487305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9638476371765137  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9638476371765137  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.963864803314209  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9661650657653809  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.966425895690918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.966425895690918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9664525985717773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9702177047729492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9705276489257812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9705276489257812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9705581665039062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9750747680664062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9752287864685059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9752287864685059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9752440452575684  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9776091575622559  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9778447151184082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9778447151184082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9778656959533691  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.981264591217041  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9815082550048828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9815082550048828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9815292358398438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9850749969482422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([122, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9879961013793945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9879961013793945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9882287979125977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0291833877563477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 122, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0158963203430176  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.016310691833496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0167250633239746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0162897109985352  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2778, 40])
input nodes number: 13419
output nodes number: 2778
edges number: 16511
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0163946151733398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.016395092010498  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03751373291015625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 15 input nodes size: 48410
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.035096168518066406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.035096168518066406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.058533668518066406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05855512619018555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03497743606567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03572797775268555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03572797775268555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03572797775268555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([48410, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03572797775268555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([1008, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07835531234741211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07835531234741211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07931661605834961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08700704574584961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([1273, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08774042129516602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08774042129516602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1273, 128]), torch.Size([1, 1273, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08895444869995117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10716485977172852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1273, 128])
m.shape torch.Size([1185, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10856437683105469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10856437683105469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1185, 128]), torch.Size([1, 1185, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1096944808959961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1348552703857422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1185, 128])
m.shape torch.Size([1108, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13696813583374023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13696813583374023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13802480697631836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.16866827011108398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1011, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17055034637451172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17055034637451172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1011, 128]), torch.Size([1, 1011, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17151451110839844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20652198791503906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1011, 128])
m.shape torch.Size([790, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20830011367797852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20830011367797852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20905351638793945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24144983291625977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([654, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2432560920715332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2432560920715332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2438797950744629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27661657333374023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([572, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2784867286682129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2784867286682129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27903223037719727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31153392791748047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([476, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31330394744873047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31330394744873047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.31375789642333984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.34281063079833984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([5044, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3666353225708008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3666353225708008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5044, 128]), torch.Size([1, 5044, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3714456558227539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7164583206176758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5044, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6787538528442383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6912670135498047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7037801742553711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6911687850952148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13121, 256])
first layer input nodes number: 48410
first layer output nodes number: 13121
edges number: 85214
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7041430473327637  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7166562080383301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7197847366333008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7197847366333008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([506, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7352309226989746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7352309226989746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7361960411071777  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7444205284118652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([491, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7448821067810059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7448821067810059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7458186149597168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7615237236022949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([357, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7623124122619629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7623124122619629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.762993335723877  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7801308631896973  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([260, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7811317443847656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7811317443847656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7816276550292969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7964315414428711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([258, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7974238395690918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7974238395690918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7979159355163574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8167252540588379  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([189, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8175692558288574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8175692558288574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.817929744720459  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8334307670593262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8342466354370117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8342466354370117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.834528923034668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8486433029174805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8493404388427734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8493404388427734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.84954833984375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8613986968994141  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8620476722717285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8620476722717285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8622136116027832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8728337287902832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([58, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8733086585998535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8733086585998535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8734192848205566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8812737464904785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([40, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8816413879394531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8816413879394531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8817176818847656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8876686096191406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8881959915161133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8881959915161133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8882894515991211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8962335586547852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8966870307922363  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8966870307922363  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8967633247375488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9037823677062988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([26, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9040942192077637  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9040942192077637  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9041438102722168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9090533256530762  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9093890190124512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9093890190124512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9094367027282715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9144911766052246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.914759635925293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.914759635925293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9147958755493164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9188909530639648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9192161560058594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9192161560058594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9192562103271484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9240627288818359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9242157936096191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9242157936096191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9242348670959473  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9266571998596191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9268302917480469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9268302917480469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.926849365234375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9294052124023438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9294919967651367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9294919967651367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9295015335083008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9308462142944336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9310836791992188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9310836791992188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9311065673828125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9344940185546875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9345884323120117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9345884323120117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9345979690551758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9360761642456055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9362263679504395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9362263679504395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9362397193908691  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9384026527404785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9385113716125488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9385113716125488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9385209083557129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9401326179504395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([83, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9421224594116211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9421224594116211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9422807693481445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9701433181762695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 83, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9579629898071289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9583835601806641  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9588041305541992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9583621025085449  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2820, 40])
input nodes number: 13121
output nodes number: 2820
edges number: 15430
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9584879875183105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9584884643554688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03728818893432617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 16 input nodes size: 36960
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03498363494873047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03498363494873047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05260753631591797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.05262899398803711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.02917003631591797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.029999732971191406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.029999732971191406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.029999732971191406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([36960, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.029999732971191406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([557, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07035160064697266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07035160064697266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07088279724121094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07597732543945312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([732, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07640981674194336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07640981674194336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07710790634155273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08757925033569336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 732, 128])
m.shape torch.Size([735, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08844709396362305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08844709396362305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 735, 128]), torch.Size([1, 735, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08914804458618164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1050724983215332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 735, 128])
m.shape torch.Size([737, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10612773895263672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10612773895263672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 737, 128]), torch.Size([1, 737, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10683059692382812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.12769031524658203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 737, 128])
m.shape torch.Size([663, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1289196014404297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1289196014404297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.12955188751220703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1530909538269043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([627, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.15456867218017578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.15456867218017578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1551666259765625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.18184852600097656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([540, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.18335199356079102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.18335199356079102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1838669776916504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21068620681762695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([532, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21245813369750977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21245813369750977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2129654884338379  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24343347549438477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([460, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24515390396118164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24515390396118164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24559259414672852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2736687660217285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([5449, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.29943227767944336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.29943227767944336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5449, 128]), torch.Size([1, 5449, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.304628849029541  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6758813858032227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5449, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6392674446105957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6497883796691895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6603093147277832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6497058868408203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([11032, 256])
first layer input nodes number: 36960
first layer output nodes number: 11032
edges number: 80917
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6605868339538574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6711077690124512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6737380027770996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6737380027770996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([250, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7036266326904297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7036266326904297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7041034698486328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7079181671142578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([243, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7081470489501953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7081470489501953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7086105346679688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7155628204345703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([183, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7158589363098145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7158589363098145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7162079811096191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7238869667053223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([153, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7243008613586426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7243008613586426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7245926856994629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.733055591583252  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([158, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7336692810058594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7336692810058594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7339706420898438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7448196411132812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7455801963806152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7455801963806152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7458815574645996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7588400840759277  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7596044540405273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7596044540405273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7598638534545898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7728338241577148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([141, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7739601135253906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7739601135253906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7742290496826172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7895584106445312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([140, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7907590866088867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7907590866088867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7910261154174805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8081159591674805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8088765144348145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8088765144348145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.809053897857666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.821648120880127  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8228940963745117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8228940963745117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8230962753295898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8388662338256836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([97, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8400998115539551  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8400998115539551  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8402848243713379  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.856010913848877  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([81, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8572521209716797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8572521209716797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8574066162109375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8716201782226562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8724446296691895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8724446296691895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8725724220275879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8852238655090332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8858089447021484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8858089447021484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.885894775390625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8949928283691406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8956727981567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8956727981567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8957624435424805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9058923721313477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9067301750183105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9067301750183105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9068331718444824  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9191927909851074  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9199199676513672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9199199676513672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9200057983398438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9309062957763672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9314661026000977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9314661026000977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9315290451049805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9399633407592773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9405856132507324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9405856132507324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.940650463104248  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9497942924499512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9506502151489258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9506502151489258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9507341384887695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9631547927856445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([43, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.964022159576416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.964022159576416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.964104175567627  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9768166542053223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9774832725524902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9774832725524902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9775443077087402  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9874320030212402  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.987978458404541  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.987978458404541  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9880261421203613  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9960846900939941  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([415, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.006032943725586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.006032943725586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0068244934082031  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1476612091064453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 415, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.120589256286621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1210103034973145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1214313507080078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1209888458251953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2823, 40])
input nodes number: 11032
output nodes number: 2823
edges number: 30269
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1210932731628418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.12109375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03161191940307617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 17 input nodes size: 40725
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.029170513153076172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.029170513153076172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.04870176315307617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.04872322082519531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.031077861785888672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.031941890716552734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.031941890716552734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.031941890716552734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([40725, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.031941890716552734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([689, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0749502182006836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0749502182006836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.0756072998046875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08095073699951172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([855, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08143758773803711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08143758773803711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08225297927856445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09542036056518555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([881, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09627294540405273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09627294540405273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 881, 128]), torch.Size([1, 881, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.09711313247680664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11602306365966797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 881, 128])
m.shape torch.Size([864, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11725091934204102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11725091934204102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.11807489395141602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14220666885375977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([814, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14373540878295898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14373540878295898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.14451169967651367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17348527908325195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([698, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1750941276550293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1750941276550293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 698, 128]), torch.Size([1, 698, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.17575979232788086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20501089096069336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 698, 128])
m.shape torch.Size([612, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20672082901000977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.20672082901000977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2073044776916504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.23670625686645508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([577, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2386155128479004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2386155128479004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2391657829284668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27240419387817383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([452, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27406883239746094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27406883239746094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27449989318847656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.30208778381347656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([5745, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3292665481567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3292665481567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5745, 128]), torch.Size([1, 5745, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3347454071044922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.733130931854248  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5745, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6940689086914062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7065486907958984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7183637619018555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7057929039001465  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([12187, 256])
first layer input nodes number: 40725
first layer output nodes number: 12187
edges number: 87174
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7178120613098145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7302918434143066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7325291633605957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7325291633605957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([324, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7605242729187012  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7605242729187012  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7611422538757324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7670774459838867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([249, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.767247200012207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.767247200012207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7677221298217773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.774846076965332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([209, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7752113342285156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7752113342285156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7756099700927734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7843799591064453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([186, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7848958969116211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7848958969116211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7852506637573242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7955389022827148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.796231746673584  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.796231746673584  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.796576976776123  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8090052604675293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8097615242004395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8097615242004395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8100686073303223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8232731819152832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8240146636962891  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8240146636962891  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8242683410644531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8369522094726562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([146, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8383126258850098  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8383126258850098  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8385910987854004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.854464054107666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.855224609375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.855224609375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8554229736328125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8681182861328125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([126, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8692302703857422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8692302703857422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8694705963134766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8865337371826172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.887291431427002  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.887291431427002  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8874497413635254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8997979164123535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([80, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9006414413452148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9006414413452148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9007940292358398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9137639999389648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([78, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9146623611450195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9146623611450195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9148111343383789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9284982681274414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9292988777160645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9292988777160645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9294228553771973  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9416966438293457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9425430297851562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9425430297851562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9426631927490234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9554004669189453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9561095237731934  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9561095237731934  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.956204891204834  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9669814109802246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9676856994628906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9676856994628906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9677734375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.978302001953125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9789848327636719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9789848327636719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.97906494140625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9892387390136719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9899840354919434  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9899840354919434  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9900660514831543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.00105619430542  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.001688003540039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.001688003540039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0017547607421875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0111675262451172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0117197036743164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0117197036743164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.011775016784668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0199613571166992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0204625129699707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0204625129699707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.020510196685791  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0279011726379395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0282092094421387  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0282092094421387  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0282378196716309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0328726768493652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0335044860839844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0335044860839844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0335578918457031  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0425834655761719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([379, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.051663875579834  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.051663875579834  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.05238676071167  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.180406093597412  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 379, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1553754806518555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1558046340942383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.156233787536621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1557831764221191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2880, 40])
input nodes number: 12187
output nodes number: 2880
edges number: 28607
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1559038162231445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1559042930603027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.03363752365112305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 18 input nodes size: 35144
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.031085968017578125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.031085968017578125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.04784393310546875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.04786539077758789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.02831268310546875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.029188156127929688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.029188156127929688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.029188156127929688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([35144, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.029188156127929688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([530, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07152462005615234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07152462005615234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07203006744384766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07682514190673828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([706, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07724571228027344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07724571228027344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 706, 128]), torch.Size([1, 706, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.07791900634765625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08801841735839844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 706, 128])
m.shape torch.Size([820, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08885478973388672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08885478973388672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.08963680267333984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10761165618896484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([718, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10867595672607422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.10867595672607422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 718, 128]), torch.Size([1, 718, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1093606948852539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1295919418334961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 718, 128])
m.shape torch.Size([738, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13100910186767578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.13100910186767578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.1317129135131836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.15784263610839844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([600, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.15920734405517578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.15920734405517578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.15977954864501953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.18507099151611328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([582, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.18672752380371094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.18672752380371094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.18728256225585938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21692562103271484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([512, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21860122680664062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21860122680664062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.21908950805664062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24692153930664062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([472, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2487030029296875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.2487030029296875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.24915313720703125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.27796173095703125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([5780, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3052978515625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3052978515625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5780, 128]), torch.Size([1, 5780, 128])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.3108100891113281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7128524780273438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5780, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6743230819702148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6852502822875977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6961774826049805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.6851644515991211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([11458, 256])
first layer input nodes number: 35144
first layer output nodes number: 11458
edges number: 84782
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.696441650390625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7073688507080078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7104120254516602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7104120254516602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([243, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7422642707824707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7422642707824707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7427277565002441  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7464356422424316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([206, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7466001510620117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7466001510620117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7469930648803711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7528867721557617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([174, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7531924247741699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7531924247741699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7535243034362793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7608256340026855  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([120, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7611212730407715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7611212730407715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.761350154876709  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7679877281188965  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([152, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7686038017272949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7686038017272949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7688937187194824  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7793307304382324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([136, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7799701690673828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7799701690673828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7802295684814453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7913837432861328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7921490669250488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7921490669250488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.7924027442932129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.805086612701416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8059134483337402  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8059134483337402  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.806149959564209  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8196310997009277  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([125, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8212571144104004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8212571144104004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.821495532989502  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.836754322052002  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([122, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8378081321716309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8378081321716309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.838040828704834  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8545622825622559  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8558521270751953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8558521270751953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8561058044433594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8758926391601562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([99, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8770270347595215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8770270347595215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8772158622741699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8932662010192871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([78, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8941464424133301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8941464424133301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.8942952156066895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.907982349395752  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9091463088989258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9091463088989258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9093217849731445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9266939163208008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.928034782409668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.928034782409668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9281949996948242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9451780319213867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9461708068847656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9461708068847656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9463024139404297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9611740112304688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9622030258178711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9622030258178711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9623308181762695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.977665901184082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.978449821472168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.978449821472168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9785432815551758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.990412712097168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9911880493164062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9911880493164062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.9912738800048828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0027751922607422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0036358833312988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0036358833312988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.003725528717041  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0163655281066895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0171079635620117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0171079635620117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0171823501586914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0281915664672852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0287466049194336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0287466049194336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0288000106811523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0370779037475586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0378031730651855  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0378031730651855  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0378680229187012  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0483736991882324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0491719245910645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0491719245910645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0492405891418457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.060844898223877  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([433, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0712151527404785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0712151527404785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.0720410346984863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8963623046875 GB
    Memory Allocated: 1.2214064598083496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 433, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8963623046875 GB
    Memory Allocated: 1.1924071311950684  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8963623046875 GB
    Memory Allocated: 1.1928348541259766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8963623046875 GB
    Memory Allocated: 1.1932625770568848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8963623046875 GB
    Memory Allocated: 1.1928133964538574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2868, 40])
input nodes number: 11458
output nodes number: 2868
edges number: 32540
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8963623046875 GB
    Memory Allocated: 1.1929192543029785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8963623046875 GB
    Memory Allocated: 1.1929197311401367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.030857563018798828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 19 input nodes size: 39795
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.02831125259399414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.02831125259399414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.04784250259399414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.04786396026611328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.031084537506103516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03198575973510742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03198575973510742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03198575973510742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([39795, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03198575973510742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([637, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07639265060424805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07639265060424805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07700014114379883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08186006546020508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([860, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08237648010253906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08237648010253906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08319664001464844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09549903869628906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([857, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09660148620605469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09660148620605469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09741878509521484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11566448211669922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([789, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1167607307434082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1167607307434082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11751317977905273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1399998664855957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([792, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1415119171142578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1415119171142578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.14226722717285156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1702423095703125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([709, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17189311981201172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17189311981201172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17256927490234375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20422935485839844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([599, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20589065551757812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20589065551757812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20646190643310547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2357316017150879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([549, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23754024505615234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23754024505615234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23806381225585938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.26811695098876953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([528, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27012109756469727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27012109756469727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.30428171157836914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([5979, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3333268165588379  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3333268165588379  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5979, 128]), torch.Size([1, 5979, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.33902883529663086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7470192909240723  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5979, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7068266868591309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7185559272766113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7302851676940918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7184638977050781  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([12299, 256])
first layer input nodes number: 39795
first layer output nodes number: 12299
edges number: 89425
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.730583667755127  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7423129081726074  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7452454566955566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7452454566955566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([288, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7758574485778809  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7758574485778809  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7764067649841309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7810287475585938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([253, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7812404632568359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7812404632568359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7817230224609375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7889614105224609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([210, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7893257141113281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7893257141113281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7897262573242188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7985382080078125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([154, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7989301681518555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7989301681518555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7992238998413086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8077421188354492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([152, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8083257675170898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8083257675170898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8086156845092773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8190526962280273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([129, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8196520805358887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8196520805358887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8198981285095215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8304781913757324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.831169605255127  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.831169605255127  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8314003944396973  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8429398536682129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.843693733215332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.843693733215332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8439092636108398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8561944961547852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([122, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8572592735290527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8572592735290527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8574919700622559  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8723845481872559  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([103, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8732585906982422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8732585906982422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8734550476074219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8874034881591797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8880772590637207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8880772590637207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.888216495513916  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8990769386291504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([96, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9002962112426758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9002962112426758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9004793167114258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9160432815551758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9169392585754395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9169392585754395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9170899391174316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9309525489807129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9317116737365723  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9317116737365723  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9318299293518066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9435372352600098  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.944328784942627  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.944328784942627  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9444413185119629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9563698768615723  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9569902420043945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9569902420043945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9570741653442383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.966557502746582  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9678120613098145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9678120613098145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9679341316223145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9825825691223145  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9834213256835938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9834213256835938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9835205078125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9961166381835938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9967975616455078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9967975616455078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9968738555908203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0070972442626953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.008059024810791  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.008059024810791  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0081582069396973  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0221428871154785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0229411125183105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0229411125183105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0230212211608887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0348773002624512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0354504585266113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0354504585266113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.035505771636963  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.044079303741455  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0446929931640625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0446929931640625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.044748306274414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0537090301513672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.054142951965332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.054142951965332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0541810989379883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0606279373168945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([482, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0724072456359863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0724072456359863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 482, 256]), torch.Size([1, 482, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.073326587677002  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.2480459213256836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 482, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.2202749252319336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.2207026481628418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.22113037109375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.2206811904907227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2868, 40])
input nodes number: 12299
output nodes number: 2868
edges number: 31433
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.220794677734375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.2207951545715332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.033727169036865234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 20 input nodes size: 41150
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.031084537506103516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.031084537506103516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05070638656616211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05072784423828125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03117513656616211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03200960159301758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03200960159301758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03200960159301758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([41150, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03200960159301758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([706, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07445669174194336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07445669174194336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 706, 128]), torch.Size([1, 706, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07512998580932617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08051633834838867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 706, 128])
m.shape torch.Size([853, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0809931755065918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0809931755065918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08180665969848633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0946192741394043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([910, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09551429748535156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09551429748535156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09638214111328125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1154775619506836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([907, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11677360534667969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11677360534667969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11763858795166016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.14272308349609375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([790, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.14417409896850586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.14417409896850586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1449275016784668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17204999923706055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([751, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17382192611694336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17382192611694336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 751, 128]), torch.Size([1, 751, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17453813552856445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20657014846801758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 751, 128])
m.shape torch.Size([619, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20827817916870117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20827817916870117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20886850357055664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23929309844970703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([542, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24106550216674805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24106550216674805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24158239364624023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27231454849243164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([461, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2740345001220703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2740345001220703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2744741439819336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3026113510131836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([5511, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.32867002487182617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.32867002487182617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5511, 128]), torch.Size([1, 5511, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.333925724029541  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7081456184387207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5511, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6700139045715332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6815056800842285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6934514045715332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6818695068359375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([12050, 256])
first layer input nodes number: 41150
first layer output nodes number: 12050
edges number: 85154
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6937599182128906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7052516937255859  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7085256576538086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7085256576538086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([343, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.734677791595459  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.734677791595459  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7353320121765137  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7411055564880371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([262, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7412824630737305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7412824630737305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7417821884155273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7500872611999512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([214, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7504549026489258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7504549026489258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7508630752563477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7598428726196289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([206, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7604308128356934  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7604308128356934  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7608237266540527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7722182273864746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([167, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.772824764251709  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.772824764251709  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7731432914733887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7846102714538574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7853450775146484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7853450775146484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7856407165527344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7983531951904297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([146, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7991876602172852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7991876602172852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7994661331176758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.813389778137207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([133, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8144659996032715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8144659996032715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8147196769714355  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8291792869567871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.830268383026123  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.830268383026123  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8304991722106934  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8452696800231934  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([123, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8463711738586426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8463711738586426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8466057777404785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8632626533508301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8643617630004883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8643617630004883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.864567756652832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8806352615356445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8813977241516113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8813977241516113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8815407752990723  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.893700122833252  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([87, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8948445320129395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8948445320129395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8950104713439941  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9102768898010254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9110956192016602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9110956192016602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9112234115600586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9238748550415039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9246187210083008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9246187210083008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9247255325317383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9360475540161133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9368095397949219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9368095397949219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9369106292724609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.948333740234375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9490842819213867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9490842819213867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9491777420043945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.960392951965332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9611248970031738  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9611248970031738  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9612107276916504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9721112251281738  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9725799560546875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9725799560546875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9726333618164062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9797897338867188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.980743408203125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.980743408203125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9808406829833984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9945564270019531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9952750205993652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9952750205993652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9953474998474121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0060744285583496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0065879821777344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0065879821777344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0066375732421875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0143241882324219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0146093368530273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0146093368530273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0146360397338867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0189619064331055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0195484161376953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0195484161376953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0195980072021484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0279788970947266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([275, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.034562110900879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.034562110900879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0350866317749023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.1346540451049805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 275, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.111557960510254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.111985683441162  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.1124134063720703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.111964225769043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2868, 40])
input nodes number: 12050
output nodes number: 2868
edges number: 26734
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.1120758056640625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.1120762825012207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03365325927734375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 21 input nodes size: 45478
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03117513656616211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03117513656616211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05286073684692383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05288267135620117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03323936462402344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.034088134765625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.034088134765625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.034088134765625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([45478, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.034088134765625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([816, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07864046096801758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07864046096801758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07941865921020508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08660173416137695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([1009, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08717489242553711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08717489242553711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1009, 128]), torch.Size([1, 1009, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08813714981079102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10274267196655273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1009, 128])
m.shape torch.Size([1054, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10376930236816406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10376930236816406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10477447509765625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.12704753875732422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([965, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1283855438232422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1283855438232422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.12930583953857422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.15734481811523438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([892, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1590113639831543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1590113639831543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 892, 128]), torch.Size([1, 892, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.15986204147338867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.19062185287475586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 892, 128])
m.shape torch.Size([752, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.19234800338745117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.19234800338745117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 752, 128]), torch.Size([1, 752, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.19306516647338867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.22438383102416992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 752, 128])
m.shape torch.Size([671, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.22713804244995117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.22713804244995117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.22777795791625977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2601742744445801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([635, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.26227664947509766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.26227664947509766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2628822326660156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2996492385864258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([507, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.30152225494384766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.30152225494384766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3020057678222656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3329505920410156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([5701, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.36005258560180664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.36005258560180664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5701, 128]), torch.Size([1, 5701, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.36548948287963867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7617835998535156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5701, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7215151786804199  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.733914852142334  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.746314525604248  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7338175773620605  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13002, 256])
first layer input nodes number: 45478
first layer output nodes number: 13002
edges number: 90178
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7466554641723633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7590551376342773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7622756958007812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7622756958007812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7864241600036621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7864241600036621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.787229061126709  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7954378128051758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([335, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7956795692443848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7956795692443848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.796318531036377  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8059029579162598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([255, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8063187599182129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8063187599182129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8068051338195801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8175053596496582  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([231, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.818150520324707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.818150520324707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8185911178588867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8313684463500977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8321046829223633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8321046829223633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.832484245300293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8461484909057617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.846893310546875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.846893310546875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8472023010253906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8604888916015625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([152, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8614277839660645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8614277839660645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.861717700958252  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.876213550567627  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([132, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8770837783813477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8770837783813477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8773355484008789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8916864395141602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8924517631530762  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8924517631530762  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8926482200622559  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9052214622497559  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.906036376953125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.906036376953125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9062175750732422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9190826416015625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([85, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9198908805847168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9198908805847168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9200530052185059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9326987266540527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9333906173706055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9333906173706055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9335184097290039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9443807601928711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.945314884185791  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.945314884185791  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9454655647277832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9593281745910645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9599795341491699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9599795341491699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9600825309753418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9702792167663574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9710206985473633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9710206985473633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.971125602722168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9822454452514648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9828543663024902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9828543663024902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9829363822937012  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9922041893005371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9928007125854492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9928007125854492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9928750991821289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0018014907836914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.002387523651123  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.002387523651123  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0024561882019043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.011176586151123  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0117268562316895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0117268562316895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0117878913879395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0199666023254395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0205512046813965  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0205512046813965  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0206122398376465  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0292181968688965  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0295310020446777  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0295310020446777  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0295634269714355  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0343623161315918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.034769058227539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.034769058227539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0348072052001953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.040719985961914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.041010856628418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.041010856628418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0410375595092773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.045363426208496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0457191467285156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0457191467285156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0457496643066406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0509071350097656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([233, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0564908981323242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0564908981323242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0569353103637695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.1351518630981445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 233, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.1145291328430176  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.1149625778198242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.1153960227966309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.1149406433105469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2908, 40])
input nodes number: 13002
output nodes number: 2908
edges number: 23667
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.115065574645996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.1150660514831543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035782814025878906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 22 input nodes size: 48437
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.033245086669921875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.033245086669921875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.056682586669921875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.056704044342041016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03499650955200195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03582334518432617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03582334518432617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03582334518432617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([48437, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03582334518432617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([900, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0809321403503418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0809321403503418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08179044723510742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08865690231323242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([1097, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08989572525024414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08989572525024414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0909419059753418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10663461685180664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1158, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10811996459960938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10811996459960938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1158, 128]), torch.Size([1, 1158, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10922431945800781  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13419532775878906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1158, 128])
m.shape torch.Size([1066, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13567638397216797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13567638397216797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13669300079345703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16617488861083984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([908, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1678314208984375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1678314208984375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16869735717773438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20076560974121094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([798, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20261573791503906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20261573791503906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20337677001953125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2361621856689453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([671, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2380213737487793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2380213737487793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2386612892150879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2711830139160156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([581, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27307939529418945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27307939529418945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2736334800720215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.30747079849243164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([509, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.30937814712524414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.30937814712524414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3098635673522949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3409304618835449  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([5712, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.36803150177001953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.36803150177001953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5712, 128]), torch.Size([1, 5712, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.37347888946533203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.769524097442627  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5712, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7289752960205078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7417545318603516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7545337677001953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7416543960571289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13400, 256])
first layer input nodes number: 48437
first layer output nodes number: 13400
edges number: 91206
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7548966407775879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7676758766174316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7708706855773926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7708706855773926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([460, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7902874946594238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7902874946594238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7911648750305176  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8001313209533691  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8004136085510254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8004136085510254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8011288642883301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8123049736022949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([343, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8129415512084961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8129415512084961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8135957717895508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8291940689086914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([296, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8300051689147949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8300051689147949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8305697441101074  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8476748466491699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8483729362487793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8483729362487793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.848762035369873  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.862769603729248  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8634634017944336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8634634017944336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8637571334838867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8763875961303711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8771424293518066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8771424293518066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8773980140686035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8901772499084473  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8908953666687012  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8908953666687012  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8911051750183105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9030642509460449  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9038763046264648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9038763046264648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.904078483581543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.917017936706543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9178013801574707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9178013801574707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9179768562316895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9304356575012207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9310460090637207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9310460090637207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9311718940734863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9409909248352051  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9416317939758301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9416317939758301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9417481422424316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9516377449035645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9520044326782227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9520044326782227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9520692825317383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9580354690551758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.958460807800293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.958460807800293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9585256576538086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9649457931518555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9654326438903809  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9654326438903809  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9655013084411621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9727797508239746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9731760025024414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9731760025024414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9732294082641602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9792642593383789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9797115325927734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9797115325927734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.979766845703125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9864044189453125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9866366386413574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9866366386413574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9866652488708496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9902987480163574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9908509254455566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9908509254455566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9909100532531738  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.998833179473877  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9992265701293945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9992265701293945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9992685317993164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0051851272583008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0054669380187988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0054669380187988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.005495548248291  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0097298622131348  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.010033130645752  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.010033130645752  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0100617408752441  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0144963264465332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0146589279174805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0146589279174805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.014674186706543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.017146110534668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0174155235290527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0174155235290527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0174384117126465  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0213065147399902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([171, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0254039764404297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0254039764404297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0257301330566406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0831336975097656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 171, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0669159889221191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0673408508300781  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.067765712738037  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.067319393157959  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2851, 40])
input nodes number: 13400
output nodes number: 2851
edges number: 19607
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0674324035644531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0674328804016113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.037482261657714844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 23 input nodes size: 49995
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0349879264831543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0349879264831543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05882740020751953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05884838104248047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03538942337036133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03619718551635742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03619718551635742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03619718551635742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([49995, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03619718551635742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([1028, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08168649673461914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08168649673461914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08266687393188477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09050989151000977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([1258, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09157085418701172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09157085418701172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1258, 128]), torch.Size([1, 1258, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09277057647705078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11136531829833984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1258, 128])
m.shape torch.Size([1232, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11252784729003906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11252784729003906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1232, 128]), torch.Size([1, 1232, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11370277404785156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13995933532714844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1232, 128])
m.shape torch.Size([1122, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1416912078857422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1416912078857422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.14276123046875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17397117614746094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1024, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17587757110595703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17587757110595703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1024, 128]), torch.Size([1, 1024, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17685413360595703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.21201038360595703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1024, 128])
m.shape torch.Size([821, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.21387100219726562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.21387100219726562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.21465396881103516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24907875061035156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([717, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2510805130004883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2510805130004883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.25176429748535156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2878599166870117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([627, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.28990983963012695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.28990983963012695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.29050779342651367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.32668161392211914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([503, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.32854127883911133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.32854127883911133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.32902097702026367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.35972166061401367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([5550, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3868255615234375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3868255615234375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5550, 128]), torch.Size([1, 5550, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.39279794692993164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.769472599029541  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5550, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7293901443481445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7426290512084961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7558679580688477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.742525577545166  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13882, 256])
first layer input nodes number: 49995
first layer output nodes number: 13882
edges number: 91836
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7562427520751953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7694816589355469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7731342315673828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7731342315673828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([493, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7895975112915039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7895975112915039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7905378341674805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7993364334106445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([450, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7997317314147949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7997317314147949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8005900382995605  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8142962455749512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([338, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8148417472839355  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8148417472839355  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8154864311218262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.830024242401123  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([278, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8308305740356445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8308305740356445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8313608169555664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8476858139038086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([248, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8486127853393555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8486127853393555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.849085807800293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.866114616394043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8667778968811035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8667778968811035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8670754432678223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8798699378967285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8806428909301758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8806428909301758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8809041976928711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8939695358276367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8946847915649414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8946847915649414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8948945999145508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9068536758422852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9075102806091309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9075102806091309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9076781272888184  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9184203147888184  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9189901351928711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9189901351928711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9191198348999023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9283285140991211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9288983345031738  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9288983345031738  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9290127754211426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9379391670227051  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9384474754333496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9384474754333496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9385409355163574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9464850425720215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9469008445739746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9469008445739746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9469714164733887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9534640312194824  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9539403915405273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9539403915405273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9540128707885742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9611883163452148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9614839553833008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9614839553833008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9615278244018555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9661779403686523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.966463565826416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.966463565826416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9665017127990723  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9708123207092285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9710383415222168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9710383415222168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.971066951751709  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9745001792907715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9748492240905762  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9748492240905762  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9748892784118652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9799761772155762  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9801573753356934  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9801573753356934  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9801783561706543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9829897880554199  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9831910133361816  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9831910133361816  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9832119941711426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9861702919006348  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9863214492797852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9863214492797852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9863367080688477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9885950088500977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9887146949768066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9887146949768066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9887261390686035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9904999732971191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9906048774719238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9906048774719238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9906144142150879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.992159366607666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9922699928283691  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9922699928283691  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9922795295715332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9938912391662598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([119, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9967460632324219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9967460632324219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9969730377197266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0369205474853516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 119, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0237979888916016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.024214744567871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0246315002441406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0241937637329102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2794, 40])
input nodes number: 13882
output nodes number: 2794
edges number: 16504
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0243101119995117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.02431058883667  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.037835121154785156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 24 input nodes size: 45318
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035381317138671875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035381317138671875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.056990623474121094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.057012081146240234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03315162658691406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03393268585205078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03393268585205078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03393268585205078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([45318, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03393268585205078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([919, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07650041580200195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07650041580200195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0773768424987793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08446359634399414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([1167, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08513832092285156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08513832092285156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08625125885009766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10336780548095703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1137, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10443782806396484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10443782806396484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10552215576171875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13025283813476562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1004, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13162565231323242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13162565231323242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1004, 128]), torch.Size([1, 1004, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1325831413269043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16057920455932617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1004, 128])
m.shape torch.Size([948, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16236066818237305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16236066818237305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 948, 128]), torch.Size([1, 948, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16326475143432617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1974349021911621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 948, 128])
m.shape torch.Size([733, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1990799903869629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1990799903869629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.19977903366088867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23037481307983398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([692, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23233509063720703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23233509063720703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23299503326416016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.26683712005615234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([575, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.26870059967041016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.26870059967041016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.26924896240234375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.30242490768432617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([488, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3042449951171875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3042449951171875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.30471038818359375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.33449554443359375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([5109, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3586244583129883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3586244583129883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5109, 128]), torch.Size([1, 5109, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3634967803955078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.709935188293457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5109, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.672330379486084  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6845107078552246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6966910362243652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.684415340423584  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([12772, 256])
first layer input nodes number: 45318
first layer output nodes number: 12772
edges number: 84744
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6970310211181641  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7092113494873047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7122564315795898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7122564315795898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([421, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7324690818786621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7324690818786621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7332720756530762  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7405276298522949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([387, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.740870475769043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.740870475769043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7416086196899414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7547016143798828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([323, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7552642822265625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7552642822265625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7558803558349609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7716884613037109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7723493576049805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7723493576049805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7728300094604492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.786768913269043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([230, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7877411842346191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7877411842346191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.788179874420166  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8039727210998535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([179, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8047904968261719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8047904968261719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8051319122314453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8198127746582031  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([156, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8207345008850098  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8207345008850098  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8210320472717285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.835909366607666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.836606502532959  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.836606502532959  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8368163108825684  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8487753868103027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8495702743530273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8495702743530273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8497686386108398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8624639511108398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8631243705749512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8631243705749512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8632750511169434  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8739733695983887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8746066093444824  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8746066093444824  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8747344017028809  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.884702205657959  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8853306770324707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8853306770324707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8854451179504395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8951725959777832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8956780433654785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8956780433654785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8957638740539551  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9036602973937988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9043846130371094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9043846130371094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9044933319091797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9152565002441406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9157648086547852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9157648086547852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9158391952514648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9237241744995117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9242405891418457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9242405891418457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.924309253692627  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9320683479309082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9325242042541504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9325242042541504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9325814247131348  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9394478797912598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9398002624511719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9398002624511719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9398422241210938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9451713562011719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9455704689025879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9455704689025879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9456143379211426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9514927864074707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9517979621887207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9517979621887207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9518303871154785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9564023017883301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9567699432373047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9567699432373047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9568061828613281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9621696472167969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9624691009521484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9624691009521484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9624977111816406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9669322967529297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9672055244445801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9672055244445801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9672303199768066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9712471961975098  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9715118408203125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9715118408203125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9715347290039062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.97540283203125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([150, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9789958000183105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9789958000183105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9792819023132324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0296359062194824  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 150, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0126018524169922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.013026237487793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0134506225585938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0130047798156738  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2846, 40])
input nodes number: 12772
output nodes number: 2846
edges number: 19844
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0131292343139648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.013129711151123  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03552675247192383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 25 input nodes size: 48604
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03315925598144531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03315925598144531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05659675598144531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05661773681640625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03498697280883789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03576326370239258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03576326370239258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03576326370239258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([48604, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03576326370239258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([1009, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0791015625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0791015625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1009, 128]), torch.Size([1, 1009, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0800638198852539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08776187896728516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1009, 128])
m.shape torch.Size([1229, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08854150772094727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08854150772094727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1229, 128]), torch.Size([1, 1229, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08971357345581055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10729455947875977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1229, 128])
m.shape torch.Size([1198, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10905075073242188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10905075073242188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1198, 128]), torch.Size([1, 1198, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11019325256347656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1356220245361328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1198, 128])
m.shape torch.Size([1056, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13762950897216797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13762950897216797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13863658905029297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16784191131591797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([839, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16933870315551758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16933870315551758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17013883590698242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20044517517089844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([762, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2022252082824707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2022252082824707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 762, 128]), torch.Size([1, 762, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20295190811157227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23466920852661133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 762, 128])
m.shape torch.Size([593, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23628520965576172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23628520965576172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23685073852539062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2667660713195801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([574, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2686729431152344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2686729431152344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.26922035217285156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3019275665283203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([497, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3037867546081543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3037867546081543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3042607307434082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3345952033996582  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([5420, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3602027893066406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3602027893066406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5420, 128]), torch.Size([1, 5420, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3653717041015625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7338638305664062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5420, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6956033706665039  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7087030410766602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7212696075439453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7080717086791992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13177, 256])
first layer input nodes number: 48604
first layer output nodes number: 13177
edges number: 87468
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7216339111328125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7342004776000977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.737342357635498  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.737342357635498  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([538, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7538890838623047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7538890838623047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7549152374267578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7648401260375977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([452, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7651963233947754  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7651963233947754  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7660584449768066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7797389030456543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([341, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7802910804748535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7802910804748535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7809414863586426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7959713935852051  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7966113090515137  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7966113090515137  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7970900535583496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8109736442565918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8117146492004395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8117146492004395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8121037483215332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8261113166809082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8268857002258301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8268857002258301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8272061347961426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8409848213195801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8417263031005859  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8417263031005859  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8419818878173828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8547611236572266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8555254936218262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8555254936218262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8557467460632324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8683581352233887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8689742088317871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8689742088317871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8691344261169434  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8793883323669434  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.880192756652832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.880192756652832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8803682327270508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.892827033996582  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([45, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8932151794433594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8932151794433594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8933010101318359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8999958038330078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9005413055419922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9005413055419922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9006385803222656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9089069366455078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9093208312988281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9093208312988281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9093914031982422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9158840179443359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9163331985473633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9163331985473633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9164018630981445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9231996536254883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9235405921936035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9235405921936035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9235901832580566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9288468360900879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9290990829467773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9290990829467773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.929133415222168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9330129623413086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9333229064941406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9333229064941406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9333610534667969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9379386901855469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9381446838378906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9381446838378906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9381694793701172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9413185119628906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9415435791015625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9415435791015625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9415683746337891  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9448909759521484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9450902938842773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9450902938842773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9451112747192383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9480695724487305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9482612609863281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9482612609863281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9482803344726562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9511032104492188  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9511995315551758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9511995315551758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9512090682983398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9526872634887695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9528818130493164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9528818130493164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9528989791870117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9556798934936523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9558329582214355  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9558329582214355  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9558463096618652  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9581027030944824  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([120, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9609794616699219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9609794616699219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9612083435058594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0014915466308594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 120, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9881954193115234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9886131286621094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9890308380126953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9885921478271484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2801, 40])
input nodes number: 13177
output nodes number: 2801
edges number: 16545
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9887046813964844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9887051582336426  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03734540939331055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 26 input nodes size: 50366
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03498029708862305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03498029708862305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05899667739868164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05901813507080078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035559654235839844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03635597229003906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03635597229003906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03635597229003906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([50366, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03635597229003906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([989, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08146047592163086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08146047592163086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08240365982055664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08994913101196289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 989, 128])
m.shape torch.Size([1192, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0908517837524414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0908517837524414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1192, 128]), torch.Size([1, 1192, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09198856353759766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1090402603149414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1192, 128])
m.shape torch.Size([1191, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11017560958862305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11017560958862305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1191, 128]), torch.Size([1, 1191, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11131143569946289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13758277893066406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1191, 128])
m.shape torch.Size([1101, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1391148567199707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1391148567199707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.14016485214233398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17131853103637695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([968, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17310142517089844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17310142517089844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1740245819091797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2085399627685547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([804, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.21037864685058594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.21037864685058594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.21114540100097656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24458980560302734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([641, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24634599685668945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24634599685668945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24695730209350586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27832603454589844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([589, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.28026723861694336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.28026723861694336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.28082895278930664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3148226737976074  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([499, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.316683292388916  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.316683292388916  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.31715917587280273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.34761571884155273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([5639, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3747215270996094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3747215270996094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5639, 128]), torch.Size([1, 5639, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3800992965698242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7736268043518066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5639, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7330203056335449  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7460026741027832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7589850425720215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7459011077880859  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13613, 256])
first layer input nodes number: 50366
first layer output nodes number: 13613
edges number: 91094
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7593622207641602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7723445892333984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7757425308227539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7757425308227539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([525, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7914905548095703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7914905548095703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 525, 256]), torch.Size([1, 525, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7924919128417969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8010663986206055  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 525, 256])
m.shape torch.Size([478, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8014845848083496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8014845848083496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.802396297454834  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8171701431274414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([330, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8176660537719727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8176660537719727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8182954788208008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8322362899780273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([288, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8330287933349609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8330287933349609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8335781097412109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.84979248046875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([247, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8507051467895508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8507051467895508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8511762619018555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8681364059448242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([185, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8689947128295898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8689947128295898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8693475723266602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8845205307006836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8852458000183105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8852458000183105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8855013847351074  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8982806205749512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8990297317504883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8990297317504883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8992471694946289  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9116411209106445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9121813774108887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9121813774108887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9123244285583496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9214797019958496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9220619201660156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9220619201660156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9221916198730469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9314002990722656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9319806098937988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9319806098937988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9320969581604004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9411721229553223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9416103363037109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9416103363037109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9416923522949219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9486637115478516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9490976333618164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9490976333618164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9491701126098633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9558382034301758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9561386108398438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9561386108398438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9561862945556641  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.960906982421875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9612436294555664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9612436294555664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9612913131713867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9663457870483398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9666142463684082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9666142463684082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9666504859924316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9707455635070801  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9709725379943848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9709725379943848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.971001148223877  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9744343757629395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9746799468994141  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9746799468994141  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9747085571289062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9783420562744141  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9785103797912598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9785103797912598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9785294532775879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9810853004455566  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9812488555908203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9812488555908203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9812660217285156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9836864471435547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9839000701904297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9839000701904297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9839210510253906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9870262145996094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9871640205383301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9871640205383301  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9871773719787598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9892468452453613  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9893732070922852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9893732070922852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.989384651184082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9912385940551758  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.991279125213623  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.991279125213623  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9912829399108887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9919276237487793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([95, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9951472282409668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9951472282409668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.995328426361084  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.027219295501709  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 95, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.015444278717041  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0158653259277344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0162863731384277  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0158438682556152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2825, 40])
input nodes number: 13613
output nodes number: 2825
edges number: 15724
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.015970230102539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0159707069396973  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.037985801696777344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 27 input nodes size: 47427
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035562992095947266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035562992095947266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.059000492095947266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05902242660522461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.034984588623046875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035782814025878906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035782814025878906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035782814025878906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([47427, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035782814025878906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([887, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0791921615600586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0791921615600586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08003807067871094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08680534362792969  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([1161, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08751249313354492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08751249313354492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1161, 128]), torch.Size([1, 1161, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08861970901489258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10522794723510742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1161, 128])
m.shape torch.Size([1138, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10630226135253906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10630226135253906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10738754272460938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13212966918945312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1054, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13359737396240234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13359737396240234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13460254669189453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16375255584716797  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([900, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16539573669433594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16539573669433594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16625404357910156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.19784927368164062  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([737, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.19952869415283203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.19952869415283203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 737, 128]), torch.Size([1, 737, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20023155212402344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23146343231201172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 737, 128])
m.shape torch.Size([692, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23342180252075195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23342180252075195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.23408174514770508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2678074836730957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([582, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2696976661682129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2696976661682129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27025270462036133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3034796714782715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([469, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.30521488189697266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.30521488189697266  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3056621551513672  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3342876434326172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([5426, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3599371910095215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3599371910095215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5426, 128]), torch.Size([1, 5426, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3651118278503418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7339816093444824  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5426, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.695526123046875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7086143493652344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7210559844970703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7078704833984375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13046, 256])
first layer input nodes number: 47427
first layer output nodes number: 13046
edges number: 87742
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7214117050170898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7338533401489258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7369637489318848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7369637489318848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([474, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.756014347076416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.756014347076416  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7569184303283691  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.764286994934082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([406, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.764615535736084  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.764615535736084  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7653899192810059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7780427932739258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([339, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7786331176757812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7786331176757812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7792797088623047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7942419052124023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([277, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7950801849365234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7950801849365234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7956085205078125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.812530517578125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([231, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8140606880187988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8140606880187988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8145012855529785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8303627967834473  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8310017585754395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8310017585754395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8312859535217285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8435063362121582  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8443994522094727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8443994522094727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8446798324584961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.858698844909668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8594660758972168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8594660758972168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8596911430358887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8725199699401855  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8731603622436523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8731603622436523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.873326301574707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.883946418762207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8848152160644531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8848152160644531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8850040435791016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8984107971191406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8991308212280273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8991308212280273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8992776870727539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9107332229614258  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9113864898681641  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9113864898681641  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9115066528320312  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9217205047607422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.922447681427002  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.922447681427002  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9225678443908691  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9336228370666504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9340744018554688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9340744018554688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9341468811035156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9413223266601562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9417619705200195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9417619705200195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9418249130249023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9484968185424805  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9489884376525879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9489884376525879  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9490532875061035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9563813209533691  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9566597938537598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9566597938537598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9566960334777832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9610447883605957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9613385200500488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9613385200500488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9613728523254395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9657330513000488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9661726951599121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9661726951599121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9662203788757324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9726099967956543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9728937149047852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9728937149047852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9729242324829102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9772272109985352  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9774947166442871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9774947166442871  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9775214195251465  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.981473445892334  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9817776679992676  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9817776679992676  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9818062782287598  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9862408638000488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9864258766174316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9864258766174316  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.986443042755127  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9892239570617676  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9894924163818359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9894924163818359  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9895153045654297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9933834075927734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([138, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9966878890991211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9966878890991211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9969511032104492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0432767868041992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 138, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0275158882141113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0279483795166016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0283808708190918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0279264450073242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2901, 40])
input nodes number: 13046
output nodes number: 2901
edges number: 19210
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0280570983886719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.02805757522583  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0374150276184082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 28 input nodes size: 50906
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03499603271484375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03499603271484375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05926990509033203  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05929088592529297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.035831451416015625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03665447235107422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03665447235107422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03665447235107422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([50906, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03665447235107422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([975, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08303213119506836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08303213119506836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08396196365356445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09172916412353516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([1219, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09242677688598633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09242677688598633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1219, 128]), torch.Size([1, 1219, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.09358930587768555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11102724075317383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1219, 128])
m.shape torch.Size([1235, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11263275146484375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11263275146484375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11381053924560547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1397848129272461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1065, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.14149236679077148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.14149236679077148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.14250802993774414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1722273826599121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([1021, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17415380477905273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17415380477905273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1021, 128]), torch.Size([1, 1021, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17512750625610352  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2102494239807129  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1021, 128])
m.shape torch.Size([806, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2120685577392578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2120685577392578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.21283721923828125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2470855712890625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([682, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2489776611328125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2489776611328125  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 682, 128]), torch.Size([1, 682, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24962806701660156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.28319787979125977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 682, 128])
m.shape torch.Size([585, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.28510427474975586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.28510427474975586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2856621742248535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.31878137588500977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([528, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3207683563232422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3207683563232422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3212718963623047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3557415008544922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([5819, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3832368850708008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3832368850708008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5819, 128]), torch.Size([1, 5819, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.38878631591796875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7864365577697754  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5819, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7453527450561523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7586421966552734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7719316482543945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7585382461547852  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13935, 256])
first layer input nodes number: 50906
first layer output nodes number: 13935
edges number: 93715
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.772313117980957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7856025695800781  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7889251708984375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7889251708984375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([507, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8055248260498047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8055248260498047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8064918518066406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8159594535827637  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([441, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8163237571716309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8163237571716309  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8171648979187012  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8300557136535645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([360, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8308830261230469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8308830261230469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8315696716308594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8472518920898438  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([282, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8481569290161133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8481569290161133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8486948013305664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8659830093383789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([232, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8668293952941895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8668293952941895  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.867271900177002  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.883202075958252  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8839211463928223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8839211463928223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8842320442199707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8976006507873535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8982863426208496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8982863426208496  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8985247611999512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9104456901550293  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9111418724060059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9111418724060059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.911344051361084  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9228682518005371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([115, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.923762321472168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.923762321472168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9239816665649414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9380197525024414  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9386601448059082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9386601448059082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9388089179992676  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9493718147277832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([38, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9496994018554688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9496994018554688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9497718811035156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9554252624511719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9558391571044922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9558391571044922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9559135437011719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9622364044189453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9626617431640625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9626617431640625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9627323150634766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9692249298095703  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9696202278137207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9696202278137207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9696812629699707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9757237434387207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.976010799407959  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.976010799407959  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9760527610778809  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9805006980895996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9807567596435547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9807567596435547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9807910919189453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9846706390380859  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.984980583190918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.984980583190918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9850187301635742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9895963668823242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9898371696472168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9898371696472168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.989865779876709  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9934992790222168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9937591552734375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9937591552734375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9937877655029297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9976215362548828  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9977612495422363  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9977612495422363  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9977765083312988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9999279975891113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0000414848327637  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0000414848327637  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0000529289245605  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.001746654510498  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0018048286437988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0018048286437988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0018105506896973  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.002697467803955  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0028495788574219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0028495788574219  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0028629302978516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.005025863647461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0051579475402832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0051579475402832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.00516939163208  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.007103443145752  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([135, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0103416442871094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0103416442871094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.010599136352539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.055917739868164  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 135, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0429649353027344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.043384075164795  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0438032150268555  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.043363094329834  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2810, 40])
input nodes number: 13935
output nodes number: 2810
edges number: 16633
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0434746742248535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.0434751510620117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.038311004638671875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 29 input nodes size: 48761
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03581809997558594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03581809997558594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05925559997558594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.059276580810546875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.034981727600097656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03575706481933594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03575706481933594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03575706481933594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([48761, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03575706481933594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([976, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07936906814575195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07936906814575195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08029985427856445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08774614334106445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([1222, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08844614028930664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08844614028930664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1222, 128]), torch.Size([1, 1222, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08961153030395508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10739946365356445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1222, 128])
m.shape torch.Size([1207, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10921239852905273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10921239852905273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1207, 128]), torch.Size([1, 1207, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.11036348342895508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1358952522277832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1207, 128])
m.shape torch.Size([1069, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13782978057861328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13782978057861328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13884925842285156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16841411590576172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([920, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17009782791137695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17009782791137695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1709752082824707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2027440071105957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([813, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20463132858276367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20463132858276367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20540666580200195  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2396988868713379  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([637, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24143743515014648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24143743515014648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24204492568969727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27522945404052734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([539, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27698183059692383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.27698183059692383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2774958610534668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3079400062561035  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([490, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3097858428955078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3097858428955078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3102531433105469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3401603698730469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([5408, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.36571407318115234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.36571407318115234  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5408, 128]), torch.Size([1, 5408, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.37087154388427734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7386083602905273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5408, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7004246711730957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7135472297668457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7262129783630371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7129912376403809  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13281, 256])
first layer input nodes number: 48761
first layer output nodes number: 13281
edges number: 88056
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7265782356262207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7392439842224121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7433028221130371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7433028221130371  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([538, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7592830657958984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7592830657958984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7603092193603516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.770226001739502  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([448, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7705740928649902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7705740928649902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7714285850524902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7842459678649902  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([367, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.785210132598877  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.785210132598877  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7859101295471191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8014206886291504  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8025588989257812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8025588989257812  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8030681610107422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8200035095214844  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8208065032958984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8208065032958984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8212261199951172  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8363323211669922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8369474411010742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8369474411010742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8372201919555664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8489484786987305  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8496465682983398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8496465682983398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8498830795288086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8617086410522461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8624439239501953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8624439239501953  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8626556396484375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8747234344482422  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8753442764282227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8753442764282227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8755044937133789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8857583999633789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8862743377685547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8862743377685547  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8863925933837891  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8947887420654297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8953852653503418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8953852653503418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8955035209655762  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9047274589538574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9052915573120117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9052915573120117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9053945541381836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.914149284362793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([33, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9145102500915527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9145102500915527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9145731925964355  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9203639030456543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9208035469055176  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9208035469055176  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.920870304107666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9274792671203613  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([18, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9277057647705078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9277057647705078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9277400970458984  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9313793182373047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9317469596862793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9317469596862793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9317946434020996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9371829032897949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.937535285949707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.937535285949707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9375791549682617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9428434371948242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9431333541870117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9431333541870117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9431676864624023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9475278854370117  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9477119445800781  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9477119445800781  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9477329254150391  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9505443572998047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9506878852844238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9506878852844238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9507031440734863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9528546333312988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.953028678894043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.953028678894043  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9530458450317383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9555864334106445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9556417465209961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9556417465209961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9556474685668945  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9565343856811523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9566864967346191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9566864967346191  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9566998481750488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9588627815246582  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9589486122131348  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9589486122131348  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.958956241607666  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9602456092834473  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([110, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9628849029541016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9628849029541016  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9630947113037109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 1.000020980834961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 110, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9872798919677734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9876947402954102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9881095886230469  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9876737594604492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2784, 40])
input nodes number: 13281
output nodes number: 2784
edges number: 15958
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9877896308898926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9877901077270508  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03733968734741211  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 30 input nodes size: 48799
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03497743606567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03497743606567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.05841493606567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.058435916900634766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03497743606567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03571939468383789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03571939468383789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03571939468383789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([48799, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03571939468383789  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([990, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07834100723266602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07834100723266602  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 990, 128]), torch.Size([1, 990, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0792851448059082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0868382453918457  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 990, 128])
m.shape torch.Size([1246, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0875544548034668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0875544548034668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1246, 128]), torch.Size([1, 1246, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08874273300170898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10667943954467773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1246, 128])
m.shape torch.Size([1262, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10829782485961914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10829782485961914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1262, 128]), torch.Size([1, 1262, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10950136184692383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13597917556762695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1262, 128])
m.shape torch.Size([1110, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13749456405639648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13749456405639648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13855314254760742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17009496688842773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([986, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17281579971313477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17281579971313477  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 986, 128]), torch.Size([1, 986, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.17375612258911133  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20889711380004883  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 986, 128])
m.shape torch.Size([781, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2106614112854004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2106614112854004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 781, 128]), torch.Size([1, 781, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.21140623092651367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24358892440795898  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 781, 128])
m.shape torch.Size([681, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24599742889404297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24599742889404297  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24664688110351562  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2791767120361328  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([573, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2810378074645996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2810378074645996  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2815842628479004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.313931941986084  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([478, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.31571006774902344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.31571006774902344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3161659240722656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3453407287597656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([5042, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3691549301147461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3691549301147461  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5042, 128]), torch.Size([1, 5042, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3739633560180664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7189321517944336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5042, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6822524070739746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6947922706604004  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7073321342468262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6946940422058105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13149, 256])
first layer input nodes number: 48799
first layer output nodes number: 13149
edges number: 85397
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.707697868347168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7202377319335938  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7233729362487793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7233729362487793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([549, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7374749183654785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7374749183654785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7385220527648926  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7469220161437988  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 549, 256])
m.shape torch.Size([502, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7473635673522949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7473635673522949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7483210563659668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7637200355529785  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([371, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7645983695983887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7645983695983887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7653059959411621  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7821774482727051  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([312, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7830233573913574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7830233573913574  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7836184501647949  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8016915321350098  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([237, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8025331497192383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8025331497192383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8029851913452148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8192586898803711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8199095726013184  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8199095726013184  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8201994895935059  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8326659202575684  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8335695266723633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8335695266723633  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8338499069213867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8478689193725586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([90, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8484210968017578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8484210968017578  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8485927581787109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8583774566650391  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8589663505554199  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8589663505554199  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8591151237487793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8686366081237793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([56, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8691005706787109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8691005706787109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8692073822021484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8767910003662109  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8771820068359375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8771820068359375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8772621154785156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8835105895996094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8838744163513184  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8838744163513184  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8839411735534668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.889615535736084  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([20, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8898324966430664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8898324966430664  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8898706436157227  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8933801651000977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8936171531677246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8936171531677246  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.893653392791748  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8972411155700684  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8975257873535156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8975257873535156  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8975658416748047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9018115997314453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9019608497619629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9019608497619629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9019818305969238  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9043526649475098  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9045710563659668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9045710563659668  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9045977592468262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9078021049499512  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9079446792602539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9079446792602539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9079618453979492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9101419448852539  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9102978706359863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9102978706359863  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9103150367736816  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9126152992248535  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.912818431854248  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.912818431854248  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.912839412689209  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9157977104187012  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9158682823181152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9158682823181152  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9158759117126465  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9170050621032715  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.917107105255127  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.917107105255127  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.917116641998291  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9185948371887207  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9187231063842773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9187231063842773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9187345504760742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.920588493347168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9206752777099609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9206752777099609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9206829071044922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9219722747802734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([74, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9237465858459473  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9237465858459473  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9238877296447754  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9487290382385254  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 74, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9380931854248047  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9385075569152832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9389219284057617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9384865760803223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2778, 40])
input nodes number: 13149
output nodes number: 2778
edges number: 13990
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9386053085327148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.938605785369873  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03725576400756836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

pseudo mini batch 31 input nodes size: 47687
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.034976959228515625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.034976959228515625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.058414459228515625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.058435916900634766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03497743606567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03574419021606445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03574419021606445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03574419021606445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([47687, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.03574419021606445  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([998, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0784907341003418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0784907341003418  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 998, 128]), torch.Size([1, 998, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.07944250106811523  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08705663681030273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 998, 128])
m.shape torch.Size([1217, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08841943740844727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08841943740844727  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1217, 128]), torch.Size([1, 1217, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.08958005905151367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10698938369750977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1217, 128])
m.shape torch.Size([1167, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10884284973144531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.10884284973144531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.1099557876586914  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13502979278564453  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1044, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13728857040405273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13728857040405273  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.13828420639038086  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16715764999389648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([980, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16899633407592773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16899633407592773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.16993093490600586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20458364486694336  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([799, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20640230178833008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20640230178833008  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 799, 128]), torch.Size([1, 799, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.20716428756713867  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24054384231567383  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 799, 128])
m.shape torch.Size([646, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24231910705566406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.24231910705566406  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2429351806640625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2747373580932617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([608, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2767486572265625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2767486572265625  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.2773284912109375  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3113250732421875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([483, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.313107967376709  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.313107967376709  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3135685920715332  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3430485725402832  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([5172, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3682088851928711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3682088851928711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5172, 128]), torch.Size([1, 5172, 128])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.3731412887573242  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7233419418334961  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5172, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6857457160949707  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6982522010803223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7107586860656738  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.6981544494628906  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([13114, 256])
first layer input nodes number: 47687
first layer output nodes number: 13114
edges number: 86256
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7111163139343262  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7236227989196777  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7270359992980957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7270359992980957  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

m.shape torch.Size([534, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.743593692779541  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.743593692779541  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7446122169494629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7534527778625488  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([425, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.753760814666748  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.753760814666748  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7545714378356934  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7681269645690918  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([345, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7687320709228516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7687320709228516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7693901062011719  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7858386039733887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([261, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7865686416625977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7865686416625977  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.7870664596557617  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8030118942260742  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([227, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8038539886474609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8038539886474609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8042869567871094  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8198738098144531  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([200, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8208107948303223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8208107948303223  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8211922645568848  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8375954627990723  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8381986618041992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8381986618041992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8384237289428711  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8496770858764648  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8505721092224121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8505721092224121  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8508219718933105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8650641441345215  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8655967712402344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8655967712402344  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8657417297363281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8750190734863281  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8755426406860352  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8755426406860352  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8756608963012695  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8840570449829102  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8846640586853027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8846640586853027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8847842216491699  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8941569328308105  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8946738243103027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8946738243103027  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.8947691917419434  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9028754234313965  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9032654762268066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9032654762268066  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9033322334289551  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9094738960266113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9099388122558594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9099388122558594  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9100093841552734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9169960021972656  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9174222946166992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9174222946166992  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9174833297729492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9239530563354492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9242916107177734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9242916107177734  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9243373870849609  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9295101165771484  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9297161102294922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9297161102294922  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9297428131103516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9329471588134766  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9332799911499023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9332799911499023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9333181381225586  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9381628036499023  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.938326358795166  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.938326358795166  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9383454322814941  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9409012794494629  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9411611557006836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9411611557006836  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.941187858581543  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9449529647827148  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9451618194580078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9451618194580078  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes
Using backend: pytorch

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9451828002929688  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9482879638671875  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9484891891479492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9484891891479492  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9485082626342773  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9514646530151367  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9515881538391113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9515881538391113  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9515995979309082  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.953453540802002  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9535632133483887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9535632133483887  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9535727500915527  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9551844596862793  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([107, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9577507972717285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9577507972717285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9579548835754395  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9938740730285645  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

rst.shape  torch.Size([1, 107, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9805922508239746  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9810123443603516  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9814324378967285  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9809908866882324  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

torch.Size([2817, 40])
input nodes number: 13114
output nodes number: 2817
edges number: 16558
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9811158180236816  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.9811162948608398  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0373225212097168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0373225212097168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9002685546875 GB
    Memory Allocated: 0.0373225212097168  GigaBytes
Max Memory Allocated: 1.9338970184326172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011403277516365051 |0.0016349926590919495 |0.11419568955898285 |8.651614189147949e-05 |0.07553945481777191 |0.004612922668457031 |
----------------------------------------------------------pseudo_mini_loss sum 3.2395920753479004
Total (block generation + training)time/epoch 22.03104591369629
Training time/epoch 6.653780221939087
Training time without block to device /epoch 6.6014604568481445
Training time without total dataloading part /epoch 6.078906059265137
load block tensor time/epoch 0.36490488052368164
block to device time/epoch 0.05231976509094238
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1956087
Number of first layer input nodes during this epoch:  1515053
Number of first layer output nodes during this epoch:  441034
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
