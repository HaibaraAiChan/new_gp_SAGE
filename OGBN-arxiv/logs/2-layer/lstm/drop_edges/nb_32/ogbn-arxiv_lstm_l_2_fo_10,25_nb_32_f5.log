[05:38:06] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23358328 edges into 32 parts and get 7494714 edge cuts
main start at this time 1651556264.480411
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02996540069580078
global_2_local spend time (sec) 0.035773277282714844
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0045773983001708984
A = g.adjacency_matrix() spent  0.008041620254516602
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08999896049499512
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.299941062927246
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2179672718048096

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328})
Convert a graph into a bidirected graph: 1.078 seconds
Metis partitioning: 5.114 seconds
Split the graph: 0.493 seconds
Construct subgraphs: 0.073 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.770544767379761
2837
2927
2884
2875
2861
2894
2882
2875
2856
2877
2926
2814
2869
2879
2883
2867
2846
2824
2917
2893
2763
2763
2857
2758
2761
2758
2774
2824
2758
2758
2758
2923
total k batches seeds list generation spend  17.778347969055176
after graph partition
graph partition algorithm spend time 17.87496066093445
2837
2927
2884
2875
2861
2894
2882
2875
2856
2877
2926
2814
2869
2879
2883
2867
2846
2824
2917
2893
2763
2763
2857
2758
2761
2758
2774
2824
2758
2758
2758
2923
partition_len_list
[6990, 8962, 6279, 5602, 5690, 5499, 5548, 7526, 7540, 6792, 8156, 7179, 6461, 6937, 6308, 6704, 9464, 7235, 8425, 7104, 11441, 16426, 13539, 11673, 19999, 16300, 19112, 17691, 17749, 17221, 16820, 18511]
shared_neighbor_graph_partition_s0 selection method  spend 17.964025497436523
time for parepare:  0.01873469352722168
local_output_nid generation:  0.0006761550903320312
local_in_edges_tensor generation:  0.0009164810180664062
mini_batch_src_global generation:  0.0009789466857910156
r_  generation:  0.006131887435913086
local_output_nid generation:  0.0007245540618896484
local_in_edges_tensor generation:  0.0008285045623779297
mini_batch_src_global generation:  0.0013308525085449219
r_  generation:  0.007521867752075195
local_output_nid generation:  0.0007369518280029297
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0007917881011962891
r_  generation:  0.006728649139404297
local_output_nid generation:  0.0007562637329101562
local_in_edges_tensor generation:  0.0007088184356689453
mini_batch_src_global generation:  0.0006923675537109375
r_  generation:  0.006228208541870117
local_output_nid generation:  0.0007603168487548828
local_in_edges_tensor generation:  0.0006754398345947266
mini_batch_src_global generation:  0.0006117820739746094
r_  generation:  0.005421876907348633
local_output_nid generation:  0.0007658004760742188
local_in_edges_tensor generation:  0.0006470680236816406
mini_batch_src_global generation:  0.0005822181701660156
r_  generation:  0.005226612091064453
local_output_nid generation:  0.0007359981536865234
local_in_edges_tensor generation:  0.0006158351898193359
mini_batch_src_global generation:  0.0004954338073730469
r_  generation:  0.004367351531982422
local_output_nid generation:  0.000728607177734375
local_in_edges_tensor generation:  0.0006804466247558594
mini_batch_src_global generation:  0.0007293224334716797
r_  generation:  0.006797075271606445
local_output_nid generation:  0.0007212162017822266
local_in_edges_tensor generation:  0.0006783008575439453
mini_batch_src_global generation:  0.0009074211120605469
r_  generation:  0.007237434387207031
local_output_nid generation:  0.0007588863372802734
local_in_edges_tensor generation:  0.0006773471832275391
mini_batch_src_global generation:  0.0007891654968261719
r_  generation:  0.007054567337036133
local_output_nid generation:  0.0007650852203369141
local_in_edges_tensor generation:  0.0006804466247558594
mini_batch_src_global generation:  0.0008177757263183594
r_  generation:  0.007474660873413086
local_output_nid generation:  0.000743865966796875
local_in_edges_tensor generation:  0.0006296634674072266
mini_batch_src_global generation:  0.0006785392761230469
r_  generation:  0.005596160888671875
local_output_nid generation:  0.0007529258728027344
local_in_edges_tensor generation:  0.0006437301635742188
mini_batch_src_global generation:  0.0006778240203857422
r_  generation:  0.006387233734130859
local_output_nid generation:  0.0007622241973876953
local_in_edges_tensor generation:  0.0006654262542724609
mini_batch_src_global generation:  0.0007798671722412109
r_  generation:  0.007239341735839844
local_output_nid generation:  0.0007517337799072266
local_in_edges_tensor generation:  0.0006747245788574219
mini_batch_src_global generation:  0.0007870197296142578
r_  generation:  0.007165670394897461
local_output_nid generation:  0.0007505416870117188
local_in_edges_tensor generation:  0.0006384849548339844
mini_batch_src_global generation:  0.0007340908050537109
r_  generation:  0.006735801696777344
local_output_nid generation:  0.0007491111755371094
local_in_edges_tensor generation:  0.0006387233734130859
mini_batch_src_global generation:  0.0007312297821044922
r_  generation:  0.00610041618347168
local_output_nid generation:  0.000732421875
local_in_edges_tensor generation:  0.0006070137023925781
mini_batch_src_global generation:  0.0005915164947509766
r_  generation:  0.005133628845214844
local_output_nid generation:  0.0007531642913818359
local_in_edges_tensor generation:  0.0006284713745117188
mini_batch_src_global generation:  0.0006775856018066406
r_  generation:  0.005855560302734375
local_output_nid generation:  0.0007498264312744141
local_in_edges_tensor generation:  0.0006265640258789062
mini_batch_src_global generation:  0.0006844997406005859
r_  generation:  0.0061376094818115234
local_output_nid generation:  0.0007061958312988281
local_in_edges_tensor generation:  0.00060272216796875
mini_batch_src_global generation:  0.0006482601165771484
r_  generation:  0.005136728286743164
local_output_nid generation:  0.0007030963897705078
local_in_edges_tensor generation:  0.0006842613220214844
mini_batch_src_global generation:  0.0010881423950195312
r_  generation:  0.009044647216796875
local_output_nid generation:  0.0007753372192382812
local_in_edges_tensor generation:  0.0006728172302246094
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.006906032562255859
local_output_nid generation:  0.0007922649383544922
local_in_edges_tensor generation:  0.0006258487701416016
mini_batch_src_global generation:  0.0007557868957519531
r_  generation:  0.006231784820556641
local_output_nid generation:  0.0007948875427246094
local_in_edges_tensor generation:  0.0006878376007080078
mini_batch_src_global generation:  0.0010814666748046875
r_  generation:  0.009546995162963867
local_output_nid generation:  0.0008065700531005859
local_in_edges_tensor generation:  0.006363391876220703
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.00759124755859375
local_output_nid generation:  0.0007793903350830078
local_in_edges_tensor generation:  0.0007631778717041016
mini_batch_src_global generation:  0.0012211799621582031
r_  generation:  0.009403228759765625
local_output_nid generation:  0.0008301734924316406
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0010805130004882812
r_  generation:  0.008436203002929688
local_output_nid generation:  0.0008258819580078125
local_in_edges_tensor generation:  0.0006997585296630859
mini_batch_src_global generation:  0.0010638236999511719
r_  generation:  0.008680582046508789
local_output_nid generation:  0.0008215904235839844
local_in_edges_tensor generation:  0.0006847381591796875
mini_batch_src_global generation:  0.0010063648223876953
r_  generation:  0.008635997772216797
local_output_nid generation:  0.0008461475372314453
local_in_edges_tensor generation:  0.0006742477416992188
mini_batch_src_global generation:  0.0010232925415039062
r_  generation:  0.009245634078979492
local_output_nid generation:  0.0008771419525146484
local_in_edges_tensor generation:  0.0009832382202148438
mini_batch_src_global generation:  0.0016019344329833984
r_  generation:  0.014518022537231445
----------------------check_connections_block total spend ----------------------------- 0.39684414863586426
generate_one_block  0.015277385711669922
generate_one_block  0.012457609176635742
generate_one_block  0.00950312614440918
generate_one_block  0.008594036102294922
generate_one_block  0.007488727569580078
generate_one_block  0.007447242736816406
generate_one_block  0.006253719329833984
generate_one_block  0.010236978530883789
generate_one_block  0.011040687561035156
generate_one_block  0.010735750198364258
generate_one_block  0.011139154434204102
generate_one_block  0.008331775665283203
generate_one_block  0.009039640426635742
generate_one_block  0.010527372360229492
generate_one_block  0.011197566986083984
generate_one_block  0.009757280349731445
generate_one_block  0.009347200393676758
generate_one_block  0.007367849349975586
generate_one_block  0.008782625198364258
generate_one_block  0.008896350860595703
generate_one_block  0.008723735809326172
generate_one_block  0.015623092651367188
generate_one_block  0.010160684585571289
generate_one_block  0.00940847396850586
generate_one_block  0.01570415496826172
generate_one_block  0.011830806732177734
generate_one_block  0.014727115631103516
generate_one_block  0.013490915298461914
generate_one_block  0.013886213302612305
generate_one_block  0.013231515884399414
generate_one_block  0.014334917068481445
generate_one_block  0.018438339233398438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03590035438537598
gen group dst list time:  0.009858846664428711
time for parepare:  0.021728038787841797
local_output_nid generation:  0.0014281272888183594
local_in_edges_tensor generation:  0.0052738189697265625
mini_batch_src_global generation:  0.001500844955444336
r_  generation:  0.015001773834228516
local_output_nid generation:  0.002500772476196289
local_in_edges_tensor generation:  0.002235889434814453
mini_batch_src_global generation:  0.002361297607421875
r_  generation:  0.02219080924987793
local_output_nid generation:  0.00182342529296875
local_in_edges_tensor generation:  0.001547098159790039
mini_batch_src_global generation:  0.001322031021118164
r_  generation:  0.014189481735229492
local_output_nid generation:  0.001611471176147461
local_in_edges_tensor generation:  0.0014340877532958984
mini_batch_src_global generation:  0.001239776611328125
r_  generation:  0.010350704193115234
local_output_nid generation:  0.0015947818756103516
local_in_edges_tensor generation:  0.0013113021850585938
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.010023117065429688
local_output_nid generation:  0.0014433860778808594
local_in_edges_tensor generation:  0.0012121200561523438
mini_batch_src_global generation:  0.0009992122650146484
r_  generation:  0.009416580200195312
local_output_nid generation:  0.0014872550964355469
local_in_edges_tensor generation:  0.0011768341064453125
mini_batch_src_global generation:  0.0009286403656005859
r_  generation:  0.008820533752441406
local_output_nid generation:  0.00194549560546875
local_in_edges_tensor generation:  0.0016126632690429688
mini_batch_src_global generation:  0.0012853145599365234
r_  generation:  0.01741194725036621
local_output_nid generation:  0.0020699501037597656
local_in_edges_tensor generation:  0.0019774436950683594
mini_batch_src_global generation:  0.0018248558044433594
r_  generation:  0.018167495727539062
local_output_nid generation:  0.0018532276153564453
local_in_edges_tensor generation:  0.001667022705078125
mini_batch_src_global generation:  0.001336812973022461
r_  generation:  0.016398906707763672
local_output_nid generation:  0.0021402835845947266
local_in_edges_tensor generation:  0.0018570423126220703
mini_batch_src_global generation:  0.0020401477813720703
r_  generation:  0.020008563995361328
local_output_nid generation:  0.004118680953979492
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.0013172626495361328
r_  generation:  0.01562643051147461
local_output_nid generation:  0.0018520355224609375
local_in_edges_tensor generation:  0.0014541149139404297
mini_batch_src_global generation:  0.0012242794036865234
r_  generation:  0.014570474624633789
local_output_nid generation:  0.0018963813781738281
local_in_edges_tensor generation:  0.0016579627990722656
mini_batch_src_global generation:  0.0014910697937011719
r_  generation:  0.016838788986206055
local_output_nid generation:  0.0016918182373046875
local_in_edges_tensor generation:  0.0016014575958251953
mini_batch_src_global generation:  0.001352071762084961
r_  generation:  0.015389442443847656
local_output_nid generation:  0.0017752647399902344
local_in_edges_tensor generation:  0.0015957355499267578
mini_batch_src_global generation:  0.0012946128845214844
r_  generation:  0.01576972007751465
local_output_nid generation:  0.002578258514404297
local_in_edges_tensor generation:  0.002227783203125
mini_batch_src_global generation:  0.018584728240966797
r_  generation:  0.024695873260498047
local_output_nid generation:  0.002048492431640625
local_in_edges_tensor generation:  0.0016837120056152344
mini_batch_src_global generation:  0.001779794692993164
r_  generation:  0.015743732452392578
local_output_nid generation:  0.002380847930908203
local_in_edges_tensor generation:  0.0019412040710449219
mini_batch_src_global generation:  0.0015249252319335938
r_  generation:  0.018393993377685547
local_output_nid generation:  0.0019397735595703125
local_in_edges_tensor generation:  0.0015823841094970703
mini_batch_src_global generation:  0.0013501644134521484
r_  generation:  0.015521049499511719
local_output_nid generation:  0.0031833648681640625
local_in_edges_tensor generation:  0.002900838851928711
mini_batch_src_global generation:  0.002168893814086914
r_  generation:  0.02782893180847168
local_output_nid generation:  0.004351377487182617
local_in_edges_tensor generation:  0.005002260208129883
mini_batch_src_global generation:  0.005619049072265625
r_  generation:  0.04687309265136719
local_output_nid generation:  0.0039556026458740234
local_in_edges_tensor generation:  0.004269123077392578
mini_batch_src_global generation:  0.003805398941040039
r_  generation:  0.03693866729736328
local_output_nid generation:  0.0033884048461914062
local_in_edges_tensor generation:  0.0028810501098632812
mini_batch_src_global generation:  0.005238056182861328
r_  generation:  0.03026270866394043
local_output_nid generation:  0.005539417266845703
local_in_edges_tensor generation:  0.005656719207763672
mini_batch_src_global generation:  0.005509853363037109
r_  generation:  0.05968117713928223
local_output_nid generation:  0.004921913146972656
local_in_edges_tensor generation:  0.004855155944824219
mini_batch_src_global generation:  0.0055065155029296875
r_  generation:  0.04778289794921875
local_output_nid generation:  0.00549006462097168
local_in_edges_tensor generation:  0.005482196807861328
mini_batch_src_global generation:  0.00654149055480957
r_  generation:  0.05933833122253418
local_output_nid generation:  0.005156278610229492
local_in_edges_tensor generation:  0.004525899887084961
mini_batch_src_global generation:  0.005730867385864258
r_  generation:  0.05139970779418945
local_output_nid generation:  0.005273103713989258
local_in_edges_tensor generation:  0.00456690788269043
mini_batch_src_global generation:  0.005692243576049805
r_  generation:  0.05452704429626465
local_output_nid generation:  0.005089759826660156
local_in_edges_tensor generation:  0.004471778869628906
mini_batch_src_global generation:  0.005505084991455078
r_  generation:  0.051011085510253906
local_output_nid generation:  0.0049054622650146484
local_in_edges_tensor generation:  0.004141807556152344
mini_batch_src_global generation:  0.010562419891357422
r_  generation:  0.05201435089111328
local_output_nid generation:  0.008783102035522461
local_in_edges_tensor generation:  0.007867574691772461
mini_batch_src_global generation:  0.014086723327636719
r_  generation:  0.056908607482910156
----------------------check_connections_block total spend ----------------------------- 1.4435908794403076
generate_one_block  0.020377397537231445
generate_one_block  0.032463788986206055
generate_one_block  0.02085423469543457
generate_one_block  0.015728235244750977
generate_one_block  0.013169288635253906
generate_one_block  0.012299537658691406
generate_one_block  0.01142120361328125
generate_one_block  0.021532297134399414
generate_one_block  0.02509760856628418
generate_one_block  0.021010637283325195
generate_one_block  0.038240909576416016
generate_one_block  0.03713345527648926
generate_one_block  0.019909381866455078
generate_one_block  0.022150039672851562
generate_one_block  0.019625425338745117
generate_one_block  0.0200350284576416
generate_one_block  0.029453516006469727
generate_one_block  0.020479679107666016
generate_one_block  0.02480173110961914
generate_one_block  0.021925687789916992
generate_one_block  0.04206371307373047
generate_one_block  0.06614017486572266
generate_one_block  0.0496366024017334
generate_one_block  0.040247440338134766
generate_one_block  0.08145427703857422
generate_one_block  0.062018632888793945
generate_one_block  0.07727241516113281
generate_one_block  0.0700676441192627
generate_one_block  0.07064437866210938
generate_one_block  0.06611919403076172
generate_one_block  0.06471776962280273
generate_one_block  0.09623098373413086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.4435908794403076
block generation total time  1.2343223094940186
average batch blocks generation time:  0.03857257217168808
pseudo mini batch 0 input nodes size: 15433
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010136604309082031  GigaBytes
Max Memory Allocated: 0.010136604309082031  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010158061981201172  GigaBytes
Max Memory Allocated: 0.010158061981201172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010158061981201172  GigaBytes
Max Memory Allocated: 0.010158061981201172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.010624408721923828  GigaBytes
Max Memory Allocated: 0.010624408721923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.010624408721923828  GigaBytes
Max Memory Allocated: 0.010624408721923828  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.010624408721923828  GigaBytes
Max Memory Allocated: 0.010624408721923828  GigaBytes

torch.Size([15433, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.010624408721923828  GigaBytes
Max Memory Allocated: 0.010624408721923828  GigaBytes

m.shape torch.Size([696, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.032001495361328125  GigaBytes
Max Memory Allocated: 0.03228139877319336  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.032001495361328125  GigaBytes
Max Memory Allocated: 0.03228139877319336  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.032665252685546875  GigaBytes
Max Memory Allocated: 0.032665252685546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.037975311279296875  GigaBytes
Max Memory Allocated: 0.03830718994140625  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([723, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.03833293914794922  GigaBytes
Max Memory Allocated: 0.03834962844848633  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.03833293914794922  GigaBytes
Max Memory Allocated: 0.03834962844848633  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03902244567871094  GigaBytes
Max Memory Allocated: 0.03902244567871094  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.04936504364013672  GigaBytes
Max Memory Allocated: 0.05005455017089844  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([666, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.0499730110168457  GigaBytes
Max Memory Allocated: 0.05005455017089844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.0499730110168457  GigaBytes
Max Memory Allocated: 0.05005455017089844  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.050608158111572266  GigaBytes
Max Memory Allocated: 0.050608158111572266  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.064605712890625  GigaBytes
Max Memory Allocated: 0.06555843353271484  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([609, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.06544971466064453  GigaBytes
Max Memory Allocated: 0.06555843353271484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.06544971466064453  GigaBytes
Max Memory Allocated: 0.06555843353271484  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.06603050231933594  GigaBytes
Max Memory Allocated: 0.06603050231933594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.08287334442138672  GigaBytes
Max Memory Allocated: 0.08403491973876953  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([573, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.08394908905029297  GigaBytes
Max Memory Allocated: 0.08403491973876953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.08394908905029297  GigaBytes
Max Memory Allocated: 0.08403491973876953  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08449554443359375  GigaBytes
Max Memory Allocated: 0.08449554443359375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.10436582565307617  GigaBytes
Max Memory Allocated: 0.10573196411132812  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([420, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.10529422760009766  GigaBytes
Max Memory Allocated: 0.10573196411132812  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.10529422760009766  GigaBytes
Max Memory Allocated: 0.10573196411132812  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.10569477081298828  GigaBytes
Max Memory Allocated: 0.10573196411132812  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.12291812896728516  GigaBytes
Max Memory Allocated: 0.12411975860595703  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([366, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.12393951416015625  GigaBytes
Max Memory Allocated: 0.12411975860595703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.12393951416015625  GigaBytes
Max Memory Allocated: 0.12411975860595703  GigaBytes

 h.shape torch.Size([1, 366, 128]), torch.Size([1, 366, 128])
----------------------------------------3
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.12428855895996094  GigaBytes
Max Memory Allocated: 0.12428855895996094  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.1417407989501953  GigaBytes
Max Memory Allocated: 0.14296245574951172  GigaBytes

rst.shape  torch.Size([1, 366, 128])
m.shape torch.Size([342, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.14287090301513672  GigaBytes
Max Memory Allocated: 0.14296245574951172  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.14287090301513672  GigaBytes
Max Memory Allocated: 0.14296245574951172  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.14319705963134766  GigaBytes
Max Memory Allocated: 0.14319705963134766  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.1617879867553711  GigaBytes
Max Memory Allocated: 0.16309261322021484  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([306, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.16293811798095703  GigaBytes
Max Memory Allocated: 0.16309261322021484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.16293811798095703  GigaBytes
Max Memory Allocated: 0.16309261322021484  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.16322994232177734  GigaBytes
Max Memory Allocated: 0.16322994232177734  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.18190670013427734  GigaBytes
Max Memory Allocated: 0.18321990966796875  GigaBytes

rst.shape  torch.Size([1, 306, 128])
m.shape torch.Size([2289, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.1934795379638672  GigaBytes
Max Memory Allocated: 0.19373559951782227  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.1934795379638672  GigaBytes
Max Memory Allocated: 0.19373559951782227  GigaBytes

 h.shape torch.Size([1, 2289, 128]), torch.Size([1, 2289, 128])
----------------------------------------3
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.1956624984741211  GigaBytes
Max Memory Allocated: 0.1956624984741211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.35875368118286133  GigaBytes
Max Memory Allocated: 0.37047243118286133  GigaBytes

rst.shape  torch.Size([1, 2289, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.33942556381225586  GigaBytes
Max Memory Allocated: 0.37047243118286133  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.34609174728393555  GigaBytes
Max Memory Allocated: 0.37047243118286133  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.35275793075561523  GigaBytes
Max Memory Allocated: 0.37047243118286133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3460392951965332  GigaBytes
Max Memory Allocated: 0.37047243118286133  GigaBytes

torch.Size([6990, 256])
first layer input nodes number: 15433
first layer output nodes number: 6990
edges number: 42903
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3528752326965332  GigaBytes
Max Memory Allocated: 0.37047243118286133  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3595414161682129  GigaBytes
Max Memory Allocated: 0.37047243118286133  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36126089096069336  GigaBytes
Max Memory Allocated: 0.37047243118286133  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36126089096069336  GigaBytes
Max Memory Allocated: 0.37047243118286133  GigaBytes

m.shape torch.Size([470, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.3815193176269531  GigaBytes
Max Memory Allocated: 0.38152122497558594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.3815193176269531  GigaBytes
Max Memory Allocated: 0.38152122497558594  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 1.5975341796875 GB
    Memory Allocated: 0.382415771484375  GigaBytes
Max Memory Allocated: 0.382415771484375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.389862060546875  GigaBytes
Max Memory Allocated: 0.39031028747558594  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([386, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39015626907348633  GigaBytes
Max Memory Allocated: 0.39031028747558594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39015626907348633  GigaBytes
Max Memory Allocated: 0.39031028747558594  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39089250564575195  GigaBytes
Max Memory Allocated: 0.39089250564575195  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.40247297286987305  GigaBytes
Max Memory Allocated: 0.40320920944213867  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.40302467346191406  GigaBytes
Max Memory Allocated: 0.40320920944213867  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.40302467346191406  GigaBytes
Max Memory Allocated: 0.40320920944213867  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.40363311767578125  GigaBytes
Max Memory Allocated: 0.40363311767578125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.41745948791503906  GigaBytes
Max Memory Allocated: 0.41837215423583984  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([274, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.4182090759277344  GigaBytes
Max Memory Allocated: 0.41837215423583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.4182090759277344  GigaBytes
Max Memory Allocated: 0.41837215423583984  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.418731689453125  GigaBytes
Max Memory Allocated: 0.418731689453125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.4338874816894531  GigaBytes
Max Memory Allocated: 0.4349327087402344  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([217, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.43466901779174805  GigaBytes
Max Memory Allocated: 0.4349327087402344  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.43466901779174805  GigaBytes
Max Memory Allocated: 0.4349327087402344  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.43508291244506836  GigaBytes
Max Memory Allocated: 0.43508291244506836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6424560546875 GB
    Memory Allocated: 0.4499831199645996  GigaBytes
Max Memory Allocated: 0.4510178565979004  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.6424560546875 GB
    Memory Allocated: 0.4506354331970215  GigaBytes
Max Memory Allocated: 0.4510178565979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6424560546875 GB
    Memory Allocated: 0.4506354331970215  GigaBytes
Max Memory Allocated: 0.4510178565979004  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 1.6424560546875 GB
    Memory Allocated: 0.45091962814331055  GigaBytes
Max Memory Allocated: 0.4510178565979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.46314001083374023  GigaBytes
Max Memory Allocated: 0.4639925956726074  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.4638996124267578  GigaBytes
Max Memory Allocated: 0.4639925956726074  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.4638996124267578  GigaBytes
Max Memory Allocated: 0.4639925956726074  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.4641551971435547  GigaBytes
Max Memory Allocated: 0.4641551971435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.47693443298339844  GigaBytes
Max Memory Allocated: 0.4778289794921875  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.4776449203491211  GigaBytes
Max Memory Allocated: 0.4778289794921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.4776449203491211  GigaBytes
Max Memory Allocated: 0.4778289794921875  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.47785282135009766  GigaBytes
Max Memory Allocated: 0.47785282135009766  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.4897031784057617  GigaBytes
Max Memory Allocated: 0.49053478240966797  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.49037790298461914  GigaBytes
Max Memory Allocated: 0.49053478240966797  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.49037790298461914  GigaBytes
Max Memory Allocated: 0.49053478240966797  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.49054956436157227  GigaBytes
Max Memory Allocated: 0.49054956436157227  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.5015358924865723  GigaBytes
Max Memory Allocated: 0.5023083686828613  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([98, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.5023922920227051  GigaBytes
Max Memory Allocated: 0.5023961067199707  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.5023922920227051  GigaBytes
Max Memory Allocated: 0.5023961067199707  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.5025792121887207  GigaBytes
Max Memory Allocated: 0.5025792121887207  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5158505439758301  GigaBytes
Max Memory Allocated: 0.5167851448059082  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5166134834289551  GigaBytes
Max Memory Allocated: 0.5167851448059082  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5166134834289551  GigaBytes
Max Memory Allocated: 0.5167851448059082  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5167679786682129  GigaBytes
Max Memory Allocated: 0.5167851448059082  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.5288186073303223  GigaBytes
Max Memory Allocated: 0.5296683311462402  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.529329776763916  GigaBytes
Max Memory Allocated: 0.5296683311462402  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.529329776763916  GigaBytes
Max Memory Allocated: 0.5296683311462402  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.5294270515441895  GigaBytes
Max Memory Allocated: 0.5296683311462402  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5376954078674316  GigaBytes
Max Memory Allocated: 0.5382790565490723  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5381340980529785  GigaBytes
Max Memory Allocated: 0.5382790565490723  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5381340980529785  GigaBytes
Max Memory Allocated: 0.5382790565490723  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5382084846496582  GigaBytes
Max Memory Allocated: 0.5382790565490723  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5450520515441895  GigaBytes
Max Memory Allocated: 0.5455355644226074  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5455265045166016  GigaBytes
Max Memory Allocated: 0.5455355644226074  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5455265045166016  GigaBytes
Max Memory Allocated: 0.5455355644226074  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5455989837646484  GigaBytes
Max Memory Allocated: 0.5455989837646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5527744293212891  GigaBytes
Max Memory Allocated: 0.5532817840576172  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5531854629516602  GigaBytes
Max Memory Allocated: 0.5532817840576172  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5531854629516602  GigaBytes
Max Memory Allocated: 0.5532817840576172  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5532445907592773  GigaBytes
Max Memory Allocated: 0.5532817840576172  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5595121383666992  GigaBytes
Max Memory Allocated: 0.5599555969238281  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5601134300231934  GigaBytes
Max Memory Allocated: 0.5601162910461426  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5601134300231934  GigaBytes
Max Memory Allocated: 0.5601162910461426  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5601916313171387  GigaBytes
Max Memory Allocated: 0.5601916313171387  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.569028377532959  GigaBytes
Max Memory Allocated: 0.5696539878845215  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.5693488121032715  GigaBytes
Max Memory Allocated: 0.5696539878845215  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.5693488121032715  GigaBytes
Max Memory Allocated: 0.5696539878845215  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.5693907737731934  GigaBytes
Max Memory Allocated: 0.5696539878845215  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7635498046875 GB
    Memory Allocated: 0.5744261741638184  GigaBytes
Max Memory Allocated: 0.5747828483581543  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.7635498046875 GB
    Memory Allocated: 0.5747342109680176  GigaBytes
Max Memory Allocated: 0.5747828483581543  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7635498046875 GB
    Memory Allocated: 0.5747342109680176  GigaBytes
Max Memory Allocated: 0.5747828483581543  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 1.7635498046875 GB
    Memory Allocated: 0.574770450592041  GigaBytes
Max Memory Allocated: 0.5747828483581543  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.5793728828430176  GigaBytes
Max Memory Allocated: 0.5796990394592285  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.5799212455749512  GigaBytes
Max Memory Allocated: 0.5799236297607422  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.5799212455749512  GigaBytes
Max Memory Allocated: 0.5799236297607422  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.5799803733825684  GigaBytes
Max Memory Allocated: 0.5799803733825684  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.5879034996032715  GigaBytes
Max Memory Allocated: 0.5884652137756348  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.5882391929626465  GigaBytes
Max Memory Allocated: 0.5884652137756348  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.5882391929626465  GigaBytes
Max Memory Allocated: 0.5884652137756348  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.5882754325866699  GigaBytes
Max Memory Allocated: 0.5884652137756348  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.5933852195739746  GigaBytes
Max Memory Allocated: 0.593747615814209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.593569278717041  GigaBytes
Max Memory Allocated: 0.593747615814209  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.593569278717041  GigaBytes
Max Memory Allocated: 0.593747615814209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.5935883522033691  GigaBytes
Max Memory Allocated: 0.593747615814209  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.5964112281799316  GigaBytes
Max Memory Allocated: 0.596611499786377  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.5966768264770508  GigaBytes
Max Memory Allocated: 0.5966782569885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.5966768264770508  GigaBytes
Max Memory Allocated: 0.5966782569885254  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.5967016220092773  GigaBytes
Max Memory Allocated: 0.5967016220092773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.6005449295043945  GigaBytes
Max Memory Allocated: 0.6008176803588867  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.6007981300354004  GigaBytes
Max Memory Allocated: 0.6008176803588867  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.6007981300354004  GigaBytes
Max Memory Allocated: 0.6008176803588867  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.6008210182189941  GigaBytes
Max Memory Allocated: 0.6008210182189941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.6045289039611816  GigaBytes
Max Memory Allocated: 0.6047921180725098  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.6047482490539551  GigaBytes
Max Memory Allocated: 0.6047921180725098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.6047482490539551  GigaBytes
Max Memory Allocated: 0.6047921180725098  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.6047673225402832  GigaBytes
Max Memory Allocated: 0.6047921180725098  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6079907417297363  GigaBytes
Max Memory Allocated: 0.6082196235656738  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([174, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.612922191619873  GigaBytes
Max Memory Allocated: 0.612938404083252  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.612922191619873  GigaBytes
Max Memory Allocated: 0.612938404083252  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6132540702819824  GigaBytes
Max Memory Allocated: 0.6132540702819824  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6716647148132324  GigaBytes
Max Memory Allocated: 0.6758131980895996  GigaBytes

rst.shape  torch.Size([1, 174, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6545977592468262  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6550207138061523  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6554436683654785  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6549992561340332  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

torch.Size([2837, 40])
input nodes number: 6990
output nodes number: 2837
edges number: 19584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6554961204528809  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6554970741271973  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.014740943908691406  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

pseudo mini batch 1 input nodes size: 23125
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.013357162475585938  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.013357162475585938  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.025075912475585938  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.02509784698486328  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.017717361450195312  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.018380165100097656  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.018380165100097656  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.018380165100097656  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

torch.Size([23125, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.018380165100097656  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

m.shape torch.Size([552, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.050713539123535156  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.050713539123535156  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.051239967346191406  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.055451393127441406  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([642, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.055800437927246094  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.055800437927246094  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.056412696838378906  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0655965805053711  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([622, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.06618022918701172  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.06618022918701172  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0667734146118164  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0798501968383789  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([593, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.08068466186523438  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.08068466186523438  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.08125019073486328  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09765052795410156  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([568, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09872198104858398  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09872198104858398  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09926366806030273  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1193690299987793  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([496, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.12051725387573242  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.12051725387573242  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.12099027633666992  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14133024215698242  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([470, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14266252517700195  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14266252517700195  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1431107521057129  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.16552209854125977  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([472, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1670985221862793  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1670985221862793  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.16754865646362305  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1932063102722168  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([381, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.19461631774902344  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.19461631774902344  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.19497966766357422  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.21823406219482422  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([4166, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.23791742324829102  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.23791742324829102  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 4166, 128]), torch.Size([1, 4166, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.24189043045043945  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.5248022079467773  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 4166, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.4956650733947754  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.5042119026184082  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.512758731842041  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.5041446685791016  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

torch.Size([8962, 256])
first layer input nodes number: 23125
first layer output nodes number: 8962
edges number: 64045
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.5129332542419434  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.5215973854064941  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.5236167907714844  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.5236167907714844  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

m.shape torch.Size([356, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5478949546813965  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5478949546813965  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5485739707946777  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5547065734863281  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([327, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5549960136413574  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5549960136413574  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5556197166442871  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5674071311950684  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([287, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5679230690002441  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5679230690002441  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5684704780578613  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5859847068786621  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5866031646728516  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5866031646728516  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5870456695556641  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.5998783111572266  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6005897521972656  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6005897521972656  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6009597778320312  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6142807006835938  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6151165962219238  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6151165962219238  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6154541969299316  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6299710273742676  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6308450698852539  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6308450698852539  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6311407089233398  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6459226608276367  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([150, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6469283103942871  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6469283103942871  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.647214412689209  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6635222434997559  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6642875671386719  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6642875671386719  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6644878387451172  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6773052215576172  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6781086921691895  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6781086921691895  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6782879829406738  GigaBytes
Max Memory Allocated: 0.6796212196350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6910176277160645  GigaBytes
Max Memory Allocated: 0.6919140815734863  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6917634010314941  GigaBytes
Max Memory Allocated: 0.6919140815734863  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6917634010314941  GigaBytes
Max Memory Allocated: 0.6919140815734863  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.6919140815734863  GigaBytes
Max Memory Allocated: 0.6919140815734863  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.703667163848877  GigaBytes
Max Memory Allocated: 0.704495906829834  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7044224739074707  GigaBytes
Max Memory Allocated: 0.704495906829834  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7044224739074707  GigaBytes
Max Memory Allocated: 0.704495906829834  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7045598030090332  GigaBytes
Max Memory Allocated: 0.7045598030090332  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7162327766418457  GigaBytes
Max Memory Allocated: 0.7170567512512207  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7169513702392578  GigaBytes
Max Memory Allocated: 0.7170567512512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7169513702392578  GigaBytes
Max Memory Allocated: 0.7170567512512207  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.717071533203125  GigaBytes
Max Memory Allocated: 0.717071533203125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7281265258789062  GigaBytes
Max Memory Allocated: 0.728907585144043  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7288203239440918  GigaBytes
Max Memory Allocated: 0.728907585144043  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7288203239440918  GigaBytes
Max Memory Allocated: 0.728907585144043  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7289271354675293  GigaBytes
Max Memory Allocated: 0.7289271354675293  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7395014762878418  GigaBytes
Max Memory Allocated: 0.7402491569519043  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7402844429016113  GigaBytes
Max Memory Allocated: 0.7402877807617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7402844429016113  GigaBytes
Max Memory Allocated: 0.7402877807617188  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7403950691223145  GigaBytes
Max Memory Allocated: 0.7403950691223145  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7521214485168457  GigaBytes
Max Memory Allocated: 0.7529511451721191  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7528815269470215  GigaBytes
Max Memory Allocated: 0.7529511451721191  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7528815269470215  GigaBytes
Max Memory Allocated: 0.7529511451721191  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7529826164245605  GigaBytes
Max Memory Allocated: 0.7529826164245605  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7644057273864746  GigaBytes
Max Memory Allocated: 0.7652144432067871  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7650904655456543  GigaBytes
Max Memory Allocated: 0.7652144432067871  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7650904655456543  GigaBytes
Max Memory Allocated: 0.7652144432067871  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7651762962341309  GigaBytes
Max Memory Allocated: 0.7652144432067871  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7754759788513184  GigaBytes
Max Memory Allocated: 0.7762055397033691  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7758831977844238  GigaBytes
Max Memory Allocated: 0.7762055397033691  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7758831977844238  GigaBytes
Max Memory Allocated: 0.7762055397033691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.775932788848877  GigaBytes
Max Memory Allocated: 0.7762055397033691  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7822308540344238  GigaBytes
Max Memory Allocated: 0.782677173614502  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7825899124145508  GigaBytes
Max Memory Allocated: 0.782677173614502  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7825899124145508  GigaBytes
Max Memory Allocated: 0.782677173614502  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7826299667358398  GigaBytes
Max Memory Allocated: 0.782677173614502  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7879972457885742  GigaBytes
Max Memory Allocated: 0.7883777618408203  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7885732650756836  GigaBytes
Max Memory Allocated: 0.7885756492614746  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7885732650756836  GigaBytes
Max Memory Allocated: 0.7885756492614746  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7886323928833008  GigaBytes
Max Memory Allocated: 0.7886323928833008  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7969694137573242  GigaBytes
Max Memory Allocated: 0.7975606918334961  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7973842620849609  GigaBytes
Max Memory Allocated: 0.7975606918334961  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7973842620849609  GigaBytes
Max Memory Allocated: 0.7975606918334961  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7974262237548828  GigaBytes
Max Memory Allocated: 0.7975606918334961  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8036365509033203  GigaBytes
Max Memory Allocated: 0.8040771484375  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8039965629577637  GigaBytes
Max Memory Allocated: 0.8040771484375  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8039965629577637  GigaBytes
Max Memory Allocated: 0.8040771484375  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8040308952331543  GigaBytes
Max Memory Allocated: 0.8040771484375  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8093523979187012  GigaBytes
Max Memory Allocated: 0.809730052947998  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8096671104431152  GigaBytes
Max Memory Allocated: 0.809730052947998  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8096671104431152  GigaBytes
Max Memory Allocated: 0.809730052947998  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8096957206726074  GigaBytes
Max Memory Allocated: 0.809730052947998  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8143305778503418  GigaBytes
Max Memory Allocated: 0.814659595489502  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8146853446960449  GigaBytes
Max Memory Allocated: 0.8146867752075195  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8146853446960449  GigaBytes
Max Memory Allocated: 0.8146867752075195  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8147158622741699  GigaBytes
Max Memory Allocated: 0.8147158622741699  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.8198733329772949  GigaBytes
Max Memory Allocated: 0.8202395439147949  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([275, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.8264660835266113  GigaBytes
Max Memory Allocated: 0.8264918327331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.8264660835266113  GigaBytes
Max Memory Allocated: 0.8264918327331543  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.8269906044006348  GigaBytes
Max Memory Allocated: 0.8269906044006348  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.9218153953552246  GigaBytes
Max Memory Allocated: 0.9283719062805176  GigaBytes

rst.shape  torch.Size([1, 275, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.9006485939025879  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.9010848999023438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.9015212059020996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.9010629653930664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2927, 40])
input nodes number: 8962
output nodes number: 2927
edges number: 24769
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.9011654853820801  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.9011659622192383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.019649028778076172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 2 input nodes size: 13707
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.017730712890625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.017730712890625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.024266719818115234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.024288654327392578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.012547969818115234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.013003826141357422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.013003826141357422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.013003826141357422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([13707, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.013003826141357422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([597, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03335714340209961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03335714340209961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03392648696899414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03848123550415039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([626, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03879356384277344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03879356384277344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.03939056396484375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04891824722290039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([575, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.049442291259765625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.049442291259765625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.04999065399169922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06231975555419922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([506, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06301069259643555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06301069259643555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.06349325180053711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07748746871948242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([462, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07834768295288086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07834768295288086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.07878828048706055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0946497917175293  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([365, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0954737663269043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.0954737663269043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.09582185745239258  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11078977584838867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([321, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11168718338012695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11168718338012695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.11199331283569336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.12729978561401367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([289, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1282491683959961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1282491683959961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1285247802734375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.14423465728759766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([243, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1451396942138672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1451396942138672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1453714370727539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1602029800415039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([2295, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.17103052139282227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.17103052139282227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 2295, 128]), torch.Size([1, 2295, 128])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.1732192039489746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.33603525161743164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 2295, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3182811737060547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.32426929473876953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3302574157714844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3242220878601074  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([6279, 256])
first layer input nodes number: 13707
first layer output nodes number: 6279
edges number: 39794
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.33036184310913086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3363499641418457  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.33814430236816406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.33814430236816406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([435, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.35922765731811523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.35922765731811523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36005735397338867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36678123474121094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([399, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36713361740112305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36713361740112305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.36789464950561523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37931013107299805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([322, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37985849380493164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.37985849380493164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.38047266006469727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39412546157836914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3948535919189453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3948535919189453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.39534759521484375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.40996265411376953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([227, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.41080665588378906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.41080665588378906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4112396240234375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42682647705078125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42754459381103516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.42754459381103516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4278535842895508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.44114017486572266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4418606758117676  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4418606758117676  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4421086311340332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.45450639724731445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4551362991333008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4551362991333008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4553232192993164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.46597766876220703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.46665430068969727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.46665430068969727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4668240547180176  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4776883125305176  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.47829580307006836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.47829580307006836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.47843313217163086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.48818349838256836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4887704849243164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4887704849243164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4888887405395508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.49811267852783203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.49884939193725586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.49884939193725586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.4989809989929199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5101675987243652  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5107517242431641  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5107517242431641  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5108509063720703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5199756622314453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5205183029174805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5205183029174805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5206022262573242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5289106369018555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.529416561126709  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.529416561126709  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5294890403747559  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5371718406677246  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5375356674194336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5375356674194336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5375852584838867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5431890487670898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.543703556060791  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.543703556060791  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5437664985656738  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5513195991516113  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5518245697021484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5518245697021484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5518836975097656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5593929290771484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5597653388977051  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5597653388977051  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.559807300567627  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5654301643371582  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5658516883850098  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5658516883850098  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5658955574035645  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5720810890197754  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.572664737701416  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.572664737701416  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5727219581604004  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5811905860900879  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.581606388092041  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.581606388092041  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5816464424133301  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5878548622131348  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5884318351745605  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5884318351745605  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5884833335876465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5968260765075684  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5971465110778809  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.5971465110778809  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.597175121307373  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6020102500915527  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([198, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6067538261413574  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6067538261413574  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.6071314811706543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.6735987663269043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 198, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.6557092666625977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.6561393737792969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.6565694808959961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.6561174392700195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2884, 40])
input nodes number: 6279
output nodes number: 2884
edges number: 21365
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.6561803817749023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.6561808586120605  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.013890266418457031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 3 input nodes size: 10618
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012541770935058594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012541770935058594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.01772451400756836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.0177459716796875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011188030242919922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011577129364013672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011577129364013672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011577129364013672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([10618, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011577129364013672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([612, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.027798175811767578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.027798175811767578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.028381824493408203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03360748291015625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([634, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.0339202880859375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.0339202880859375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03452491760253906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04408407211303711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([587, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04462146759033203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04462146759033203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.0451812744140625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.05792999267578125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([556, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.058710575103759766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.058710575103759766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.05924081802368164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07461786270141602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([445, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07541370391845703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07541370391845703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07583808898925781  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09111595153808594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([374, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09197378158569336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09197378158569336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.0923304557800293  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.10766744613647461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([332, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1085972785949707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1085972785949707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 332, 128]), torch.Size([1, 332, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.10891389846801758  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.12474489212036133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 332, 128])
m.shape torch.Size([289, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.12568902969360352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.12568902969360352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.12596464157104492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14167451858520508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([251, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14294004440307617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14294004440307617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14317941665649414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.15849924087524414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 251, 128])
m.shape torch.Size([1522, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.16563701629638672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.16563701629638672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 1522, 128]), torch.Size([1, 1522, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.16708850860595703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.27080631256103516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 1522, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2571697235107422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2628812789916992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.26822376251220703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2624702453613281  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([5602, 256])
first layer input nodes number: 10618
first layer output nodes number: 5602
edges number: 32449
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.26793575286865234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2736473083496094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2753915786743164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2753915786743164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.29559850692749023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.29559850692749023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.29639196395874023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.304318904876709  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3046450614929199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3046450614929199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3053622245788574  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3166046142578125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([314, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3171515464782715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3171515464782715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3177504539489746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33141279220581055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([268, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33214378356933594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33214378356933594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3326549530029297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3483467102050781  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.34911489486694336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.34911489486694336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3495211601257324  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.36414670944213867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([178, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.36497020721435547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.36497020721435547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3653097152709961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.37990856170654297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([159, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38080883026123047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38080883026123047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38111209869384766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39627552032470703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39711618423461914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39711618423461914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39736223220825195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41138696670532227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41228485107421875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41228485107421875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4125099182128906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4269142150878906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42769575119018555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42769575119018555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4278731346130371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.44046735763549805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.44118261337280273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.44118261337280273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4413275718688965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.452634334564209  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4534616470336914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4534616470336914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4536104202270508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.46625614166259766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4670567512512207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4670567512512207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4671902656555176  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4794735908508301  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48006629943847656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48006629943847656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4801597595214844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4894123077392578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49002885818481445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49002885818481445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49011659622192383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4994168281555176  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4999265670776367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4999265670776367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49999523162841797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5077543258666992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5081615447998047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5081615447998047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5082130432128906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5143928527832031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5148172378540039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5148172378540039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.514866828918457  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5211648941040039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.521669864654541  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.521669864654541  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5217251777648926  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.529137134552002  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5294942855834961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5294942855834961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5295324325561523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5349111557006836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5351343154907227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5351343154907227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5351572036743164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5385446548461914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5389142036437988  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5389142036437988  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5389485359191895  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5442700386047363  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5444521903991699  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5444521903991699  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5444693565368652  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5472502708435059  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5475649833679199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5475649833679199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5475916862487793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5521044731140137  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([101, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5545182228088379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5545182228088379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.554710865020752  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.588615894317627  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 101, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5716552734375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5720839500427246  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5725126266479492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5720624923706055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2875, 40])
input nodes number: 5602
output nodes number: 2875
edges number: 19680
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5721244812011719  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5721249580383301  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012349128723144531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 4 input nodes size: 11706
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011186599731445312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011186599731445312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.017722606658935547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.017744064331054688  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012539863586425781  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012887954711914062  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012887954711914062  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012887954711914062  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([11706, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012887954711914062  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([731, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.028029918670654297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.028029918670654297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 731, 128]), torch.Size([1, 731, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.028727054595947266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.034304141998291016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 731, 128])
m.shape torch.Size([792, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03471088409423828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03471088409423828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03546619415283203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.047448158264160156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([689, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.048070430755615234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.048070430755615234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04872751235961914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.06379938125610352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([585, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.06458663940429688  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.06458663940429688  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.06514453887939453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.08220863342285156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([475, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.08306217193603516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.08306217193603516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.08351516723632812  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.099822998046875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([385, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.10069799423217773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.10069799423217773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 385, 128]), torch.Size([1, 385, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.10106515884399414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.11685323715209961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 385, 128])
m.shape torch.Size([299, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.11766767501831055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.11766767501831055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.11795282363891602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.13221025466918945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([259, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1330556869506836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1330556869506836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1333026885986328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14738178253173828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([234, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14826250076293945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14826250076293945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14848566055297852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.16276788711547852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([1241, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.16857385635375977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.16857385635375977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 1241, 128]), torch.Size([1, 1241, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.16975736618041992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.25574445724487305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 1241, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.24340391159057617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.24883031845092773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2542567253112793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.24878787994384766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([5690, 256])
first layer input nodes number: 11706
first layer output nodes number: 5690
edges number: 30088
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2543458938598633  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.25977230072021484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.26112890243530273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.26112890243530273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([509, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2775416374206543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2775416374206543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.27851247787475586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.28668642044067383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([463, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2870912551879883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2870912551879883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.28797435760498047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3013725280761719  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([358, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3022956848144531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3022956848144531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.302978515625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3185749053955078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([289, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.31934499740600586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.31934499740600586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.31989622116088867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33588171005249023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([233, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33672618865966797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33672618865966797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3371706008911133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.35316944122314453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([184, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.35405826568603516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.35405826568603516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.35440921783447266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.36950016021728516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.37023305892944336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.37023305892944336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.37049055099487305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3833651542663574  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3840360641479492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3840360641479492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3842344284057617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3955411911010742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39622068405151367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39622068405151367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3963923454284668  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4073786735534668  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4080233573913574  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4080233573913574  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40816831588745117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4184603691101074  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4190225601196289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4190225601196289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41913700103759766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42806339263916016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4284677505493164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4284677505493164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4285440444946289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4350290298461914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4355158805847168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4355158805847168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4355959892272949  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4429659843444824  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.44338369369506836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.44338369369506836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.443448543548584  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.44986867904663086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.45029783248901367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.45029783248901367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.45035886764526367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.45682859420776367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4570598602294922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4570598602294922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.45709228515625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4607563018798828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4611978530883789  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4611978530883789  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.46125125885009766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.46765995025634766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.46808338165283203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.46808338165283203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.46813297271728516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47443103790283203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47458887100219727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47458887100219727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4746079444885254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47716379165649414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4774618148803711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4774618148803711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4774923324584961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4817953109741211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4819822311401367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4819822311401367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48200130462646484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48482418060302734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48496294021606445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48496294021606445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48497629165649414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4870457649230957  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4872603416442871  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4872603416442871  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48727941513061523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4903693199157715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49059057235717773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49059057235717773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49060964584350586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.493833065032959  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([78, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4956979751586914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4956979751586914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4958467483520508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5220308303833008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 78, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5089383125305176  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5093650817871094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5097918510437012  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5093436241149902  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2861, 40])
input nodes number: 5690
output nodes number: 2861
edges number: 16433
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5094056129455566  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5094060897827148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.01360464096069336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 5 input nodes size: 9830
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012537956237792969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012537956237792969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.017720699310302734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.017742633819580078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011185169219970703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.01152181625366211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.01152181625366211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.01152181625366211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([9830, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.01152181625366211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([685, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.025894641876220703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.025894641876220703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.026547908782958984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.031774044036865234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([793, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03220367431640625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03220367431640625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.032959938049316406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.045267581939697266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([662, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.045836448669433594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.045836448669433594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04646778106689453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.060461997985839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 662, 128])
m.shape torch.Size([566, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.06122589111328125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.06122589111328125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.06176567077636719  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07741928100585938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([506, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07835578918457031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07835578918457031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07883834838867188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09621047973632812  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([413, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09715080261230469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09715080261230469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09754467010498047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.11448097229003906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([324, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.11613035202026367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.11613035202026367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 324, 128]), torch.Size([1, 324, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1164393424987793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.13188886642456055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 324, 128])
m.shape torch.Size([253, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.13269948959350586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.13269948959350586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.13294076919555664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14669370651245117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([225, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1475386619567871  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1475386619567871  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14775323867797852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.16148614883422852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 225, 128])
m.shape torch.Size([1072, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1664905548095703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1664905548095703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 1072, 128]), torch.Size([1, 1072, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1675128936767578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2402057647705078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 1072, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.22858667373657227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.23383092880249023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2390751838684082  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.23378992080688477  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([5499, 256])
first layer input nodes number: 9830
first layer output nodes number: 5499
edges number: 28566
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2391505241394043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.24439477920532227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2458362579345703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2458362579345703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([476, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.26226043701171875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.26226043701171875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2631683349609375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2714247703552246  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([462, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.27185916900634766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.27185916900634766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.27274036407470703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.28595829010009766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([347, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2866549491882324  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2866549491882324  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.28731679916381836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.30210447311401367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([274, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.30291128158569336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.30291128158569336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.303433895111084  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3185896873474121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([260, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.32003211975097656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.32003211975097656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3205280303955078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3383808135986328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([190, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33922863006591797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33922863006591797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33959102630615234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.35517406463623047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([167, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.35611677169799805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.35611677169799805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.35643529891967773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3723616600036621  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3730635643005371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3730635643005371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3732771873474121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3854537010192871  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38623809814453125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38623809814453125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38643455505371094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39900779724121094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39967870712280273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39967870712280273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39983129501342773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41066503524780273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4113292694091797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4113292694091797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41146278381347656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4218769073486328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42249107360839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42249107360839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4226036071777344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.43216896057128906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4327125549316406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4327125549316406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4328041076660156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4412269592285156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4417734146118164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4417734146118164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.44185733795166016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4501657485961914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4507007598876953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4507007598876953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4507770538330078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4588642120361328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4592876434326172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4592876434326172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.45934486389160156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.46581077575683594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.46601104736328125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.46601104736328125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4660377502441406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4692420959472656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4694709777832031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4694709777832031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4694976806640625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4728889465332031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4730219841003418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4730219841003418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4730372428894043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4750819206237793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47522830963134766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47522830963134766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47524356842041016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47739505767822266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47760963439941406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47760963439941406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.477630615234375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48073577880859375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4808945655822754  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4808945655822754  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4809098243713379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4832749366760254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4834442138671875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4834442138671875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48345947265625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.485931396484375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4861316680908203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4861316680908203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4861488342285156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.48904991149902344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([52, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49029111862182617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49029111862182617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4903903007507324  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5078463554382324  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 52, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4947681427001953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49519968032836914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49563121795654297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4951777458190918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2894, 40])
input nodes number: 5499
output nodes number: 2894
edges number: 16476
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49524545669555664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49524593353271484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.012215614318847656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 6 input nodes size: 10416
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011189937591552734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011189937591552734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.016156673431396484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.016178607940673828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.010973930358886719  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011260986328125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011260986328125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011260986328125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([10416, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011260986328125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([969, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.024292945861816406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.024292945861816406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.025217056274414062  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03260993957519531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 969, 128])
m.shape torch.Size([923, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03302812576293945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03302812576293945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.03390836715698242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.047437191009521484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([763, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04820442199707031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04820442199707031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04893207550048828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.06586170196533203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([588, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.0666193962097168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.0666193962097168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 588, 128]), torch.Size([1, 588, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.06718015670776367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.0836939811706543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 588, 128])
m.shape torch.Size([418, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.08441019058227539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.08441019058227539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.0848088264465332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09915971755981445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([353, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09997034072875977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09997034072875977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 353, 128]), torch.Size([1, 353, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.10030698776245117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.11478281021118164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 353, 128])
m.shape torch.Size([291, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1155858039855957  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1155858039855957  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 291, 128]), torch.Size([1, 291, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.11586332321166992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.12973928451538086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 291, 128])
m.shape torch.Size([226, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.130462646484375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.130462646484375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 226, 128]), torch.Size([1, 226, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1306781768798828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14296340942382812  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 226, 128])
m.shape torch.Size([169, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14358091354370117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14358091354370117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14374208450317383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.15405702590942383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 169, 128])
m.shape torch.Size([848, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.15802001953125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.15802001953125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1588287353515625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.21636962890625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 848, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.20633554458618164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.21162652969360352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2169175148010254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.21158504486083984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([5548, 256])
first layer input nodes number: 10416
first layer output nodes number: 5548
edges number: 25510
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2169971466064453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2222881317138672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.22387027740478516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.22387027740478516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([687, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2370305061340332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2370305061340332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 687, 256]), torch.Size([1, 687, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2383408546447754  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.24889802932739258  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 687, 256])
m.shape torch.Size([549, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.24999094009399414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.24999094009399414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2510380744934082  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.26772165298461914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 549, 256])
m.shape torch.Size([416, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.26839780807495117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.26839780807495117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.26919126510620117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2875971794128418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([288, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.28830766677856445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.28830766677856445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.28885698318481445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.30478715896606445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.30553340911865234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.30553340911865234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.30592823028564453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3201417922973633  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.32079219818115234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.32079219818115234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3210725784301758  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3331289291381836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33374929428100586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33374929428100586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.33396482467651367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3447413444519043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([100, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.34540271759033203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.34540271759033203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3455934524536133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.35646533966064453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([62, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3569064140319824  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3569064140319824  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3570246696472168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3645930290222168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3651299476623535  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3651299476623535  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3652482032775879  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3736443519592285  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([40, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3740081787109375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3740081787109375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.37408447265625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.380035400390625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38047027587890625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38047027587890625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38054847717285156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3871955871582031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([24, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38745641708374023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38745641708374023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.38750219345092773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39171361923217773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.392000675201416  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.392000675201416  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3920445442199707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.39638757705688477  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3966975212097168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3966975212097168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.3967413902282715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40139150619506836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4015388488769531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4015388488769531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40155982971191406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4039306640625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40419816970825195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40419816970825195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40423059463500977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40812158584594727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40820932388305664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40820932388305664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4082207679748535  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40967416763305664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4098329544067383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4098329544067383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4098501205444336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41215038299560547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41223812103271484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41223812103271484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4122476577758789  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4135923385620117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4137897491455078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4137897491455078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41380882263183594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41663169860839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4166860580444336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4166860580444336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41669178009033203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41757869720458984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41764259338378906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41764259338378906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4176483154296875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4185752868652344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4186420440673828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4186420440673828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41864776611328125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4196147918701172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([33, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42040491104125977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42040491104125977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4204678535461426  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4315457344055176  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 33, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42191410064697266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42234373092651367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4227733612060547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42232179641723633  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2882, 40])
input nodes number: 5548
output nodes number: 2882
edges number: 12868
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42238330841064453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42238378524780273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.011878013610839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 7 input nodes size: 17824
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.010972023010253906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.010972023010253906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.019471168518066406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.019492626190185547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.014503955841064453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.015052318572998047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.015052318572998047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.015052318572998047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([17824, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.015052318572998047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([598, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.039947509765625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.039947509765625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04051780700683594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.046320438385009766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([674, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04667806625366211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04667806625366211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.04732084274291992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.05696249008178711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([632, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.05754518508911133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.05754518508911133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.05814790725708008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07179689407348633  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([571, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07258462905883789  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07258462905883789  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.07312917709350586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.08923959732055664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([480, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09011173248291016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09011173248291016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.09056949615478516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.10704898834228516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([439, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.10807609558105469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.10807609558105469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.10849475860595703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1264972686767578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([375, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.12753963470458984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.12753963470458984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1278972625732422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14577865600585938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([403, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14713716506958008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.14713716506958008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1475214958190918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.16942834854125977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 403, 128])
m.shape torch.Size([326, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.17063522338867188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.17063522338867188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1709461212158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.1908435821533203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([3028, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.20512676239013672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.20512676239013672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 3028, 128]), torch.Size([1, 3028, 128])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.20801448822021484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4228329658508301  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 3028, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.40012216567993164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4072995185852051  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4144768714904785  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4072432518005371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([7526, 256])
first layer input nodes number: 17824
first layer output nodes number: 7526
edges number: 50223
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.41461181640625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.42178916931152344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4235835075378418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4235835075378418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([408, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4464864730834961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4464864730834961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4472646713256836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.45390892028808594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([372, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4542350769042969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4542350769042969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4549446105957031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4672889709472656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([253, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4676637649536133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4676637649536133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.46814632415771484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4787626266479492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47945594787597656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47945594787597656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.47991943359375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4933605194091797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49408531188964844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.49408531188964844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.4944648742675781  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5081291198730469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5088047981262207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5088047981262207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5090909004211426  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5213932991027832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5220646858215332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5220646858215332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5222954750061035  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5338349342346191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([152, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5348882675170898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5348882675170898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5351781845092773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5517034530639648  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5523285865783691  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5523285865783691  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5524983406066895  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5633625984191895  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5642004013061523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5642004013061523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5643835067749023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5773839950561523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5781068801879883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5781068801879883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5782537460327148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5897092819213867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([80, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5905585289001465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5905585289001465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.5907111167907715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6036810874938965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6042299270629883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6042299270629883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6043252944946289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6130990982055664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6136841773986816  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6136841773986816  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6137738227844238  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6226487159729004  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6232671737670898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6232671737670898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6233549118041992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.632655143737793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6331648826599121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6331648826599121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6332335472106934  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6409926414489746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6415467262268066  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6415467262268066  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6416153907775879  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6498551368713379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6504440307617188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6504440307617188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6505126953125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6592330932617188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6597285270690918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6597285270690918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6597838401794434  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6671957969665527  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6676106452941895  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6676106452941895  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6676545143127441  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6738400459289551  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6743836402893066  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6743836402893066  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6744370460510254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6823410987854004  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6829066276550293  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6829066276550293  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.682960033416748  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6912379264831543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6918082237243652  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6918082237243652  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.6918597221374512  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.700202465057373  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.7005000114440918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.7005000114440918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.7005267143249512  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.7050395011901855  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([235, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.7106728553771973  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.7106728553771973  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.7111210823059082  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7900090217590332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 235, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7708005905151367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7712292671203613  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7716579437255859  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7712078094482422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2875, 40])
input nodes number: 7526
output nodes number: 2875
edges number: 23290
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7712845802307129  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7712850570678711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.016107559204101562  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 8 input nodes size: 15328
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.014503002166748047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.014503002166748047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.021811962127685547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.021833419799804688  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013312816619873047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013908863067626953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013908863067626953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013908863067626953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([15328, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013908863067626953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([430, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.04087495803833008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.04087495803833008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.041285037994384766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.044565677642822266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([518, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.04485464096069336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.04485464096069336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.0453486442565918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.05321645736694336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([533, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.05373191833496094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.05373191833496094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.05424022674560547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.06558418273925781  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([479, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.06624364852905273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.06624364852905273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.06670045852661133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.07994794845581055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([465, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.08082818984985352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.08082818984985352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.08127164840698242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.09723615646362305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([406, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.0981760025024414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.0981760025024414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.09856319427490234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.11521244049072266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([394, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1163339614868164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1163339614868164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.11670970916748047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1354970932006836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([350, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1373429298400879  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1373429298400879  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.13767671585083008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.15670251846313477  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([292, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.15778875350952148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.15778875350952148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1580672264099121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1758894920349121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 292, 128])
m.shape torch.Size([3673, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.19402837753295898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.19402837753295898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 3673, 128]), torch.Size([1, 3673, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.19753122329711914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.44835805892944336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 3673, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4237241744995117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.43091487884521484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.43810558319091797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4308586120605469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([7540, 256])
first layer input nodes number: 15328
first layer output nodes number: 7540
edges number: 54658
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.43822193145751953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.44541263580322266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.44733715057373047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.44733715057373047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([305, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4718971252441406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4718971252441406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.47247886657714844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.47817039489746094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([323, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4785008430480957  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4785008430480957  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.47911691665649414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4887199401855469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.48920202255249023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.48920202255249023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.48972463607788086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5024847984313965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([221, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5030732154846191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5030732154846191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5034947395324707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.515718936920166  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([186, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5164022445678711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5164022445678711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5167570114135742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5295286178588867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5302915573120117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5302915573120117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5306024551391602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.543971061706543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.544858455657959  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.544858455657959  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5451540946960449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5599360466003418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5607571601867676  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5607571601867676  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.560997486114502  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5746960639953613  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5754928588867188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5754928588867188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5756950378417969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5886344909667969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5893411636352539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5893411636352539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5895013809204102  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6008768081665039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([110, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6019597053527832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6019597053527832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6021695137023926  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6185345649719238  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6192255020141602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6192255020141602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6193571090698242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6305437088012695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6313028335571289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6313028335571289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6314287185668945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.643010139465332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6438488960266113  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6438488960266113  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6439766883850098  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6566281318664551  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6575016975402832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6575016975402832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.657625675201416  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6707673072814941  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6714591979980469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6714591979980469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6715526580810547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6821136474609375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6826882362365723  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6826882362365723  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6827607154846191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6914582252502441  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6919755935668945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6919755935668945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6920366287231445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6997880935668945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7001962661743164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7001962661743164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7002420425415039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7063760757446289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7069683074951172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7069683074951172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7070293426513672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7156352996826172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7163114547729492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7163114547729492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7163782119750977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7262582778930664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7266693115234375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7266693115234375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7267093658447266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7329177856445312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7334065437316895  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7334065437316895  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7334504127502441  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7405571937561035  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.741112232208252  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.741112232208252  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7411599159240723  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7492184638977051  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([257, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7553701400756836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7553701400756836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.7558603286743164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8462686538696289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 257, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8247222900390625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8251481056213379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8255739212036133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8251266479492188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2856, 40])
input nodes number: 7540
output nodes number: 2856
edges number: 25114
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8252015113830566  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.8252019882202148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.01500558853149414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 9 input nodes size: 14403
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013309955596923828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013309955596923828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.020177841186523438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.020199298858642578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.012868881225585938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013398170471191406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013398170471191406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013398170471191406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([14403, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.013398170471191406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([512, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.03653287887573242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.03653287887573242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.03702116012573242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.04092741012573242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([505, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.04116487503051758  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.04116487503051758  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.041646480560302734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.04887056350708008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([534, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.049393653869628906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.049393653869628906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.049902915954589844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.06193828582763672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([495, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.06262779235839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.06262779235839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.06309986114501953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.07678985595703125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([455, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.07763862609863281  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.07763862609863281  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.07807254791259766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.09369373321533203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([390, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.09459257125854492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.09459257125854492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.09496450424194336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.11095762252807617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([363, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1119832992553711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1119832992553711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.11232948303222656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.129638671875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([332, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.13073205947875977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.13073205947875977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 332, 128]), torch.Size([1, 332, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.13104867935180664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.14909601211547852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 332, 128])
m.shape torch.Size([251, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.15001487731933594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.15001487731933594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1502542495727539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.1655740737915039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 251, 128])
m.shape torch.Size([2955, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.17954492568969727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.17954492568969727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 2955, 128]), torch.Size([1, 2955, 128])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.18236303329467773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.382448673248291  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 2955, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.3626575469970703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.36913490295410156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.3756122589111328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.36908388137817383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([6792, 256])
first layer input nodes number: 14403
first layer output nodes number: 6792
edges number: 46725
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.37572193145751953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.38229846954345703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.38398075103759766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.38398075103759766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([371, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4076957702636719  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4076957702636719  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4084033966064453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.41498565673828125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([302, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.41521263122558594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.41521263122558594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4157886505126953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4247918128967285  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.42536306381225586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.42536306381225586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.425931453704834  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.43950653076171875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4401531219482422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4401531219482422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4406147003173828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.45400047302246094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.45488548278808594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.45488548278808594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.45528221130371094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.46956443786621094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4703235626220703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4703235626220703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4706401824951172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4842548370361328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.48499155044555664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.48499155044555664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4852452278137207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.49792909622192383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.49864816665649414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.49864816665649414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.4988579750061035  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5108170509338379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5115947723388672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5115947723388672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5117893218994141  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5242404937744141  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([104, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5251431465148926  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5251431465148926  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5253415107727051  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5394253730773926  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([88, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5402569770812988  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5402569770812988  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5404248237609863  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5535168647766113  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.554171085357666  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.554171085357666  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.554293155670166  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.564669132232666  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5653953552246094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5653953552246094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5655155181884766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5765705108642578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5772104263305664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5772104263305664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5773096084594727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5871286392211914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5878868103027344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5878868103027344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5879936218261719  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5993156433105469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5999083518981934  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5999083518981934  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.5999884605407715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6090407371520996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6097850799560547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6097850799560547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6098766326904297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6208629608154297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.621370792388916  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.621370792388916  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.621431827545166  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.629183292388916  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6297192573547363  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6297192573547363  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6297783851623535  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6377015113830566  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.638267993927002  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.638267993927002  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6383271217346191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6466641426086426  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.647240161895752  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.647240161895752  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6472973823547363  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6557660102844238  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6560759544372559  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6560759544372559  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6561064720153809  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6608366966247559  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6611089706420898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6611089706420898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6611337661743164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6651506423950195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6655998229980469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6655998229980469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6656379699707031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6720848083496094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([255, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6781930923461914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6781930923461914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6786794662475586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7642812728881836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 255, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7438564300537109  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7442855834960938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7447147369384766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7442641258239746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2877, 40])
input nodes number: 6792
output nodes number: 2877
edges number: 24174
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7443399429321289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7443404197692871  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014404773712158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 10 input nodes size: 16185
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01287221908569336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01287221908569336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.020589828491210938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.02061176300048828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013722419738769531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014333724975585938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014333724975585938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014333724975585938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([16185, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014333724975585938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([554, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.0421299934387207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.0421299934387207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.042658329010009766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04771614074707031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([637, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04805946350097656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04805946350097656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.048666954040527344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05858039855957031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([629, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05917644500732422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05917644500732422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05977630615234375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07384872436523438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([599, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.0746912956237793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.0746912956237793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07526254653930664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09182882308959961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([575, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09291410446166992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09291410446166992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09346246719360352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11320352554321289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([495, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1146388053894043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1146388053894043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11511087417602539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13540983200073242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([443, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13665246963500977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13665246963500977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13707494735717773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.15819883346557617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([375, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.15941810607910156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.15941810607910156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1597757339477539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1801605224609375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([335, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.18141937255859375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.18141937255859375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.18173885345458984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.20218563079833984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([3514, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.2187819480895996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.2187819480895996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 3514, 128]), torch.Size([1, 3514, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.22213315963745117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4601731300354004  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 3514, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4354267120361328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4432048797607422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45098304748535156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4431438446044922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([8156, 256])
first layer input nodes number: 16185
first layer output nodes number: 8156
edges number: 56212
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45110559463500977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45888376235961914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4611210823059082  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4611210823059082  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([359, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.48717451095581055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.48717451095581055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.48785924911499023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.49424123764038086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([316, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4945063591003418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4945063591003418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.49510908126831055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5048670768737793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([283, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5053820610046387  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5053820610046387  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5059218406677246  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.517937183380127  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5185480117797852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5185480117797852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5189847946166992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.531651496887207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5323991775512695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5323991775512695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5327825546264648  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5465841293334961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5473904609680176  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5473904609680176  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5477204322814941  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5619091987609863  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5627131462097168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5627131462097168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5629878044128418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5767207145690918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5775141716003418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5775141716003418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5777449607849121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5908999443054199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5918316841125488  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5918316841125488  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5920624732971191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6068329811096191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6076979637145996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6076979637145996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6078925132751465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6217055320739746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6222429275512695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6222429275512695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6223573684692383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6312837600708008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6320223808288574  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6320223808288574  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6321539878845215  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6433405876159668  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6440119743347168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6440119743347168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6441245079040527  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.654477596282959  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6552152633666992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6552152633666992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6553277969360352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.666468620300293  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6670756340026855  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6670756340026855  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6671633720397949  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6764636039733887  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6768965721130371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6768965721130371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6769556999206543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6836371421813965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6844902038574219  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6844902038574219  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6845932006835938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6969528198242188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6975069046020508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6975069046020508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6975736618041992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7060518264770508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7064933776855469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7064933776855469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.70654296875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7131881713867188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7139902114868164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7139902114868164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7140722274780273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7256364822387695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.726161003112793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.726161003112793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7262144088745117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7341184616088867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7344727516174316  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7344727516174316  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7345070838928223  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7398285865783691  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7402315139770508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7402315139770508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7402677536010742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7461385726928711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7464666366577148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7464666366577148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.746495246887207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7513303756713867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7591533660888672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7591533660888672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7597541809082031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.8675012588500977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.8445296287536621  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.844965934753418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.8454022407531738  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.8449440002441406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2926, 40])
input nodes number: 8156
output nodes number: 2926
edges number: 25709
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.845034122467041  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.8450345993041992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.015480518341064453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 11 input nodes size: 16820
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013729572296142578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013729572296142578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.02174997329711914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.021770954132080078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014031410217285156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014491081237792969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014491081237792969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014491081237792969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([16820, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014491081237792969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([785, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.036950111389160156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.036950111389160156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.03769874572753906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.044391632080078125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([815, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.044794559478759766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.044794559478759766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04557180404663086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05812501907348633  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([724, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05877208709716797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05877208709716797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.059462547302246094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07465267181396484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([606, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07546329498291016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07546329498291016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 606, 128]), torch.Size([1, 606, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07604122161865234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09308910369873047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 606, 128])
m.shape torch.Size([495, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09398031234741211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09398031234741211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.0944523811340332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11144685745239258  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([426, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11242961883544922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11242961883544922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11283588409423828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13030529022216797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([320, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13117027282714844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13117027282714844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13147544860839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.14673423767089844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([342, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1478862762451172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1478862762451172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.14821243286132812  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.16680335998535156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([272, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.16780757904052734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.16780757904052734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.16806697845458984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.18466854095458984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 272, 128])
m.shape torch.Size([2394, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1959543228149414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1959543228149414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 2394, 128]), torch.Size([1, 2394, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.19823741912841797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3622574806213379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 2394, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3429136276245117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3497600555419922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.35660648345947266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.34970617294311523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([7179, 256])
first layer input nodes number: 16820
first layer output nodes number: 7179
edges number: 43406
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3567337989807129  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.36358022689819336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3659954071044922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3659954071044922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([548, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.38403940200805664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.38403940200805664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3850846290588379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3936305046081543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([438, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3939499855041504  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3939499855041504  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.39478540420532227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4090723991394043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([346, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.40999555587768555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.40999555587768555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.41065549850463867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4260392189025879  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.42667055130004883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.42667055130004883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.42714738845825195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4409756660461426  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.44165515899658203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.44165515899658203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4420194625854492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45513439178466797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45581769943237305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45581769943237305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4561038017272949  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.46840620040893555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([99, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4689292907714844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4689292907714844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4691181182861328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4785594940185547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.47928810119628906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.47928810119628906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4794921875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.49112510681152344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4918365478515625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4918365478515625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4920158386230469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5034904479980469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.504025936126709  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.504025936126709  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5041499137878418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5129523277282715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5134401321411133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5134401321411133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5135393142700195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.521275520324707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.521883487701416  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.521883487701416  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5219922065734863  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5312333106994629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5316915512084961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5316915512084961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5317697525024414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5389642715454102  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([24, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5392484664916992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5392484664916992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5392942428588867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5438261032104492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.544163703918457  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.544163703918457  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5442113876342773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5492658615112305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5496110916137695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5496110916137695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.549656867980957  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5548295974731445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5552315711975098  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5552315711975098  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5552811622619629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5612320899963379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5615882873535156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5615882873535156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5616302490234375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5669593811035156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5673403739929199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5673403739929199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5673823356628418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.573005199432373  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5733113288879395  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5733113288879395  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5733437538146973  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5779156684875488  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5782427787780762  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5782427787780762  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.578275203704834  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5830740928649902  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5832905769348145  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5832905769348145  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5833115577697754  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5865635871887207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5869731903076172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5869731903076172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5870094299316406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5928802490234375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5930466651916504  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5930466651916504  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5930619239807129  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5956406593322754  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([161, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5995016098022461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5995016098022461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5998086929321289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6538553237915039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 161, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6398181915283203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6402378082275391  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6406574249267578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6402168273925781  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2814, 40])
input nodes number: 7179
output nodes number: 2814
edges number: 18095
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6402750015258789  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6402754783630371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01538848876953125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 12 input nodes size: 15479
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014014720916748047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014014720916748047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.02139568328857422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.02141714096069336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01337575912475586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013840198516845703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013840198516845703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013840198516845703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([15479, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013840198516845703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([558, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.034313201904296875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.034313201904296875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.03484535217285156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.0398707389831543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([640, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04021501541137695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04021501541137695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04082536697387695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04998064041137695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([608, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05054521560668945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05054521560668945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05112504959106445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.06485795974731445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([536, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.06559038162231445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.06559038162231445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.0661015510559082  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.08136796951293945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([435, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.08214950561523438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.08214950561523438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.0825643539428711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09749889373779297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([415, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09847879409790039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09847879409790039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 415, 128]), torch.Size([1, 415, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09887456893920898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11589288711547852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 415, 128])
m.shape torch.Size([346, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11684989929199219  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11684989929199219  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11717987060546875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13367843627929688  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([317, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13472270965576172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13472270965576172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1350250244140625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.15225696563720703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([276, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1532902717590332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1532902717590332  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 276, 128]), torch.Size([1, 276, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.15355348587036133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.17039918899536133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 276, 128])
m.shape torch.Size([2330, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.18137788772583008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.18137788772583008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 2330, 128]), torch.Size([1, 2330, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.18402576446533203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3469419479370117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 2330, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3291325569152832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.335294246673584  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.34145593643188477  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.33524608612060547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([6461, 256])
first layer input nodes number: 15479
first layer output nodes number: 6461
edges number: 41213
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.34157323837280273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3477349281311035  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3492755889892578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3492755889892578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([387, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.37000131607055664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.37000131607055664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3707394599914551  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3767085075378418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([383, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3770756721496582  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3770756721496582  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3778061866760254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3890814781188965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([312, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3896160125732422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3896160125732422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3902111053466797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.40376996994018555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.40446901321411133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.40446901321411133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.40496301651000977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.41996049880981445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4206361770629883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4206361770629883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4210023880004883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4341859817504883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([186, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4350757598876953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4350757598876953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.43543052673339844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4506855010986328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45140981674194336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45140981674194336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45166540145874023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.464444637298584  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4652857780456543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4652857780456543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.46552610397338867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.47922468185424805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4801516532897949  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4801516532897949  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.48038244247436523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.49515295028686523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4958834648132324  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4958834648132324  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4960513114929199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5079684257507324  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([88, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5088152885437012  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5088152885437012  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5089831352233887  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5220751762390137  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.522799015045166  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.522799015045166  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5229325294494629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5342812538146973  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5351395606994629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5351395606994629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.535280704498291  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5482659339904785  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5488009452819824  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5488009452819824  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.548886775970459  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5573840141296387  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5579900741577148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5579900741577148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5580759048461914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.567173957824707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5675926208496094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5675926208496094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5676498413085938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5741157531738281  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.574495792388916  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.574495792388916  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5745434761047363  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5802655220031738  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5806918144226074  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5806918144226074  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5807414054870605  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5870394706726074  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5875992774963379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5875992774963379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5876603126525879  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5958390235900879  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5962891578674316  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5962891578674316  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.596336841583252  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.603060245513916  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6034402847290039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6034402847290039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6034784317016602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6091241836547852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6094226837158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6094226837158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6094512939453125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6138858795166016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6140484809875488  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6140484809875488  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6140637397766113  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6165356636047363  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6168279647827148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6168279647827148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6168527603149414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6210432052612305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([165, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6249957084655762  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6249957084655762  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6253104209899902  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6806998252868652  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 165, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6631364822387695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6635642051696777  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6639919281005859  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6635427474975586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2869, 40])
input nodes number: 6461
output nodes number: 2869
edges number: 21043
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6636204719543457  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6636209487915039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01476287841796875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 13 input nodes size: 17654
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013383865356445312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013383865356445312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.02180194854736328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.021823406219482422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01442098617553711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01497507095336914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01497507095336914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01497507095336914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([17654, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01497507095336914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([471, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.03965139389038086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04324483871459961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([526, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.043521881103515625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.043521881103515625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04402351379394531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.051854610443115234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([526, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05235624313354492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05235624313354492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05285787582397461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.06389379501342773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([457, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.0645146369934082  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.0645146369934082  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.06495046615600586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07758951187133789  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([439, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07905769348144531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07905769348144531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07947635650634766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09454822540283203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([345, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09532594680786133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09532594680786133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.09565496444702148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1098027229309082  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([328, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1107330322265625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1107330322265625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.11104583740234375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.12668609619140625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([328, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.12778091430664062  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.12778091430664062  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.12809371948242188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.14592361450195312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([277, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1469559669494629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1469559669494629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 277, 128]), torch.Size([1, 277, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.14722013473510742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.16412687301635742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 277, 128])
m.shape torch.Size([3240, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1794443130493164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.1794443130493164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 3240, 128]), torch.Size([1, 3240, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.18253421783447266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4019174575805664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 3240, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3801732063293457  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.38678884506225586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.393404483795166  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3867368698120117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([6937, 256])
first layer input nodes number: 17654
first layer output nodes number: 6937
edges number: 49007
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3935379981994629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.40015363693237305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.40269041061401367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.40269041061401367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([338, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.42739105224609375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.42739105224609375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4280357360839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.43396425247192383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([321, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.43425941467285156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.43425941467285156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4348716735839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4442329406738281  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.44475746154785156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.44475746154785156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.44530677795410156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45809078216552734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45873117446899414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.45873117446899414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4591851234436035  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4723496437072754  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.473050594329834  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.473050594329834  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4734187126159668  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.48667097091674805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4873061180114746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4873061180114746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.487576961517334  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4992232322692871  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5000367164611816  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5000367164611816  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5003056526184082  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5137524604797363  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5145716667175293  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5145716667175293  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.514808177947998  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5282893180847168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5291056632995605  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5291056632995605  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5293116569519043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5424952507019043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([106, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5434112548828125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5434112548828125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5436134338378906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5579681396484375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5586495399475098  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5586495399475098  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5587906837463379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5697999000549316  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.57061767578125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.57061767578125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5707645416259766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5832481384277344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5839743614196777  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5839743614196777  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5840964317321777  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5953269004821777  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5961003303527832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5961003303527832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5962185859680176  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6079258918762207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6086454391479492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6086454391479492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6087484359741211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6196660995483398  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6200761795043945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6200761795043945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6201333999633789  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6265993118286133  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6271753311157227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6271753311157227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6272459030151367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6357145309448242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6362676620483398  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6362676620483398  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6363325119018555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6445684432983398  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6450109481811523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6450109481811523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6450605392456055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6517057418823242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.652315616607666  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.652315616607666  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6523785591125488  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6612534523010254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6617469787597656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6617469787597656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6617965698242188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6691360473632812  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6697878837585449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6697878837585449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6698489189147949  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6793093681335449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6795444488525391  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6795444488525391  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6795673370361328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6832752227783203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6837253570556641  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6837253570556641  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6837635040283203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6902103424072266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([299, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6973757743835449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6973757743835449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6979460716247559  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7991385459899902  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 299, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7774662971496582  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.777895450592041  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7783246040344238  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7778739929199219  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2879, 40])
input nodes number: 6937
output nodes number: 2879
edges number: 25228
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7779488563537598  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.777949333190918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.01603984832763672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 14 input nodes size: 13681
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014422416687011719  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.014422416687011719  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.020946025848388672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.020967960357666016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.012528419494628906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013047218322753906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013047218322753906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013047218322753906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([13681, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.013047218322753906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([354, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.035279273986816406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.035279273986816406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 354, 128]), torch.Size([1, 354, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.03561687469482422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.03831768035888672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 354, 128])
m.shape torch.Size([428, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.03855705261230469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.03855705261230469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.03896522521972656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04508781433105469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([448, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04552459716796875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04552459716796875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.04595184326171875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05535125732421875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([455, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05600547790527344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05600547790527344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.05643939971923828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.06902313232421875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([416, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.06979799270629883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.06979799270629883  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.07019472122192383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.08447694778442383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([408, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.08544588088989258  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.08544588088989258  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.08583498001098633  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.10256624221801758  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([362, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.10357999801635742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.10357999801635742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.10392522811889648  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.12118673324584961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([331, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.12284183502197266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.12284183502197266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.12315750122070312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.14115047454833984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.14212560653686523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.14212560653686523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.14237737655639648  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.15849065780639648  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([2842, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.17191648483276367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.17191648483276367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 2842, 128]), torch.Size([1, 2842, 128])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.17462682723999023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3726496696472168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 2842, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3526921272277832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.35870790481567383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.36472368240356445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3586606979370117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([6308, 256])
first layer input nodes number: 13681
first layer output nodes number: 6308
edges number: 44880
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.36482763290405273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.37084341049194336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.372347354888916  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.372347354888916  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([276, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.39641475677490234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.39641475677490234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.3969411849975586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.40200138092041016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([297, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4023094177246094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4023094177246094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4028759002685547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.41181278228759766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([263, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.41228818893432617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.41228818893432617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.41278982162475586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4243025779724121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.42493247985839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.42493247985839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4253692626953125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4380359649658203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([229, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4389181137084961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4389181137084961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.43935489654541016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4550790786743164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([199, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4560084342956543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4560084342956543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.456387996673584  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.47270917892456055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([173, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.47368335723876953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.47368335723876953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4740133285522461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4905118942260742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4914236068725586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.4914236068725586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.49169063568115234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5069112777709961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.507634162902832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.507634162902832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5078229904174805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5199079513549805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([122, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5209865570068359  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5209865570068359  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5212192535400391  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5377407073974609  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([102, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5387029647827148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5387029647827148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5388975143432617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.554072380065918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5547595024108887  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5547595024108887  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5548892021179199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5659136772155762  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5667486190795898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5667486190795898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5668859481811523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5795202255249023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([71, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5804071426391602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5804071426391602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5805425643920898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5939493179321289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5945019721984863  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5945019721984863  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.5945839881896973  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6032776832580566  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6040363311767578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6040363311767578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6041355133056641  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6153430938720703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6161432266235352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6161432266235352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6162424087524414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6281442642211914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6287178993225098  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6287178993225098  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.628786563873291  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6375069618225098  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6379475593566895  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6379475593566895  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6379971504211426  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6446423530578613  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6454253196716309  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6454253196716309  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.645505428314209  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6568007469177246  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6573057174682617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6573057174682617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6573572158813477  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6649789810180664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6654396057128906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6654396057128906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6654834747314453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6722831726074219  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6726813316345215  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6726813316345215  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6727175712585449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6785883903503418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6790781021118164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6790781021118164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6791200637817383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6862115859985352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([201, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6910204887390137  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.6910204887390137  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.691403865814209  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2674560546875 GB
    Memory Allocated: 0.758878231048584  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 201, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2674560546875 GB
    Memory Allocated: 0.7378730773925781  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2674560546875 GB
    Memory Allocated: 0.7383027076721191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7387323379516602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7382807731628418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2883, 40])
input nodes number: 6308
output nodes number: 2883
edges number: 24630
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7383503913879395  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7383508682250977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.014027595520019531  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 15 input nodes size: 14957
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01252889633178711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01252889633178711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01966094970703125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01968240737915039  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.013136863708496094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.013647079467773438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.013647079467773438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.013647079467773438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([14957, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.013647079467773438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([454, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.036136627197265625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.036136627197265625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.03656959533691406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04003334045410156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([547, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04033851623535156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04033851623535156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04086017608642578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.0492711067199707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([586, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04984855651855469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04984855651855469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05040740966796875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.06304121017456055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([517, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.06374788284301758  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.06374788284301758  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.06424093246459961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.07934427261352539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([440, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.08014678955078125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.08014678955078125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.08056640625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.095672607421875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([407, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09662723541259766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09662723541259766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.097015380859375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11370563507080078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([388, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1148066520690918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1148066520690918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11517667770385742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13367795944213867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([307, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13466405868530273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13466405868530273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 307, 128]), torch.Size([1, 307, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13495683670043945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.15164518356323242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 307, 128])
m.shape torch.Size([313, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.15284204483032227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.15284204483032227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.15314054489135742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.17224454879760742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([2745, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.18518447875976562  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.18518447875976562  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 2745, 128]), torch.Size([1, 2745, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.18784570693969727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.37371206283569336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 2745, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3544192314147949  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3608126640319824  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3672060966491699  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3607625961303711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([6704, 256])
first layer input nodes number: 14957
first layer output nodes number: 6704
edges number: 45455
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.36731958389282227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.37406396865844727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.37531137466430664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.37531137466430664  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([319, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3977069854736328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3977069854736328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3983154296875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4039459228515625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([323, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4042630195617676  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4042630195617676  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.404879093170166  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4147038459777832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([304, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.41527271270751953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.41527271270751953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.41585254669189453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4290294647216797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4297671318054199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4297671318054199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4302706718444824  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.44591760635375977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4465789794921875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4465789794921875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4469413757324219  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4599876403808594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4607868194580078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4607868194580078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.46111106872558594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4750537872314453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([164, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4759950637817383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4759950637817383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.47630786895751953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.49194812774658203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([130, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.49279165267944336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.49279165267944336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.493039608001709  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5071730613708496  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([120, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.508087158203125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.508087158203125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5083160400390625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5229644775390625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5238018035888672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5238018035888672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5239906311035156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5373973846435547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([94, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.538297176361084  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.538297176361084  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5384764671325684  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5524611473083496  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5533404350280762  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5533404350280762  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5535006523132324  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5671191215515137  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5678763389587402  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5678763389587402  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5680041313171387  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5797610282897949  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5804510116577148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5804510116577148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5805578231811523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5911321640014648  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5916991233825684  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5916991233825684  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5917811393737793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6004748344421387  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6012029647827148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6012029647827148  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6012983322143555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6120748519897461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6126971244812012  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6126971244812012  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6127753257751465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.622159481048584  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6229162216186523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6229162216186523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6230039596557617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6341466903686523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.634650707244873  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.634650707244873  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6347079277038574  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6423754692077637  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6429429054260254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6429429054260254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6430020332336426  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.651339054107666  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6518344879150391  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6518344879150391  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6518840789794922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6592235565185547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6596431732177734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6596431732177734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6596832275390625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6658916473388672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6662478446960449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6662478446960449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6662802696228027  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6715331077575684  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6719093322753906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6719093322753906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6719417572021484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6774215698242188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([161, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6812739372253418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6812739372253418  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6815810203552246  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7356276512145996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 161, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.716343879699707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.716771125793457  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.717198371887207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7167496681213379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2867, 40])
input nodes number: 6704
output nodes number: 2867
edges number: 22850
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7168188095092773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7168192863464355  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.014620304107666016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 16 input nodes size: 24356
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.013134479522705078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.013134479522705078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.024853229522705078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.02487468719482422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.017721176147460938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01833629608154297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01833629608154297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01833629608154297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([24356, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01833629608154297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([739, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04923200607299805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04923200607299805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.049936771392822266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05569648742675781  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([906, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.056208133697509766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.056208133697509766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05707216262817383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.07029199600219727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([802, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.07100725173950195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.07100725173950195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.07177209854125977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.08859872817993164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([768, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.08968114852905273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.08968114852905273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09041357040405273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11165380477905273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([620, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11324071884155273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11324071884155273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11383199691772461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1353592872619629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([535, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13659429550170898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13659429550170898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13710451126098633  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1594681739807129  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([522, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.16139698028564453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.16139698028564453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1618947982788086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.18739986419677734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([487, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1890087127685547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1890087127685547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.18947315216064453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.21594619750976562  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([414, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.21749067306518555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.21749067306518555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.21788549423217773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.24315404891967773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([3671, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.26046133041381836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.26046133041381836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 3671, 128]), torch.Size([1, 3671, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.2642383575439453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.514737606048584  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 3671, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4873213768005371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.49634695053100586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5053725242614746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4962763786315918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([9464, 256])
first layer input nodes number: 24356
first layer output nodes number: 9464
edges number: 62325
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5055561065673828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5145816802978516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5168380737304688  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5168380737304688  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([455, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5367531776428223  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5367531776428223  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.537621021270752  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5451130867004395  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([431, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5455079078674316  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5455079078674316  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5463299751281738  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5596761703491211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([322, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5601940155029297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5601940155029297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5608081817626953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5754032135009766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5760536193847656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5760536193847656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5765285491943359  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.590301513671875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5911121368408203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5911121368408203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5915279388427734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6064968109130859  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6071481704711914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6071481704711914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6074323654174805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6196527481079102  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6202778816223145  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6202778816223145  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6204953193664551  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6313672065734863  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6321353912353516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6321353912353516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6323528289794922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6447467803955078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6454429626464844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6454429626464844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6456203460693359  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6569728851318359  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6577110290527344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6577110290527344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6578750610351562  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6695213317871094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6700000762939453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6700000762939453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6701011657714844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6779861450195312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6784892082214355  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6784892082214355  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6785807609558105  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6863627433776855  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6868796348571777  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6868796348571777  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6869654655456543  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.694861888885498  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6954917907714844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6954917907714844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.695587158203125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7050285339355469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7054281234741211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7054281234741211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7054872512817383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7117547988891602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7122945785522461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7122945785522461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7123651504516602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7203397750854492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7207784652709961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7207784652709961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7208337783813477  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7274713516235352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.728032112121582  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.728032112121582  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7280969619750977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.736332893371582  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7366113662719727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7366113662719727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7366437911987305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7409887313842773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7412610054016113  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7412610054016113  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7412896156311035  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.745323657989502  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7457332611083984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7457332611083984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7457733154296875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7517013549804688  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7519354820251465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7519354820251465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7519583702087402  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7555060386657715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7558927536010742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7558927536010742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7559270858764648  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7614889144897461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.761725902557373  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.761725902557373  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.761746883392334  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7652926445007324  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([194, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.770845890045166  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.770845890045166  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7712159156799316  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.8363404273986816  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 194, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.8195967674255371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.8200211524963379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.8204455375671387  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.8199996948242188  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2846, 40])
input nodes number: 9464
output nodes number: 2846
edges number: 20132
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.8200888633728027  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.8200893402099609  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01952505111694336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 17 input nodes size: 19762
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01771831512451172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01771831512451172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.027141571044921875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.027163028717041016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.015422821044921875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01585674285888672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01585674285888672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01585674285888672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([19762, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01585674285888672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([833, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.03718900680541992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.03718900680541992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.03798341751098633  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04504537582397461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([849, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04545783996582031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04545783996582031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04626750946044922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.058856964111328125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([756, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05959796905517578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05959796905517578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 756, 128]), torch.Size([1, 756, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.060318946838378906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.07618045806884766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 756, 128])
m.shape torch.Size([616, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.0769948959350586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.0769948959350586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.07758235931396484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09485340118408203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([529, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09582090377807617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09582090377807617  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09632539749145508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11511993408203125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([419, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11606645584106445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11606645584106445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 419, 128]), torch.Size([1, 419, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11646604537963867  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13364839553833008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 419, 128])
m.shape torch.Size([397, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13477373123168945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13477373123168945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13515233993530273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1540827751159668  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([312, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.15508365631103516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.15508365631103516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 312, 128]), torch.Size([1, 312, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1553812026977539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.17234134674072266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 312, 128])
m.shape torch.Size([284, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.17341136932373047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.17341136932373047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.17368221282958984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.19101619720458984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 284, 128])
m.shape torch.Size([2240, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.20156192779541016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.20156192779541016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 2240, 128]), torch.Size([1, 2240, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.20369815826416016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.35792970657348633  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 2240, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3398308753967285  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.34673070907592773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.35363054275512695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3466763496398926  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([7235, 256])
first layer input nodes number: 19762
first layer output nodes number: 7235
edges number: 42653
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.35377979278564453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.36067962646484375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.36240482330322266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.36240482330322266  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([599, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.37787866592407227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.37787866592407227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 599, 256]), torch.Size([1, 599, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.37902116775512695  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.38846826553344727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 599, 256])
m.shape torch.Size([480, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.38881969451904297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.38881969451904297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.38973522186279297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.40370655059814453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([359, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4043846130371094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4043846130371094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.40506935119628906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4216732978820801  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4222579002380371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4222579002380371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4227175712585449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4360480308532715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.43686628341674805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.43686628341674805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.43728208541870117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.45225095748901367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.45296573638916016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.45296573638916016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.45327091217041016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.46639347076416016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4670753479003906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4670753479003906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4673118591308594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4791374206542969  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.47981882095336914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.47981882095336914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.48001718521118164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.49132394790649414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4920206069946289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4920206069946289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.49219608306884766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5034265518188477  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5040116310119629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5040116310119629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5041451454162598  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5136246681213379  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([48, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5140657424926758  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5140657424926758  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5141572952270508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5212984085083008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5216794013977051  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5216794013977051  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5217499732971191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5277485847473145  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.528200626373291  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.528200626373291  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5282750129699707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.535118579864502  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5354447364807129  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5354447364807129  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5354962348937988  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5405945777893066  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5409150123596191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5409150123596191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5409607887268066  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5458130836486816  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5462822914123535  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5462822914123535  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5463433265686035  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5532402992248535  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5535039901733398  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5535039901733398  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5535383224487305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5576581954956055  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5579180717468262  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5579180717468262  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5579485893249512  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5618243217468262  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5621199607849121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5621199607849121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5621523857116699  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5664973258972168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5667695999145508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5667695999145508  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.566798210144043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5708322525024414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5709595680236816  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5709595680236816  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5709729194641113  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5729489326477051  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5730695724487305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5730695724487305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5730810165405273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.574854850769043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5749378204345703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5749378204345703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5749454498291016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5761814117431641  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5762701034545898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5762701034545898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5762777328491211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5775671005249023  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([83, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5795578956604004  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5795578956604004  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5797162055969238  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6075787544250488  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 83, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5954642295837402  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5958852767944336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.596306324005127  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5958638191223145  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2824, 40])
input nodes number: 7235
output nodes number: 2824
edges number: 15366
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5959362983703613  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5959367752075195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.016745567321777344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 18 input nodes size: 21286
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.015419483184814453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.015419483184814453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.025569438934326172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.025591373443603516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01614665985107422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.016679763793945312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.016679763793945312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.016679763793945312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([21286, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.016679763793945312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([856, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04319190979003906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04319190979003906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04400825500488281  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05053901672363281  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([820, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05091285705566406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05091285705566406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05169486999511719  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.0639944076538086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([810, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.06476211547851562  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.06476211547851562  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.06553459167480469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.08252906799316406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([647, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.08337688446044922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.08337688446044922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.08399391174316406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.10232353210449219  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([663, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.10359573364257812  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.10359573364257812  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.10422801971435547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.12757253646850586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([551, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.12883281707763672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.12883281707763672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.12935829162597656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1526317596435547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([451, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.15387439727783203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.15387439727783203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.15430450439453125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1758098602294922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([391, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.17708635330200195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.17708635330200195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 391, 128]), torch.Size([1, 391, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1774592399597168  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1987137794494629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 391, 128])
m.shape torch.Size([318, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1998920440673828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1998920440673828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.2001953125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.2196044921875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 318, 128])
m.shape torch.Size([2918, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.2333669662475586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.2333669662475586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 2918, 128]), torch.Size([1, 2918, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.23614978790283203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.43424510955810547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 2918, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4113154411315918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.41935014724731445  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4273848533630371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.41928720474243164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([8425, 256])
first layer input nodes number: 21286
first layer output nodes number: 8425
edges number: 52462
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.42754554748535156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4355802536010742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.437589168548584  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.437589168548584  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([547, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.45655298233032227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.45655298233032227  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4575963020324707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4659428596496582  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([413, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4662151336669922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4662151336669922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.46700286865234375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4800243377685547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([330, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.48058223724365234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.48058223724365234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.48121166229248047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.49637556076049805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4969916343688965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4969916343688965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4974532127380371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5108389854431152  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([241, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5118279457092285  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5118279457092285  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5122876167297363  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5288357734680176  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([178, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.529632568359375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.529632568359375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5299720764160156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5445709228515625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5451951026916504  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5451951026916504  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5454201698303223  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.556673526763916  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5574455261230469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5574455261230469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5576648712158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5701675415039062  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.570897102355957  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.570897102355957  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5710821151733398  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5829229354858398  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5835132598876953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5835132598876953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.583648681640625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5932636260986328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5937671661376953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5937671661376953  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5938701629638672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6019039154052734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6025214195251465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6025214195251465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6026320457458496  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6120352745056152  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6127424240112305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6127424240112305  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.612858772277832  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6235628128051758  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6241774559020996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6241774559020996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6242728233337402  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6337141990661621  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6341567039489746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6341567039489746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6342215538024902  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6410956382751465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6414937973022461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6414937973022461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6415472030639648  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6475820541381836  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6478824615478516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6478824615478516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6479206085205078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6524982452392578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6527910232543945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6527910232543945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6528253555297852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6571855545043945  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6576070785522461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6576070785522461  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6576528549194336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6637868881225586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6641101837158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6641101837158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6641445159912109  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6689853668212891  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6691298484802246  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6691298484802246  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6691451072692871  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6714034080505371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.671628475189209  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.671628475189209  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6716494560241699  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6749014854431152  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6752228736877441  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6752228736877441  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6752514839172363  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6798863410949707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6800799369812012  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6800799369812012  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6800971031188965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6829981803894043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([157, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6867623329162598  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6867623329162598  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6870617866516113  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7397656440734863  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 157, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7241568565368652  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7245917320251465  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7250266075134277  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7245697975158691  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2917, 40])
input nodes number: 8425
output nodes number: 2917
edges number: 19050
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7246685028076172  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.7246689796447754  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.017749309539794922  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 19 input nodes size: 16018
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01616048812866211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.01616048812866211  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.023798465728759766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.02382040023803711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.013648509979248047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.014121532440185547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.014121532440185547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.014121532440185547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([16018, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.014121532440185547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([695, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.03653097152709961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.03653097152709961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 695, 128]), torch.Size([1, 695, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.03719377517700195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.042600154876708984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 695, 128])
m.shape torch.Size([762, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.042995452880859375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.042995452880859375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 762, 128]), torch.Size([1, 762, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.04372215270996094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.054622650146484375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 762, 128])
m.shape torch.Size([681, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05523347854614258  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.05523347854614258  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.055882930755615234  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.0705714225769043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([633, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.07145404815673828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.07145404815673828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.07205772399902344  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09034442901611328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([586, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09143972396850586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09143972396850586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.09199857711791992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1130375862121582  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([429, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11398553848266602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.11398553848266602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1143946647644043  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1319870948791504  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([390, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13308429718017578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13308429718017578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.13345623016357422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1520528793334961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([381, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1533203125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1533203125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.15368366241455078  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.1743946075439453  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([321, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.17559051513671875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.17559051513671875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.17589664459228516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.19548892974853516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([2226, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.20595026016235352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.20595026016235352  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 2226, 128]), torch.Size([1, 2226, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.20807313919067383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3622913360595703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 2226, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.34299421310424805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.34976911544799805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.35654401779174805  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3497161865234375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([7104, 256])
first layer input nodes number: 16018
first layer output nodes number: 7104
edges number: 43225
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.35666561126708984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.36344051361083984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3660154342651367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3660154342651367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([450, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.386258602142334  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.386258602142334  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3871169090270996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.3939833641052246  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.39427709579467773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.39427709579467773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.39499425888061523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4060072898864746  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([313, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4065513610839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4065513610839844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4071483612060547  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.42028236389160156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([274, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.42110633850097656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.42110633850097656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4216289520263672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.43774986267089844  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([228, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4385843276977539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4385843276977539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.43901920318603516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.45467472076416016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4553861618041992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4553861618041992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.45569324493408203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.46889781951904297  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([157, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4698009490966797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4698009490966797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.47010040283203125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4850730895996094  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.48580026626586914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.48580026626586914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.48601770401000977  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4984116554260254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4992804527282715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4992804527282715  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.4994959831237793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5132899284362793  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5140185356140137  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5140185356140137  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5141844749450684  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5259661674499512  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5265917778015137  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5265917778015137  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5267195701599121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5366873741149902  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5373501777648926  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5373501777648926  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5374703407287598  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5476841926574707  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5483613014221191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5483613014221191  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5484738349914551  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5588269233703613  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5594034194946289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5594034194946289  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5594930648803711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5683679580688477  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5688567161560059  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5688567161560059  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5689272880554199  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5764079093933105  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.576941967010498  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.576941967010498  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5770125389099121  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5849871635437012  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5855731964111328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5855731964111328  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5856456756591797  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5943431854248047  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5947742462158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5947742462158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5948257446289062  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6013660430908203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6018881797790527  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6018881797790527  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6019454002380371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6096129417419434  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6099882125854492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6099882125854492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6100282669067383  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6156759262084961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.615938663482666  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.615938663482666  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6159653663635254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6199173927307129  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6202850341796875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6202850341796875  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6203193664550781  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.625640869140625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6259555816650391  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6259555816650391  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6259841918945312  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6306190490722656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6309046745300293  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6309046745300293  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6309294700622559  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6351199150085449  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([134, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6383275985717773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6383275985717773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6385831832885742  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6835660934448242  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 134, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6665925979614258  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6670241355895996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6674556732177734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6670022010803223  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([2893, 40])
input nodes number: 7104
output nodes number: 2893
edges number: 20125
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6670737266540527  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.6670742034912109  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.015053749084472656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

pseudo mini batch 20 input nodes size: 37603
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.013645172119140625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.013645172119140625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.031575679779052734  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.03159666061401367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.023936748504638672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.024658679962158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.024658679962158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.024658679962158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([37603, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.024658679962158203  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([929, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.06519412994384766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.06519412994384766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.06608009338378906  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.07316780090332031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([920, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.07360219955444336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.07360219955444336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.07447957992553711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.08764028549194336  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([823, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.08880233764648438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.08880233764648438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.08958721160888672  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10702991485595703  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([709, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10798978805541992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10798978805541992  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.10866594314575195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.12913846969604492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([703, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.1304764747619629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.1304764747619629  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.13114690780639648  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.15564918518066406  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([565, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.15693044662475586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.15693044662475586  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.1574692726135254  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.18069982528686523  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([506, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.18211936950683594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.18211936950683594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.1826019287109375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.20672988891601562  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([480, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.20831966400146484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.20831966400146484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.20877742767333984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.23486995697021484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([421, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.23644781112670898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.23644781112670898  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 421, 128]), torch.Size([1, 421, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.23684930801391602  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.262545108795166  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 421, 128])
m.shape torch.Size([5385, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.2880220413208008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.2880220413208008  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 5385, 128]), torch.Size([1, 5385, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.2940177917480469  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6609621047973633  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 5385, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6245670318603516  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6354780197143555  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6463890075683594  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6353926658630371  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

torch.Size([11441, 256])
first layer input nodes number: 37603
first layer output nodes number: 11441
edges number: 80000
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6466712951660156  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6575822830200195  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6603102684020996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6603102684020996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

m.shape torch.Size([566, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6775388717651367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6775388717651367  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.6786184310913086  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.687619686126709  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([459, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.687962532043457  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.687962532043457  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.688838005065918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.702272891998291  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([304, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7027120590209961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7027120590209961  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7032918930053711  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7188901901245117  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([216, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7194309234619141  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7194309234619141  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7198429107666016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7317905426025391  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([223, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7326698303222656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7326698303222656  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7330951690673828  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7484073638916016  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.749053955078125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.749053955078125  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7493381500244141  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7615585327148438  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7621970176696777  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7621970176696777  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.762418270111084  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7734808921813965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7742929458618164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7742929458618164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7745218276977539  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7875680923461914  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7882237434387207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7882237434387207  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.788393497467041  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.799257755279541  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7997980117797852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.7997980117797852  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.799921989440918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8087244033813477  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8091487884521484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8091487884521484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8092365264892578  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8160800933837891  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8165326118469238  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8165326118469238  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8166146278381348  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8235859870910645  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8240575790405273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8240575790405273  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8241357803344727  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8313302993774414  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8317084312438965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8317084312438965  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8317675590515137  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8376212120056152  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8379092216491699  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8379092216491699  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8379511833190918  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8423991203308105  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8426399230957031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8426399230957031  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8426723480224609  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8463363647460938  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8466472625732422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8466472625732422  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8466854095458984  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8512630462646484  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8516592979431152  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8516592979431152  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8517050743103027  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8575186729431152  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8577880859375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8577880859375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.857818603515625  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.861907958984375  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8622965812683105  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8622965812683105  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8623366355895996  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8679842948913574  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8682065010070801  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8682065010070801  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8682293891906738  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8716168403625488  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8717746734619141  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8717746734619141  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8717899322509766  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8741550445556641  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8743906021118164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8743906021118164  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8744115829467773  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8778104782104492  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8780770301818848  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8780770301818848  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8780999183654785  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8819680213928223  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([132, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8851284980773926  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8851284980773926  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8853802680969238  GigaBytes
Max Memory Allocated: 0.9299345016479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.9296917915344238  GigaBytes
Max Memory Allocated: 0.932894229888916  GigaBytes

rst.shape  torch.Size([1, 132, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.916262149810791  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.9166741371154785  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.917086124420166  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.9166531562805176  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

torch.Size([2763, 40])
input nodes number: 11441
output nodes number: 2763
edges number: 16848
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.9167399406433105  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.9167404174804688  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.026055335998535156  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

pseudo mini batch 21 input nodes size: 41635
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.023917198181152344  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.023917198181152344  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.04377031326293945  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.04379129409790039  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.025839805603027344  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.027109146118164062  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.027109146118164062  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.027109146118164062  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

torch.Size([41635, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.3768310546875 GB
    Memory Allocated: 0.027109146118164062  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

m.shape torch.Size([564, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.09543991088867188  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.09543991088867188  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.095977783203125  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.10083627700805664  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([642, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.10117959976196289  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.10117959976196289  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.1017918586730957  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.11097574234008789  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([551, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.11145782470703125  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.11145782470703125  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.1119832992553711  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.12366199493408203  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([547, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.12444257736206055  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.12444257736206055  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.12496423721313477  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.14028120040893555  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([572, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.1423492431640625  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.1423492431640625  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.14289474487304688  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.16334152221679688  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([516, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.16454505920410156  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.16454505920410156  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.1650371551513672  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.18700218200683594  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([531, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.18852853775024414  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.18852853775024414  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.18903493881225586  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.21512508392333984  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([552, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.21697759628295898  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.21697759628295898  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.21750402450561523  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.24809789657592773  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([536, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.2501349449157715  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.2501349449157715  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.25064611434936523  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 0.28420400619506836  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([11415, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.3386359214782715  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.3386359214782715  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

 h.shape torch.Size([1, 11415, 128]), torch.Size([1, 11415, 128])
----------------------------------------3
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.34952211380004883  GigaBytes
Max Memory Allocated: 0.9380435943603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1235308647155762  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

rst.shape  torch.Size([1, 11415, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0591988563537598  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0748639106750488  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.090528964996338  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0747413635253906  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

torch.Size([16426, 256])
first layer input nodes number: 41635
first layer output nodes number: 16426
edges number: 138752
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.090841293334961  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.10650634765625  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1105408668518066  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1105408668518066  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

m.shape torch.Size([344, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.141275405883789  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.141275405883789  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1419315338134766  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1482391357421875  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([281, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.148451328277588  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.148451328277588  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1489872932434082  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.160585880279541  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([209, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1609206199645996  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1609206199645996  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1613192558288574  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1700892448425293  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([156, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.17048978805542  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.17048978805542  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1707873344421387  GigaBytes
Max Memory Allocated: 1.1782183647155762  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1794161796569824  GigaBytes
Max Memory Allocated: 1.18001127243042  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([150, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1799883842468262  GigaBytes
Max Memory Allocated: 1.18001127243042  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1799883842468262  GigaBytes
Max Memory Allocated: 1.18001127243042  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.180274486541748  GigaBytes
Max Memory Allocated: 1.180274486541748  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1905741691589355  GigaBytes
Max Memory Allocated: 1.1912894248962402  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([109, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1910600662231445  GigaBytes
Max Memory Allocated: 1.1912894248962402  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1910600662231445  GigaBytes
Max Memory Allocated: 1.1912894248962402  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.191267967224121  GigaBytes
Max Memory Allocated: 1.1912894248962402  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2002077102661133  GigaBytes
Max Memory Allocated: 1.200831413269043  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2007431983947754  GigaBytes
Max Memory Allocated: 1.200831413269043  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2007431983947754  GigaBytes
Max Memory Allocated: 1.200831413269043  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2009243965148926  GigaBytes
Max Memory Allocated: 1.2009243965148926  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.209984302520752  GigaBytes
Max Memory Allocated: 1.210618495941162  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2105860710144043  GigaBytes
Max Memory Allocated: 1.210618495941162  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2105860710144043  GigaBytes
Max Memory Allocated: 1.210618495941162  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2107577323913574  GigaBytes
Max Memory Allocated: 1.2107577323913574  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2205424308776855  GigaBytes
Max Memory Allocated: 1.221229076385498  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.22114896774292  GigaBytes
Max Memory Allocated: 1.221229076385498  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.22114896774292  GigaBytes
Max Memory Allocated: 1.221229076385498  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.221301555633545  GigaBytes
Max Memory Allocated: 1.221301555633545  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.231067180633545  GigaBytes
Max Memory Allocated: 1.2317538261413574  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2316060066223145  GigaBytes
Max Memory Allocated: 1.2317538261413574  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2316060066223145  GigaBytes
Max Memory Allocated: 1.2317538261413574  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2317280769348145  GigaBytes
Max Memory Allocated: 1.2317538261413574  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2403950691223145  GigaBytes
Max Memory Allocated: 1.2410054206848145  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2410531044006348  GigaBytes
Max Memory Allocated: 1.241055965423584  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2410531044006348  GigaBytes
Max Memory Allocated: 1.241055965423584  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.241182804107666  GigaBytes
Max Memory Allocated: 1.241182804107666  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2512993812561035  GigaBytes
Max Memory Allocated: 1.2520127296447754  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2519035339355469  GigaBytes
Max Memory Allocated: 1.2520127296447754  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2519035339355469  GigaBytes
Max Memory Allocated: 1.2520127296447754  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.25201416015625  GigaBytes
Max Memory Allocated: 1.25201416015625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2614173889160156  GigaBytes
Max Memory Allocated: 1.2620811462402344  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2619619369506836  GigaBytes
Max Memory Allocated: 1.2620811462402344  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2619619369506836  GigaBytes
Max Memory Allocated: 1.2620811462402344  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2620534896850586  GigaBytes
Max Memory Allocated: 1.2620811462402344  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2704763412475586  GigaBytes
Max Memory Allocated: 1.271071434020996  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2709555625915527  GigaBytes
Max Memory Allocated: 1.271071434020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2709555625915527  GigaBytes
Max Memory Allocated: 1.271071434020996  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2710299491882324  GigaBytes
Max Memory Allocated: 1.271071434020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2783942222595215  GigaBytes
Max Memory Allocated: 1.2789149284362793  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.278890609741211  GigaBytes
Max Memory Allocated: 1.2789149284362793  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.278890609741211  GigaBytes
Max Memory Allocated: 1.2789149284362793  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.278961181640625  GigaBytes
Max Memory Allocated: 1.278961181640625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2864418029785156  GigaBytes
Max Memory Allocated: 1.286971092224121  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2868833541870117  GigaBytes
Max Memory Allocated: 1.286971092224121  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2868833541870117  GigaBytes
Max Memory Allocated: 1.286971092224121  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.286942481994629  GigaBytes
Max Memory Allocated: 1.286971092224121  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.293623924255371  GigaBytes
Max Memory Allocated: 1.2940969467163086  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2940192222595215  GigaBytes
Max Memory Allocated: 1.2940969467163086  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2940192222595215  GigaBytes
Max Memory Allocated: 1.2940969467163086  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.2940688133239746  GigaBytes
Max Memory Allocated: 1.2940969467163086  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3000197410583496  GigaBytes
Max Memory Allocated: 1.3004412651062012  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3006696701049805  GigaBytes
Max Memory Allocated: 1.3006725311279297  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3006696701049805  GigaBytes
Max Memory Allocated: 1.3006725311279297  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3007440567016602  GigaBytes
Max Memory Allocated: 1.3007440567016602  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3101911544799805  GigaBytes
Max Memory Allocated: 1.3108606338500977  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3108482360839844  GigaBytes
Max Memory Allocated: 1.3108606338500977  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3108482360839844  GigaBytes
Max Memory Allocated: 1.3108606338500977  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3109207153320312  GigaBytes
Max Memory Allocated: 1.3109207153320312  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3206329345703125  GigaBytes
Max Memory Allocated: 1.3213214874267578  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3211545944213867  GigaBytes
Max Memory Allocated: 1.3213214874267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3211545944213867  GigaBytes
Max Memory Allocated: 1.3213214874267578  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3212099075317383  GigaBytes
Max Memory Allocated: 1.3213214874267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3290090560913086  GigaBytes
Max Memory Allocated: 1.3295621871948242  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3294053077697754  GigaBytes
Max Memory Allocated: 1.3295621871948242  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3294053077697754  GigaBytes
Max Memory Allocated: 1.3295621871948242  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3294453620910645  GigaBytes
Max Memory Allocated: 1.3295621871948242  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3353734016418457  GigaBytes
Max Memory Allocated: 1.3357939720153809  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3358187675476074  GigaBytes
Max Memory Allocated: 1.3358206748962402  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3358187675476074  GigaBytes
Max Memory Allocated: 1.3358206748962402  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3358607292175293  GigaBytes
Max Memory Allocated: 1.3358607292175293  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.34236478805542  GigaBytes
Max Memory Allocated: 1.3428263664245605  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3427200317382812  GigaBytes
Max Memory Allocated: 1.3428263664245605  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3427200317382812  GigaBytes
Max Memory Allocated: 1.3428263664245605  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.342752456665039  GigaBytes
Max Memory Allocated: 1.3428263664245605  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3480052947998047  GigaBytes
Max Memory Allocated: 1.3483781814575195  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3486580848693848  GigaBytes
Max Memory Allocated: 1.348660945892334  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3486580848693848  GigaBytes
Max Memory Allocated: 1.348660945892334  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3487133979797363  GigaBytes
Max Memory Allocated: 1.3487133979797363  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3580613136291504  GigaBytes
Max Memory Allocated: 1.3587250709533691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([683, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3744449615478516  GigaBytes
Max Memory Allocated: 1.3745088577270508  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3744449615478516  GigaBytes
Max Memory Allocated: 1.3745088577270508  GigaBytes

 h.shape torch.Size([1, 683, 256]), torch.Size([1, 683, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.3757476806640625  GigaBytes
Max Memory Allocated: 1.3757476806640625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.6092915534973145  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 683, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.5811595916748047  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.5815715789794922  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.5819835662841797  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.5815505981445312  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

torch.Size([2763, 40])
input nodes number: 16426
output nodes number: 2763
edges number: 31504
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.5816941261291504  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.5816946029663086  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.029324054718017578  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

pseudo mini batch 22 input nodes size: 38824
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.025839805603027344  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.025839805603027344  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.04435253143310547  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.04437398910522461  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.024499893188476562  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.025421142578125  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.025421142578125  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.025421142578125  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

torch.Size([38824, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.025421142578125  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

m.shape torch.Size([766, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.07600688934326172  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.07600688934326172  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 766, 128]), torch.Size([1, 766, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.0767374038696289  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.0825815200805664  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 766, 128])
m.shape torch.Size([875, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.08305072784423828  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.08305072784423828  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 875, 128]), torch.Size([1, 875, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.08388519287109375  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.09640216827392578  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 875, 128])
m.shape torch.Size([781, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.09734487533569336  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.09734487533569336  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 781, 128]), torch.Size([1, 781, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.09808969497680664  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.11469125747680664  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 781, 128])
m.shape torch.Size([701, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.11565589904785156  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.11565589904785156  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 701, 128]), torch.Size([1, 701, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.11632442474365234  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1365814208984375  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 701, 128])
m.shape torch.Size([719, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.13796138763427734  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.13796138763427734  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 719, 128]), torch.Size([1, 719, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.13864707946777344  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.16394281387329102  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 719, 128])
m.shape torch.Size([590, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.16528797149658203  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.16528797149658203  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.16585063934326172  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19068241119384766  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([549, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19223356246948242  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19223356246948242  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19275712966918945  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.21964168548583984  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([549, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.22147417068481445  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.22147417068481445  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.22199773788452148  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.25252389907836914  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([479, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2550392150878906  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2550392150878906  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2554960250854492  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2847318649291992  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([7530, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.32040929794311523  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.32040929794311523  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 7530, 128]), torch.Size([1, 7530, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.3275904655456543  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8374533653259277  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 7530, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7911157608032227  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8040275573730469  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8169393539428711  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8039264678955078  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

torch.Size([13539, 256])
first layer input nodes number: 38824
first layer output nodes number: 13539
edges number: 102644
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8172307014465332  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8301424980163574  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8336739540100098  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8336739540100098  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

m.shape torch.Size([484, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8543910980224609  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8543910980224609  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 484, 256]), torch.Size([1, 484, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8553142547607422  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8642454147338867  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 484, 256])
m.shape torch.Size([427, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8646049499511719  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8646049499511719  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8654193878173828  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8781223297119141  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([324, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8786497116088867  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8786497116088867  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.879267692565918  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8956766128540039  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([215, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8961944580078125  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8961944580078125  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8966045379638672  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9084968566894531  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9092626571655273  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9092626571655273  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9096479415893555  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.923518180847168  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9242773056030273  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9242773056030273  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9245920181274414  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9381246566772461  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9387478828430176  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9387478828430176  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9389691352844238  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9500317573547363  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9507365226745605  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9507365226745605  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9509387016296387  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9624629020690918  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9631147384643555  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9631147384643555  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9632806777954102  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9739007949829102  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9746155738830566  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9746155738830566  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9747738838195801  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9860138893127441  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9867386817932129  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9867386817932129  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9868836402893066  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9981904029846191  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9986486434936523  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9986486434936523  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9987363815307617  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0061941146850586  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.006537914276123  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.006537914276123  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0065970420837402  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0120368003845215  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0124244689941406  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0124244689941406  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0124835968017578  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0183372497558594  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0187835693359375  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0187835693359375  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0188465118408203  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0255184173583984  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0259947776794434  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0259947776794434  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0260577201843262  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.033170223236084  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0335474014282227  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0335474014282227  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.033595085144043  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0393171310424805  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.039656639099121  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.039656639099121  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0396966934204102  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.044783592224121  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.045074462890625  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.045074462890625  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0451068878173828  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0494518280029297  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0497817993164062  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0497817993164062  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0498161315917969  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.054656982421875  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0549631118774414  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0549631118774414  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0549936294555664  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0595102310180664  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0598969459533691  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0598969459533691  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0599331855773926  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0655503273010254  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0657978057861328  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0657978057861328  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0658206939697266  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.069528579711914  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0699787139892578  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0699787139892578  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.070016860961914  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0764636993408203  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([250, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0824518203735352  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0824518203735352  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0829286575317383  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1668519973754883  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 250, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1496868133544922  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1501126289367676  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.150538444519043  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1500911712646484  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

torch.Size([2857, 40])
input nodes number: 13539
output nodes number: 2857
edges number: 20937
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1502275466918945  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.1502280235290527  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.02713775634765625  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

pseudo mini batch 23 input nodes size: 32150
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.024513721466064453  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.024513721466064453  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.03984403610229492  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.03986501693725586  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.021330833435058594  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.022119522094726562  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.022119522094726562  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.022119522094726562  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

torch.Size([32150, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.022119522094726562  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

m.shape torch.Size([797, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.0646200180053711  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.0646200180053711  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.06538009643554688  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.0721883773803711  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([834, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.07260370254516602  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.07260370254516602  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.07339906692504883  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.08605432510375977  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([700, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.08665800094604492  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.08665800094604492  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 700, 128]), torch.Size([1, 700, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.0873255729675293  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.10201215744018555  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 700, 128])
m.shape torch.Size([645, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.10290861129760742  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.10290861129760742  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 645, 128]), torch.Size([1, 645, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.10352373123168945  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.12169408798217773  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 645, 128])
m.shape torch.Size([604, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.12282657623291016  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.12282657623291016  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.12340259552001953  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1446542739868164  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([529, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.14587974548339844  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.14587974548339844  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.14638423919677734  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.16862010955810547  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([505, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.17005348205566406  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.17005348205566406  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.17053508758544922  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19461536407470703  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([501, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19628572463989258  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.19628572463989258  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1967635154724121  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2239975929260254  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([407, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.22550535202026367  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.22550535202026367  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.22589349746704102  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.250734806060791  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([6151, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.27987098693847656  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.27987098693847656  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 6151, 128]), torch.Size([1, 6151, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2857370376586914  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7022266387939453  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 6151, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.6635994911193848  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.6753048896789551  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.6870102882385254  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.6752176284790039  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

torch.Size([11673, 256])
first layer input nodes number: 32150
first layer output nodes number: 11673
edges number: 86055
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.6872520446777344  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.6989574432373047  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7017407417297363  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7017407417297363  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

m.shape torch.Size([493, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7212753295898438  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7212753295898438  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7222156524658203  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7298822402954102  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([451, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7302794456481934  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7302794456481934  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7311396598815918  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7453188896179199  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7457079887390137  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7457079887390137  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7462496757507324  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7593441009521484  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([210, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7598810195922852  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7598810195922852  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7602815628051758  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7718973159790039  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7726197242736816  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7726197242736816  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7729859352111816  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7861695289611816  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7868576049804688  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7868576049804688  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.7871456146240234  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.799530029296875  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8001799583435059  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8001799583435059  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8004050254821777  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8116583824157715  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8123536109924316  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8123536109924316  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.812553882598877  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8239693641662598  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8245787620544434  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8245787620544434  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.824735164642334  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.834744930267334  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8353300094604492  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8353300094604492  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8354616165161133  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8448057174682617  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8454484939575195  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8454484939575195  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.845576286315918  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8555440902709961  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8559994697570801  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8559994697570801  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8560853004455566  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8633809089660645  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8637881278991699  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8637881278991699  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8638567924499512  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8701739311218262  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8705167770385742  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8705167770385742  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.870570182800293  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8758573532104492  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8762059211730957  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8762059211730957  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8762555122375488  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8815121650695801  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8817949295043945  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8817949295043945  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8818330764770508  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.886143684387207  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8864841461181641  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8864841461181641  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8865261077880859  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8915615081787109  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8918867111206055  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8918867111206055  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8919248580932617  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8967695236206055  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8972253799438477  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8972253799438477  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.8972749710083008  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9039201736450195  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9043378829956055  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9043378829956055  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9043817520141602  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9105672836303711  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9108481407165527  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9108481407165527  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9108767509460449  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9151110649108887  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9154562950134277  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9154562950134277  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9154887199401855  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9205145835876465  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9205870628356934  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9205870628356934  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9205946922302246  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9218306541442871  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9221038818359375  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9221038818359375  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9221267700195312  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.925994873046875  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([242, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9317984580993652  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9317984580993652  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9322600364685059  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 1.0134978294372559  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 242, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9979715347290039  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.998382568359375  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9987936019897461  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9983615875244141  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

torch.Size([2758, 40])
input nodes number: 11673
output nodes number: 2758
edges number: 19701
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9984550476074219  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.9984555244445801  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.023573875427246094  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

pseudo mini batch 24 input nodes size: 51064
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.021316051483154297  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.021316051483154297  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.04566526412963867  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.04568624496459961  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.030334949493408203  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.0318608283996582  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.0318608283996582  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.0318608283996582  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

torch.Size([51064, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.0318608283996582  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

m.shape torch.Size([602, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.1164240837097168  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.1164240837097168  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.11699819564819336  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.12219047546386719  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([660, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.12253284454345703  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.12253284454345703  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.12316226959228516  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.13260364532470703  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([630, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.13319015502929688  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.13319015502929688  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.1337909698486328  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.1476764678955078  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([613, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.14948177337646484  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.14948177337646484  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.15006637573242188  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.16704654693603516  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([590, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.16816091537475586  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.16816091537475586  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.16872358322143555  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.18907594680786133  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([602, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.19051694869995117  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.19051694869995117  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.19109106063842773  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.21577787399291992  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([555, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.21734333038330078  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.21734333038330078  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.21787261962890625  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.24550199508666992  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([585, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.2474689483642578  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.2474689483642578  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.24802684783935547  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.28038978576660156  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([548, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.28246259689331055  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.28246259689331055  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.28298521041870117  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.31801557540893555  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([14614, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.38806676864624023  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.38806676864624023  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 14614, 128]), torch.Size([1, 14614, 128])
----------------------------------------3
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.40200376510620117  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3915305137634277  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 14614, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.31148099899292  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.33101224899292  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.35054349899292  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3308629989624023  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

torch.Size([19999, 256])
first layer input nodes number: 51064
first layer output nodes number: 19999
edges number: 172463
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3509259223937988  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3704571723937988  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.376051425933838  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.376051425933838  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

m.shape torch.Size([339, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4074244499206543  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4074244499206543  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4080710411071777  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.413632869720459  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([307, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4138998985290527  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4138998985290527  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4144854545593262  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4247794151306152  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([207, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4250836372375488  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4250836372375488  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.425478458404541  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4341645240783691  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([163, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4345941543579102  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4345941543579102  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4349050521850586  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4439210891723633  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([108, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4442849159240723  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4442849159240723  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.444490909576416  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.451906681060791  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([101, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4523863792419434  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4523863792419434  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4525790214538574  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.460862636566162  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([77, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4612846374511719  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4612846374511719  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4614315032958984  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4687747955322266  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([76, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4692859649658203  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4692859649658203  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.469430923461914  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4776935577392578  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4783391952514648  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4783391952514648  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4784975051879883  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4886293411254883  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4891753196716309  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4891753196716309  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4892992973327637  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4981017112731934  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4986743927001953  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4986743927001953  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.498788833618164  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5077152252197266  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5084424018859863  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5084424018859863  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5085721015930176  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5195965766906738  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.520143985748291  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.520143985748291  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5202374458312988  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5288357734680176  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5294890403747559  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5294890403747559  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.529588222503662  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5394072532653809  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5398192405700684  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5398192405700684  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5398802757263184  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5463500022888184  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5467963218688965  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5467963218688965  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5468554496765137  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5535368919372559  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5539488792419434  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5539488792419434  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5540003776550293  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5601801872253418  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5607600212097168  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5607600212097168  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5608267784118652  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5693049430847168  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.569819450378418  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.569819450378418  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5698766708374023  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5775442123413086  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.57826566696167  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.57826566696167  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5783400535583496  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5888285636901855  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5894575119018555  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5894575119018555  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5895204544067383  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5988359451293945  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5994176864624023  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5994176864624023  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.599472999572754  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.608046531677246  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6085939407348633  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6085939407348633  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6086435317993164  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6166772842407227  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6172757148742676  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6172757148742676  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6173272132873535  GigaBytes
Max Memory Allocated: 1.6255755424499512  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.626030445098877  GigaBytes
Max Memory Allocated: 1.6266484260559082  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([697, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6427526473999023  GigaBytes
Max Memory Allocated: 1.6428179740905762  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6427526473999023  GigaBytes
Max Memory Allocated: 1.6428179740905762  GigaBytes

 h.shape torch.Size([1, 697, 256]), torch.Size([1, 697, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6440820693969727  GigaBytes
Max Memory Allocated: 1.6440820693969727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8835105895996094  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 697, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8547248840332031  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8551363945007324  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8555479049682617  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8551154136657715  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([2761, 40])
input nodes number: 19999
output nodes number: 2761
edges number: 32174
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8552861213684082  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8552865982055664  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03448772430419922  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

pseudo mini batch 25 input nodes size: 49933
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.030335426330566406  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.030335426330566406  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05414533615112305  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.054166316986083984  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.029796123504638672  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.030945301055908203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.030945301055908203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.030945301055908203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([49933, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.030945301055908203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([694, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09516763687133789  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09516763687133789  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 694, 128]), torch.Size([1, 694, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09582948684692383  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10138130187988281  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 694, 128])
m.shape torch.Size([846, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10185718536376953  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10185718536376953  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10266399383544922  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11476612091064453  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([785, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11581850051879883  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11581850051879883  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11656713485717773  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1335768699645996  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([729, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13459300994873047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13459300994873047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13528823852539062  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15593814849853516  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 729, 128])
m.shape torch.Size([683, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15721893310546875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15721893310546875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 683, 128]), torch.Size([1, 683, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15787029266357422  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.18240690231323242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 683, 128])
m.shape torch.Size([639, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.18390941619873047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.18390941619873047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.18451881408691406  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21129798889160156  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([627, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21308612823486328  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21308612823486328  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21368408203125  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2441859245300293  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([542, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2459545135498047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2459545135498047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24647140502929688  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.27703094482421875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([522, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.27901268005371094  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.27901268005371094  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.279510498046875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3116598129272461  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([10233, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.36020565032958984  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.36020565032958984  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 10233, 128]), torch.Size([1, 10233, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.369964599609375  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0630769729614258  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 10233, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0033564567565918  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0190215110778809  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0345664024353027  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0187797546386719  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([16300, 256])
first layer input nodes number: 49933
first layer output nodes number: 16300
edges number: 130659
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0349407196044922  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.050485610961914  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0544052124023438  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0544052124023438  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([435, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.077547550201416  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.077547550201416  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0783772468566895  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0856289863586426  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.085923671722412  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.085923671722412  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.08662748336792  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.097184658050537  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([271, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0976142883300781  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0976142883300781  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0981311798095703  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1105437278747559  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([219, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1111273765563965  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1111273765563965  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1115450859069824  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1236586570739746  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([180, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1243152618408203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1243152618408203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1246585845947266  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1370182037353516  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([122, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1375503540039062  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1375503540039062  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1377830505371094  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1477890014648438  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1484532356262207  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1484532356262207  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.148674488067627  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1597371101379395  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1603727340698242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1603727340698242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.160557746887207  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1711034774780273  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1717033386230469  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1717033386230469  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1718559265136719  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1816215515136719  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1821990013122559  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1821990013122559  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.182328701019287  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1915373802185059  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.192117691040039  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.192117691040039  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1922340393066406  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2013092041015625  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.201897144317627  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.201897144317627  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2020039558410645  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.211082935333252  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([28, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2113795280456543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2113795280456543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.211432933807373  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.216346263885498  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2167906761169434  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2167906761169434  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2168574333190918  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.223466396331787  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2240242958068848  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2240242958068848  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.22410249710083  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2323918342590332  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2328448295593262  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2328448295593262  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2329058647155762  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2398028373718262  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.24029541015625  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.24029541015625  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2403564453125  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2476806640625  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.248255729675293  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.248255729675293  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2483224868774414  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.256800651550293  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2574429512023926  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2574429512023926  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2575135231018066  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.266970157623291  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2673578262329102  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2673578262329102  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.267399787902832  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2733163833618164  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2736992835998535  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2736992835998535  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2737374305725098  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2793831825256348  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2796392440795898  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2796392440795898  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2796640396118164  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2835073471069336  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.283738136291504  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.283738136291504  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2837591171264648  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2871580123901367  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2875165939331055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2875165939331055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2875471115112305  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2927045822143555  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([362, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3013877868652344  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3013877868652344  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3020782470703125  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4255809783935547  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 362, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.405369758605957  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4057807922363281  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4061918258666992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4057598114013672  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([2758, 40])
input nodes number: 16300
output nodes number: 2758
edges number: 23516
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4059019088745117  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.40590238571167  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03303861618041992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

pseudo mini batch 26 input nodes size: 50742
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02979564666748047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02979564666748047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05399131774902344  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.054012298583984375  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.030181407928466797  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03163576126098633  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03163576126098633  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03163576126098633  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([50742, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03163576126098633  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([576, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11185884475708008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11185884475708008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11240816116333008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11689901351928711  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([607, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1172032356262207  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1172032356262207  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1177821159362793  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1267695426940918  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([638, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12739276885986328  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12739276885986328  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12800121307373047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14233112335205078  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([617, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1432037353515625  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1432037353515625  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14379215240478516  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1608562469482422  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([650, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16211175918579102  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16211175918579102  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16273164749145508  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.18629980087280273  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([628, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.18778657913208008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.18778657913208008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1883854866027832  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21413850784301758  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([586, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21579504013061523  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21579504013061523  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2163538932800293  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24430513381958008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([592, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24628400802612305  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24628400802612305  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24684858322143555  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.27988386154174805  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([610, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.28221940994262695  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.28221940994262695  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.28280115127563477  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.32184743881225586  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([13608, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3864445686340332  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3864445686340332  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 13608, 128]), torch.Size([1, 13608, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4001584053039551  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3220868110656738  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 13608, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2463393211364746  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2645659446716309  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.282792568206787  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2644233703613281  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([19112, 256])
first layer input nodes number: 50742
first layer output nodes number: 19112
edges number: 163598
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.283172607421875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3013992309570312  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3066940307617188  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3066940307617188  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([313, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3373384475708008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3373384475708008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.337935447692871  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.343043327331543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([250, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3432254791259766  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3432254791259766  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3437023162841797  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3508548736572266  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([218, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.351245403289795  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.351245403289795  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.351661205291748  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3608088493347168  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([177, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3612818717956543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3612818717956543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.361619472503662  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3714098930358887  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([154, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3719816207885742  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3719816207885742  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3722753524780273  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3828496932983398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([101, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3832855224609375  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3832855224609375  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3834781646728516  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3917617797851562  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([100, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3923382759094238  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3923382759094238  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.392529010772705  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4020657539367676  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4026241302490234  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4026241302490234  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4027862548828125  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.412027359008789  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.412595272064209  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.412595272064209  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.41273832321167  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.42189359664917  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4225049018859863  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4225049018859863  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.422640323638916  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4322552680969238  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.432875156402588  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.432875156402588  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4329991340637207  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.44266939163208  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4433341026306152  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4433341026306152  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4434542655944824  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4536681175231934  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.454308032989502  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.454308032989502  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4544148445129395  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4642415046691895  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4650897979736328  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4650897979736328  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4652175903320312  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4778690338134766  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4785552024841309  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4785552024841309  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.478654384613037  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4891676902770996  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4899640083312988  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4899640083312988  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4900689125061035  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5019230842590332  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5024590492248535  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5024590492248535  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5025277137756348  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5107674598693848  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.512129783630371  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.512129783630371  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5122442245483398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.526778221130371  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.527451515197754  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.527451515197754  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5275278091430664  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5377511978149414  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5384631156921387  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5384631156921387  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5385375022888184  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5490260124206543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5497560501098633  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5497560501098633  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5498285293579102  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5605554580688477  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5611538887023926  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5611538887023926  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.561211109161377  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.570080280303955  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5706486701965332  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5706486701965332  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5707001686096191  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.579042911529541  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.579686164855957  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.579686164855957  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5797414779663086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5890893936157227  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([573, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.602829933166504  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.602829933166504  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6039228439331055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.7968664169311523  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 573, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.768908977508545  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.769322395324707  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.7697358131408691  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.769301414489746  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([2774, 40])
input nodes number: 19112
output nodes number: 2774
edges number: 31445
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.7694673538208008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.769467830657959  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.0341649055480957  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

pseudo mini batch 27 input nodes size: 50112
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.030183792114257812  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.030183792114257812  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05407905578613281  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05410051345825195  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.029883861541748047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03116750717163086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03116750717163086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03116750717163086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([50112, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03116750717163086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([665, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10201025009155273  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10201025009155273  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10264444351196289  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10820436477661133  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([791, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1086416244506836  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1086416244506836  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10939598083496094  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1207113265991211  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([814, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12173223495483398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12173223495483398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12250852584838867  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14043760299682617  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([731, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14144372940063477  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14144372940063477  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 731, 128]), torch.Size([1, 731, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14214086532592773  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16260576248168945  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 731, 128])
m.shape torch.Size([752, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1642160415649414  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1642160415649414  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 752, 128]), torch.Size([1, 752, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1649332046508789  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1911172866821289  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 752, 128])
m.shape torch.Size([699, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19275856018066406  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19275856018066406  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 699, 128]), torch.Size([1, 699, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19342517852783203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2220897674560547  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 699, 128])
m.shape torch.Size([637, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.22388267517089844  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.22388267517089844  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.22449016571044922  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.25551652908325195  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([612, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.25754737854003906  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.25754737854003906  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2581310272216797  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2922534942626953  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([570, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.29440784454345703  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.29440784454345703  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2949514389038086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3297414779663086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([11420, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3841571807861328  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3841571807861328  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 11420, 128]), torch.Size([1, 11420, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3950481414794922  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1684226989746094  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 11420, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.102292537689209  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.119163990020752  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.136035442352295  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1190319061279297  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([17691, 256])
first layer input nodes number: 50112
first layer output nodes number: 17691
edges number: 144252
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1364107131958008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1532821655273438  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1575002670288086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1575002670288086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([369, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1848301887512207  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1848301887512207  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1855340003967285  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.191908359527588  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([299, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.192131519317627  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.192131519317627  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.192701816558838  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2043461799621582  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2048511505126953  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2048511505126953  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.205373764038086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.221165657043457  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([187, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.221623420715332  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.221623420715332  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.221980094909668  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2323236465454102  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2330780029296875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2330780029296875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2334480285644531  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2467689514160156  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2473974227905273  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2473974227905273  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.247666358947754  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.259230613708496  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([106, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2598094940185547  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2598094940185547  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2600116729736328  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.270120620727539  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2707500457763672  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2707500457763672  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2709312438964844  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.281259536743164  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([71, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.281783103942871  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.281783103942871  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2819185256958008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2905855178833008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.291229248046875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.291229248046875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2913703918457031  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3013916015625  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3021140098571777  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3021140098571777  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3022570610046387  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3134150505065918  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3140244483947754  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3140244483947754  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3141369819641113  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.323702335357666  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.324295997619629  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.324295997619629  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3243951797485352  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3335199356079102  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3338875770568848  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3338875770568848  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.333946704864502  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3398003578186035  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3404488563537598  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3404488563537598  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.340538501739502  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3500409126281738  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3505654335021973  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3505654335021973  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3506360054016113  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3586106300354004  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3592290878295898  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3592290878295898  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3593053817749023  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3684606552124023  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.368924617767334  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.368924617767334  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3689799308776855  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.376004695892334  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3765983581542969  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3765983581542969  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3766632080078125  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3853530883789062  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3857436180114746  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3857436180114746  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3857855796813965  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3917021751403809  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3923072814941406  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3923072814941406  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3923664093017578  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4011173248291016  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4014263153076172  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4014263153076172  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4014568328857422  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4061870574951172  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.406548023223877  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.406548023223877  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4065804481506348  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4118332862854004  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4123249053955078  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4123249053955078  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4123668670654297  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4194583892822266  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([502, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.43149995803833  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.43149995803833  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.432457447052002  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6059889793395996  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 502, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5814909934997559  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5819120407104492  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5823330879211426  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.58189058303833  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([2824, 40])
input nodes number: 17691
output nodes number: 2824
edges number: 27934
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5820517539978027  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.582052230834961  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03347015380859375  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

pseudo mini batch 28 input nodes size: 46672
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.029891490936279297  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.029891490936279297  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05214643478393555  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.052167415618896484  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.028250694274902344  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02958393096923828  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02958393096923828  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02958393096923828  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([46672, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02958393096923828  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([613, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10310029983520508  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10310029983520508  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10368490219116211  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10837507247924805  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([658, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10871028900146484  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10871028900146484  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10933780670166016  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11875057220458984  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([670, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11939525604248047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11939525604248047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12003421783447266  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13466358184814453  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([639, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13583946228027344  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13583946228027344  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13644886016845703  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15487098693847656  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([602, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15600156784057617  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15600156784057617  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15657567977905273  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1781296730041504  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([557, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.17943620681762695  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.17943620681762695  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.17996740341186523  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.20285749435424805  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([541, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.20439767837524414  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.20439767837524414  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.20491361618041992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2308330535888672  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([512, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2325282096862793  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2325282096862793  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2330164909362793  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2608485221862793  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([480, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2626643180847168  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2626643180847168  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2631220817565918  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2924189567565918  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([12477, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3516850471496582  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3516850471496582  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 12477, 128]), torch.Size([1, 12477, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3645458221435547  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2093744277954102  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 12477, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1409640312194824  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.157890796661377  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1748175621032715  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1577582359313965  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([17749, 256])
first layer input nodes number: 46672
first layer output nodes number: 17749
edges number: 149820
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1751675605773926  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.192094326019287  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1963262557983398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1963262557983398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([364, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2246789932250977  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2246789932250977  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2253732681274414  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2314496040344238  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([311, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2317004203796387  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2317004203796387  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2322936058044434  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2436637878417969  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([215, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2439875602722168  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2439875602722168  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2443976402282715  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2534193992614746  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([213, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2540335655212402  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2540335655212402  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2544398307800293  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.266221523284912  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([145, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2667155265808105  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2667155265808105  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2669920921325684  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2769484519958496  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([120, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2775025367736816  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2775025367736816  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2777314186096191  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2875733375549316  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([103, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2881522178649902  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2881522178649902  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.28834867477417  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2981715202331543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([83, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2987117767333984  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2987117767333984  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2988700866699219  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3078937530517578  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3085241317749023  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3085241317749023  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.308680534362793  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.318690299987793  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.31925630569458  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.31925630569458  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3193840980529785  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3284573554992676  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3290281295776367  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3290281295776367  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3291425704956055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.338068962097168  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3387269973754883  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3387269973754883  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3388452529907227  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3488969802856445  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.349400520324707  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.349400520324707  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3494863510131836  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3573827743530273  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.357743740081787  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.357743740081787  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3578009605407715  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3634657859802246  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.363884449005127  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.363884449005127  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3639435768127441  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.370211124420166  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.370673656463623  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.370673656463623  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.370734691619873  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.377631664276123  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.378157138824463  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.378157138824463  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3782219886779785  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3860039710998535  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.386490821838379  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.386490821838379  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3865480422973633  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.393815040588379  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3942065238952637  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3942065238952637  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3942503929138184  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4001288414001465  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.400683879852295  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.400683879852295  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4007411003112793  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4088091850280762  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4092450141906738  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4092450141906738  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4092888832092285  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4157814979553223  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4160981178283691  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4160981178283691  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4161286354064941  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4208588600158691  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4213523864746094  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4213523864746094  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.421396255493164  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4285030364990234  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.428919792175293  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.428919792175293  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4289560317993164  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4350805282592773  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([597, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4494075775146484  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4494075775146484  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4505462646484375  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6747217178344727  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 597, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6490488052368164  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6494598388671875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6498708724975586  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6494388580322266  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([2758, 40])
input nodes number: 17749
output nodes number: 2758
edges number: 29007
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6495823860168457  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.649582862854004  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.031900882720947266  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

pseudo mini batch 29 input nodes size: 46676
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.028240680694580078  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.028240680694580078  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05049753189086914  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05051851272583008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02824258804321289  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.029513835906982422  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.029513835906982422  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.029513835906982422  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([46676, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.029513835906982422  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([687, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09971475601196289  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09971475601196289  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10036993026733398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10645389556884766  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([684, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10677862167358398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10677862167358398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10743093490600586  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11721563339233398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([672, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11785078048706055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11785078048706055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11849164962768555  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13277387619018555  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 672, 128])
m.shape torch.Size([654, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13372373580932617  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13372373580932617  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13434743881225586  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15292692184448242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([635, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1541290283203125  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1541290283203125  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15473461151123047  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1769423484802246  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([622, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1784191131591797  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1784191131591797  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.17901229858398438  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.20464706420898438  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([585, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.20630311965942383  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.20630311965942383  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.20686101913452148  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2362823486328125  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([509, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2379450798034668  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2379450798034668  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.23843050003051758  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2660994529724121  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([550, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2682170867919922  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2682170867919922  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2687416076660156  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.30258655548095703  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([11623, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.35774707794189453  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.35774707794189453  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 11623, 128]), torch.Size([1, 11623, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3688316345214844  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1558351516723633  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 11623, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0902533531188965  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1066765785217285  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1230998039245605  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1065478324890137  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([17221, 256])
first layer input nodes number: 46676
first layer output nodes number: 17221
edges number: 142941
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1234498023986816  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1398730278015137  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1439790725708008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1439790725708008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([374, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1709470748901367  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1709470748901367  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1716604232788086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1779556274414062  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([310, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1781949996948242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1781949996948242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.178786277770996  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1881704330444336  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([247, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1885871887207031  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1885871887207031  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1890583038330078  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.199422836303711  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([185, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1998987197875977  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1998987197875977  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.200251579284668  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.210484504699707  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.211033821105957  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.211033821105957  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2113218307495117  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2216901779174805  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([132, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2223076820373535  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2223076820373535  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2225594520568848  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2333855628967285  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.234107494354248  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.234107494354248  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2343478202819824  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2463641166687012  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2468209266662598  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2468209266662598  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2469639778137207  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2551178932189941  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.25575590133667  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.25575590133667  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2559123039245605  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2659220695495605  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2665071487426758  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2665071487426758  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2666387557983398  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2759828567504883  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2765412330627441  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2765412330627441  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.27665376663208  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2854313850402832  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2860212326049805  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2860212326049805  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.286128044128418  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2952070236206055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2957162857055664  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2957162857055664  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.295802116394043  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3036985397338867  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.30418062210083  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.30418062210083  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3042550086975098  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3116192817687988  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.31227445602417  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.31227445602417  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.312366008758545  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.322070598602295  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3227324485778809  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3227324485778809  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3228201866149902  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3327345848083496  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3333444595336914  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3333444595336914  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.333420753479004  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.342576026916504  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3430399894714355  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3430399894714355  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.343095302581787  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3501200675964355  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3507318496704102  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3507318496704102  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3507986068725586  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3597440719604492  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3602685928344727  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3602685928344727  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3603239059448242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3681230545043945  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3688020706176758  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3688020706176758  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3688688278198242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.378748893737793  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.379138469696045  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.379138469696045  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3791766166687012  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.38508939743042  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3854904174804688  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3854904174804688  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3855266571044922  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.391397476196289  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3917484283447266  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3917484283447266  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3917789459228516  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3969364166259766  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([491, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4087190628051758  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4087190628051758  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4096555709838867  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.578737735748291  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 491, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5549521446228027  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5553631782531738  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.555774211883545  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.555342197418213  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([2758, 40])
input nodes number: 17221
output nodes number: 2758
edges number: 27558
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5554919242858887  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5554924011230469  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03175687789916992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

pseudo mini batch 30 input nodes size: 42805
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02824258804321289  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02824258804321289  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.048653602600097656  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.048674583435058594  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.026396751403808594  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02767658233642578  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02767658233642578  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02767658233642578  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([42805, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.02767658233642578  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([614, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09727239608764648  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09727239608764648  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09785795211791992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10290098190307617  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([630, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10320901870727539  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10320901870727539  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10380983352661133  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11282205581665039  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([614, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11339998245239258  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11339998245239258  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11398553848266602  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12686777114868164  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([592, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12770414352416992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12770414352416992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12826871871948242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1452021598815918  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([575, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14629077911376953  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14629077911376953  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14683914184570312  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16705751419067383  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([528, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16829395294189453  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16829395294189453  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16879749298095703  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19093942642211914  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([542, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19249677658081055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19249677658081055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19301366806030273  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21921968460083008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([457, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2207045555114746  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2207045555114746  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.22114038467407227  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24598264694213867  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([465, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24776029586791992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24776029586791992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24820375442504883  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.27658510208129883  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([11803, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3326444625854492  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3326444625854492  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 11803, 128]), torch.Size([1, 11803, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3439006805419922  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1652936935424805  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 11803, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.0997533798217773  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1157941818237305  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1318349838256836  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.115668773651123  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([16820, 256])
first layer input nodes number: 42805
first layer output nodes number: 16820
edges number: 141792
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1321558952331543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1481966972351074  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.152693748474121  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.152693748474121  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([359, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1826810836791992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1826810836791992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.183365821838379  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1888437271118164  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([274, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.189028263092041  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.189028263092041  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1895508766174316  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1983089447021484  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([230, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1987109184265137  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1987109184265137  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.1991496086120605  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2088007926940918  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([163, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2092084884643555  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2092084884643555  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.209519386291504  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2185354232788086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([157, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.21913480758667  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.21913480758667  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2194342613220215  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2302145957946777  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([124, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2307801246643066  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2307801246643066  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2310166358947754  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2411866188049316  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.241788387298584  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.241788387298584  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.241992473602295  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2521967887878418  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([76, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2526793479919434  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2526793479919434  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.252824306488037  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2610869407653809  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2616376876831055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2616376876831055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.261775016784668  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.270564079284668  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2710914611816406  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2710914611816406  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.271209716796875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2796058654785156  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2802977561950684  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2802977561950684  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.280433177947998  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2909960746765137  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2916321754455566  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2916321754455566  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2917485237121582  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.301638126373291  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3022799491882324  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3022799491882324  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.30238676071167  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.31221342086792  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3127927780151367  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3127927780151367  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.312882423400879  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3217573165893555  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3224191665649414  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3224191665649414  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3225126266479492  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3324193954467773  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.332864761352539  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.332864761352539  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.332925796508789  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.339822769165039  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3403315544128418  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3403315544128418  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3403944969177246  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.347947597503662  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3486428260803223  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3486428260803223  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3487229347229004  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3588967323303223  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3594231605529785  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3594231605529785  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3594822883605957  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3674054145812988  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3678951263427734  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3678951263427734  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3679466247558594  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3752079010009766  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.375868797302246  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.375868797302246  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3759336471557617  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3855314254760742  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3858585357666016  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3858585357666016  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3858909606933594  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3909168243408203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3914093971252441  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3914093971252441  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3914532661437988  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3985600471496582  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3991150856018066  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3991150856018066  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.399162769317627  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4072213172912598  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([586, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4212779998779297  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4212779998779297  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4223957061767578  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6233820915222168  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 586, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5960869789123535  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5964980125427246  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5969090461730957  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5964770317077637  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([2758, 40])
input nodes number: 16820
output nodes number: 2758
edges number: 29862
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.596623420715332  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5966238975524902  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.029906749725341797  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

pseudo mini batch 31 input nodes size: 43418
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.026396751403808594  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.026396751403808594  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.047881126403808594  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.04790306091308594  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.027471065521240234  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.028961658477783203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.028961658477783203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.028961658477783203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([43418, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.028961658477783203  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([520, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10840654373168945  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10840654373168945  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1089024543762207  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1128697395324707  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([523, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11312055587768555  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11312055587768555  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11361932754516602  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1218256950378418  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([501, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12229299545288086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12229299545288086  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12277078628540039  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13328218460083008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([509, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13401412963867188  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13401412963867188  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13449954986572266  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1485767364501953  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([522, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14957857131958008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14957857131958008  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15007638931274414  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16850996017456055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([485, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1696486473083496  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1696486473083496  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.17011117935180664  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19000005722045898  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([502, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19213485717773438  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19213485717773438  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1926136016845703  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2165508270263672  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([504, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21823406219482422  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21823406219482422  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.21871471405029297  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24611186981201172  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([529, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24814176559448242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24814176559448242  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.24864625930786133  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2820167541503906  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([13916, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.34817075729370117  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.34817075729370117  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 13916, 128]), torch.Size([1, 13916, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.36144208908081055  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3045077323913574  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 13916, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2290558815002441  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2467093467712402  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2643628120422363  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2465710639953613  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

torch.Size([18511, 256])
first layer input nodes number: 43418
first layer output nodes number: 18511
edges number: 162092
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.264688491821289  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2823419570922852  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2870492935180664  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.2870492935180664  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

m.shape torch.Size([277, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.323756217956543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.323756217956543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.324284553527832  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3306827545166016  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([231, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3308629989624023  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3308629989624023  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.331303596496582  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3379125595092773  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([186, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.338228702545166  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.338228702545166  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3385834693908691  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.346388339996338  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([151, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3467917442321777  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3467917442321777  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3470797538757324  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3554320335388184  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([121, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3558697700500488  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3558697700500488  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3561005592346191  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3644089698791504  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([119, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3649802207946777  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3649802207946777  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3652071952819824  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.374967098236084  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.375493049621582  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.375493049621582  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3756742477416992  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3847341537475586  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([79, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3852510452270508  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3852510452270508  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.385401725769043  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3939905166625977  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3946161270141602  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.3946161270141602  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.394770622253418  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.404658317565918  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4054174423217773  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4054174423217773  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.405583381652832  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4173650741577148  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4179167747497559  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4179167747497559  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4180312156677246  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.426957607269287  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4276618957519531  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4276618957519531  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4277877807617188  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4384880065917969  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.43931245803833  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.43931245803833  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4394478797912598  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.451906681060791  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4526329040527344  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4526329040527344  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4527454376220703  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4638862609863281  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4646086692810059  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4646086692810059  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4647116661071777  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4756293296813965  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.476393222808838  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.476393222808838  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.476494312286377  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.487917423248291  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4886350631713867  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4886350631713867  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.488724708557129  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.4994821548461914  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5001640319824219  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5001640319824219  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.500244140625  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5104179382324219  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.511199951171875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.511199951171875  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5112857818603516  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.522787094116211  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5235133171081543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5235133171081543  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5235896110534668  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5343470573425293  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([47, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5352578163146973  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5352578163146973  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5353474617004395  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5486149787902832  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5491833686828613  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5491833686828613  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.549238681793213  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.557812213897705  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5585803985595703  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5585803985595703  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5586490631103516  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.569772720336914  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5704307556152344  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5704307556152344  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes
[05:38:35] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23400434 edges into 32 parts and get 7564334 edge cuts

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5704879760742188  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.5801582336425781  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([817, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.599813461303711  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.599813461303711  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

 h.shape torch.Size([1, 817, 256]), torch.Size([1, 817, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.6013717651367188  GigaBytes
Max Memory Allocated: 1.9001283645629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8817214965820312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 817, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8476266860961914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.848062515258789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8484983444213867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8480405807495117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2923, 40])
input nodes number: 18511
output nodes number: 2923
edges number: 37783
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8482255935668945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 1.8482260704040527  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03153085708618164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.037081241607666016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.037081241607666016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008431918919086456 |0.012174621224403381 |0.13120941072702408 |8.843094110488892e-05 |0.07575476914644241 |0.0059261322021484375 |
----------------------------------------------------------pseudo_mini_loss sum 5.334081172943115
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1187105
Number of first layer input nodes during this epoch:  850222
Number of first layer output nodes during this epoch:  336883
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03708076477050781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.020759105682373047
global_2_local spend time (sec) 0.04777026176452637
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00426936149597168
A = g.adjacency_matrix() spent  0.00754094123840332
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0819234848022461
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3467686176300049
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.270395278930664

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434})
Convert a graph into a bidirected graph: 1.044 seconds
Metis partitioning: 5.112 seconds
Split the graph: 0.474 seconds
Construct subgraphs: 0.086 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.72746729850769
2913
2854
2879
2864
2927
2781
2813
2879
2903
2873
2886
2904
2925
2892
2898
2910
2913
2856
2816
2758
2803
2758
2828
2786
2758
2758
2927
2758
2803
2796
2764
2758
total k batches seeds list generation spend  17.527132272720337
after graph partition
graph partition algorithm spend time 17.617756366729736
2913
2854
2879
2864
2927
2781
2813
2879
2903
2873
2886
2904
2925
2892
2898
2910
2913
2856
2816
2758
2803
2758
2828
2786
2758
2758
2927
2758
2803
2796
2764
2758
partition_len_list
[6684, 5624, 6337, 7245, 8173, 10161, 7296, 7969, 5850, 5750, 5656, 7652, 7650, 6857, 5974, 7064, 8506, 10065, 8235, 8680, 11996, 15169, 12016, 10535, 15878, 17960, 18377, 19546, 19066, 19629, 14634, 14610]
shared_neighbor_graph_partition_s0 selection method  spend 17.722442150115967
time for parepare:  0.018877029418945312
local_output_nid generation:  0.0008516311645507812
local_in_edges_tensor generation:  0.0010707378387451172
mini_batch_src_global generation:  0.0010883808135986328
r_  generation:  0.006825447082519531
local_output_nid generation:  0.0008406639099121094
local_in_edges_tensor generation:  0.0008594989776611328
mini_batch_src_global generation:  0.0010733604431152344
r_  generation:  0.006461381912231445
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.0008046627044677734
mini_batch_src_global generation:  0.0008661746978759766
r_  generation:  0.007180452346801758
local_output_nid generation:  0.0008382797241210938
local_in_edges_tensor generation:  0.0007956027984619141
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.007332801818847656
local_output_nid generation:  0.0008883476257324219
local_in_edges_tensor generation:  0.0007646083831787109
mini_batch_src_global generation:  0.0009438991546630859
r_  generation:  0.00802755355834961
local_output_nid generation:  0.0008325576782226562
local_in_edges_tensor generation:  0.0007395744323730469
mini_batch_src_global generation:  0.0008106231689453125
r_  generation:  0.0060651302337646484
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.0006690025329589844
mini_batch_src_global generation:  0.0006966590881347656
r_  generation:  0.006127119064331055
local_output_nid generation:  0.0008862018585205078
local_in_edges_tensor generation:  0.0007245540618896484
mini_batch_src_global generation:  0.0008223056793212891
r_  generation:  0.00796365737915039
local_output_nid generation:  0.0008935928344726562
local_in_edges_tensor generation:  0.0006785392761230469
mini_batch_src_global generation:  0.0006833076477050781
r_  generation:  0.005396127700805664
local_output_nid generation:  0.0008738040924072266
local_in_edges_tensor generation:  0.00066375732421875
mini_batch_src_global generation:  0.0005576610565185547
r_  generation:  0.0048105716705322266
local_output_nid generation:  0.0008614063262939453
local_in_edges_tensor generation:  0.0006585121154785156
mini_batch_src_global generation:  0.0005576610565185547
r_  generation:  0.005133628845214844
local_output_nid generation:  0.0008819103240966797
local_in_edges_tensor generation:  0.0007169246673583984
mini_batch_src_global generation:  0.0007951259613037109
r_  generation:  0.00711822509765625
local_output_nid generation:  0.0008907318115234375
local_in_edges_tensor generation:  0.0007221698760986328
mini_batch_src_global generation:  0.0009071826934814453
r_  generation:  0.00801396369934082
local_output_nid generation:  0.0008819103240966797
local_in_edges_tensor generation:  0.0006542205810546875
mini_batch_src_global generation:  0.0006580352783203125
r_  generation:  0.005316257476806641
local_output_nid generation:  0.0008993148803710938
local_in_edges_tensor generation:  0.0007026195526123047
mini_batch_src_global generation:  0.0006785392761230469
r_  generation:  0.006174564361572266
local_output_nid generation:  0.0008761882781982422
local_in_edges_tensor generation:  0.0006780624389648438
mini_batch_src_global generation:  0.0007200241088867188
r_  generation:  0.006975650787353516
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0006873607635498047
mini_batch_src_global generation:  0.0007185935974121094
r_  generation:  0.0058972835540771484
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0006592273712158203
mini_batch_src_global generation:  0.0007691383361816406
r_  generation:  0.006922006607055664
local_output_nid generation:  0.0008625984191894531
local_in_edges_tensor generation:  0.0006301403045654297
mini_batch_src_global generation:  0.0006527900695800781
r_  generation:  0.0054209232330322266
local_output_nid generation:  0.0008175373077392578
local_in_edges_tensor generation:  0.0006299018859863281
mini_batch_src_global generation:  0.0005981922149658203
r_  generation:  0.005036830902099609
local_output_nid generation:  0.0008327960968017578
local_in_edges_tensor generation:  0.0006468296051025391
mini_batch_src_global generation:  0.0008041858673095703
r_  generation:  0.007466316223144531
local_output_nid generation:  0.0008389949798583984
local_in_edges_tensor generation:  0.0006964206695556641
mini_batch_src_global generation:  0.0010783672332763672
r_  generation:  0.00901651382446289
local_output_nid generation:  0.000919342041015625
local_in_edges_tensor generation:  0.0007832050323486328
mini_batch_src_global generation:  0.0008637905120849609
r_  generation:  0.006845712661743164
local_output_nid generation:  0.0008995532989501953
local_in_edges_tensor generation:  0.0006723403930664062
mini_batch_src_global generation:  0.0006906986236572266
r_  generation:  0.005675077438354492
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0007073879241943359
mini_batch_src_global generation:  0.0009865760803222656
r_  generation:  0.008997917175292969
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.0007145404815673828
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.008417367935180664
local_output_nid generation:  0.0009644031524658203
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  0.0012140274047851562
r_  generation:  0.012630701065063477
local_output_nid generation:  0.0009326934814453125
local_in_edges_tensor generation:  0.0007634162902832031
mini_batch_src_global generation:  0.0014145374298095703
r_  generation:  0.010119438171386719
local_output_nid generation:  0.0009379386901855469
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.011531591415405273
local_output_nid generation:  0.0009629726409912109
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0011696815490722656
r_  generation:  0.009315013885498047
local_output_nid generation:  0.0009613037109375
local_in_edges_tensor generation:  0.0007128715515136719
mini_batch_src_global generation:  0.0009019374847412109
r_  generation:  0.007008790969848633
local_output_nid generation:  0.0009505748748779297
local_in_edges_tensor generation:  0.0006995201110839844
mini_batch_src_global generation:  0.0008320808410644531
r_  generation:  0.0075342655181884766
----------------------check_connections_block total spend ----------------------------- 0.4012324810028076
generate_one_block  0.023469209671020508
generate_one_block  0.012445211410522461
generate_one_block  0.011475086212158203
generate_one_block  0.011642694473266602
generate_one_block  0.012713909149169922
generate_one_block  0.010146856307983398
generate_one_block  0.009183883666992188
generate_one_block  0.011713027954101562
generate_one_block  0.00773310661315918
generate_one_block  0.007002115249633789
generate_one_block  0.007170438766479492
generate_one_block  0.010433673858642578
generate_one_block  0.011687517166137695
generate_one_block  0.007682323455810547
generate_one_block  0.008751630783081055
generate_one_block  0.010147571563720703
generate_one_block  0.013830423355102539
generate_one_block  0.011142969131469727
generate_one_block  0.008328914642333984
generate_one_block  0.008205890655517578
generate_one_block  0.012167930603027344
generate_one_block  0.014378070831298828
generate_one_block  0.010058403015136719
generate_one_block  0.008978605270385742
generate_one_block  0.014832258224487305
generate_one_block  0.013868093490600586
generate_one_block  0.018105506896972656
generate_one_block  0.01707148551940918
generate_one_block  0.015949010848999023
generate_one_block  0.01490473747253418
generate_one_block  0.010721206665039062
generate_one_block  0.011187553405761719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0386960506439209
gen group dst list time:  0.010171890258789062
time for parepare:  0.023225069046020508
local_output_nid generation:  0.0018711090087890625
local_in_edges_tensor generation:  0.006596088409423828
mini_batch_src_global generation:  0.0015254020690917969
r_  generation:  0.01555180549621582
local_output_nid generation:  0.0017387866973876953
local_in_edges_tensor generation:  0.0014753341674804688
mini_batch_src_global generation:  0.0014197826385498047
r_  generation:  0.01249551773071289
local_output_nid generation:  0.0019960403442382812
local_in_edges_tensor generation:  0.0015006065368652344
mini_batch_src_global generation:  0.001299142837524414
r_  generation:  0.015051126480102539
local_output_nid generation:  0.0020356178283691406
local_in_edges_tensor generation:  0.001641988754272461
mini_batch_src_global generation:  0.0014591217041015625
r_  generation:  0.01731705665588379
local_output_nid generation:  0.002182483673095703
local_in_edges_tensor generation:  0.0020127296447753906
mini_batch_src_global generation:  0.001745462417602539
r_  generation:  0.020113468170166016
local_output_nid generation:  0.0028493404388427734
local_in_edges_tensor generation:  0.002369403839111328
mini_batch_src_global generation:  0.002391338348388672
r_  generation:  0.025191307067871094
local_output_nid generation:  0.002067089080810547
local_in_edges_tensor generation:  0.001974821090698242
mini_batch_src_global generation:  0.0024013519287109375
r_  generation:  0.016482114791870117
local_output_nid generation:  0.0021936893463134766
local_in_edges_tensor generation:  0.0019526481628417969
mini_batch_src_global generation:  0.0015404224395751953
r_  generation:  0.01908278465270996
local_output_nid generation:  0.0017600059509277344
local_in_edges_tensor generation:  0.0014147758483886719
mini_batch_src_global generation:  0.0014183521270751953
r_  generation:  0.010494232177734375
local_output_nid generation:  0.0016529560089111328
local_in_edges_tensor generation:  0.001260995864868164
mini_batch_src_global generation:  0.0010974407196044922
r_  generation:  0.00972437858581543
local_output_nid generation:  0.0015249252319335938
local_in_edges_tensor generation:  0.0012216567993164062
mini_batch_src_global generation:  0.0010406970977783203
r_  generation:  0.009601593017578125
local_output_nid generation:  0.0021164417266845703
local_in_edges_tensor generation:  0.0017938613891601562
mini_batch_src_global generation:  0.0014100074768066406
r_  generation:  0.01928257942199707
local_output_nid generation:  0.0021860599517822266
local_in_edges_tensor generation:  0.0018854141235351562
mini_batch_src_global generation:  0.001735687255859375
r_  generation:  0.01858234405517578
local_output_nid generation:  0.0018808841705322266
local_in_edges_tensor generation:  0.0015397071838378906
mini_batch_src_global generation:  0.0012669563293457031
r_  generation:  0.014796972274780273
local_output_nid generation:  0.0016357898712158203
local_in_edges_tensor generation:  0.0013301372528076172
mini_batch_src_global generation:  0.0010578632354736328
r_  generation:  0.012529611587524414
local_output_nid generation:  0.0019693374633789062
local_in_edges_tensor generation:  0.0016009807586669922
mini_batch_src_global generation:  0.0012290477752685547
r_  generation:  0.016094446182250977
local_output_nid generation:  0.0022454261779785156
local_in_edges_tensor generation:  0.0018422603607177734
mini_batch_src_global generation:  0.0015177726745605469
r_  generation:  0.018834590911865234
local_output_nid generation:  0.002662181854248047
local_in_edges_tensor generation:  0.002465963363647461
mini_batch_src_global generation:  0.0023751258850097656
r_  generation:  0.02566361427307129
local_output_nid generation:  0.002351999282836914
local_in_edges_tensor generation:  0.0018849372863769531
mini_batch_src_global generation:  0.0017058849334716797
r_  generation:  0.018738985061645508
local_output_nid generation:  0.00246429443359375
local_in_edges_tensor generation:  0.002079010009765625
mini_batch_src_global generation:  0.0015816688537597656
r_  generation:  0.02089667320251465
local_output_nid generation:  0.0032842159271240234
local_in_edges_tensor generation:  0.0035490989685058594
mini_batch_src_global generation:  0.0029859542846679688
r_  generation:  0.032073020935058594
local_output_nid generation:  0.00422215461730957
local_in_edges_tensor generation:  0.004261493682861328
mini_batch_src_global generation:  0.004667520523071289
r_  generation:  0.04239034652709961
local_output_nid generation:  0.003682851791381836
local_in_edges_tensor generation:  0.003307819366455078
mini_batch_src_global generation:  0.0034182071685791016
r_  generation:  0.03188157081604004
local_output_nid generation:  0.003236532211303711
local_in_edges_tensor generation:  0.0026252269744873047
mini_batch_src_global generation:  0.0026595592498779297
r_  generation:  0.02729010581970215
local_output_nid generation:  0.004511356353759766
local_in_edges_tensor generation:  0.0050165653228759766
mini_batch_src_global generation:  0.0045108795166015625
r_  generation:  0.045356035232543945
local_output_nid generation:  0.0052835941314697266
local_in_edges_tensor generation:  0.005504131317138672
mini_batch_src_global generation:  0.005994081497192383
r_  generation:  0.05515480041503906
local_output_nid generation:  0.005239009857177734
local_in_edges_tensor generation:  0.005796194076538086
mini_batch_src_global generation:  0.010669469833374023
r_  generation:  0.05438065528869629
local_output_nid generation:  0.005614042282104492
local_in_edges_tensor generation:  0.00486445426940918
mini_batch_src_global generation:  0.006314516067504883
r_  generation:  0.0603184700012207
local_output_nid generation:  0.0056154727935791016
local_in_edges_tensor generation:  0.0049288272857666016
mini_batch_src_global generation:  0.006621122360229492
r_  generation:  0.06593751907348633
local_output_nid generation:  0.0057065486907958984
local_in_edges_tensor generation:  0.0058062076568603516
mini_batch_src_global generation:  0.008902549743652344
r_  generation:  0.06132221221923828
local_output_nid generation:  0.004651069641113281
local_in_edges_tensor generation:  0.004107236862182617
mini_batch_src_global generation:  0.004731178283691406
r_  generation:  0.042658329010009766
local_output_nid generation:  0.004582643508911133
local_in_edges_tensor generation:  0.0038909912109375
mini_batch_src_global generation:  0.0041351318359375
r_  generation:  0.04229450225830078
----------------------check_connections_block total spend ----------------------------- 1.417353630065918
generate_one_block  0.02421736717224121
generate_one_block  0.025544404983520508
generate_one_block  0.02129077911376953
generate_one_block  0.023519277572631836
generate_one_block  0.02696394920349121
generate_one_block  0.03322720527648926
generate_one_block  0.022020578384399414
generate_one_block  0.02515387535095215
generate_one_block  0.015532493591308594
generate_one_block  0.012873411178588867
generate_one_block  0.012565135955810547
generate_one_block  0.02203226089477539
generate_one_block  0.02601480484008789
generate_one_block  0.019095897674560547
generate_one_block  0.01633930206298828
generate_one_block  0.02138495445251465
generate_one_block  0.025065898895263672
generate_one_block  0.03453874588012695
generate_one_block  0.024576902389526367
generate_one_block  0.025565624237060547
generate_one_block  0.048758506774902344
generate_one_block  0.06062197685241699
generate_one_block  0.04325127601623535
generate_one_block  0.03636431694030762
generate_one_block  0.0632162094116211
generate_one_block  0.07203888893127441
generate_one_block  0.0746762752532959
generate_one_block  0.0796668529510498
generate_one_block  0.07608151435852051
generate_one_block  0.0780794620513916
generate_one_block  0.05519413948059082
generate_one_block  0.05534696578979492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03708076477050781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

connection checking time:  1.417353630065918
block generation total time  1.2008192539215088
average batch blocks generation time:  0.03752560168504715
block dataloader generation time/epoch 21.372024536132812
pseudo mini batch 0 input nodes size: 15654
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.033045291900634766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.033045291900634766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.040509700775146484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.04053163528442383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.019025325775146484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.019528865814208984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.019528865814208984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.019528865814208984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([15654, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.019528865814208984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([497, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.0418400764465332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.0418400764465332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.04231405258178711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.04610586166381836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([592, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.046433448791503906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.046433448791503906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.046998023986816406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05633354187011719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([579, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.056879520416259766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.056879520416259766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.057431697845458984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.07018041610717773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([534, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.0709228515625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.0709228515625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.07143211364746094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.08654403686523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([424, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.08730030059814453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.08730030059814453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.08770465850830078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10226154327392578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([427, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10328102111816406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10328102111816406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10368824005126953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12119865417480469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([350, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12216329574584961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12216329574584961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1224970817565918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13918638229370117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([335, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14029741287231445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14029741287231445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14061689376831055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1588273048400879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([319, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16003656387329102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16003656387329102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1603407859802246  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1798110008239746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([2627, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1921854019165039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1921854019165039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 2627, 128]), torch.Size([1, 2627, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.19503498077392578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.37740135192871094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 2627, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3570370674133301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.36341142654418945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3701939582824707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.36376953125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([6684, 256])
first layer input nodes number: 15654
first layer output nodes number: 6684
edges number: 44507
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3703126907348633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.37668704986572266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3786811828613281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3786811828613281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([332, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.40117931365966797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.40117931365966797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4018125534057617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.40721607208251953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.40758800506591797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.40758800506591797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.40827083587646484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4194173812866211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.41992664337158203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.41992664337158203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4204893112182617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4335026741027832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.43419790267944336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.43419790267944336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.43468236923217773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4487318992614746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.449465274810791  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.449465274810791  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.44985246658325195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4637913703918457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.46463584899902344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.46463584899902344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4649791717529297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.47974205017089844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.48057985305786133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.48057985305786133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4808659553527832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.49517107009887695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4960818290710449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4960818290710449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.49634313583374023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.511237621307373  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([124, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5121798515319824  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5121798515319824  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5124163627624512  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5275530815124512  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5283193588256836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5283193588256836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5284948348999023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5409536361694336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([99, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5419130325317383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5419130325317383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5421018600463867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5568304061889648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([93, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5578088760375977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5578088760375977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5579862594604492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.573063850402832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([84, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5740251541137695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5740251541137695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5741853713989258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5889253616333008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5894646644592285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5894646644592285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5895524024963379  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.598238468170166  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5988435745239258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5988435745239258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5989294052124023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.608027458190918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6085691452026367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6085691452026367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6086416244506836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6168317794799805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6174330711364746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6174330711364746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6175074577331543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6264338493347168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6270022392272949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6270022392272949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6270689964294434  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6355471611022949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6361165046691895  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6361165046691895  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6361794471740723  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6446137428283691  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6450629234313965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6450629234313965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6451106071472168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6518340110778809  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6523351669311523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6523351669311523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6523847579956055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.659724235534668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6601223945617676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6601223945617676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6601605415344238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6660733222961426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6663198471069336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6663198471069336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6663427352905273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6700506210327148  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6703853607177734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6703853607177734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6704139709472656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6752490997314453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([178, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6795120239257812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6795120239257812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6798515319824219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.7396049499511719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 178, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.7202610969543457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.7206954956054688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.7211298942565918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.7206735610961914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2913, 40])
input nodes number: 6684
output nodes number: 2913
edges number: 22942
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.7207441329956055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.7207450866699219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.020503997802734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 1 input nodes size: 11243
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.01902484893798828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.01902484893798828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.024385929107666016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.024407386779785156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.016921043395996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.017343521118164062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.017343521118164062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.017343521118164062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([11243, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.017343521118164062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([577, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03454017639160156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03454017639160156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03509044647216797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.039521217346191406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([636, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03985261917114258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.03985261917114258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.04045915603637695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05007457733154297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([530, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05052947998046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05052947998046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05103492736816406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.06215476989746094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([478, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.06281375885009766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.06281375885009766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.06326961517333984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.07648944854736328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([380, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.07716751098632812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.07716751098632812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.0775299072265625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.090576171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([340, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09136772155761719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09136772155761719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09169197082519531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10563468933105469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([297, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.106475830078125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.106475830078125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.10675907135009766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12092113494873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([254, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12174844741821289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12174844741821289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.12199068069458008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13579797744750977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 254, 128])
m.shape torch.Size([226, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13664674758911133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13664674758911133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 226, 128]), torch.Size([1, 226, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13686227798461914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15065622329711914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 226, 128])
m.shape torch.Size([1906, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16024541854858398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16024541854858398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 1906, 128]), torch.Size([1, 1906, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1620631217956543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2919325828552246  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 1906, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2771463394165039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.28250980377197266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.28823184967041016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.28282642364501953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([5624, 256])
first layer input nodes number: 11243
first layer output nodes number: 5624
edges number: 34496
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.2883176803588867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.29368114471435547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.29503536224365234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.29503536224365234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([413, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.31721019744873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.31721019744873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.31799793243408203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.32429981231689453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([387, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.32465028762817383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.32465028762817383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.32538843154907227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.33739519119262695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([310, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3379201889038086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3379201889038086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.33851146697998047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3522062301635742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([257, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3529829978942871  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3529829978942871  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3534731864929199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3686995506286621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3693675994873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3693675994873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.36972999572753906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.38277626037597656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3834834098815918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3834834098815918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3837771415710449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3964076042175293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3971824645996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3971824645996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3974437713623047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4105091094970703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.41110897064208984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.41110897064208984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.41129016876220703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4216184616088867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4224104881286621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4224104881286621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.422605037689209  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.435056209564209  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.43579530715942383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.43579530715942383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4359612464904785  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.44774293899536133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.44825220108032227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.44825220108032227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.44835901260375977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.45669031143188477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4574098587036133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4574098587036133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4575376510620117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4684000015258789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4688987731933594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4688987731933594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.46898460388183594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4768810272216797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.47757863998413086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.47757863998413086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.47768354415893555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4880690574645996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4885067939758301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4885067939758301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4885716438293457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.49544572830200195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.49590539932250977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.49590539932250977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.49596643447875977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5028634071350098  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5034375190734863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5034375190734863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5035080909729004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5119767189025879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5125126838684082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5125126838684082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.512575626373291  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5205693244934082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5210857391357422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5210857391357422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5211429595947266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5288105010986328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.529109001159668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.529109001159668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5291414260864258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5337133407592773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5341615676879883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5341615676879883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.534205436706543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5406980514526367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5411624908447266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5411624908447266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5412063598632812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5480060577392578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5485591888427734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5485591888427734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5486087799072266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5566425323486328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5570793151855469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5570793151855469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5571174621582031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5635643005371094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([224, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5689277648925781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5689277648925781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5693550109863281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6445503234863281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 224, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6254997253417969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6259250640869141  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6263504028320312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6259036064147949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2854, 40])
input nodes number: 5624
output nodes number: 2854
edges number: 22123
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6259579658508301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6259584426879883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.01816415786743164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 2 input nodes size: 13377
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.016911983489990234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.016911983489990234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.023290634155273438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.023312091827392578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.017929553985595703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.018443584442138672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.018443584442138672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.018443584442138672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([13377, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.018443584442138672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([359, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.04067564010620117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.04067564010620117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.041018009185791016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.043756961822509766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([451, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.04401588439941406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.04401588439941406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.04444599151611328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.05089759826660156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([461, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.051342010498046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.051342010498046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.051781654357910156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.061453819274902344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([465, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.062120914459228516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.062120914459228516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.06256437301635742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.0754246711730957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([438, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.0762472152709961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.0762472152709961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.07666492462158203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09170246124267578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([418, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09268951416015625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09268951416015625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.09308815002441406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1102294921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([374, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11127853393554688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11127853393554688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.11163520812988281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.1294689178466797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([337, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13114213943481445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13114213943481445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.13146352767944336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.14978265762329102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([256, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15072059631347656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15072059631347656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.15096473693847656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.16658973693847656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([2778, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.17971420288085938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.17971420288085938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 2778, 128]), torch.Size([1, 2778, 128])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.18236351013183594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.37084484100341797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 2778, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3509330749511719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3569765090942383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3630199432373047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.35692882537841797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([6337, 256])
first layer input nodes number: 13377
first layer output nodes number: 6337
edges number: 44600
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.36312198638916016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.36916542053222656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3714761734008789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3714761734008789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([279, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3954916000366211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3954916000366211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.3960237503051758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.40073204040527344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([286, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4010157585144043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4010157585144043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.40156126022338867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.41138696670532227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([257, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.41185569763183594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.41185569763183594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.41234588623046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4231700897216797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.42383623123168945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.42383623123168945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.424288272857666  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.43739748001098633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4382290840148926  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4382290840148926  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.43864870071411133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.45375490188598633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([210, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4547562599182129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4547562599182129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4551568031311035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4723801612854004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([177, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.47402143478393555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.47402143478393555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.47435903549194336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.491239070892334  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([151, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4922313690185547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4922313690185547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.4925193786621094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5089359283447266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5097436904907227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5097436904907227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.509953498840332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.523381233215332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([120, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5244297981262207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5244297981262207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5246586799621582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5409092903137207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([109, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5419473648071289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5419473648071289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5421552658081055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5583715438842773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5590405464172363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5590405464172363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5591683387756348  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.570030689239502  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5708417892456055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5708417892456055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5709753036499023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5832586288452148  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5841741561889648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5841741561889648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5843133926391602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5980978012084961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5986485481262207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5986485481262207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.5987305641174316  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.607424259185791  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6080293655395508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6080293655395508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6081094741821289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.617161750793457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.618004322052002  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.618004322052002  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6181073188781738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6304669380187988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6309866905212402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6309866905212402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.631049633026123  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6390433311462402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6395053863525391  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6395053863525391  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.639556884765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6464576721191406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.647066593170166  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.647066593170166  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6471295356750488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6560044288635254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6565179824829102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6565179824829102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6565694808959961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6641912460327148  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6646308898925781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6646308898925781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6646728515625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6711769104003906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.671532154083252  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.671532154083252  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6715645790100098  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6768174171447754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6772627830505371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6772627830505371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6773009300231934  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6837477684020996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([195, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6884145736694336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.6884145736694336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 0.688786506652832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0487060546875 GB
    Memory Allocated: 0.754246711730957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 195, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0487060546875 GB
    Memory Allocated: 0.7332944869995117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0487060546875 GB
    Memory Allocated: 0.7337236404418945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0487060546875 GB
    Memory Allocated: 0.7341527938842773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0487060546875 GB
    Memory Allocated: 0.7337021827697754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2879, 40])
input nodes number: 6337
output nodes number: 2879
edges number: 24301
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0487060546875 GB
    Memory Allocated: 0.7337751388549805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0487060546875 GB
    Memory Allocated: 0.7337756156921387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01941823959350586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 3 input nodes size: 16494
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017933368682861328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017933368682861328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.025798320770263672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.025819778442382812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01941967010498047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01997661590576172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01997661590576172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01997661590576172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([16494, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01997661590576172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([464, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04494905471801758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04494905471801758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04539155960083008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04893159866333008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([560, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04924440383911133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04924440383911133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04977846145629883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.058664798736572266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([553, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0591888427734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0591888427734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.059716224670410156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07140827178955078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([525, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07214593887329102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07214593887329102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0726466178894043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08787012100219727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([451, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08869504928588867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08869504928588867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08912515640258789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10460901260375977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([438, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10564708709716797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10564708709716797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1060647964477539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12402629852294922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([398, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12514591217041016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12514591217041016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12552547454833984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14450359344482422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([363, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14569854736328125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14569854736328125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14604473114013672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16577720642089844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([312, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16694307327270508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16694307327270508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 312, 128]), torch.Size([1, 312, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16724061965942383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18628358840942383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 312, 128])
m.shape torch.Size([3181, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20130300521850586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20130300521850586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 3181, 128]), torch.Size([1, 3181, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2052297592163086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42091989517211914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 3181, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3986191749572754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40552854537963867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41243791580200195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4054741859436035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([7245, 256])
first layer input nodes number: 16494
first layer output nodes number: 7245
edges number: 50534
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41256284713745117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41947221755981445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42173004150390625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42173004150390625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([325, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4457864761352539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4457864761352539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44640636444091797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45163440704345703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([310, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4519205093383789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4519205093383789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4525117874145508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4622621536254883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4627857208251953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4627857208251953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46332740783691406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47686195373535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47747182846069336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47747182846069336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4779086112976074  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49057531356811523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4912991523742676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4912991523742676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49167299270629883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5051312446594238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5059366226196289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5059366226196289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5062646865844727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5203714370727539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5216937065124512  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5216937065124512  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.521979808807373  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5362849235534668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5370340347290039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5370340347290039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5372552871704102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5498666763305664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5506644248962402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5506644248962402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5508646965026855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5636820793151855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([105, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5645914077758789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5645914077758789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5647916793823242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5790109634399414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5800528526306152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5800528526306152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.580258846282959  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5963263511657715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([81, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5971579551696777  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5971579551696777  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5973124504089355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6104445457458496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.611304759979248  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.611304759979248  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.611447811126709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6246085166931152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6253175735473633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6253175735473633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6254281997680664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6363801956176758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6370172500610352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6370172500610352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6371088027954102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6468133926391602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6476750373840332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6476750373840332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6477875709533691  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6605038642883301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6610689163208008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6610689163208008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6611413955688477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6698389053344727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6705813407897949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6705813407897949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6706671714782715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6815676689147949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6820363998413086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6820363998413086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6820898056030273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6892461776733398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.689969539642334  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.689969539642334  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6900439262390137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7005324363708496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7012019157409668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7012019157409668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7012686729431152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.711148738861084  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7115597724914551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7115597724914551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7115998268127441  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7178082466125488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7181863784790039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7181863784790039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7182207107543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7237825393676758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7242732048034668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7242732048034668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7243151664733887  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7314066886901855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([197, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7361974716186523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7361974716186523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7365732192993164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8027048110961914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 197, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7817387580871582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.78216552734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7825922966003418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7821440696716309  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2864, 40])
input nodes number: 7245
output nodes number: 2864
edges number: 24141
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7822175025939941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7822179794311523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021029949188232422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 4 input nodes size: 16044
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019417285919189453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019417285919189453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02706766128540039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.027089595794677734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01920318603515625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01986408233642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01986408233642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01986408233642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([16044, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01986408233642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([410, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.050119876861572266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.050119876861572266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05051088333129883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05363893508911133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([492, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05391263961791992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05391263961791992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0543818473815918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06141996383666992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([531, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06194496154785156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06194496154785156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06245136260986328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0736093521118164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([496, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07430219650268555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07430219650268555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07477521896362305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08849287033081055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([516, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08948659896850586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08948659896850586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08997869491577148  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10819768905639648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([420, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10982847213745117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10982847213745117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1102290153503418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12745237350463867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([436, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1287074089050293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1287074089050293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12912321090698242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14991331100463867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([422, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15131521224975586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15131521224975586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1517176628112793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17465734481811523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([357, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17598819732666016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17598819732666016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1763286590576172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1981182098388672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([4093, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21747922897338867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21747922897338867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 4093, 128]), torch.Size([1, 4093, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22138261795043945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49867916107177734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 4093, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47119569778442383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4789900779724121  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4867844581604004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4789290428161621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([8173, 256])
first layer input nodes number: 16044
first layer output nodes number: 8173
edges number: 60642
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4869060516357422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49470043182373047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49664926528930664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49664926528930664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([282, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5246000289916992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5246000289916992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5251379013061523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.530524730682373  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([283, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5307998657226562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5307998657226562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5313396453857422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5407981872558594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([254, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5412607192993164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5412607192993164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5417451858520508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.552403450012207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([200, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5529303550720215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5529303550720215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.553311824798584  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5643744468688965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([174, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5650200843811035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5650200843811035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5653519630432129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5772995948791504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5780391693115234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5780391693115234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.578338623046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5912151336669922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([163, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5921621322631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5921621322631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.592473030090332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6080179214477539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([146, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6096463203430176  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6096463203430176  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6099247932434082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6257977485656738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6267056465148926  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6267056465148926  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6269364356994629  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6417069435119629  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([110, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6426491737365723  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6426491737365723  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6428589820861816  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6577553749084473  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([110, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6595144271850586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6595144271850586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.659724235534668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6760892868041992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.676872730255127  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.676872730255127  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6770195960998535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6895031929016113  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6902923583984375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6902923583984375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6904239654541016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7025318145751953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([77, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7035021781921387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7035021781921387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7036490440368652  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7181887626647949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7190093994140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7190093994140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7191276550292969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7316627502441406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7324190139770508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7324190139770508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7325201034545898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7439432144165039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.744873046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.744873046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7449874877929688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7587203979492188  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7592687606811523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7592687606811523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7593355178833008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7678136825561523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7682371139526367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7682371139526367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.768284797668457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7746744155883789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.775477409362793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.775477409362793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7755594253540039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7871236801147461  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7876882553100586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7876882553100586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.787745475769043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7962141036987305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7967352867126465  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7967352867126465  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7967848777770996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.804471492767334  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8049330711364746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8049330711364746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8049750328063965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8117728233337402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8124208450317383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8124208450317383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8124761581420898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8218240737915039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([319, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8294615745544434  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8294615745544434  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8300700187683105  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9389948844909668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 319, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9149866104125977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9154229164123535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9158592224121094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9154009819030762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2927, 40])
input nodes number: 8173
output nodes number: 2927
edges number: 27971
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9154934883117676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9154939651489258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021079063415527344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 5 input nodes size: 27535
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019212722778320312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019212722778320312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03234243392944336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0323634147644043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.024691104888916016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02536916732788086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02536916732788086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02536916732788086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([27535, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02536916732788086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([707, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.060553550720214844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.060553550720214844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 707, 128]), torch.Size([1, 707, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06122779846191406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06702470779418945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 707, 128])
m.shape torch.Size([781, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06743240356445312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06743240356445312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 781, 128]), torch.Size([1, 781, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0681772232055664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08001136779785156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 781, 128])
m.shape torch.Size([746, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08070611953735352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08070611953735352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 746, 128]), torch.Size([1, 746, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08141756057739258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09756040573120117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 746, 128])
m.shape torch.Size([721, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09857988357543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09857988357543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09926748275756836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12040376663208008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([624, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12154769897460938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12154769897460938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12214279174804688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1439056396484375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([558, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1452045440673828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1452045440673828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1457366943359375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16945648193359375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([502, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1708660125732422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1708660125732422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17134475708007812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.195281982421875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([493, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19692325592041016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19692325592041016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 493, 128]), torch.Size([1, 493, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19739341735839844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22419261932373047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 493, 128])
m.shape torch.Size([447, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2258758544921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2258758544921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2263021469116211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2535848617553711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([4582, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2752203941345215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2752203941345215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 4582, 128]), torch.Size([1, 4582, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2795901298522949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.589841365814209  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 4582, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5583744049072266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5680646896362305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5777549743652344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5679888725280762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([10161, 256])
first layer input nodes number: 27535
first layer output nodes number: 10161
edges number: 71160
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5781130790710449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5878033638000488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5903768539428711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5903768539428711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([447, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6099224090576172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6099224090576172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6107749938964844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6186370849609375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([401, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6189818382263184  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6189818382263184  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6197466850280762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6338915824890137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([327, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6344523429870605  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6344523429870605  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6350760459899902  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6552743911743164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6559200286865234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6559200286865234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6563949584960938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6701679229736328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6709060668945312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6709060668945312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6712932586669922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6852321624755859  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6860132217407227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6860132217407227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.686335563659668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7001962661743164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.700836181640625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.700836181640625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7010631561279297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7124118804931641  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7131519317626953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7131519317626953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7133636474609375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7254314422607422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7260699272155762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7260699272155762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.726233959197998  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.736732006072998  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([59, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7372174263000488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7372174263000488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7373299598693848  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7453198432922363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([45, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7457394599914551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7457394599914551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7458252906799316  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7525200843811035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7531232833862305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7531232833862305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.753230094909668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7623090744018555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7627558708190918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7627558708190918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7628321647644043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7698512077331543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.770418643951416  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.770418643951416  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7705044746398926  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7790017127990723  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7794637680053711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7794637680053711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7795305252075195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7866067886352539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.787111759185791  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.787111759185791  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7871785163879395  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7947220802307129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7951302528381348  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7951302528381348  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7951817512512207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8013615608215332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8018379211425781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8018379211425781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8018932342529297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8089179992675781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8093471527099609  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8093471527099609  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8093948364257812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8157844543457031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8161454200744629  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8161454200744629  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8161835670471191  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8215622901916504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8219270706176758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8219270706176758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8219633102416992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.827326774597168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8276472091674805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8276472091674805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8276777267456055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8324079513549805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.83270263671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.83270263671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8327293395996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8370552062988281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8372960090637207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8372960090637207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8373169898986816  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8408627510070801  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([193, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8458843231201172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8458843231201172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.84625244140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.911041259765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 193, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8945937156677246  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8950085639953613  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.895423412322998  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8949875831604004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2781, 40])
input nodes number: 10161
output nodes number: 2781
edges number: 19760
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8950629234313965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8950634002685547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.026638507843017578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 6 input nodes size: 16835
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.024669647216796875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.024669647216796875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.032697200775146484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03271818161010742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019567489624023438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02005767822265625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02005767822265625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02005767822265625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([16835, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02005767822265625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([746, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04287099838256836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04287099838256836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 746, 128]), torch.Size([1, 746, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04358243942260742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.050296783447265625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 746, 128])
m.shape torch.Size([734, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05064105987548828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05064105987548828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 734, 128]), torch.Size([1, 734, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05134105682373047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06184101104736328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 734, 128])
m.shape torch.Size([678, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.062460899353027344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.062460899353027344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06310749053955078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0780649185180664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([566, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07882118225097656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07882118225097656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0793609619140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09644508361816406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([529, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09743642807006836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09743642807006836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09794092178344727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11620521545410156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([412, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11713171005249023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11713171005249023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11752462387084961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13441991806030273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([411, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13559532165527344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13559532165527344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1359872817993164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15558528900146484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([312, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15657949447631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15657949447631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 312, 128]), torch.Size([1, 312, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1568770408630371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17383718490600586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 312, 128])
m.shape torch.Size([286, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17491579055786133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17491579055786133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17518854141235352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19264459609985352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 286, 128])
m.shape torch.Size([2622, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20501089096069336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20501089096069336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 2622, 128]), torch.Size([1, 2622, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20832157135009766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3913002014160156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 2622, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.371549129486084  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.378507137298584  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.385465145111084  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.37845277786254883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([7296, 256])
first layer input nodes number: 16835
first layer output nodes number: 7296
edges number: 45796
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3855929374694824  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3925509452819824  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3946871757507324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3946871757507324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([497, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41497087478637695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41497087478637695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41591882705688477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4242386817932129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([400, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4245338439941406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4245338439941406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4252967834472656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4367408752441406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([324, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43729400634765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43729400634765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4379119873046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4517059326171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45226240158081055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45226240158081055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45269155502319336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4651370048522949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46596813201904297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46596813201904297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46635913848876953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4804353713989258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4810357093811035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4810357093811035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48129892349243164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.492617130279541  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.493441104888916  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.493441104888916  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4937119483947754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5072541236877441  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([84, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5077648162841797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5077648162841797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5079250335693359  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5170574188232422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5178251266479492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5178251266479492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5180120468139648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5299749374389648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5305929183959961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5305929183959961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5307340621948242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5407552719116211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5413403511047363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5413403511047363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5414586067199707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.550682544708252  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5511889457702637  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5511889457702637  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5512824058532715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5592265129089355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5597171783447266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5597171783447266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5597991943359375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5673446655273438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5678553581237793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5678553581237793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5679335594177246  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5756754875183105  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5762710571289062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5762710571289062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.57635498046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5852508544921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5856857299804688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5856857299804688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5857448577880859  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5924263000488281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5930013656616211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5930013656616211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5930719375610352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6015405654907227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6019034385681152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6019034385681152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6019473075866699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6075186729431152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6079716682434082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6079716682434082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6080212593078613  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6146664619445801  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6150455474853516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6150455474853516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6150856018066406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6207332611083984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6211977005004883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6211977005004883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6212434768676758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6280183792114258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6283130645751953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6283130645751953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6283416748046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6327762603759766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.633049488067627  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.633049488067627  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6330742835998535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6370911598205566  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6372866630554199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6372866630554199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6373038291931152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.640204906463623  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([188, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6447138786315918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6447138786315918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6450724601745605  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7081828117370605  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 188, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6910815238952637  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6915011405944824  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6919207572937012  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6914801597595215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2813, 40])
input nodes number: 7296
output nodes number: 2813
edges number: 19875
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6915602684020996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6915607452392578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021022796630859375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 7 input nodes size: 16719
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01957225799560547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01957225799560547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.027544498443603516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.027565956115722656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01951742172241211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020141124725341797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020141124725341797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020141124725341797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([16719, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020141124725341797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([527, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0484619140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0484619140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.048964500427246094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.053716182708740234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([535, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05397510528564453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05397510528564453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.054485321044921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06213855743408203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([557, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06268024444580078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06268024444580078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06321144104003906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07518196105957031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([545, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07595586776733398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07595586776733398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07647562026977539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09174108505249023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([542, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0927734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0927734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09329032897949219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1119527816772461  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([502, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11313056945800781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11313056945800781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11360931396484375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13419532775878906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([434, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1354045867919922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1354045867919922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1358184814453125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15651321411132812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([374, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15773296356201172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15773296356201172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15808963775634766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1784200668334961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([336, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18013668060302734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18013668060302734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18045711517333984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20096492767333984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 336, 128])
m.shape torch.Size([3617, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21805191040039062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21805191040039062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 3617, 128]), torch.Size([1, 3617, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2220606803894043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47144556045532227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 3617, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44567060470581055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45327043533325195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46087026596069336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45321083068847656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([7969, 256])
first layer input nodes number: 16719
first layer output nodes number: 7969
edges number: 56394
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4609971046447754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4685969352722168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47053050994873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47053050994873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([359, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4971461296081543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4971461296081543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.497830867767334  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5036954879760742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([288, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5039067268371582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5039067268371582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5044560432434082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.513460636138916  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([256, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5139241218566895  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5139241218566895  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5144124031066895  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5251545906066895  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5257258415222168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5257258415222168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.526130199432373  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5378565788269043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5386013984680176  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5386013984680176  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5389771461486816  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5525040626525879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5531816482543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5531816482543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5534677505493164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.565770149230957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5664281845092773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5664281845092773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.566655158996582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5780038833618164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5787596702575684  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5787596702575684  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5789752006530762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5912604331970215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([117, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5921964645385742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5921964645385742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5924196243286133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6067018508911133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6075129508972168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6075129508972168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6076960563659668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6206965446472168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6213345527648926  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6213345527648926  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6214661598205566  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6317315101623535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6325311660766602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6325311660766602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6326742172241211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6448335647583008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6455121040344238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6455121040344238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6456265449523926  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6561551094055176  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6567573547363281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6567573547363281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6568508148193359  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6661033630371094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6667633056640625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6667633056640625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6668567657470703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6767635345458984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.677147388458252  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.677147388458252  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6772007942199707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6832356452941895  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6839118003845215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6839118003845215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6839938163757324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6938357353210449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6945042610168457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6945042610168457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.694582462310791  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7045140266418457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7051692008972168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7051692008972168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7052416801452637  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7149538993835449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7157635688781738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7157635688781738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7158474922180176  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7276806831359863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7283048629760742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7283048629760742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.728367805480957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7376832962036133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.738011360168457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.738011360168457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7380437850952148  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7430696487426758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7437167167663574  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7437167167663574  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7437739372253418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7530436515808105  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7534537315368652  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7534537315368652  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7534899711608887  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7596144676208496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([377, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7686553001403809  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7686553001403809  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7693743705749512  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8996424674987793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 377, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8760151863098145  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8764443397521973  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8768734931945801  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8764228820800781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2879, 40])
input nodes number: 7969
output nodes number: 2879
edges number: 27203
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8765134811401367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8765139579772949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021314144134521484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 8 input nodes size: 12079
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019526958465576172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019526958465576172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02528667449951172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.025308609008789062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017314910888671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017668724060058594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017668724060058594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017668724060058594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([12079, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017668724060058594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([755, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03327131271362305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03327131271362305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 755, 128]), torch.Size([1, 755, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.033991336822509766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.039751529693603516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 755, 128])
m.shape torch.Size([818, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04017162322998047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04017162322998047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04095172882080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05265331268310547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([680, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05323600769042969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05323600769042969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 680, 128]), torch.Size([1, 680, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05388450622558594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06845521926879883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 680, 128])
m.shape torch.Size([584, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0692448616027832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0692448616027832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06980180740356445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0869145393371582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 584, 128])
m.shape torch.Size([516, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08786630630493164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08786630630493164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08835840225219727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10666704177856445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([378, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10750246047973633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10750246047973633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10786294937133789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12336397171020508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([330, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12428522109985352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12428522109985352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12459993362426758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1403355598449707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([287, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14127302169799805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14127302169799805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 287, 128]), torch.Size([1, 287, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14154672622680664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15714788436889648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 287, 128])
m.shape torch.Size([233, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15801095962524414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15801095962524414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 233, 128]), torch.Size([1, 233, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1582331657409668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1724543571472168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 233, 128])
m.shape torch.Size([1269, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17839431762695312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17839431762695312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 1269, 128]), torch.Size([1, 1269, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17960453033447266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2660331726074219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 1269, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.25331640243530273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2588953971862793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.26447439193725586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2588515281677246  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([5850, 256])
first layer input nodes number: 12079
first layer output nodes number: 5850
edges number: 31008
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.26456642150878906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2701454162597656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2716202735900879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2716202735900879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([515, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.28794193267822266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.28794193267822266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2889242172241211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.297607421875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([470, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2980198860168457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2980198860168457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2989163398742676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.312563419342041  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([367, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.31350183486938477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.31350183486938477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.31420183181762695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3300356864929199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([298, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.33083152770996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.33083152770996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.33139991760253906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34796905517578125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([250, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34888648986816406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34888648986816406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3493633270263672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3665294647216797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([174, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3672947883605957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3672947883605957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3676266670227051  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3818974494934082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3826603889465332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3826603889465332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.38292360305786133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3960843086242676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.39689111709594727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.39689111709594727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3971238136291504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4103875160217285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.411041259765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.411041259765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4112110137939453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4220752716064453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4227595329284668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4227595329284668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4229121208190918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4337458610534668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4342193603515625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4342193603515625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43431854248046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44205474853515625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4424552917480469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4424552917480469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44252967834472656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4488525390625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44931554794311523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44931554794311523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44939184188842773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45641088485717773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4568305015563965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4568305015563965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4568953514099121  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.463315486907959  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4637589454650879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4637589454650879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4638218879699707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47049379348754883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47086238861083984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47086238861083984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47091197967529297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4765157699584961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4768342971801758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4768342971801758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47687435150146484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48168087005615234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.482180118560791  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.482180118560791  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4822373390197754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.489504337310791  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.489713191986084  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.489713191986084  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48973798751831055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4930605888366699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49325990676879883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49325990676879883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49328088760375977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49623918533325195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49645090103149414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49645090103149414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4964718818664551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49957704544067383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4997572898864746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4997572898864746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4997744560241699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5024352073669434  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5025815963745117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5025815963745117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5025949478149414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5047578811645508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.504889965057373  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.504889965057373  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5049014091491699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5068354606628418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([68, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5084638595581055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5084638595581055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5085935592651367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5314207077026367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 68, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5189242362976074  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5193572044372559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5197901725769043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5193352699279785  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2903, 40])
input nodes number: 5850
output nodes number: 2903
edges number: 16330
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5194048881530762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5194053649902344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.018403053283691406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 9 input nodes size: 11089
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0173187255859375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0173187255859375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023277759552001953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023299217224121094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017517566680908203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01783609390258789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01783609390258789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01783609390258789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([11089, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01783609390258789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([831, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03213691711425781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03213691711425781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.032929420471191406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0402064323425293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([900, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.040668487548828125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.040668487548828125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04152679443359375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.055142879486083984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([754, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05579233169555664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05579233169555664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05651140213012695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07322835922241211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([586, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07452058792114258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07452058792114258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07507944107055664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0918278694152832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([488, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0927119255065918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0927119255065918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09317731857299805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10993146896362305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([400, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11084318161010742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11084318161010742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11122465133666992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12762784957885742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([329, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12853527069091797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12853527069091797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12884902954101562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14453697204589844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([258, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14536428451538086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14536428451538086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14561033248901367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15963506698608398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([233, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16051197052001953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16051197052001953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 233, 128]), torch.Size([1, 233, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1607341766357422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1749553680419922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 233, 128])
m.shape torch.Size([971, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1794743537902832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1794743537902832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18040037155151367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24614763259887695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 971, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.23483991622924805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24032354354858398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24580717086791992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2402806282043457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([5750, 256])
first layer input nodes number: 11089
first layer output nodes number: 5750
edges number: 28251
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24589204788208008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.25171422958374023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2530951499938965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2530951499938965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([567, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2675929069519043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2675929069519043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.268674373626709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2773261070251465  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([489, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2777256965637207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2777256965637207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.278658390045166  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.292874813079834  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([413, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.29390764236450195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.29390764236450195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2946953773498535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3129281997680664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([295, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.31366872787475586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.31366872787475586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.31423139572143555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.331174373626709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([238, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.33203697204589844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.33203697204589844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3324909210205078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3488330841064453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([179, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3496384620666504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3496384620666504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34997987747192383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.36466073989868164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.36531782150268555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.36531782150268555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3655524253845215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.37728261947631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3779573440551758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3779573440551758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.37815380096435547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.38935184478759766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.38994598388671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.38994598388671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.39009857177734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.39986419677734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4004707336425781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4004707336425781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4006061553955078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4102210998535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4107246398925781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4107246398925781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41082763671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41886138916015625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41930627822875977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41930627822875977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4193882942199707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4263596534729004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4267563819885254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4267563819885254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42682313919067383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4329648017883301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4333353042602539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4333353042602539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4333925247192383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4390573501586914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43946170806884766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43946170806884766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43951892852783203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4455842971801758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([12, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4457402229309082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4457402229309082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44576311111450195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4483494758605957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44858312606811523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44858312606811523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4486117362976074  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4520449638366699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.452272891998291  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.452272891998291  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4522995948791504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.455690860748291  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4558238983154297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4558238983154297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4558391571044922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4578838348388672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45804929733276367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45804929733276367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.458066463470459  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46048688888549805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46057939529418945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46057939529418945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4605889320373535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46200037002563477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4620804786682129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4620804786682129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46208810806274414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4632706642150879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46339988708496094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46339988708496094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4634113311767578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46526527404785156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46544408798217773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46544408798217773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46545934677124023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46803808212280273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([42, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46904945373535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46904945373535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4691295623779297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4832286834716797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 42, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.472137451171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4725656509399414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4729938507080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47254419326782227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2873, 40])
input nodes number: 5750
output nodes number: 2873
edges number: 14382
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47260379791259766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47260427474975586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.018501758575439453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 10 input nodes size: 10458
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017512798309326172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017512798309326172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02327251434326172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023294448852539062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01731395721435547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017638206481933594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017638206481933594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017638206481933594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([10458, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017638206481933594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([792, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03196907043457031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03196907043457031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03272438049316406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03876686096191406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([827, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.039177894592285156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.039177894592285156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.039966583251953125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.051796913146972656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([717, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05243825912475586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05243825912475586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05312204360961914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06816530227661133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([591, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06911706924438477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06911706924438477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06968069076538086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08633661270141602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([527, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0873112678527832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0873112678527832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0878138542175293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10634613037109375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([395, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10722494125366211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10722494125366211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10760164260864258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12379980087280273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([317, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12466955184936523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12466955184936523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12497186660766602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14008760452270508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([259, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14092445373535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14092445373535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14117145538330078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15525054931640625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([211, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15603256225585938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15603256225585938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1562337875366211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1691122055053711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([1020, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1738753318786621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1738753318786621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 1020, 128]), torch.Size([1, 1020, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17484807968139648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24440288543701172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 1020, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.23297834396362305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2383723258972168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24376630783081055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.23832988739013672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([5656, 256])
first layer input nodes number: 10458
first layer output nodes number: 5656
edges number: 28356
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24384641647338867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24924039840698242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.25139570236206055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.25139570236206055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([545, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2664761543273926  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2664761543273926  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 545, 256]), torch.Size([1, 545, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2675156593322754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.27710390090942383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 545, 256])
m.shape torch.Size([484, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2775149345397949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2775149345397949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 484, 256]), torch.Size([1, 484, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.27843809127807617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2922854423522949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 484, 256])
m.shape torch.Size([370, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2931246757507324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2931246757507324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.29383039474487305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.30977582931518555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([283, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.31051111221313477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.31051111221313477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3110508918762207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3267045021057129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([261, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.32768917083740234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.32768917083740234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3281869888305664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34659576416015625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([181, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34739065170288086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34739065170288086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3477358818054199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3625807762145996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3633570671081543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3633570671081543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.36362600326538086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.377072811126709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3778228759765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3778228759765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.37804222106933594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3905448913574219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.391265869140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.391265869140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.391448974609375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.403167724609375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([56, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40361452102661133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40361452102661133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40372133255004883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41130495071411133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4118647575378418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4118647575378418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4119753837585449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42060422897338867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42118358612060547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42118358612060547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42128849029541016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4302053451538086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([33, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43056535720825195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43056535720825195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43062829971313477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4364190101623535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43689918518066406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43689918518066406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43697166442871094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44414710998535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44455814361572266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44455814361572266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44461727142333984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4508848190307617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45131683349609375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45131683349609375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4513740539550781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4578399658203125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45810556411743164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45810556411743164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45813989639282227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46225976943969727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46246767044067383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46246767044067383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4624924659729004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46564149856567383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46581172943115234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46581172943115234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46583080291748047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4683866500854492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4684734344482422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4684734344482422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46848297119140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46982765197753906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4700450897216797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4700450897216797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4700660705566406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4731712341308594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47328805923461914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47328805923461914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.473299503326416  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47507333755493164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.475156307220459  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.475156307220459  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47516393661499023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47639989852905273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47655773162841797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47655773162841797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47657108306884766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47882747650146484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([35, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4796619415283203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4796619415283203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47972869873046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49147796630859375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47980785369873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4802379608154297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4806680679321289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48021602630615234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2886, 40])
input nodes number: 5656
output nodes number: 2886
edges number: 15009
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4802823066711426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4802827835083008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.018315792083740234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 11 input nodes size: 17957
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01731586456298828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01731586456298828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.025878429412841797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02590036392211914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02011871337890625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020666122436523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020666122436523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020666122436523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([17957, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020666122436523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([624, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.045635223388671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.045635223388671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.046230316162109375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.051962852478027344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([733, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.052364349365234375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.052364349365234375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.053063392639160156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06354904174804688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([679, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06417083740234375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06417083740234375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0648183822631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0798044204711914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([580, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08058691024780273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08058691024780273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08114004135131836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09827756881713867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([468, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09911680221557617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09911680221557617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0995631217956543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1156306266784668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([479, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11677789688110352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11677789688110352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11723470687866211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13687753677368164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([373, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1378941535949707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1378941535949707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13824987411499023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1560359001159668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([382, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15731525421142578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15731525421142578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 382, 128]), torch.Size([1, 382, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15767955780029297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17844486236572266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 382, 128])
m.shape torch.Size([327, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17966604232788086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17966604232788086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1799778938293457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1999363899230957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([3007, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21411895751953125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21411895751953125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 3007, 128]), torch.Size([1, 3007, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21698665618896484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43039655685424805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 3007, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40767765045166016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4149751663208008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4222726821899414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4149179458618164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([7652, 256])
first layer input nodes number: 17957
first layer output nodes number: 7652
edges number: 50341
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4224085807800293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4297060966491699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43203115463256836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43203115463256836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([414, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45464658737182617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45464658737182617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45543622970581055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46224355697631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([397, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4626121520996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4626121520996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46336936950683594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47506046295166016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47554731369018555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47554731369018555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4761195182800293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4901151657104492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49075984954833984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49075984954833984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49122142791748047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5046072006225586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5052270889282227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5052270889282227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5055646896362305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5177183151245117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.518460750579834  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.518460750579834  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5187621116638184  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5317206382751465  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5323505401611328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5323505401611328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5325717926025391  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5436344146728516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([145, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5446391105651855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5446391105651855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5449156761169434  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5606799125671387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5613551139831543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5613551139831543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5615344047546387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5730090141296387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5737652778625488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5737652778625488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5739331245422363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5858502388000488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.586644172668457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.586644172668457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5868024826049805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5991506576538086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5997638702392578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5997638702392578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5998783111572266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6096057891845703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6101861000061035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6101861000061035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.610283374786377  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6192326545715332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.619816780090332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.619816780090332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6199064254760742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6287813186645508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6293277740478516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6293277740478516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6294059753417969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6376953125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6382713317871094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6382713317871094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6383476257324219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6469688415527344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6475191116333008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6475191116333008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.647587776184082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.655827522277832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6564335823059082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6564335823059082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6565041542053223  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6654667854309082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6659793853759766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6659793853759766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6660366058349609  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6737041473388672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6741757392883301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6741757392883301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6742253303527832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6812176704406738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6816978454589844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6816978454589844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6817455291748047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6888027191162109  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.68939208984375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.68939208984375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6894474029541016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6980209350585938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6984796524047852  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6984796524047852  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.698521614074707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7053194046020508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7057600021362305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7057600021362305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7057981491088867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.712244987487793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([226, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7176566123962402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7176566123962402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7180876731872559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7939543724060059  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 226, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7745175361633301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7749505043029785  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.775383472442627  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7749285697937012  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2904, 40])
input nodes number: 7652
output nodes number: 2904
edges number: 22983
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7750105857849121  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7750110626220703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021726608276367188  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 12 input nodes size: 19495
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02012157440185547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02012157440185547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02941751480102539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029439449310302734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020854949951171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021462440490722656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021462440490722656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021462440490722656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([19495, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021462440490722656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([487, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04854774475097656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04854774475097656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.049012184143066406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.052727699279785156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([549, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.053019046783447266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.053019046783447266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0535426139831543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.061867713928222656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([574, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06242704391479492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06242704391479492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06297445297241211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07593107223510742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([492, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07659578323364258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07659578323364258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07706499099731445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09067201614379883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([457, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09152698516845703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09152698516845703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09196281433105469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10765266418457031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([379, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10851907730102539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10851907730102539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10888051986694336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12442255020141602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([358, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12543678283691406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12543678283691406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1257781982421875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14284896850585938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([358, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1440439224243164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1440439224243164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14438533782958984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16384601593017578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([316, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16503143310546875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16503143310546875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16533279418945312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18461990356445312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([3680, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20204734802246094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20204734802246094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 3680, 128]), torch.Size([1, 3680, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20555686950683594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45633506774902344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 3680, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4316983222961426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4389939308166504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4462895393371582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.438936710357666  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([7650, 256])
first layer input nodes number: 19495
first layer output nodes number: 7650
edges number: 54848
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44643688201904297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4537324905395508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4555778503417969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4555778503417969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([324, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4816098213195801  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4816098213195801  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48222780227661133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48822879791259766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([338, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4885697364807129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4885697364807129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4892144203186035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4988846778869629  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4993295669555664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4993295669555664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49983692169189453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5123147964477539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5129570960998535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5129570960998535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5134015083312988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5262894630432129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5269899368286133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5269899368286133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5273561477661133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5405397415161133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5411758422851562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5411758422851562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5414466857910156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5530929565429688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5538458824157715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5538458824157715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5540976524353027  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5666861534118652  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5680027008056641  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5680027008056641  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5682487487792969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5822734832763672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5830245018005371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5830245018005371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5832171440124512  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5955462455749512  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([106, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5964689254760742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5964689254760742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5966711044311523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6110258102416992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6118025779724121  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6118025779724121  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6119608879089355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6243090629577637  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([90, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6252679824829102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6252679824829102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6254396438598633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6400308609008789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6408076286315918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6408076286315918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6409392356872559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6530470848083496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.653923511505127  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.653923511505127  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6540570259094238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6672749519348145  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6679725646972656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6679725646972656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6680736541748047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6787891387939453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6793231964111328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6793231964111328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6793956756591797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6875858306884766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6882195472717285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6882195472717285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6882977485656738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6976819038391113  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.698214054107666  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.698214054107666  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6982769966125488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.706270694732666  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7068057060241699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7068057060241699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7068648338317871  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7147879600524902  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7152776718139648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7152776718139648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7153291702270508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.722590446472168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7231502532958984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7231502532958984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.72320556640625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7313919067382812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7320199012756348  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7320199012756348  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.732079029083252  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.741243839263916  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7415680885314941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7415680885314941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7415986061096191  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7465424537658691  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7470808029174805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7470808029174805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.747126579284668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7548627853393555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([327, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7626972198486328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7626972198486328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7633209228515625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8782529830932617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 327, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8552637100219727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8557000160217285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8561363220214844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8556780815124512  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2925, 40])
input nodes number: 7650
output nodes number: 2925
edges number: 26570
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8557605743408203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8557610511779785  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.022621631622314453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 13 input nodes size: 16136
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020858287811279297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020858287811279297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.028552532196044922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.028574466705322266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019256591796875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019669532775878906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019669532775878906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019669532775878906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([16136, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019669532775878906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([865, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04017019271850586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04017019271850586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.040995121002197266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.048319339752197266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([820, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04868888854980469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04868888854980469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04947090148925781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.061885833740234375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([729, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06253767013549805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06253767013549805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0632328987121582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07947063446044922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 729, 128])
m.shape torch.Size([602, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08027124404907227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08027124404907227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08084535598754883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09839487075805664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([522, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09935235977172852  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09935235977172852  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09985017776489258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1182551383972168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([410, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11917924880981445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11917924880981445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11957025527954102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1363835334777832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([331, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13729286193847656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13729286193847656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13760852813720703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15339183807373047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([367, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1546339988708496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1546339988708496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1549839973449707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17493391036987305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([234, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17576313018798828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17576313018798828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17598628997802734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19026851654052734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([1977, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1995840072631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1995840072631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 1977, 128]), torch.Size([1, 1977, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20146942138671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.33871936798095703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 1977, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.321380615234375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.32791996002197266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3344593048095703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3278684616088867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([6857, 256])
first layer input nodes number: 16136
first layer output nodes number: 6857
edges number: 39299
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3345818519592285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34112119674682617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34368371963500977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34368371963500977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([611, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3596782684326172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3596782684326172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3608436584472656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3711056709289551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 611, 256])
m.shape torch.Size([461, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.37140941619873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.37140941619873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.37228870391845703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3858656883239746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([383, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3866114616394043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3866114616394043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3873419761657715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40471696853637695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([279, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40569400787353516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40569400787353516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40622615814208984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4216585159301758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42245006561279297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42245006561279297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4228696823120117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4379758834838867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4386715888977051  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4386715888977051  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43897104263305664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45184755325317383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([112, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4524517059326172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4524517059326172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4526653289794922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4633464813232422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46411657333374023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46411657333374023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46433401107788086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4767279624938965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47728538513183594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47728538513183594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4774322509765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4868316650390625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4874119758605957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4874119758605957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48754167556762695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4967503547668457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4972038269042969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4972038269042969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4972972869873047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5045871734619141  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5050368309020996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5050368309020996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5051188468933105  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5120902061462402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5126242637634277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5126242637634277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5127120018005371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5207839012145996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5211844444274902  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5211844444274902  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.521247386932373  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5274786949157715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5279808044433594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5279808044433594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5280513763427734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5355319976806641  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.535881519317627  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.535881519317627  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5359292030334473  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5413174629211426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5416698455810547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5416698455810547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5417137145996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5469779968261719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5472331047058105  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5472331047058105  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5472636222839355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5511393547058105  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5513434410095215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5513434410095215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5513663291931152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5544333457946777  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5546722412109375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5546722412109375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5546970367431641  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5581932067871094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5584230422973633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5584230422973633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.558445930480957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.561833381652832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5619068145751953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5619068145751953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5619144439697266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5630970001220703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5632038116455078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5632038116455078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5632133483886719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.56475830078125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5649151802062988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5649151802062988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5649285316467285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5671849250793457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([85, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.569221019744873  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.569221019744873  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5693831443786621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5979170799255371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 85, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5853610038757324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.585792064666748  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5862231254577637  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5857701301574707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2892, 40])
input nodes number: 6857
output nodes number: 2892
edges number: 15894
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5858383178710938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.585838794708252  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020504474639892578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 14 input nodes size: 10735
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019251346588134766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019251346588134766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.024370193481445312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.024392127990722656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.016675949096679688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017081260681152344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017081260681152344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017081260681152344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([10735, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017081260681152344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([618, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03445100784301758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03445100784301758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03504037857055664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03975534439086914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([664, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04009389877319336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04009389877319336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04072713851928711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05075645446777344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([617, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05132246017456055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05132246017456055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0519108772277832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06562471389770508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([592, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06645965576171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06645965576171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06702423095703125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0836334228515625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([520, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08459091186523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08459091186523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08508682250976562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10353279113769531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([395, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1044149398803711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1044149398803711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10479164123535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12098979949951172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([377, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12205982208251953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12205982208251953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12241935729980469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1403961181640625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([320, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14143705368041992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14143705368041992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14174222946166992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15913724899291992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16011762619018555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16011762619018555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1603693962097168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1764826774597168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([1607, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1840195655822754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1840195655822754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 1607, 128]), torch.Size([1, 1607, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18555212020874023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.29436349868774414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 1607, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.27978086471557617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2854781150817871  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.29117536544799805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.285433292388916  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([5974, 256])
first layer input nodes number: 10735
first layer output nodes number: 5974
edges number: 34780
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.291257381439209  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2969546318054199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.29837894439697266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.29837894439697266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([398, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3185696601867676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3185696601867676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.31932878494262695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.32540178298950195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([390, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3257722854614258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3257722854614258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.32651615142822266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.33781909942626953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.33832693099975586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.33832693099975586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.33890867233276367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3519444465637207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([270, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3528022766113281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3528022766113281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3533172607421875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.36893367767333984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([233, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3697962760925293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3697962760925293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3702406883239746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.38623952865600586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3870406150817871  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3870406150817871  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3873782157897949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40189504623413086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([191, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4030113220214844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4030113220214844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40337562561035156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42159080505371094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([139, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42247772216796875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42247772216796875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4227428436279297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4378547668457031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([119, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4387516975402832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4387516975402832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4389786720275879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4535050392150879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4543142318725586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4543142318725586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4544973373413086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4674978256225586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46824169158935547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46824169158935547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46839237213134766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4801454544067383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48088932037353516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48088932037353516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48102474212646484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4925355911254883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4933304786682129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4933304786682129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49346208572387695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5055699348449707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5062847137451172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5062847137451172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5063953399658203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5173473358154297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5179123878479004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5179123878479004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5179944038391113  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5266880989074707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5272164344787598  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5272164344787598  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5272870063781738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5352616310119629  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5355205535888672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5355205535888672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5355548858642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5396747589111328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5399694442749023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5399694442749023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.540003776550293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5443639755249023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5447854995727539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5447854995727539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5448312759399414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5509653091430664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5513076782226562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5513076782226562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5513439178466797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5564537048339844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5566778182983398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5566778182983398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5567007064819336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5600881576538086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5604362487792969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5604362487792969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5604686737060547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5654945373535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5657439231872559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5657439231872559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5657668113708496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5694746971130371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5696477890014648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5696477890014648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5696630477905273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5722417831420898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([95, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5745172500610352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5745172500610352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5746984481811523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6065893173217773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 95, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5896553993225098  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5900874137878418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5905194282531738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5900654792785645  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2898, 40])
input nodes number: 5974
output nodes number: 2898
edges number: 19482
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5901331901550293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5901336669921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.017880916595458984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 15 input nodes size: 15219
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.016676902770996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.016676902770996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023933887481689453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023955821990966797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.018815040588378906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019329071044921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019329071044921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019329071044921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([15219, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.019329071044921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([616, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0421600341796875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0421600341796875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04274749755859375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.047788143157958984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([629, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04809427261352539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04809427261352539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04869413375854492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05860424041748047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([582, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05913686752319336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05913686752319336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0596919059753418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07207250595092773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([536, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07281732559204102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07281732559204102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07332849502563477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08827447891235352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([538, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08930158615112305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08930158615112305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08981466293334961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10848283767700195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([456, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10953092575073242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10953092575073242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10996580123901367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12866544723510742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([406, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12980318069458008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12980318069458008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13019037246704102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1495499610900879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([367, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1507563591003418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1507563591003418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1511063575744629  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17105627059936523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([335, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1731119155883789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1731119155883789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.173431396484375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.193878173828125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([2599, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20611143112182617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20611143112182617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 2599, 128]), torch.Size([1, 2599, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20859003067016602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3911628723144531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 2599, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.37034082412719727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.377077579498291  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.38381433486938477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.37702465057373047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([7064, 256])
first layer input nodes number: 15219
first layer output nodes number: 7064
edges number: 45973
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3839297294616699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.39066648483276367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.39284753799438477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.39284753799438477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([433, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4154839515686035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4154839515686035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41630983352661133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42291688919067383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([342, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42316150665283203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42316150665283203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4238138198852539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4340486526489258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([278, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4345245361328125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4345245361328125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4350547790527344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4479079246520996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([248, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4485964775085449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4485964775085449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4490694999694824  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4627871513366699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4634881019592285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4634881019592285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46386003494262695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4772496223449707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4779982566833496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4779982566833496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47830724716186523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4915938377380371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49240827560424805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49240827560424805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49268293380737305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.506415843963623  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5071935653686523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5071935653686523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.507420539855957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5203580856323242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5212917327880859  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5212917327880859  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5215225219726562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5362930297851562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([104, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.537177562713623  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.537177562713623  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5373759269714355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.551459789276123  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([93, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5523438453674316  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5523438453674316  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5525212287902832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5663571357727051  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5670528411865234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5670528411865234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5671825408935547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5782070159912109  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5788044929504395  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5788044929504395  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5789055824279785  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5882058143615723  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5886936187744141  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5886936187744141  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5887699127197266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5963230133056641  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5969338417053223  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5969338417053223  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5970196723937988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6061177253723145  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6068286895751953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6068286895751953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6069221496582031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6174831390380859  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.617943286895752  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.617943286895752  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6180024147033691  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6250977516174316  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6255874633789062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6255874633789062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6256446838378906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6329116821289062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6335406303405762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6335406303405762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6336092948913574  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6428103446960449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6434106826782227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6434106826782227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6434736251831055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.652348518371582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6527209281921387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6527209281921387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6527590751647949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6584048271179199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6587667465209961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6587667465209961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6588010787963867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6641225814819336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6645035743713379  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6645035743713379  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6645379066467285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6700997352600098  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6704516410827637  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6704516410827637  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6704821586608887  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6756396293640137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([214, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6807665824890137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6807665824890137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6811747550964355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7530131340026855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 214, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7335896492004395  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7340235710144043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7344574928283691  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.734001636505127  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2910, 40])
input nodes number: 7064
output nodes number: 2910
edges number: 22901
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7340784072875977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7340788841247559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.020321369171142578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 16 input nodes size: 21490
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01881694793701172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.01881694793701172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029064178466796875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02908611297607422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021807193756103516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.022339344024658203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.022339344024658203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.022339344024658203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([21490, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.022339344024658203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([839, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04884815216064453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04884815216064453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.049648284912109375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.056049346923828125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([878, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05648660659790039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05648660659790039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05732393264770508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07010316848754883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([796, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07115602493286133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07115602493286133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0719151496887207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08939409255981445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([714, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09037637710571289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09037637710571289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 714, 128]), torch.Size([1, 714, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09105730056762695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11100244522094727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 714, 128])
m.shape torch.Size([686, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11229753494262695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11229753494262695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 686, 128]), torch.Size([1, 686, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11295175552368164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1365036964416504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 686, 128])
m.shape torch.Size([529, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13769006729125977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13769006729125977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13819456100463867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15994787216186523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([446, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16207408905029297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16207408905029297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16249942779541016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18376636505126953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([400, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18507957458496094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18507957458496094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18546104431152344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20720481872558594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([314, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20836162567138672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20836162567138672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20866107940673828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22782611846923828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 314, 128])
m.shape torch.Size([2904, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24152374267578125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24152374267578125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 2904, 128]), torch.Size([1, 2904, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24433422088623047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4424161911010742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 2904, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41953039169311523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4276423454284668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43575429916381836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4275789260864258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([8506, 256])
first layer input nodes number: 21490
first layer output nodes number: 8506
edges number: 52631
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4359164237976074  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.444028377532959  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4460563659667969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4460563659667969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([507, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46462202072143555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46462202072143555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4655890464782715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.473513126373291  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([422, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47384119033813477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47384119033813477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47464609146118164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48775529861450195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([333, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4883131980895996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4883131980895996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48894834518432617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5031843185424805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5038394927978516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5038394927978516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5043220520019531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5183162689208984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([256, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5193052291870117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5193052291870117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5197935104370117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5373716354370117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([188, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5382118225097656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5382118225097656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5385704040527344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5539894104003906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5547523498535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5547523498535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5550193786621094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5683708190917969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5691218376159668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5691218376159668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5693411827087402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5818438529968262  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5825562477111816  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5825562477111816  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5827374458312988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5943341255187988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5948781967163086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5948781967163086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5950040817260742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6039419174194336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6044921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6044921875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6046028137207031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6132316589355469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6139607429504395  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6139607429504395  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6140904426574707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.625114917755127  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6256623268127441  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6256623268127441  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.625755786895752  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6343541145324707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6348996162414551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6348996162414551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6349835395812988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6432919502258301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6436829566955566  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6436829566955566  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.643740177154541  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6498055458068848  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6501922607421875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6501922607421875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6502437591552734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6560630798339844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6564459800720215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6564459800720215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6564936637878418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6622157096862793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6625208854675293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6625208854675293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6625571250915527  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6671595573425293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6675252914428711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6675252914428711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6675653457641602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6729326248168945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6732778549194336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6732778549194336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.673314094543457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6784238815307617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6785473823547363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6785473823547363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.678560733795166  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6805367469787598  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.680762767791748  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.680762767791748  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.680783748626709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6840357780456543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6842684745788574  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6842684745788574  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6842894554138184  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6876883506774902  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6879549026489258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6879549026489258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6879777908325195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6918458938598633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([137, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6951265335083008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6951265335083008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6953878402709961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7413778305053711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7261409759521484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7265753746032715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7270097732543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7265534400939941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2913, 40])
input nodes number: 8506
output nodes number: 2913
edges number: 18675
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7266392707824707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7266397476196289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023395061492919922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 17 input nodes size: 27112
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02180767059326172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02180767059326172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.034735679626464844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.034757137298583984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.024487972259521484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02519845962524414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02519845962524414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02519845962524414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([27112, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02519845962524414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([641, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06097984313964844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06097984313964844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.061591148376464844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06732511520385742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([711, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06769752502441406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06769752502441406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 711, 128]), torch.Size([1, 711, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0683755874633789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07912826538085938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 711, 128])
m.shape torch.Size([657, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07972908020019531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07972908020019531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 657, 128]), torch.Size([1, 657, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08035564422607422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09427165985107422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 657, 128])
m.shape torch.Size([634, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09516763687133789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09516763687133789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09577226638793945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11401033401489258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([618, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11518144607543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11518144607543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11577081680297852  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1375899314880371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([561, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1389002799987793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1389002799987793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1394352912902832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16274309158325195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([533, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16425466537475586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16425466537475586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1647629737854004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19032764434814453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([491, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19194650650024414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19194650650024414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1924147605895996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21910524368286133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([416, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2206563949584961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2206563949584961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2210531234741211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2464437484741211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([4803, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2696828842163086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2696828842163086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 4803, 128]), torch.Size([1, 4803, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2742633819580078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5994787216186523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 4803, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5672411918640137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5771737098693848  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5871062278747559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5770983695983887  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([10065, 256])
first layer input nodes number: 27112
first layer output nodes number: 10065
edges number: 72459
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5869765281677246  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5969090461730957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5989751815795898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5989751815795898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6213889122009277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6213889122009277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6221880912780762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6292905807495117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6295657157897949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6295657157897949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6302351951599121  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6408004760742188  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6412878036499023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6412878036499023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6418313980102539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6548061370849609  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.655449390411377  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.655449390411377  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6559033393859863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6690678596496582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.669797420501709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.669797420501709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6701769828796387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6838412284851074  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6845741271972656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6845741271972656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6848793029785156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6980018615722656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.698847770690918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.698847770690918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6991281509399414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7131471633911133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7139377593994141  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7139377593994141  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7141685485839844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7273235321044922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7280473709106445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7280473709106445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7282323837280273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7400732040405273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7408461570739746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7408461570739746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7410178184509277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7532057762145996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.753807544708252  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.753807544708252  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7539315223693848  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7636017799377441  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.764312744140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.764312744140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7644405364990234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7753028869628906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7759013175964355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7759013175964355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7760024070739746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7853026390075684  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7859249114990234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7859249114990234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7860202789306641  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7954616546630859  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7961063385009766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7961063385009766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7961978912353516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8059024810791016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8064103126525879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8064103126525879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8064789772033691  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8142380714416504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8147106170654297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8147106170654297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8147697448730469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8218650817871094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8223028182983398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8223028182983398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8223543167114258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8288946151733398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8292341232299805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8292341232299805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8292722702026367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8343839645385742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8347878456115723  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8347878456115723  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8348298072814941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8407464027404785  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8411293029785156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8411293029785156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8411674499511719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8468132019042969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.847175121307373  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.847175121307373  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8472094535827637  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8525309562683105  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8527793884277344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8527793884277344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8528022766113281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8565101623535156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8568449020385742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8568449020385742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8568735122680664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8617086410522461  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([265, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8680620193481445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8680620193481445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8685674667358398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9608001708984375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 265, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9414839744567871  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9419097900390625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9423356056213379  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9418883323669434  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2856, 40])
input nodes number: 10065
output nodes number: 2856
edges number: 22767
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9419765472412109  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9419770240783691  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.026530742645263672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 18 input nodes size: 21281
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.024479389190673828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.024479389190673828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03462696075439453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03464794158935547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021698474884033203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.022193431854248047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.022193431854248047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.022193431854248047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([21281, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.022193431854248047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([833, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04702472686767578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04702472686767578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04781913757324219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.054230690002441406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([923, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05471372604370117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05471372604370117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05559396743774414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06879758834838867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([851, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06985664367675781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06985664367675781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07066822052001953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08860492706298828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([684, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08977031707763672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08977031707763672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0904226303100586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10934734344482422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([612, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11048030853271484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11048030853271484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11106395721435547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13207530975341797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([533, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13330841064453125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13330841064453125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13381671905517578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15575695037841797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([423, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15691471099853516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15691471099853516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.157318115234375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1774883270263672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([398, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17880487442016602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17880487442016602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1791844367980957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2008194923400879  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([353, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20214462280273438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20214462280273438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 353, 128]), torch.Size([1, 353, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20248126983642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22402667999267578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 353, 128])
m.shape torch.Size([2625, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2363753318786621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2363753318786621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 2625, 128]), torch.Size([1, 2625, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.23949718475341797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.42328453063964844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 2625, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40187978744506836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.40973329544067383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4175868034362793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4096717834472656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([8235, 256])
first layer input nodes number: 21281
first layer output nodes number: 8235
edges number: 49798
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.41774749755859375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4256010055541992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4276084899902344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4276084899902344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([531, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4440889358520508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4440889358520508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 531, 256]), torch.Size([1, 531, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4451017379760742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4532041549682617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 531, 256])
m.shape torch.Size([458, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45357847213745117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.45357847213745117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4544520378112793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46813011169433594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([360, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46936559677124023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46936559677124023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47005224227905273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48517560958862305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4858589172363281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4858589172363281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.48636817932128906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5011367797851562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5018625259399414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5018625259399414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5022516250610352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5162591934204102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5170855522155762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5170855522155762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5174193382263184  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5317721366882324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5323925018310547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5323925018310547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5326156616210938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5437736511230469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5445466041564941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5445466041564941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5447659492492676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5572686195373535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5578598976135254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5578598976135254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5580143928527832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5679020881652832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5685653686523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5685653686523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5687122344970703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5791397094726562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5795845985412598  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5795845985412598  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5796780586242676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.586967945098877  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5873713493347168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5873713493347168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5874457359313965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5937685966491699  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.594306468963623  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.594306468963623  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5943942070007324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6024661064147949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.602839469909668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.602839469909668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6028985977172852  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6087522506713867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6091985702514648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6091985702514648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6092615127563477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6159334182739258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6162095069885254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6162095069885254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6162476539611816  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6205582618713379  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6209316253662109  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6209316253662109  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6209774017333984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6264705657958984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6267595291137695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6267595291137695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6267938613891602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6311540603637695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6313743591308594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6313743591308594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6313991546630859  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6347217559814453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6350364685058594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6350364685058594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6350688934326172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6396408081054688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6398873329162598  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6398873329162598  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6399121284484863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6435818672180176  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6438236236572266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6438236236572266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6438465118408203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6473941802978516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6476039886474609  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6476039886474609  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6476230621337891  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6507129669189453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6509342193603516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6509342193603516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6509532928466797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6541767120361328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([96, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6564741134643555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6564741134643555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6566572189331055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6888837814331055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 96, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6756839752197266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6761035919189453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6765232086181641  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6760826110839844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2816, 40])
input nodes number: 8235
output nodes number: 2816
edges number: 16483
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6761589050292969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6761593818664551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02318096160888672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 19 input nodes size: 23912
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021692276000976562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.021692276000976562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03341102600097656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0334320068359375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02326345443725586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023777484893798828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023777484893798828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023777484893798828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([23912, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023777484893798828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([902, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05033254623413086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05033254623413086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0511927604675293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05830192565917969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([922, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05875110626220703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05875110626220703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.059630393981933594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07281970977783203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([846, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0736236572265625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0736236572265625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07443046569824219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09231376647949219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([747, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09333515167236328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09333515167236328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09404754638671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11470699310302734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([621, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11583137512207031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11583137512207031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1164236068725586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13840913772583008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([491, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13951778411865234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13951778411865234  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1399860382080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16012096405029297  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([473, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16146564483642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16146564483642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16191673278808594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18447113037109375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([425, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1858668327331543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1858668327331543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18627214431762695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20937490463256836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([305, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21071624755859375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21071624755859375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21100711822509766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22962284088134766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([2948, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24353456497192383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24353456497192383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 2948, 128]), torch.Size([1, 2948, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24721431732177734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4468259811401367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 2948, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4239940643310547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.43227195739746094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4405498504638672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4322071075439453  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([8680, 256])
first layer input nodes number: 23912
first layer output nodes number: 8680
edges number: 53259
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.44073009490966797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4490079879760742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4519834518432617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4519834518432617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([574, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46756505966186523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.46756505966186523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4686598777770996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47820425033569336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([481, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47858190536499023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47858190536499023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.47949934005737305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49341917037963867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([332, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49391794204711914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.49391794204711914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.4945511817932129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.510073184967041  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5107216835021973  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5107216835021973  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5112004280090332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5250840187072754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([212, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5259246826171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5259246826171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5263290405273438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5408859252929688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([123, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5413932800292969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5413932800292969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5416278839111328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5517158508300781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5523724555969238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5523724555969238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5525918006896973  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5635590553283691  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5644183158874512  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5644183158874512  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5646586418151855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5783572196960449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([63, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5787820816040039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5787820816040039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5789022445678711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5865926742553711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5872249603271484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5872249603271484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5873622894287109  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5971126556396484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5977845191955566  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5977845191955566  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5979180335998535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6083321571350098  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6088423728942871  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6088423728942871  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6089377403259277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6170439720153809  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([31, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6173839569091797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6173839569091797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6174430847167969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6228828430175781  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6232304573059082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6232304573059082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.623283863067627  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6285710334777832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6288471221923828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6288471221923828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6288871765136719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6331329345703125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.633420467376709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.633420467376709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6334586143493652  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6377692222595215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6379952430725098  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6379952430725098  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.638023853302002  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6414570808410645  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6417717933654785  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6417717933654785  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.641808032989502  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6464104652404785  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6465568542480469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6465568542480469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6465740203857422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6488742828369141  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6490774154663086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6490774154663086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6490983963012695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6520566940307617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6522884368896484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6522884368896484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6523113250732422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6556987762451172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6557931900024414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6557931900024414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6558027267456055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6572809219360352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.657475471496582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.657475471496582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6574926376342773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.660273551940918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6604495048522949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6604495048522949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6604647636413574  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6630434989929199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([101, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6654629707336426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6654629707336426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6656556129455566  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6995606422424316  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 101, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6872334480285645  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6876444816589355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6880555152893066  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6876235008239746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2758, 40])
input nodes number: 8680
output nodes number: 2758
edges number: 15508
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6877007484436035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6877012252807617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.024803638458251953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 20 input nodes size: 30918
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023254871368408203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.023254871368408203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03799772262573242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03801870346069336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.026278972625732422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.027147769927978516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.027147769927978516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.027147769927978516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([30918, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.027147769927978516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([669, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07275104522705078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07275104522705078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07338905334472656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07877635955810547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([712, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07913637161254883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07913637161254883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 712, 128]), torch.Size([1, 712, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07981538772583008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09000062942504883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 712, 128])
m.shape torch.Size([598, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09051656723022461  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09051656723022461  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09108686447143555  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10363340377807617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([580, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10447263717651367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10447263717651367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1050257682800293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1220698356628418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([596, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1232142448425293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1232142448425293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12378263473510742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14434194564819336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([529, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14557123184204102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14557123184204102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14607572555541992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1679987907409668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([500, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16941547393798828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16941547393798828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1698923110961914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19373416900634766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([484, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1953420639038086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1953420639038086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19580364227294922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22211360931396484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([447, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2238011360168457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2238011360168457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2242274284362793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2515101432800293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([6881, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.28410816192626953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.28410816192626953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 6881, 128]), torch.Size([1, 6881, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.29067039489746094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7565889358520508  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 6881, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7153449058532715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7267851829528809  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7387824058532715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7272524833679199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([11996, 256])
first layer input nodes number: 30918
first layer output nodes number: 11996
edges number: 92566
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7390151023864746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.750455379486084  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7534255981445312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7534255981445312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7775702476501465  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7775702476501465  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7783751487731934  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7849230766296387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7851953506469727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7851953506469727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7858648300170898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7971563339233398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([239, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.797511100769043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.797511100769043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7979669570922852  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8079957962036133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([196, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8085217475891113  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8085217475891113  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8088955879211426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8197369575500488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8205208778381348  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8205208778381348  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8209061622619629  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8347764015197754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8355526924133301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8355526924133301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8358731269836426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8496518135070801  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8502926826477051  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8502926826477051  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8505196571350098  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8618683815002441  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8626623153686523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8626623153686523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8628873825073242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8757162094116211  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.876408576965332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.876408576965332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8765859603881836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8879384994506836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.888667106628418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.888667106628418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.888829231262207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9003400802612305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9011154174804688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9011154174804688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9012699127197266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9133205413818359  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9139814376831055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9139814376831055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9141035079956055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9244794845581055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9248561859130859  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9248561859130859  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9249229431152344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9310646057128906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9316368103027344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9316368103027344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9317226409912109  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9402198791503906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9407248497009277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9407248497009277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9407973289489746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9484801292419434  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9489359855651855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9489359855651855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9489970207214355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9558939933776855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9564847946166992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9564847946166992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9565572738647461  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9652547836303711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9657378196716309  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9657378196716309  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9657950401306152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9730620384216309  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9734535217285156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9734535217285156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9734973907470703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9793758392333984  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9798345565795898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9798345565795898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9798822402954102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9866056442260742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9870262145996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9870262145996094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9870681762695312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9932785034179688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9937653541564941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9937653541564941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9938111305236816  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0009064674377441  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0011711120605469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0011711120605469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0011959075927734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0052127838134766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.005661964416504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.005661964416504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0057001113891602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0121469497680664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([320, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0205473899841309  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0205473899841309  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0211577415466309  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1426482200622559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 320, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1215081214904785  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1219258308410645  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1223435401916504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1219048500061035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2803, 40])
input nodes number: 11996
output nodes number: 2803
edges number: 23825
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1220221519470215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1220226287841797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.028732776641845703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 21 input nodes size: 38091
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.026285648345947266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.026285648345947266  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0444488525390625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04446983337402344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02970600128173828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.030872344970703125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.030872344970703125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.030872344970703125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([38091, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.030872344970703125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([562, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09298515319824219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09298515319824219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0935211181640625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09810495376586914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([650, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09845685958862305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09845685958862305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09907674789428711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10858869552612305  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([561, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10908126831054688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10908126831054688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10961627960205078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12189579010009766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([567, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12270975112915039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12270975112915039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12325048446655273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13985872268676758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([518, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1408233642578125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1408233642578125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14131736755371094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15923786163330078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([498, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1608295440673828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1608295440673828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16130447387695312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18172645568847656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([504, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18317127227783203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18317127227783203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18365192413330078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20768451690673828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([495, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20933246612548828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20933246612548828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20980453491210938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.23671245574951172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([499, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2386178970336914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2386178970336914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.23909378051757812  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2695503234863281  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([10315, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3184981346130371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3184981346130371  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 10315, 128]), torch.Size([1, 10315, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.32891845703125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0303325653076172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 10315, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9714460372924805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9859123229980469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0003786087036133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9857988357543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([15169, 256])
first layer input nodes number: 38091
first layer output nodes number: 15169
edges number: 126520
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0006647109985352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0151309967041016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0188941955566406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0188941955566406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([335, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0488595962524414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0488595962524414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0494985580444336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0564255714416504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([325, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0567312240600586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0567312240600586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0573511123657227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.066737174987793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([223, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.067070484161377  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.067070484161377  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0674958229064941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0768532752990723  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([183, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0773444175720215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0773444175720215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0776934623718262  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.087815761566162  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([148, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0883526802062988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0883526802062988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.088634967803955  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.09879732131958  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([118, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.099337100982666  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.099337100982666  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.099562168121338  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1092400550842285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([96, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1097736358642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1097736358642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1099567413330078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1191120147705078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1196355819702148  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1196355819702148  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1197881698608398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1284856796264648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1290931701660156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1290931701660156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1292438507080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1388874053955078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1395525932312012  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1395525932312012  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1396994590759277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1501269340515137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1506776809692383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1506776809692383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1507902145385742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1595678329467773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1600537300109863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1600537300109863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1601433753967285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1677632331848145  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.168243408203125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.168243408203125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1683235168457031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1756935119628906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1762995719909668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1762995719909668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1763911247253418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1854548454284668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1858420372009277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1858420372009277  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.185899257659912  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1919646263122559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1923823356628418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1923823356628418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1924376487731934  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.19868803024292  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1991181373596191  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1991181373596191  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.199171543121338  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.205580234527588  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2061591148376465  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2061591148376465  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.206225872039795  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2147040367126465  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2153100967407227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2153100967407227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.215376853942871  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2243223190307617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2248659133911133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2248659133911133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2249231338500977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2329912185668945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2334675788879395  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2334675788879395  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2335152626037598  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.240572452545166  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.241034984588623  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.241034984588623  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2410788536071777  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2478785514831543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.248166561126709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.248166561126709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2481932640075684  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.252519130706787  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2530136108398438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2530136108398438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2530555725097656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2601470947265625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([627, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2751917839050293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2751917839050293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2763876914978027  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.489938735961914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 627, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4627618789672852  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4631729125976562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4635839462280273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4631519317626953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2758, 40])
input nodes number: 15169
output nodes number: 2758
edges number: 29899
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4632797241210938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.463280200958252  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03291130065917969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 22 input nodes size: 35770
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029699325561523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029699325561523438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04727745056152344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04729890823364258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029114723205566406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029929161071777344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029929161071777344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029929161071777344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([35770, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029929161071777344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([758, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07360124588012695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07360124588012695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 758, 128]), torch.Size([1, 758, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07432413101196289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08010721206665039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 758, 128])
m.shape torch.Size([830, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08053731918334961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08053731918334961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0813288688659668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09320211410522461  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([767, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0939035415649414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0939035415649414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.094635009765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11086797714233398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([705, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.111846923828125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.111846923828125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 705, 128]), torch.Size([1, 705, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1125192642211914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1334667205810547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 705, 128])
m.shape torch.Size([685, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1347637176513672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1347637176513672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13541698455810547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1593008041381836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([535, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16050481796264648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16050481796264648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16101503372192383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18338823318481445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([531, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1849055290222168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1849055290222168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18541193008422852  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2111968994140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([499, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21284723281860352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21284723281860352  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21332311630249023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2404484748840332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([448, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24213314056396484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24213314056396484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24256038665771484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.26990413665771484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([6258, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2995309829711914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2995309829711914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 6258, 128]), torch.Size([1, 6258, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3054990768432617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7292337417602539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 6258, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6895527839660645  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7010540962219238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7125554084777832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7009644508361816  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([12016, 256])
first layer input nodes number: 35770
first layer output nodes number: 12016
edges number: 88495
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7128238677978516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7243251800537109  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7271900177001953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7271900177001953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([496, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7476358413696289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7476358413696289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7485818862915039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7570962905883789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([416, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.757422924041748  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.757422924041748  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.758216381072998  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7703585624694824  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7708358764648438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7708358764648438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7714138031005859  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.788517951965332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7891325950622559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7891325950622559  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7895808219909668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.802579402923584  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8032684326171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8032684326171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8036308288574219  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8166770935058594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8173551559448242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8173551559448242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8176393508911133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.829859733581543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8306732177734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8306732177734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8309440612792969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8444862365722656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8451662063598633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8451662063598633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8453683853149414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8568925857543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8575615882873535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8575615882873535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8577313423156738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8685956001281738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8691067695617676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8691067695617676  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.869225025177002  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8776211738586426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8782072067260742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8782072067260742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8783235549926758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8873987197875977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8878135681152344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8878135681152344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8878917694091797  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8945388793945312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8951120376586914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8951120376586914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8952054977416992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.903803825378418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9042015075683594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9042015075683594  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9042644500732422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9104957580566406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.910954475402832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.910954475402832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9110193252563477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9178934097290039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.918276309967041  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.918276309967041  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.918327808380127  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9241471290588379  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9244976043701172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9244976043701172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9245414733886719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9298057556152344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9301128387451172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9301128387451172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9301490783691406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9347515106201172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9352083206176758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9352083206176758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9352579116821289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9419031143188477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9423589706420898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9423589706420898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9424066543579102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9491300582885742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.949409008026123  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.949409008026123  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9494376182556152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.953671932220459  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9538693428039551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9538693428039551  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9538884162902832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9568448066711426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9570345878601074  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9570345878601074  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9570517539978027  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9598326683044434  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9601011276245117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9601011276245117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9601240158081055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9639921188354492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([256, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9701318740844727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9701318740844727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.9706201553344727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0565576553344727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 256, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0392498970031738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0396714210510254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.040092945098877  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0396499633789062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2828, 40])
input nodes number: 12016
output nodes number: 2828
edges number: 20645
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.039771556854248  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0397720336914062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.031476497650146484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 23 input nodes size: 33723
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029125213623046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029125213623046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04520559310913086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0452265739440918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.027626991271972656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02830028533935547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02830028533935547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02830028533935547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([33723, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02830028533935547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([875, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06434106826782227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06434106826782227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 875, 128]), torch.Size([1, 875, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.06517553329467773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07196426391601562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 875, 128])
m.shape torch.Size([904, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07240915298461914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07240915298461914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.07327127456665039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08620309829711914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([794, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08690786361694336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08690786361694336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 794, 128]), torch.Size([1, 794, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.08766508102416992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10477113723754883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 794, 128])
m.shape torch.Size([700, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1057276725769043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1057276725769043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 700, 128]), torch.Size([1, 700, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10639524459838867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12661314010620117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 700, 128])
m.shape torch.Size([624, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12776708602905273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12776708602905273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12836217880249023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15070104598999023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15180253982543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15180253982543945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1522688865661621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17232179641723633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([456, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17361068725585938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17361068725585938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17404556274414062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19578933715820312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([471, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19736862182617188  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19736862182617188  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19781780242919922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2234210968017578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([367, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22477149963378906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22477149963378906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22512149810791016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24752140045166016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([4855, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2707839012145996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2707839012145996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 4855, 128]), torch.Size([1, 4855, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.27541399002075195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6041502952575684  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 4855, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5719747543334961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5820217132568359  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5920686721801758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5819430351257324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([10535, 256])
first layer input nodes number: 33723
first layer output nodes number: 10535
edges number: 72732
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.5923218727111816  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6023688316345215  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6048808097839355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6048808097839355  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([543, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6223492622375488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6223492622375488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.623384952545166  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6329302787780762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([450, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6332778930664062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6332778930664062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6341361999511719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6479392051696777  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([321, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6484360694885254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6484360694885254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6490483283996582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6633772850036621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.664067268371582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.664067268371582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6645612716674805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6791620254516602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6798524856567383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6798524856567383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6802244186401367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6936140060424805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6942586898803711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6942586898803711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.6945333480834961  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7063436508178711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7070474624633789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7070474624633789  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7072858810424805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7192068099975586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.719841480255127  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.719841480255127  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7200284004211426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7306828498840332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.731290340423584  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.731290340423584  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7314448356628418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7413325309753418  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7419857978820801  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7419857978820801  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7421307563781738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7524228096008301  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([44, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7528157234191895  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7528157234191895  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7528996467590332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7594456672668457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7600150108337402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7600150108337402  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7601161003112793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7687087059020996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7691831588745117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7691831588745117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7692632675170898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7766332626342773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7769970893859863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7769970893859863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7770543098449707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7827191352844238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7831807136535645  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7831807136535645  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7832455635070801  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7901196479797363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7904257774353027  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7904257774353027  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7904677391052246  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7952094078063965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7954826354980469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7954826354980469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7955169677734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7996368408203125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7999658584594727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.7999658584594727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8000040054321289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8048486709594727  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8051586151123047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8051586151123047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8051929473876953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8097934722900391  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8101224899291992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8101224899291992  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8101568222045898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.814997673034668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8152227401733398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8152227401733398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8152456283569336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8186330795288086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8188333511352539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8188333511352539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.818852424621582  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8218088150024414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8221755027770996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8221755027770996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8222079277038574  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.827460765838623  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8276753425598145  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8276753425598145  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8276944160461426  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8309178352355957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([146, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8344168663024902  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8344168663024902  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8346953392028809  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8837065696716309  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 146, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8694610595703125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8698763847351074  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8702917098999023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8698554039001465  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2786, 40])
input nodes number: 10535
output nodes number: 2786
edges number: 17498
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8699488639831543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.8699493408203125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.0296173095703125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 24 input nodes size: 37285
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.027620792388916016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.027620792388916016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04539966583251953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.04542064666748047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.029319286346435547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.030560016632080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.030560016632080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.030560016632080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([37285, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.030560016632080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([546, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09712743759155273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09712743759155273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.09764814376831055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10319375991821289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([547, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1034550666809082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1034550666809082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.10397672653198242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1118016242980957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([546, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11232185363769531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11232185363769531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11284255981445312  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12454986572265625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([525, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1252908706665039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1252908706665039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1257915496826172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14081478118896484  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([473, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1416921615600586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1416921615600586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14214324951171875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15838241577148438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([483, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15953874588012695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15953874588012695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15999937057495117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.17980623245239258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([459, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18177556991577148  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18177556991577148  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18221330642700195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2041001319885254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([375, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20531177520751953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20531177520751953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.20566940307617188  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22605419158935547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([417, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22766494750976562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22766494750976562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22806262969970703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.25351428985595703  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([11507, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3081851005554199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3081851005554199  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 11507, 128]), torch.Size([1, 11507, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.31915903091430664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0983080863952637  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 11507, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.035393238067627  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0505356788635254  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0656781196594238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0504169464111328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([15878, 256])
first layer input nodes number: 37285
first layer output nodes number: 15878
edges number: 135677
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.065958023071289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.0811004638671875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.085489273071289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.085489273071289  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([359, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1155595779418945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1155595779418945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1162443161010742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1220827102661133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([272, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1222634315490723  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1222634315490723  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1227822303771973  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.132904052734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([229, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1333050727844238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1333050727844238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.133741855621338  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1433510780334473  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([185, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1438441276550293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1438441276550293  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1441969871520996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1544299125671387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([135, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.154902458190918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.154902458190918  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1551599502563477  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1644296646118164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([131, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1650567054748535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1650567054748535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.165306568145752  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1760506629943848  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([102, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.176612377166748  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.176612377166748  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.176806926727295  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1865344047546387  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([62, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1869139671325684  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1869139671325684  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1870322227478027  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.193772792816162  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.194483757019043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.194483757019043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1946535110473633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2055177688598633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.206028938293457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.206028938293457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2061471939086914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.214543342590332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2150764465332031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2150764465332031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2151832580566406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2235145568847656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2240843772888184  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2240843772888184  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2241873741149902  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2329421043395996  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2334532737731934  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2334532737731934  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.23353910446167  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2414355278015137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([22, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2416887283325195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2416887283325195  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2417306900024414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.245884895324707  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2463974952697754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2463974952697754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2464680671691895  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.25394868850708  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2543749809265137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2543749809265137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.254432201385498  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2608981132507324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2615232467651367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2615232467651367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2615995407104492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2707548141479492  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2712531089782715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2712531089782715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2713122367858887  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2788214683532715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2792119979858398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2792119979858398  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2792558670043945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2851343154907227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2854971885681152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2854971885681152  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2855353355407715  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2909140586853027  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2915210723876953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2915210723876953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2915802001953125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3003311157226562  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3007245063781738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3007245063781738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.30076265335083  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3066754341125488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3070545196533203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3070545196533203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.307088851928711  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3126506805419922  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3130950927734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3130950927734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3131332397460938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.319580078125  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([685, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3360204696655273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3360204696655273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 685, 256]), torch.Size([1, 685, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.337327003479004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5727500915527344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 685, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5452842712402344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5456953048706055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5461063385009766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5456743240356445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2758, 40])
input nodes number: 15878
output nodes number: 2758
edges number: 30799
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5458097457885742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5458102226257324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03269243240356445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 25 input nodes size: 50083
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02931499481201172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.02931499481201172  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05319643020629883  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.053217411041259766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03541755676269531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03673744201660156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03673744201660156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03673744201660156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([50083, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03673744201660156  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([692, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11011600494384766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11011600494384766  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11077594757080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11624479293823242  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([736, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11661672592163086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11661672592163086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 736, 128]), torch.Size([1, 736, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11731863021850586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12850332260131836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 736, 128])
m.shape torch.Size([693, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12914371490478516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12914371490478516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1298046112060547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14449739456176758  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([677, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14545822143554688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14545822143554688  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1461038589477539  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16489410400390625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([686, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16620683670043945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16620683670043945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 686, 128]), torch.Size([1, 686, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16686105728149414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19136476516723633  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 686, 128])
m.shape torch.Size([582, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1927027702331543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1927027702331543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.19325780868530273  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21781301498413086  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([577, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21946144104003906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21946144104003906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.22001171112060547  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24752521514892578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([556, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2502732276916504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2502732276916504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.25080347061157227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.28146982192993164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([534, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2834963798522949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2834963798522949  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.28400564193725586  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3172898292541504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([12227, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.375338077545166  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.375338077545166  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 12227, 128]), torch.Size([1, 12227, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.38699865341186523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2181282043457031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 12227, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1491169929504395  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1662449836730957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.183372974395752  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1661109924316406  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([17960, 256])
first layer input nodes number: 50083
first layer output nodes number: 17960
edges number: 149436
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.1837482452392578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.200876235961914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2060132026672363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2060132026672363  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([380, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.232996940612793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.232996940612793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2337217330932617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2412924766540527  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([317, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.241539478302002  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.241539478302002  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2421441078186035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.255427360534668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([249, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.255843162536621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.255843162536621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2563180923461914  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2667665481567383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([167, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2671713829040527  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2671713829040527  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2674899101257324  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2767271995544434  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([178, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.27742338180542  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.27742338180542  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2777628898620605  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.289985179901123  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([111, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2904558181762695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2904558181762695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2906675338745117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2997713088989258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([112, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3004193305969238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3004193305969238  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3006329536437988  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3113141059875488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3118610382080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3118610382080078  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3120231628417969  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3212642669677734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3218235969543457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3218235969543457  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3219647407531738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3309979438781738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3315234184265137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3315234184265137  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.331641674041748  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3400378227233887  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3405604362487793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3405604362487793  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.340665340423584  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3488478660583496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3495454788208008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3495454788208008  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3496694564819336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3602075576782227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3608827590942383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3608827590942383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3609952926635742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3713483810424805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3718171119689941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3718171119689941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3718914985656738  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.379255771636963  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.379896640777588  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.379896640777588  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.37998628616333  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.389488697052002  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3901667594909668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3901667594909668  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.390256404876709  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4003863334655762  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4010443687438965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4010443687438965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4011263847351074  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.41096830368042  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.411360263824463  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.411360263824463  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4114079475402832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.417463779449463  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4180793762207031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4180793762207031  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4181461334228516  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4270915985107422  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4275388717651367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4275388717651367  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.427586555480957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.434309959411621  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4348716735839844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4348716735839844  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.434926986694336  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4431133270263672  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4434666633605957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4434666633605957  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4435009956359863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4488224983215332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4494023323059082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4494023323059082  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4494538307189941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.457796573638916  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4581632614135742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4581632614135742  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.458195686340332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4636754989624023  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([492, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4754815101623535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4754815101623535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4764199256896973  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.6488056182861328  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 492, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.624986171722412  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.6253972053527832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.6258082389831543  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.6253762245178223  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([2758, 40])
input nodes number: 17960
output nodes number: 2758
edges number: 27570
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.6255311965942383  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.6255316734313965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03907060623168945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

pseudo mini batch 26 input nodes size: 42378
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03541755676269531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03541755676269531  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.055624961853027344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05564689636230469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.03174448013305664  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.033254146575927734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.033254146575927734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.033254146575927734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([42378, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.033254146575927734  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([435, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11312580108642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11312580108642578  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1135406494140625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11685943603515625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([428, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11706018447875977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11706018447875977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.11746835708618164  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12359094619750977  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([470, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12405920028686523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12405920028686523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.12450742721557617  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1343684196472168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([474, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13504838943481445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13504838943481445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.13550043106079102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14860963821411133  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([502, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14966058731079102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.14966058731079102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.15013933181762695  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1673741340637207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([456, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16843938827514648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16843938827514648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.16887426376342773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18757390975952148  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([485, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18897533416748047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.18897533416748047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.1894378662109375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21256446838378906  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([470, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2141261100769043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.2141261100769043  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.21457433700561523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24012327194213867  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([499, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24204063415527344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24204063415527344  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.24251651763916016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.27297306060791016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([14158, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34024572372436523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.34024572372436523  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 14158, 128]), torch.Size([1, 14158, 128])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.3537478446960449  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3134169578552246  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 14158, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2373228073120117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2548484802246094  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.272374153137207  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2547111511230469  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

torch.Size([18377, 256])
first layer input nodes number: 42378
first layer output nodes number: 18377
edges number: 163069
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2726922035217285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2902178764343262  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2951855659484863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.2951855659484863  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

m.shape torch.Size([254, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3334870338439941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3334870338439941  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3339715003967285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3378472328186035  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([196, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.337982177734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.337982177734375  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3383560180664062  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.343963623046875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([173, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.344275951385498  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.344275951385498  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3446059226989746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.351865291595459  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([140, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.352238655090332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.352238655090332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3525056838989258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3602495193481445  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([125, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3607168197631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3607168197631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3609552383422852  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3695383071899414  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([104, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3700189590454102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3700189590454102  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3702173233032227  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3787469863891602  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([82, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.379199504852295  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.379199504852295  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3793559074401855  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3871760368347168  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([83, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3877363204956055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3877363204956055  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.387894630432129  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3969182968139648  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3976178169250488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.3976178169250488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.397789478302002  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.408775806427002  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4095935821533203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4095935821533203  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4097728729248047  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4225025177001953  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4232168197631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4232168197631836  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4233617782592773  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4346685409545898  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.435380458831787  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.435380458831787  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4355101585388184  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4465346336364746  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4472947120666504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4472947120666504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.447420597076416  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4590020179748535  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([68, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4598541259765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4598541259765625  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4599838256835938  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4728240966796875  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.473494529724121  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.473494529724121  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4735918045043945  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.483902931213379  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.484684944152832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.484684944152832  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.484787940979004  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4964265823364258  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.497143268585205  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.497143268585205  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.4972329139709473  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5079903602600098  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5087590217590332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5087590217590332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5088486671447754  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5202336311340332  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.521707534790039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.521707534790039  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5218124389648438  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5358695983886719  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5368361473083496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5368361473083496  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5369372367858887  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5511908531188965  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.552048683166504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.552048683166504  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5521345138549805  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5648374557495117  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5654926300048828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5654926300048828  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5655555725097656  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5753116607666016  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5758328437805176  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5758328437805176  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.575880527496338  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5836052894592285  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5843892097473145  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5843892097473145  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.584455966949463  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.5957379341125488  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([863, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.6173501014709473  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.6173501014709473  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

 h.shape torch.Size([1, 863, 256]), torch.Size([1, 863, 256])
----------------------------------------3
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 1.6189961433410645  GigaBytes
Max Memory Allocated: 1.901200294494629  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0623779296875 GB
    Memory Allocated: 1.9120545387268066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 863, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0623779296875 GB
    Memory Allocated: 1.8766050338745117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0623779296875 GB
    Memory Allocated: 1.8770413398742676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0623779296875 GB
    Memory Allocated: 1.8774776458740234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0623779296875 GB
    Memory Allocated: 1.8770194053649902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2927, 40])
input nodes number: 18377
output nodes number: 2927
edges number: 39464
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0623779296875 GB
    Memory Allocated: 1.8772039413452148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0623779296875 GB
    Memory Allocated: 1.877204418182373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03584480285644531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 27 input nodes size: 49964
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.031769752502441406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.031769752502441406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.055594444274902344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05561542510986328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.035386085510253906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.036894798278808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.036894798278808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.036894798278808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([49964, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.036894798278808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([554, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12019109725952148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12019109725952148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12071943283081055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1262969970703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([570, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12657642364501953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12657642364501953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1271200180053711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13527393341064453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([581, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1358332633972168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1358332633972168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13638734817504883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14934015274047852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([573, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15015602111816406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15015602111816406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15070247650146484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16726303100585938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([597, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1684131622314453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1684131622314453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16898250579833984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19022417068481445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([558, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19153594970703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19153594970703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19206809997558594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21573448181152344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([546, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21729087829589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21729087829589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21781158447265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.24470996856689453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([542, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.24651718139648438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.24651718139648438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.24703407287597656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2782440185546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([539, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.28029870986938477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.28029870986938477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.28081274032592773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.31446266174316406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([14486, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.38328027725219727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.38328027725219727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14486, 128]), torch.Size([1, 14486, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3970952033996582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3779549598693848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14486, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.298966884613037  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.318498134613037  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.338029384613037  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.318352222442627  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([19546, 256])
first layer input nodes number: 49964
first layer output nodes number: 19546
edges number: 169931
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3384037017822266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3579349517822266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3630733489990234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3630733489990234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([302, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3947300910949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3947300910949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.39530611038208  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4010300636291504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([251, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4012246131896973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4012246131896973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4017033576965332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4088845252990723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([211, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4092535972595215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4092535972595215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.409656047821045  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4185099601745605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([164, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4189395904541016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4189395904541016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4192523956298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.428323745727539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([149, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4288835525512695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4288835525512695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4291677474975586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4393987655639648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([103, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4398508071899414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4398508071899414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.440047264099121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4484949111938477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([89, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.448995590209961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.448995590209961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4491653442382812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4576530456542969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4581832885742188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4581832885742188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4583358764648438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4670333862304688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4676494598388672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4676494598388672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4678020477294922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4775676727294922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4783568382263184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4783568382263184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4785284996032715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4907164573669434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.491222858428955  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.491222858428955  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4913296699523926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4996609687805176  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.500380516052246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.500380516052246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5005083084106445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5113706588745117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5119318962097168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5119318962097168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5120272636413574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.520801067352295  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5213861465454102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5213861465454102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5214757919311523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.530350685119629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.530825138092041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.530825138092041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5308938026428223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5381722450256348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5388145446777344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5388145446777344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5388984680175781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5483818054199219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.548781394958496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.548781394958496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.548832893371582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5550127029418945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5557136535644531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5557136535644531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5557937622070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5659675598144531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5666766166687012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5666766166687012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5667548179626465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5772337913513184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.57802152633667  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.57802152633667  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5781035423278809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.589667797088623  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5902528762817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5902528762817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5903120040893555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5990629196166992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.599668025970459  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.599668025970459  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5997252464294434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6085944175720215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6093177795410156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6093177795410156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6093826293945312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6198883056640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6204328536987305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6204328536987305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6204805374145508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6285390853881836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([666, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6445183753967285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6445183753967285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 666, 256]), torch.Size([1, 666, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6457886695861816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8763813972473145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 666, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8473048210144043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8477158546447754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8481268882751465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8476948738098145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2758, 40])
input nodes number: 19546
output nodes number: 2758
edges number: 32508
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8478364944458008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.847836971282959  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03946208953857422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 28 input nodes size: 50396
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03536081314086914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03536081314086914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05939149856567383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.059412479400634766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03556680679321289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03701448440551758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03701448440551758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03701448440551758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([50396, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03701448440551758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([597, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11671686172485352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11671686172485352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11728620529174805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12206220626831055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([668, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12241458892822266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12241458892822266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12305164337158203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13300180435180664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([675, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13364887237548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13364887237548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 675, 128]), torch.Size([1, 675, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1342926025390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14862632751464844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 675, 128])
m.shape torch.Size([616, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14947938919067383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14947938919067383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15006685256958008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16791009902954102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([624, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16910409927368164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16910409927368164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16969919204711914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1919388771057129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([587, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19332075119018555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19332075119018555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19388055801391602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21795225143432617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([587, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21963167190551758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21963167190551758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.22019147872924805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.24895954132080078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([572, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.25086164474487305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.25086164474487305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2514071464538574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.28302717208862305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([640, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.28550100326538086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.28550100326538086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.28611135482788086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.32590627670288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([13500, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.38997411727905273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.38997411727905273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13500, 128]), torch.Size([1, 13500, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.40340185165405273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3192534446716309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13500, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.244056224822998  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.2622389793395996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.2804217338562012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.262096881866455  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([19066, 256])
first layer input nodes number: 50396
first layer output nodes number: 19066
edges number: 162509
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.280799388885498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.2989821434020996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3044829368591309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3044829368591309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([327, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3353123664855957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3353123664855957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3359360694885254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.34122896194458  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([280, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3414554595947266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3414554595947266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.341989517211914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.351491928100586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([237, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3519086837768555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3519086837768555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.352360725402832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3623056411743164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([148, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3626489639282227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3626489639282227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.362931251525879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3711175918579102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([154, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3717169761657715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3717169761657715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3720107078552246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.382585048675537  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([110, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.383072853088379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.383072853088379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3832826614379883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3923044204711914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([94, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3928322792053223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3928322792053223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3930115699768066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4019761085510254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([76, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4024710655212402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4024710655212402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.402616024017334  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4108786582946777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4115242958068848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4115242958068848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4116826057434082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4218144416809082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([55, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4222640991210938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4222640991210938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4223690032958984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4298171997070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4305262565612793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4305262565612793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4306635856628418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4413752555847168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.442068099975586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.442068099975586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4421939849853516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4528942108154297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.453718662261963  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.453718662261963  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4538540840148926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4663128852844238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4668912887573242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4668912887573242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4669828414916992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4760465621948242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4766497611999512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4766497611999512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4767355918884277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4858336448669434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4865903854370117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4865903854370117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.486689567565918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4978971481323242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4984850883483887  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4984850883483887  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4985594749450684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5074858665466309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5083656311035156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5083656311035156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5084667205810547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5213050842285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5219120979309082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5219120979309082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5219807624816895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.531181812286377  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5317625999450684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5317625999450684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5318236351013184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5404295921325684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5413074493408203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5413074493408203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5413932800292969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5540962219238281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.554539680480957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.554539680480957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5545835494995117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5613832473754883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5618257522583008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5618257522583008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5618658065795898  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.568354606628418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5689115524291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5689115524291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5689592361450195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5770177841186523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([611, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5916752815246582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5916752815246582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5928406715393066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8026766777038574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 611, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.7745413780212402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.7749590873718262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.775376796722412  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.7749381065368652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2803, 40])
input nodes number: 19066
output nodes number: 2803
edges number: 31619
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.7751078605651855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.7751083374023438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03953886032104492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 29 input nodes size: 52326
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.035573482513427734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.035573482513427734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.060964107513427734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06098508834838867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03693342208862305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03840970993041992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03840970993041992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03840970993041992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([52326, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03840970993041992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([610, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1203770637512207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1203770637512207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12095880508422852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12641525268554688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([684, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12677669525146484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12677669525146484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12742900848388672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13721370697021484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([708, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13790035247802734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13790035247802734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 708, 128]), torch.Size([1, 708, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13857555389404297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15360736846923828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 708, 128])
m.shape torch.Size([629, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15446949005126953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15446949005126953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15506935119628906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1733865737915039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([656, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1746506690979004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1746506690979004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1752762794494629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19809770584106445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([644, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19962739944458008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19962739944458008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2002415657043457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2274174690246582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([599, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2291097640991211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2291097640991211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.22968101501464844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.25855207443237305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([622, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2606391906738281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2606391906738281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2612323760986328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2964496612548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([576, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.29862499237060547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.29862499237060547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.29917430877685547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.33483028411865234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([13901, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.40096187591552734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.40096187591552734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13901, 128]), torch.Size([1, 13901, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4142189025878906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.356297492980957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13901, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.2789640426635742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.2984952926635742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3180265426635742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.2983489036560059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([19629, 256])
first layer input nodes number: 52326
first layer output nodes number: 19629
edges number: 167125
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3184185028076172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3379497528076172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3426856994628906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3426856994628906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([362, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3728647232055664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3728647232055664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3735551834106445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.379378318786621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([280, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3795714378356934  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3795714378356934  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3801054954528809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3900561332702637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([220, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3904237747192383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3904237747192383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.390843391418457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4000749588012695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([164, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.400496006011963  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.400496006011963  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4008088111877441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4098801612854004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([145, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4104208946228027  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4104208946228027  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4106974601745605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4206538200378418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([125, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.421236515045166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.421236515045166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4214749336242676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4317269325256348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([97, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.432260513305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.432260513305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4324455261230469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4416961669921875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4422574043273926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4422574043273926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4424195289611816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4516606330871582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([70, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4521851539611816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4521851539611816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4523186683654785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4608635902404785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4614601135253906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4614601135253906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4615917205810547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4709358215332031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4715576171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4715576171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4716815948486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4813518524169922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4820399284362793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4820399284362793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.482163906097412  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4927020072937012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4932899475097656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4932899475097656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.4933891296386719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5025138854980469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5031237602233887  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5031237602233887  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5032172203063965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.51246976852417  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.513115406036377  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.513115406036377  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.513206958770752  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.522911548614502  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5233120918273926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5233120918273926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5233674049377441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5296177864074707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5301785469055176  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5301785469055176  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5302472114562988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5384869575500488  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5391793251037598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5391793251037598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.539259433746338  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5494332313537598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.550123691558838  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.550123691558838  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5501999855041504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5604233741760254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5611929893493652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5611929893493652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5612730979919434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.572568416595459  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5731945037841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5731945037841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5732574462890625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5825729370117188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5829224586486816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5829224586486816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5829567909240723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5882782936096191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5888581275939941  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5888581275939941  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.58890962600708  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.597252368927002  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5978727340698242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.5978727340698242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.597926139831543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6069517135620117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([605, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.621462345123291  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.621462345123291  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 605, 256]), torch.Size([1, 605, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.6226162910461426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8373537063598633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 605, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8098955154418945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.810312271118164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8107290267944336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8102912902832031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2796, 40])
input nodes number: 19629
output nodes number: 2796
edges number: 30908
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.810457706451416  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.8104581832885742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04097700119018555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 30 input nodes size: 45958
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03693246841430664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03693246841430664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05884695053100586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0588679313659668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03345632553100586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.034459590911865234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.034459590911865234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.034459590911865234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([45958, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.034459590911865234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([742, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09090137481689453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09090137481689453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 742, 128]), torch.Size([1, 742, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09160900115966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09737777709960938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 742, 128])
m.shape torch.Size([853, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09783744812011719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09783744812011719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09865093231201172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11160659790039062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([836, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1123957633972168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1123957633972168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11319303512573242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13165616989135742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([714, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13261938095092773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13261938095092773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 714, 128]), torch.Size([1, 714, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1333003044128418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1538710594177246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 714, 128])
m.shape torch.Size([713, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15523052215576172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15523052215576172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15591049194335938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1813044548034668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([625, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1827526092529297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1827526092529297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1833486557006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.20908832550048828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([580, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21072626113891602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21072626113891602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21127939224243164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2391648292541504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([530, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.24182558059692383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.24182558059692383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.24233102798461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2714657783508301  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([513, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.27341461181640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.27341461181640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.27390384674072266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.30574846267700195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([8528, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.34616851806640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.34616851806640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 8528, 128]), torch.Size([1, 8528, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3550891876220703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9325275421142578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 8528, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8808565139770508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8948125839233398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9087686538696289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8947033882141113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([14634, 256])
first layer input nodes number: 45958
first layer output nodes number: 14634
edges number: 113324
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9091134071350098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9230694770812988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9265584945678711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9265584945678711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([443, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.947451114654541  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.947451114654541  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.948296070098877  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9551892280578613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([418, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9555706977844238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9555706977844238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9563679695129395  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9683270454406738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([301, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9687967300415039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9687967300415039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9693708419799805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9843549728393555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9849333763122559  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9849333763122559  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9853625297546387  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9978079795837402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([178, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9984488487243652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9984488487243652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9987883567810059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0110106468200684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0117521286010742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0117521286010742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0120534896850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0250120162963867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0256085395812988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0256085395812988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.025820255279541  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0364060401916504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0370001792907715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0370001792907715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0371737480163574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0470671653747559  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0476641654968262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0476641654968262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0478148460388184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0574584007263184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0581235885620117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0581235885620117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0582704544067383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0686979293823242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0692906379699707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0692906379699707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.069410800933838  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0787835121154785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0792655944824219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0792655944824219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.079355239868164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.08697509765625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0874676704406738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0874676704406738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0875496864318848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.095095157623291  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0954313278198242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0954313278198242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.095484733581543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1007719039916992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1013507843017578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1013507843017578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.101430892944336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1099224090576172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1103744506835938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1103744506835938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1104354858398438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1173324584960938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1177597045898438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1177597045898438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1178131103515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1242218017578125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.124610424041748  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.124610424041748  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1246562004089355  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.130469799041748  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.130903720855713  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.130903720855713  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1309514045715332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.137341022491455  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1377596855163574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1377596855163574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.137803554534912  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.143989086151123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1442699432373047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1442699432373047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1442985534667969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1485328674316406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1487512588500977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1487512588500977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1487722396850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.152024269104004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1523456573486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1523456573486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.152374267578125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1570091247558594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1572489738464355  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1572489738464355  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1572699546813965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.160815715789795  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([276, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1680283546447754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1680283546447754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1685547828674316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.264958381652832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 276, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.247075080871582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.2474870681762695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.247899055480957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.2474660873413086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2764, 40])
input nodes number: 14634
output nodes number: 2764
edges number: 21165
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.247591495513916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.2475919723510742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03631877899169922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 31 input nodes size: 44742
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03345155715942383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03345155715942383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05493593215942383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.054956912994384766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03302145004272461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.034062862396240234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.034062862396240234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.034062862396240234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([44742, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.034062862396240234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([675, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09140157699584961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09140157699584961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 675, 128]), torch.Size([1, 675, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09204530715942383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09719514846801758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 675, 128])
m.shape torch.Size([762, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09759998321533203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09759998321533203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 762, 128]), torch.Size([1, 762, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0983266830444336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10922718048095703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 762, 128])
m.shape torch.Size([683, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10999774932861328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10999774932861328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 683, 128]), torch.Size([1, 683, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11064910888671875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12497901916503906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 683, 128])
m.shape torch.Size([694, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1259770393371582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1259770393371582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 694, 128]), torch.Size([1, 694, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12663888931274414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14583253860473633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 694, 128])
m.shape torch.Size([646, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14704179763793945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14704179763793945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1476578712463379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.17015790939331055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([557, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.17144346237182617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.17144346237182617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.17197465896606445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19501256942749023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([500, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19641590118408203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19641590118408203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19689273834228516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2207345962524414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([482, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2223348617553711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2223348617553711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2227945327758789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.24899578094482422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([468, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2507743835449219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2507743835449219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.251220703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.27978515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([9143, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.32315921783447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.32315921783447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 9143, 128]), torch.Size([1, 9143, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.331878662109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9509592056274414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 9143, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8976912498474121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9116244316101074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9255576133728027  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9115152359008789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([14610, 256])
first layer input nodes number: 44742
first layer output nodes number: 14610
edges number: 116594
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9258933067321777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.939826488494873  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9438719749450684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9438719749450684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([433, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9665675163269043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9665675163269043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9673933982849121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9753222465515137  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([354, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9755902290344238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9755902290344238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9762654304504395  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.987940788269043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([272, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9883875846862793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9883875846862793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.9889063835144043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0021753311157227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0028157234191895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0028157234191895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0032620429992676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0162053108215332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0169339179992676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0169339179992676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0173115730285645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.030907154083252  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.031531810760498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.031531810760498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0318007469177246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0433650016784668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([103, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0439238548278809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0439238548278809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0441203117370605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.053943157196045  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([92, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0545525550842285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0545525550842285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0547280311584473  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.064730167388916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0654473304748535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0654473304748535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.065624713897705  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.076977252960205  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0775904655456543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0775904655456543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0777297019958496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0876154899597168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0882225036621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0882225036621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0883445739746094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0978660583496094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0982894897460938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0982894897460938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.0983695983886719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1051788330078125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1056513786315918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1056513786315918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.105729579925537  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1129240989685059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1132888793945312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1132888793945312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1133460998535156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1190109252929688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1195878982543945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1195878982543945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1196680068969727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.128159523010254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1286578178405762  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1286578178405762  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1287245750427246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.136268138885498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1367249488830566  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1367249488830566  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.136782169342041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.143648624420166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1441736221313477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1441736221313477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1442346572875977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1519861221313477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1523208618164062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1523208618164062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1523590087890625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.157470703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1577787399291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1577787399291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.157811164855957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1623830795288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1627707481384277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1627707481384277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.162808895111084  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.168454647064209  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1686897277832031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1686897277832031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1687126159667969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1722602844238281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1725807189941406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1725807189941406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1726093292236328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1772441864013672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1775531768798828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1775531768798828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1775798797607422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1820926666259766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([351, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1905136108398438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.1905136108398438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.191183090209961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.324275016784668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 351, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3053345680236816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3057456016540527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3061566352844238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3057246208190918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2758, 40])
input nodes number: 14610
output nodes number: 2758
edges number: 23050
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3058538436889648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.305854320526123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03596925735473633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03596925735473633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.03596925735473633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008183076977729797 |0.001767665147781372 |0.1155790314078331 |8.513778448104858e-05 |0.07602716982364655 |0.004828691482543945 |
----------------------------------------------------------pseudo_mini_loss sum 4.86362361907959
Total (block generation + training)time/epoch 27.998687267303467
Training time/epoch 6.626271486282349
Training time without block to device /epoch 6.569706201553345
Training time without total dataloading part /epoch 6.138951539993286
load block tensor time/epoch 0.2618584632873535
block to device time/epoch 0.056565284729003906
input features size transfer per epoch 4.291534423828125e-06[05:39:02] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23407770 edges into 32 parts and get 7362124 edge cuts

blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1189342
Number of first layer input nodes during this epoch:  852498
Number of first layer output nodes during this epoch:  336844
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.035968780517578125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.020258188247680664
global_2_local spend time (sec) 0.05809760093688965
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004445314407348633
A = g.adjacency_matrix() spent  0.013873100280761719
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09123396873474121
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3125066757202148
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1742184162139893

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770})
Convert a graph into a bidirected graph: 0.956 seconds
Metis partitioning: 5.225 seconds
Split the graph: 0.471 seconds
Construct subgraphs: 0.053 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.718560218811035
2813
2788
2927
2758
2903
2927
2892
2887
2891
2890
2866
2926
2900
2870
2874
2899
2810
2758
2803
2797
2894
2852
2811
2803
2790
2817
2773
2824
2759
2758
2923
2758
total k batches seeds list generation spend  17.347227096557617
after graph partition
graph partition algorithm spend time 17.4308762550354
2813
2788
2927
2758
2903
2927
2892
2887
2891
2890
2866
2926
2900
2870
2874
2899
2810
2758
2803
2797
2894
2852
2811
2803
2790
2817
2773
2824
2759
2758
2923
2758
partition_len_list
[7739, 7289, 7989, 7608, 6887, 6659, 6816, 5752, 7639, 6317, 7058, 9913, 5623, 5360, 7052, 7723, 12330, 12401, 10390, 15066, 6820, 8120, 7975, 7243, 16146, 14667, 19547, 16797, 16953, 17054, 17481, 19171]
shared_neighbor_graph_partition_s0 selection method  spend 17.54714560508728
time for parepare:  0.017673015594482422
local_output_nid generation:  0.0008056163787841797
local_in_edges_tensor generation:  0.0010106563568115234
mini_batch_src_global generation:  0.0009124279022216797
r_  generation:  0.005716085433959961
local_output_nid generation:  0.0007941722869873047
local_in_edges_tensor generation:  0.0008609294891357422
mini_batch_src_global generation:  0.0010190010070800781
r_  generation:  0.006502866744995117
local_output_nid generation:  0.0008959770202636719
local_in_edges_tensor generation:  0.000850677490234375
mini_batch_src_global generation:  0.0009171962738037109
r_  generation:  0.007824420928955078
local_output_nid generation:  0.0008535385131835938
local_in_edges_tensor generation:  0.0007352828979492188
mini_batch_src_global generation:  0.0007979869842529297
r_  generation:  0.006863832473754883
local_output_nid generation:  0.0009169578552246094
local_in_edges_tensor generation:  0.000762939453125
mini_batch_src_global generation:  0.00080108642578125
r_  generation:  0.007233142852783203
local_output_nid generation:  0.0009310245513916016
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.0008335113525390625
r_  generation:  0.0076808929443359375
local_output_nid generation:  0.000926971435546875
local_in_edges_tensor generation:  0.0007593631744384766
mini_batch_src_global generation:  0.0007407665252685547
r_  generation:  0.0064394474029541016
local_output_nid generation:  0.0009446144104003906
local_in_edges_tensor generation:  0.0007688999176025391
mini_batch_src_global generation:  0.0007104873657226562
r_  generation:  0.006577968597412109
local_output_nid generation:  0.0009386539459228516
local_in_edges_tensor generation:  0.0007097721099853516
mini_batch_src_global generation:  0.0007796287536621094
r_  generation:  0.006917715072631836
local_output_nid generation:  0.0009233951568603516
local_in_edges_tensor generation:  0.0006880760192871094
mini_batch_src_global generation:  0.0006966590881347656
r_  generation:  0.006555080413818359
local_output_nid generation:  0.0009391307830810547
local_in_edges_tensor generation:  0.0007014274597167969
mini_batch_src_global generation:  0.0007612705230712891
r_  generation:  0.0069732666015625
local_output_nid generation:  0.0009405612945556641
local_in_edges_tensor generation:  0.0007276535034179688
mini_batch_src_global generation:  0.0008573532104492188
r_  generation:  0.007636308670043945
local_output_nid generation:  0.0009472370147705078
local_in_edges_tensor generation:  0.0006783008575439453
mini_batch_src_global generation:  0.0006415843963623047
r_  generation:  0.005455732345581055
local_output_nid generation:  0.0009143352508544922
local_in_edges_tensor generation:  0.0006928443908691406
mini_batch_src_global generation:  0.0005509853363037109
r_  generation:  0.00520777702331543
local_output_nid generation:  0.0009317398071289062
local_in_edges_tensor generation:  0.0006690025329589844
mini_batch_src_global generation:  0.0006358623504638672
r_  generation:  0.005849123001098633
local_output_nid generation:  0.0009286403656005859
local_in_edges_tensor generation:  0.0006823539733886719
mini_batch_src_global generation:  0.0007393360137939453
r_  generation:  0.0069065093994140625
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0008287429809570312
mini_batch_src_global generation:  0.0008292198181152344
r_  generation:  0.00700068473815918
local_output_nid generation:  0.0008952617645263672
local_in_edges_tensor generation:  0.0008091926574707031
mini_batch_src_global generation:  0.0007817745208740234
r_  generation:  0.006470680236816406
local_output_nid generation:  0.0009415149688720703
local_in_edges_tensor generation:  0.0006754398345947266
mini_batch_src_global generation:  0.0006587505340576172
r_  generation:  0.005565643310546875
local_output_nid generation:  0.0009469985961914062
local_in_edges_tensor generation:  0.0007274150848388672
mini_batch_src_global generation:  0.0009672641754150391
r_  generation:  0.009227991104125977
local_output_nid generation:  0.0010106563568115234
local_in_edges_tensor generation:  0.0007262229919433594
mini_batch_src_global generation:  0.0008113384246826172
r_  generation:  0.0062940120697021484
local_output_nid generation:  0.0010132789611816406
local_in_edges_tensor generation:  0.0006957054138183594
mini_batch_src_global generation:  0.0006701946258544922
r_  generation:  0.006058692932128906
local_output_nid generation:  0.0009889602661132812
local_in_edges_tensor generation:  0.0006544589996337891
mini_batch_src_global generation:  0.0006341934204101562
r_  generation:  0.0054743289947509766
local_output_nid generation:  0.0009760856628417969
local_in_edges_tensor generation:  0.0006592273712158203
mini_batch_src_global generation:  0.0005812644958496094
r_  generation:  0.00522160530090332
local_output_nid generation:  0.0009539127349853516
local_in_edges_tensor generation:  0.0006961822509765625
mini_batch_src_global generation:  0.0009667873382568359
r_  generation:  0.0075109004974365234
local_output_nid generation:  0.0009856224060058594
local_in_edges_tensor generation:  0.0008482933044433594
mini_batch_src_global generation:  0.0008521080017089844
r_  generation:  0.007120609283447266
local_output_nid generation:  0.0009639263153076172
local_in_edges_tensor generation:  0.000934600830078125
mini_batch_src_global generation:  0.0017604827880859375
r_  generation:  0.010650634765625
local_output_nid generation:  0.0010383129119873047
local_in_edges_tensor generation:  0.0008907318115234375
mini_batch_src_global generation:  0.0012655258178710938
r_  generation:  0.010737895965576172
local_output_nid generation:  0.001230001449584961
local_in_edges_tensor generation:  0.0008523464202880859
mini_batch_src_global generation:  0.0010514259338378906
r_  generation:  0.008480072021484375
local_output_nid generation:  0.0010728836059570312
local_in_edges_tensor generation:  0.0007777214050292969
mini_batch_src_global generation:  0.0011436939239501953
r_  generation:  0.009351253509521484
local_output_nid generation:  0.001157999038696289
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.001302480697631836
r_  generation:  0.012194633483886719
local_output_nid generation:  0.0010571479797363281
local_in_edges_tensor generation:  0.0008511543273925781
mini_batch_src_global generation:  0.001007080078125
r_  generation:  0.010931968688964844
----------------------check_connections_block total spend ----------------------------- 0.40802764892578125
generate_one_block  0.013406515121459961
generate_one_block  0.010683298110961914
generate_one_block  0.01224660873413086
generate_one_block  0.010407686233520508
generate_one_block  0.01061391830444336
generate_one_block  0.01127004623413086
generate_one_block  0.009651899337768555
generate_one_block  0.009574174880981445
generate_one_block  0.010492801666259766
generate_one_block  0.009207487106323242
generate_one_block  0.010380029678344727
generate_one_block  0.012409448623657227
generate_one_block  0.007673740386962891
generate_one_block  0.007426023483276367
generate_one_block  0.008632659912109375
generate_one_block  0.010317802429199219
generate_one_block  0.02174663543701172
generate_one_block  0.010459184646606445
generate_one_block  0.008974313735961914
generate_one_block  0.014708518981933594
generate_one_block  0.008962631225585938
generate_one_block  0.008862972259521484
generate_one_block  0.00819253921508789
generate_one_block  0.007703065872192383
generate_one_block  0.012741804122924805
generate_one_block  0.011157751083374023
generate_one_block  0.016196727752685547
generate_one_block  0.015248775482177734
generate_one_block  0.014055013656616211
generate_one_block  0.014837265014648438
generate_one_block  0.0171511173248291
generate_one_block  0.01728224754333496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035111188888549805
gen group dst list time:  0.010148763656616211
time for parepare:  0.022203922271728516
local_output_nid generation:  0.0021882057189941406
local_in_edges_tensor generation:  0.007600069046020508
mini_batch_src_global generation:  0.0016415119171142578
r_  generation:  0.017226457595825195
local_output_nid generation:  0.002541065216064453
local_in_edges_tensor generation:  0.0025048255920410156
mini_batch_src_global generation:  0.0018296241760253906
r_  generation:  0.016999244689941406
local_output_nid generation:  0.002536296844482422
local_in_edges_tensor generation:  0.002156972885131836
mini_batch_src_global generation:  0.0015964508056640625
r_  generation:  0.019945621490478516
local_output_nid generation:  0.0023572444915771484
local_in_edges_tensor generation:  0.002019166946411133
mini_batch_src_global generation:  0.001604318618774414
r_  generation:  0.018276691436767578
local_output_nid generation:  0.0022101402282714844
local_in_edges_tensor generation:  0.0019414424896240234
mini_batch_src_global generation:  0.0013642311096191406
r_  generation:  0.016683340072631836
local_output_nid generation:  0.002138853073120117
local_in_edges_tensor generation:  0.0016973018646240234
mini_batch_src_global generation:  0.0014362335205078125
r_  generation:  0.016436338424682617
local_output_nid generation:  0.002326488494873047
local_in_edges_tensor generation:  0.0017719268798828125
mini_batch_src_global generation:  0.0012090206146240234
r_  generation:  0.014682292938232422
local_output_nid generation:  0.0018582344055175781
local_in_edges_tensor generation:  0.0014846324920654297
mini_batch_src_global generation:  0.0011658668518066406
r_  generation:  0.013198137283325195
local_output_nid generation:  0.0025396347045898438
local_in_edges_tensor generation:  0.0019681453704833984
mini_batch_src_global generation:  0.0013189315795898438
r_  generation:  0.017806053161621094
local_output_nid generation:  0.0019686222076416016
local_in_edges_tensor generation:  0.0015456676483154297
mini_batch_src_global generation:  0.0012557506561279297
r_  generation:  0.013897180557250977
local_output_nid generation:  0.002184629440307617
local_in_edges_tensor generation:  0.0019466876983642578
mini_batch_src_global generation:  0.0012311935424804688
r_  generation:  0.016805410385131836
local_output_nid generation:  0.0030527114868164062
local_in_edges_tensor generation:  0.002759218215942383
mini_batch_src_global generation:  0.002146482467651367
r_  generation:  0.025063514709472656
local_output_nid generation:  0.00196075439453125
local_in_edges_tensor generation:  0.0017337799072265625
mini_batch_src_global generation:  0.0014693737030029297
r_  generation:  0.01017141342163086
local_output_nid generation:  0.001768350601196289
local_in_edges_tensor generation:  0.0014026165008544922
mini_batch_src_global generation:  0.0010528564453125
r_  generation:  0.00923919677734375
local_output_nid generation:  0.0022449493408203125
local_in_edges_tensor generation:  0.0017542839050292969
mini_batch_src_global generation:  0.0012106895446777344
r_  generation:  0.015126466751098633
local_output_nid generation:  0.0024580955505371094
local_in_edges_tensor generation:  0.001974344253540039
mini_batch_src_global generation:  0.0013878345489501953
r_  generation:  0.017790555953979492
local_output_nid generation:  0.00465083122253418
local_in_edges_tensor generation:  0.005580425262451172
mini_batch_src_global generation:  0.0047130584716796875
r_  generation:  0.03377699851989746
local_output_nid generation:  0.004084110260009766
local_in_edges_tensor generation:  0.003568410873413086
mini_batch_src_global generation:  0.003955364227294922
r_  generation:  0.03258228302001953
local_output_nid generation:  0.0036551952362060547
local_in_edges_tensor generation:  0.0028595924377441406
mini_batch_src_global generation:  0.0023810863494873047
r_  generation:  0.026171445846557617
local_output_nid generation:  0.004879951477050781
local_in_edges_tensor generation:  0.004366397857666016
mini_batch_src_global generation:  0.0041294097900390625
r_  generation:  0.058373212814331055
local_output_nid generation:  0.003657817840576172
local_in_edges_tensor generation:  0.0028257369995117188
mini_batch_src_global generation:  0.002287626266479492
r_  generation:  0.01594376564025879
local_output_nid generation:  0.003964424133300781
local_in_edges_tensor generation:  0.002902507781982422
mini_batch_src_global generation:  0.0016331672668457031
r_  generation:  0.01812267303466797
local_output_nid generation:  0.0037233829498291016
local_in_edges_tensor generation:  0.002782106399536133
mini_batch_src_global generation:  0.0016503334045410156
r_  generation:  0.019460201263427734
local_output_nid generation:  0.003188610076904297
local_in_edges_tensor generation:  0.002426624298095703
mini_batch_src_global generation:  0.00145721435546875
r_  generation:  0.01608753204345703
local_output_nid generation:  0.007120370864868164
local_in_edges_tensor generation:  0.005747556686401367
mini_batch_src_global generation:  0.0066263675689697266
r_  generation:  0.04888010025024414
local_output_nid generation:  0.005944252014160156
local_in_edges_tensor generation:  0.004683256149291992
mini_batch_src_global generation:  0.004693269729614258
r_  generation:  0.04165816307067871
local_output_nid generation:  0.00661921501159668
local_in_edges_tensor generation:  0.008063554763793945
mini_batch_src_global generation:  0.009212970733642578
r_  generation:  0.06130576133728027
local_output_nid generation:  0.005758762359619141
local_in_edges_tensor generation:  0.0048863887786865234
mini_batch_src_global generation:  0.005898714065551758
r_  generation:  0.048514366149902344
local_output_nid generation:  0.005852222442626953
local_in_edges_tensor generation:  0.004893064498901367
mini_batch_src_global generation:  0.005283832550048828
r_  generation:  0.04940915107727051
local_output_nid generation:  0.005728960037231445
local_in_edges_tensor generation:  0.00494074821472168
mini_batch_src_global generation:  0.0058748722076416016
r_  generation:  0.0499880313873291
local_output_nid generation:  0.005738258361816406
local_in_edges_tensor generation:  0.00628972053527832
mini_batch_src_global generation:  0.005530834197998047
r_  generation:  0.0580596923828125
local_output_nid generation:  0.00852823257446289
local_in_edges_tensor generation:  0.006381511688232422
mini_batch_src_global generation:  0.00618433952331543
r_  generation:  0.05911707878112793
----------------------check_connections_block total spend ----------------------------- 1.457671880722046
generate_one_block  0.023617982864379883
generate_one_block  0.03363347053527832
generate_one_block  0.027406692504882812
generate_one_block  0.026457786560058594
generate_one_block  0.021935224533081055
generate_one_block  0.0216982364654541
generate_one_block  0.01957988739013672
generate_one_block  0.017284631729125977
generate_one_block  0.024245500564575195
generate_one_block  0.018246889114379883
generate_one_block  0.02256941795349121
generate_one_block  0.03349900245666504
generate_one_block  0.014303207397460938
generate_one_block  0.014627218246459961
generate_one_block  0.018596172332763672
generate_one_block  0.026125669479370117
generate_one_block  0.047418832778930664
generate_one_block  0.04768776893615723
generate_one_block  0.03725552558898926
generate_one_block  0.060434579849243164
generate_one_block  0.020740985870361328
generate_one_block  0.02380084991455078
generate_one_block  0.024863719940185547
generate_one_block  0.021123409271240234
generate_one_block  0.06510496139526367
generate_one_block  0.05726742744445801
generate_one_block  0.0803380012512207
generate_one_block  0.06579113006591797
generate_one_block  0.06728553771972656
generate_one_block  0.06804752349853516
generate_one_block  0.07298898696899414
generate_one_block  0.08010506629943848
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.035968780517578125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

connection checking time:  1.457671880722046
block generation total time  1.2040812969207764
average batch blocks generation time:  0.03762754052877426
block dataloader generation time/epoch 21.303937792778015
pseudo mini batch 0 input nodes size: 20015
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0330195426940918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0330195426940918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.042563438415527344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04258441925048828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.021079063415527344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.021576881408691406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.021576881408691406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.021576881408691406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([20015, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.021576881408691406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([815, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.046057701110839844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.046057701110839844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04683494567871094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05367326736450195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([815, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0540618896484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0540618896484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.054839134216308594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06733512878417969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([691, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06793498992919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06793498992919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06859397888183594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08309173583984375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([634, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0840301513671875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0840301513671875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08463478088378906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10267829895019531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([522, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10362052917480469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10362052917480469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10411834716796875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12215709686279297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([470, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12325286865234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12325286865234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12370109558105469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.142974853515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([383, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1440291404724121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1440291404724121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1443943977355957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1626572608947754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([364, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1638631820678711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1638631820678711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16421031951904297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.18399715423583984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([286, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.18505096435546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.18505096435546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.18532371520996094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.20277976989746094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 286, 128])
m.shape torch.Size([2759, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21579933166503906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.21579933166503906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2759, 128]), torch.Size([1, 2759, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2184305191040039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4056696891784668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2759, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.38445615768432617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.39183664321899414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3992171287536621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.39177894592285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([7739, 256])
first layer input nodes number: 20015
first layer output nodes number: 7739
edges number: 48241
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3993682861328125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.40674877166748047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.40859413146972656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.40859413146972656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([533, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4270143508911133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4270143508911133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.42803096771240234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.43686771392822266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([445, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.43721485137939453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.43721485137939453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4380636215209961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4511852264404297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([312, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4516606330871582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4516606330871582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4522557258605957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4657430648803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4665336608886719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4665336608886719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.46703338623046875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.48264503479003906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4833035469055176  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4833035469055176  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.48366403579711914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4966416358947754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4973611831665039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4973611831665039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.49765872955322266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5104532241821289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5110516548156738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5110516548156738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.511263370513916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5218491554260254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5225586891174316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5225586891174316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5227608680725098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5342850685119629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.535006046295166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.535006046295166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5351872444152832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5467839241027832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5472893714904785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5472893714904785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5474076271057129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5558037757873535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5563578605651855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5563578605651855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5564684867858887  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5650973320007324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5656075477600098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5656075477600098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5657010078430176  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5736451148986816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5741610527038574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5741610527038574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.574246883392334  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5821433067321777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5824370384216309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5824370384216309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5824847221374512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5872054100036621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5875420570373535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5875420570373535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5875897407531738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.592644214630127  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5930204391479492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5930204391479492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5930700302124023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5986738204956055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5990252494812012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5990252494812012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5990691184997559  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6043334007263184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6046576499938965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6046576499938965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6046957969665527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6095404624938965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6099414825439453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6099414825439453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6099853515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6158638000488281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6162071228027344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6162071228027344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6162433624267578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6213531494140625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6216177940368652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6216177940368652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6216444969177246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6255965232849121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6257948875427246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6257948875427246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6258139610290527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6287703514099121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6291146278381348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6291146278381348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6291451454162598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6340889930725098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.634373664855957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.634373664855957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6343984603881836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6385889053344727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([176, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6428055763244629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6428055763244629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6431412696838379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7022233009338379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 176, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6870212554931641  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6874408721923828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6878604888916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6874198913574219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2813, 40])
input nodes number: 7739
output nodes number: 2813
edges number: 18502
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.687507152557373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6875081062316895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.02257680892944336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 1 input nodes size: 15277
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.021088600158691406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.021088600158691406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.028373241424560547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.028394222259521484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.018829345703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019350051879882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019350051879882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019350051879882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([15277, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019350051879882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([582, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04370737075805664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04370737075805664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04426240921020508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04870271682739258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([613, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04900979995727539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04900979995727539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04959440231323242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05836343765258789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([609, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.058942317962646484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.058942317962646484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05952310562133789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0723576545715332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([527, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07317113876342773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07317113876342773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07367372512817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08913373947143555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([535, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09015798568725586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09015798568725586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0906682014465332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10938167572021484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([467, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11046266555786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11046266555786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11090803146362305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13005876541137695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 467, 128])
m.shape torch.Size([392, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13114452362060547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13114452362060547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13151836395263672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15021038055419922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 392, 128])
m.shape torch.Size([338, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15131282806396484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15131282806396484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15163516998291016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.17000865936279297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([296, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.17124652862548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.17124652862548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 296, 128]), torch.Size([1, 296, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.17152881622314453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.18959522247314453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 296, 128])
m.shape torch.Size([2930, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.20342540740966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.20342540740966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2930, 128]), torch.Size([1, 2930, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.20621967315673828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.40461254119873047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2930, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.38310956954956055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3900609016418457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.39701223373413086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.39000654220581055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([7289, 256])
first layer input nodes number: 15277
first layer output nodes number: 7289
edges number: 48632
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3971281051635742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4040794372558594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4062323570251465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4062323570251465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([413, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4270763397216797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4270763397216797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.42786407470703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4344964027404785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([342, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.43476009368896484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.43476009368896484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4354124069213867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4455299377441406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.44609498977661133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.44609498977661133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4466843605041504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.461306095123291  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.461942195892334  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.461942195892334  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4624037742614746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.47578954696655273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4766068458557129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4766068458557129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.477022647857666  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4919915199279785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.49275827407836914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.49275827407836914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.49308061599731445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5069413185119629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5076079368591309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5076079368591309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5078425407409668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5195727348327637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.520355224609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.520355224609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5205783843994141  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5332984924316406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5341038703918457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5341038703918457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5343060493469238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5472455024719238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5480384826660156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5480384826660156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5482158660888672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5608100891113281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5613455772399902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5613455772399902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5614581108093262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5702357292175293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5708370208740234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5708370208740234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5709457397460938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5801868438720703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5806951522827148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5806951522827148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5807809829711914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5886774063110352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5892672538757324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5892672538757324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5893568992614746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5982317924499512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5986919403076172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5986919403076172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5987586975097656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6058349609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6060938835144043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6060938835144043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6061301231384277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6102252006530762  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6107463836669922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6107463836669922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.610809326171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6183624267578125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.618746280670166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.618746280670166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6187920570373535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.624605655670166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6249847412109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6249847412109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6250267028808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6306495666503906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6312055587768555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6312055587768555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6312627792358398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6393308639526367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6397466659545898  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6397466659545898  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6397886276245117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6459989547729492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6462955474853516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6462955474853516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6463241577148438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6507587432861328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6510543823242188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6510543823242188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6510810852050781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6554069519042969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6556477546691895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6556477546691895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6556687355041504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6592144966125488  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([223, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6651577949523926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6651577949523926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6655831336975098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7404427528381348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 223, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7226529121398926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7230687141418457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7234845161437988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7230477333068848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2788, 40])
input nodes number: 7289
output nodes number: 2788
edges number: 21146
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7231192588806152  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7231197357177734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.02033376693725586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 2 input nodes size: 16102
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.018825531005859375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.018825531005859375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.026503562927246094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.026525497436523438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01921987533569336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019861698150634766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019861698150634766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019861698150634766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([16102, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019861698150634766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([443, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04886960983276367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04886960983276367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04929208755493164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05267190933227539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([507, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.052944183349609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.052944183349609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.053427696228027344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.060680389404296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([533, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06120109558105469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06120109558105469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06170940399169922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0731205940246582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([465, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07375335693359375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07375335693359375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07419681549072266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08705711364746094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([489, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08800125122070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08800125122070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08846759796142578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1052560806274414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([426, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10624170303344727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10624170303344727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10664796829223633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12411737442016602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([412, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1252894401550293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1252894401550293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12568235397338867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14532804489135742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([391, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1466231346130371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1466231346130371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 391, 128]), torch.Size([1, 391, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14699602127075195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16825056076049805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 391, 128])
m.shape torch.Size([330, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1694803237915039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1694803237915039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16979503631591797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.18993663787841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([3993, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.20931053161621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.20931053161621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 3993, 128]), torch.Size([1, 3993, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.2131185531616211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.488645076751709  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 3993, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4628300666809082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.47044897079467773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.47806787490844727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.47038936614990234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([7989, 256])
first layer input nodes number: 16102
first layer output nodes number: 7989
edges number: 58829
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.47818994522094727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4858088493347168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4882040023803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4882040023803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([325, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5148453712463379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5148453712463379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.515465259552002  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5206766128540039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([293, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.520930290222168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.520930290222168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.521489143371582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5316362380981445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5321240425109863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5321240425109863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5326313972473145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5443367958068848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([191, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5448174476623535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5448174476623535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5451817512512207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5557465553283691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([186, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5564584732055664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5564584732055664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5568132400512695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.569584846496582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.570284366607666  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.570284366607666  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5705742835998535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.583040714263916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([156, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5839457511901855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5839457511901855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5842432975769043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5991206169128418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6000175476074219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6000175476074219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6002769470214844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6150627136230469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6158847808837891  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6158847808837891  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6160945892333984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6295223236083984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6303501129150391  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6303501129150391  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6305351257324219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6436710357666016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6446995735168457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6446995735168457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6449017524719238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6606717109680176  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([80, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6614933013916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6614933013916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6616458892822266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6746158599853516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6754517555236816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6754517555236816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.675590991973877  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6884007453918457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6893301010131836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6893301010131836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6894712448120117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7034444808959961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([67, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7043399810791016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7043399810791016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7044677734375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7180137634277344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7186880111694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7186880111694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7187795639038086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7291250228881836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7299127578735352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7299127578735352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7300100326538086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7416830062866211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.742222785949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.742222785949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7422876358032227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.750523567199707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7509479522705078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7509479522705078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7509956359863281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.75738525390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7580728530883789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7580728530883789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.758143424987793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7680940628051758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7687249183654785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7687249183654785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7687878608703613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7781033515930176  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7784948348999023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7784948348999023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7785329818725586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7844457626342773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7850461006164551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7850461006164551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7850995063781738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7937512397766113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7943243980407715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7943243980407715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7943739891052246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8027548789978027  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([313, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8102512359619141  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8102512359619141  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8108482360839844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.917694091796875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 313, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8941164016723633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8945527076721191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.894989013671875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8945307731628418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2927, 40])
input nodes number: 7989
output nodes number: 2927
edges number: 27259
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8946328163146973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.8946332931518555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.021059513092041016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 3 input nodes size: 17199
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019240379333496094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019240379333496094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.02744150161743164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.027462482452392578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.019762516021728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.020320415496826172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.020320415496826172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.020320415496826172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([17199, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.020320415496826172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([561, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04665851593017578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04665851593017578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04719352722167969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05178117752075195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([601, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.052086830139160156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.052086830139160156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05265998840332031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.061257362365722656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([630, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.061872005462646484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.061872005462646484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06247282028198242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07572507858276367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([555, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07648324966430664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07648324966430664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07701253890991211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09277963638305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([513, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09373807907104492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09373807907104492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09422731399536133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11190986633300781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([433, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11290407180786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11290407180786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11331701278686523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1310734748840332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([393, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13217878341674805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13217878341674805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 393, 128]), torch.Size([1, 393, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1325535774230957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15129327774047852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 393, 128])
m.shape torch.Size([347, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15242958068847656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15242958068847656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15276050567626953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.17162322998046875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([289, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1726980209350586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1726980209350586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1729736328125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19061279296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([3286, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.20614385604858398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.20614385604858398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 3286, 128]), torch.Size([1, 3286, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.20927762985229492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.440518856048584  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 3286, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.41631078720092773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4235663414001465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.43082189559936523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4235095977783203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([7608, 256])
first layer input nodes number: 17199
first layer output nodes number: 7608
edges number: 52024
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4309520721435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.43820762634277344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4400215148925781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4400215148925781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([351, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.46233367919921875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.46233367919921875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.46300315856933594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4697132110595703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([328, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.47000932693481445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.47000932693481445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.47063493728637695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.48003435134887695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([301, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4805898666381836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4805898666381836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.48116397857666016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4943819046020508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4949984550476074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4949984550476074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.49544668197631836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5084452629089355  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5091729164123535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5091729164123535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5095505714416504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5231461524963379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5238165855407715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5238165855407715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5241007804870605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5363211631774902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5371212959289551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5371212959289551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5373883247375488  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5507397651672363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5513982772827148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5513982772827148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5515947341918945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5627927780151367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5634732246398926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5634732246398926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5636448860168457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5746312141418457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5753626823425293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5753626823425293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5755248069763184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5870356559753418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5877690315246582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5877690315246582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5879158973693848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5993714332580566  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5999441146850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5999441146850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6000509262084961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6091299057006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6096639633178711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6096639633178711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6097536087036133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6180009841918945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6186561584472656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6186561584472656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6187553405761719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6285743713378906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6292457580566406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6292457580566406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6293411254882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6394500732421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6400022506713867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6400022506713867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6400766372680664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6484823226928711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6490988731384277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6490988731384277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6491751670837402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6583304405212402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6589326858520508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6589326858520508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6590032577514648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6679658889770508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6684970855712891  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6684970855712891  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6685562133789062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6764793395996094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6770844459533691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6770844459533691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.677147388458252  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6860222816467285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6864752769470215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6864752769470215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.686521053314209  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.693295955657959  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6936116218566895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6936116218566895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6936421394348145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6983723640441895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6986889839172363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6986889839172363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6987175941467285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7033524513244629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.703707218170166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.703707218170166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.703737735748291  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.708895206451416  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([245, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7147669792175293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7147669792175293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7152342796325684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7974791526794434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 245, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7781233787536621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7785344123840332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7789454460144043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7785134315490723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2758, 40])
input nodes number: 7608
output nodes number: 2758
edges number: 22735
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7785658836364746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7785663604736328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.02135324478149414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 4 input nodes size: 15573
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01973724365234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01973724365234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.027163028717041016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.02718496322631836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.018962860107421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01949024200439453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01949024200439453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01949024200439453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([15573, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01949024200439453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([453, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04254865646362305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04254865646362305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04298067092895508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04643678665161133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([591, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.046784400939941406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.046784400939941406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0473480224609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05679512023925781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([586, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05735158920288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05735158920288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05791044235229492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07072782516479492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([530, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07145929336547852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07145929336547852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07196474075317383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08711481094360352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([464, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08796834945678711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08796834945678711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.08841085433959961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10434103012084961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([408, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10528707504272461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10528707504272461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10567617416381836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12240743637084961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([405, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1235647201538086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1235647201538086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 405, 128]), torch.Size([1, 405, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.12395095825195312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1432628631591797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 405, 128])
m.shape torch.Size([348, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14439725875854492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.14439725875854492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1447291374206543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16364622116088867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([303, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1647806167602539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1647806167602539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 303, 128]), torch.Size([1, 303, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.165069580078125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.183563232421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 303, 128])
m.shape torch.Size([2799, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19676542282104492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19676542282104492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2799, 128]), torch.Size([1, 2799, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.19943475723266602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.39764404296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2799, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.37638187408447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3829498291015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.38951778411865234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.38289833068847656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([6887, 256])
first layer input nodes number: 15573
first layer output nodes number: 6887
edges number: 46617
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3896360397338867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.39620399475097656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3978462219238281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3978462219238281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([313, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4218897819519043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4218897819519043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4224867820739746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.428433895111084  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([317, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4287447929382324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4287447929382324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.429349422454834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4384188652038574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.43895864486694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.43895864486694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4395155906677246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4522128105163574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.45287656784057617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.45287656784057617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.45334386825561523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.46689558029174805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4676041603088379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4676041603088379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.46797800064086914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.48143625259399414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([171, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4822559356689453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4822559356689453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.48258209228515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.49660682678222656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([158, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.49754905700683594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.49754905700683594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4978504180908203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5129184722900391  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([143, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5138745307922363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5138745307922363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5141472816467285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5296940803527832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([116, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5305614471435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5305614471435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5307826995849609  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5449428558349609  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([110, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5458898544311523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5458898544311523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5460996627807617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5609960556030273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([104, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5619907379150391  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5619907379150391  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5621891021728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5776615142822266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([82, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5785083770751953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5785083770751953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5786647796630859  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5919589996337891  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.592780590057373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.592780590057373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5929179191589355  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6055521965026855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6062912940979004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6062912940979004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6064057350158691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6177353858947754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6183271408081055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6183271408081055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.618412971496582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6275110244750977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6284065246582031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6284065246582031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6285228729248047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6416702270507812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6422004699707031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6422004699707031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6422691345214844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6505088806152344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6511669158935547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6511669158935547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6512432098388672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6609325408935547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.661351203918457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.661351203918457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6613988876342773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6677885055541992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6684951782226562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6684951782226562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6685676574707031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6787872314453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6794171333312988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6794171333312988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6794800758361816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6887955665588379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6892504692077637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6892504692077637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6892943382263184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6960940361022949  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6963820457458496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6963820457458496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.696408748626709  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7007346153259277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7012057304382324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7012057304382324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7012457847595215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.708014965057373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([188, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7125124931335449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7125124931335449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7128710746765137  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7759814262390137  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 188, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7550621032714844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7554950714111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7559280395507812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7554731369018555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2903, 40])
input nodes number: 6887
output nodes number: 2903
edges number: 24050
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7555685043334961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7555689811706543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.020522594451904297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 5 input nodes size: 14151
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01898479461669922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01898479461669922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.02573251724243164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.025754451751708984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.018306732177734375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01885509490966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01885509490966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01885509490966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([14151, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.01885509490966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([350, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04307079315185547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04307079315185547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.043404579162597656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.046074867248535156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([448, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04633522033691406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04633522033691406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.04676246643066406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05317115783691406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([468, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05362701416015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.05362701416015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.054073333740234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06389236450195312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([486, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06459617614746094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06459617614746094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06505966186523438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07850074768066406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([446, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07933235168457031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07933235168457031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.0797576904296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09506988525390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([449, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09614181518554688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09614181518554688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.09657001495361328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11498260498046875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([383, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11604690551757812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11604690551757812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11641216278076172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1346750259399414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([343, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13583707809448242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13583707809448242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 343, 128]), torch.Size([1, 343, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.13616418838500977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15480947494506836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 343, 128])
m.shape torch.Size([276, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15583038330078125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15583038330078125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 276, 128]), torch.Size([1, 276, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.15609359741210938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.17293930053710938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 276, 128])
m.shape torch.Size([3010, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.18716049194335938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.18716049194335938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 3010, 128]), torch.Size([1, 3010, 128])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1903858184814453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.40300941467285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 3010, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3811807632446289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3875312805175781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.39388179779052734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.3874812126159668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([6659, 256])
first layer input nodes number: 14151
first layer output nodes number: 6659
edges number: 47527
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.39398956298828125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4008197784423828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4019279479980469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4019279479980469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([263, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.42789411544799805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.42789411544799805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.42839574813842773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.43299293518066406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([275, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4332709312438965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4332709312438965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4337954521179199  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4422626495361328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([247, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.44271278381347656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.44271278381347656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.44318389892578125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4535484313964844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.45421266555786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.45421266555786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.45465898513793945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4676022529602051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([225, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.46897268295288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.46897268295288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.46940183639526367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.4848513603210449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([213, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.48586511611938477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.48586511611938477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.48627138137817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5037407875061035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([177, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5047287940979004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5047287940979004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5050663948059082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5219464302062988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([134, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5228080749511719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5228080749511719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5230636596679688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5376319885253906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5384211540222168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5384211540222168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5386233329772949  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5515627861022949  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([137, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5527787208557129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5527787208557129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5530400276184082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5715928077697754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([105, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5725727081298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5725727081298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5727729797363281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5883941650390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5891823768615723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5891823768615723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.5893292427062988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6018128395080566  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([76, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.602689266204834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.602689266204834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6028342247009277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6161704063415527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([75, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6171073913574219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6171073913574219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6172504425048828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6314125061035156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6320619583129883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6320619583129883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6321573257446289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6422662734985352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6429262161254883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6429262161254883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6430139541625977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.652928352355957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6539139747619629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6539139747619629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6540341377258301  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6684536933898926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6690168380737305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6690168380737305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6690855026245117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6778059005737305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6783380508422852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6783380508422852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6783971786499023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6863203048706055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6870789527893066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6870789527893066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.687157154083252  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.698183536529541  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6987500190734863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6987500190734863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.6988072395324707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7072758674621582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7076702117919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7076702117919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7077083587646484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7136211395263672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7140665054321289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7140665054321289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.714106559753418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7205953598022461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7210831642150879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7210831642150879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7211251258850098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7282166481018066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([223, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7335543632507324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7335543632507324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.7339797019958496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.8088393211364746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 223, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.7859535217285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.7863898277282715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7868261337280273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7863678932189941  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2927, 40])
input nodes number: 6659
output nodes number: 2927
edges number: 25915
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7864432334899902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7864437103271484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01988983154296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 6 input nodes size: 14798
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.018310070037841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.018310070037841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02536630630493164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.025388240814208984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01861858367919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01907634735107422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01907634735107422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01907634735107422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([14798, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01907634735107422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([756, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03953218460083008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03953218460083008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 756, 128]), torch.Size([1, 756, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0402531623840332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04635763168334961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 756, 128])
m.shape torch.Size([791, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04675149917602539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04675149917602539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.047505855560302734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05882120132446289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([688, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05942821502685547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05942821502685547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 688, 128]), torch.Size([1, 688, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06008434295654297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0748891830444336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 688, 128])
m.shape torch.Size([614, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07578182220458984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07578182220458984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07636737823486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09335613250732422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([483, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09421491622924805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09421491622924805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09467554092407227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11125802993774414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([437, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11227798461914062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11227798461914062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11269474029541016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.130615234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 437, 128])
m.shape torch.Size([328, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1315016746520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1315016746520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13181447982788086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14745473861694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([320, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14851903915405273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14851903915405273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14882421493530273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16621923446655273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([262, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1671910285949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1671910285949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16744089126586914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18343210220336914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([2137, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1934971809387207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1934971809387207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2137, 128]), torch.Size([1, 2137, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19553518295288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3416481018066406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2137, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.32404375076293945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.33054399490356445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.33704423904418945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3304929733276367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([6816, 256])
first layer input nodes number: 14798
first layer output nodes number: 6816
edges number: 40479
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3371567726135254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3436875343322754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34586524963378906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34586524963378906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([502, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3664541244506836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3664541244506836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36741161346435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37529468536376953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([423, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3756294250488281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3756294250488281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3764362335205078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38858509063720703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([332, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38913917541503906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38913917541503906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3897724151611328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4038257598876953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40444374084472656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40444374084472656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4049072265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4183483123779297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.419034481048584  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.419034481048584  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41939878463745117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4325137138366699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43348026275634766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43348026275634766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43381595611572266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44825077056884766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([98, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4487423896789551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4487423896789551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4489293098449707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45827531814575195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45895862579345703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45895862579345703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4591512680053711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47013187408447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4708576202392578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4708576202392578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.471038818359375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.482635498046875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48325634002685547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48325634002685547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4833974838256836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49341869354248047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49401426315307617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49401426315307617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49413442611694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.503507137298584  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5041851997375488  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5041851997375488  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5043072700500488  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5146832466125488  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5151348114013672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5151348114013672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5152130126953125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5224075317382812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5228667259216309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5228667259216309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5229372978210449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5299239158630371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5303788185119629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5303788185119629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5304436683654785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5373177528381348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5376543998718262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5376543998718262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5377001762390137  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5428729057312012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5434384346008301  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5434384346008301  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5435070991516113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5517468452453613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5521798133850098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5521798133850098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5522313117980957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5587716102600098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5592207908630371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5592207908630371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5592703819274902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.565915584564209  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5661215782165527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5661215782165527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5661444664001465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5693717002868652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5697841644287109  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5697841644287109  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.56982421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5757522583007812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5760917663574219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5760917663574219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5761241912841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5811500549316406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5815982818603516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5815982818603516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5816383361816406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5881271362304688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5884532928466797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5884532928466797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5884819030761719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5933170318603516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([219, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5985651016235352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5985651016235352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5989828109741211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6724996566772461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 219, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6551527976989746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6555838584899902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6560149192810059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6555619239807129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2892, 40])
input nodes number: 6816
output nodes number: 2892
edges number: 20787
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6556296348571777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6556301116943359  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01998138427734375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 7 input nodes size: 11675
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.018613338470458984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.018613338470458984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02418041229248047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.024202346801757812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.017124176025390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01756000518798828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01756000518798828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01756000518798828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([11675, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01756000518798828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([493, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03586864471435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03586864471435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 493, 128]), torch.Size([1, 493, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03633880615234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04010009765625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 493, 128])
m.shape torch.Size([566, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0404047966003418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0404047966003418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.040944576263427734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04979515075683594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([543, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05030202865600586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05030202865600586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05081987380981445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.062212467193603516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([481, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06287097930908203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06287097930908203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06332969665527344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07663249969482422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([372, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07729005813598633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07729005813598633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07764482498168945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09041643142700195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([355, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09155702590942383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09155702590942383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09189558029174805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10645341873168945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([310, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10731887817382812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10731887817382812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 310, 128]), torch.Size([1, 310, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10761451721191406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12239646911621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 310, 128])
m.shape torch.Size([282, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12332439422607422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12332439422607422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 282, 128]), torch.Size([1, 282, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12359333038330078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13892269134521484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 282, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1399211883544922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1399211883544922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14017295837402344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15628623962402344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([2086, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.166107177734375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.166107177734375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2086, 128]), torch.Size([1, 2086, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16887378692626953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.31443023681640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2086, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2978544235229492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.30333995819091797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3088254928588867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3032970428466797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([5752, 256])
first layer input nodes number: 11675
first layer output nodes number: 5752
edges number: 36830
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3089146614074707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.31440019607543945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3160271644592285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3160271644592285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([361, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3381490707397461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3381490707397461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3388376235961914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34480762481689453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([379, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34519195556640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34519195556640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3459148406982422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35837554931640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3589339256286621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3589339256286621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3595423698425293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3730769157409668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3737802505493164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3737802505493164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3742799758911133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3891267776489258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38987207412719727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38987207412719727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39026689529418945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4044804573059082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.405240535736084  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.405240535736084  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40555715560913086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4191718101501465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([145, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41998910903930664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41998910903930664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42026567459106445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4340939521789551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4349632263183594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4349632263183594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4352130889892578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44945526123046875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4503512382507324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4503512382507324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4505763053894043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4649806022644043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4656562805175781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4656562805175781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46581268310546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4769172668457031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([91, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4778013229370117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4778013229370117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47797489166259766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4915132522583008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([82, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4923725128173828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4923725128173828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49252891540527344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5058231353759766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5066571235656738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5066571235656738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5067963600158691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5196061134338379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5202231407165527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5202231407165527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5203204154968262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5299506187438965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5305075645446777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5305075645446777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5305876731872559  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5390791893005371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5395622253417969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5395622253417969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5396270751953125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5469551086425781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5474295616149902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5474295616149902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5474886894226074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5545840263366699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5551080703735352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5551080703735352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5551691055297852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5629205703735352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5633835792541504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5633835792541504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5634350776672363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.570335865020752  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5707907676696777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5707907676696777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.570838451385498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5775618553161621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5780224800109863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5780224800109863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5780682563781738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5848431587219238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5852432250976562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5852432250976562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5852813720703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5911941528320312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5914626121520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5914626121520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5914874076843262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5955042839050293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5957460403442383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5957460403442383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5957670211791992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5993127822875977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([161, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6031708717346191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6031708717346191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.603477954864502  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.657524585723877  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 161, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6385655403137207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6389961242675781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6394267082214355  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6389741897583008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2887, 40])
input nodes number: 5752
output nodes number: 2887
edges number: 21570
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6390385627746582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6390390396118164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.018405437469482422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 8 input nodes size: 16834
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.017123699188232422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.017123699188232422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.025150775909423828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.025172710418701172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.019583702087402344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020134925842285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020134925842285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020134925842285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([16834, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020134925842285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([597, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04537010192871094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04537010192871094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04593944549560547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.050769805908203125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([664, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05111837387084961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05111837387084961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05175161361694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06125020980834961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([625, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.061827659606933594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.061827659606933594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0624237060546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.076080322265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([576, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07689428329467773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07689428329467773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07744359970092773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09354543685913086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([536, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09454870223999023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09454870223999023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09505987167358398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11409139633178711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([465, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11516618728637695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11516618728637695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11560964584350586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13467836380004883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([424, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13639163970947266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13639163970947266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1367959976196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1570138931274414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([396, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15832233428955078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15832233428955078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15869998931884766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18022632598876953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 396, 128])
m.shape torch.Size([354, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18155670166015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18155670166015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 354, 128]), torch.Size([1, 354, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18189430236816406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20350074768066406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 354, 128])
m.shape torch.Size([3002, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21764659881591797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21764659881591797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 3002, 128]), torch.Size([1, 3002, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22126483917236328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4346771240234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 3002, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41153812408447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4188232421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42610836029052734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4187660217285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([7639, 256])
first layer input nodes number: 16834
first layer output nodes number: 7639
edges number: 50916
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4262361526489258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4335212707519531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43534278869628906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43534278869628906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4579935073852539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4579935073852539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45879268646240234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46599721908569336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([348, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4662666320800781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4662666320800781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4669303894042969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4770498275756836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4775371551513672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4775371551513672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47807884216308594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4905276298522949  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4911336898803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4911336898803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49156856536865234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5041799545288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5048952102661133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5048952102661133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5052652359008789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5185861587524414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5192837715148926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5192837715148926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5195755958557129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5321240425109863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5328798294067383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5328798294067383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5331354141235352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5459146499633789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5467791557312012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5467791557312012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.547025203704834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5610499382019043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5619044303894043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5619044303894043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5621199607849121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5759139060974121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([107, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5768346786499023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5768346786499023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5770387649536133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5915288925170898  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5924210548400879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5924210548400879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5926003456115723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6065850257873535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6072454452514648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6072454452514648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6073694229125977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6179075241088867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6186079978942871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6186079978942871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6187243461608887  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6294283866882324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6299757957458496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6299757957458496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6300616264343262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6385588645935059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6391940116882324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6391940116882324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6392836570739746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6487860679626465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6495256423950195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6495256423950195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.649622917175293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6606149673461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6611876487731934  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6611876487731934  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6612601280212402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6699576377868652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6703886985778809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6703886985778809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6704401969909668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6769804954528809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6775574684143066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6775574684143066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6776204109191895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6860547065734863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6867537498474121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6867537498474121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.686826229095459  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6970458030700684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6973729133605957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6973729133605957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6974072456359863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7024884223937988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7028098106384277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7028098106384277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7028403282165527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7075705528259277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7078652381896973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7078652381896973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7078919410705566  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7122178077697754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7125506401062012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7125506401062012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7125792503356934  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.717414379119873  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([220, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7226862907409668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7226862907409668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7231059074401855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7969584465026855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 220, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7774844169616699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7779154777526855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7783465385437012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7778935432434082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2891, 40])
input nodes number: 7639
output nodes number: 2891
edges number: 23013
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7779731750488281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7779736518859863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.021188735961914062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 9 input nodes size: 12183
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.019584178924560547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.019584178924560547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02539348602294922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.025415420532226562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.017366409301757812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01780414581298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01780414581298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01780414581298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([12183, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01780414581298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([621, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03688621520996094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03688621520996094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03747844696044922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04230546951293945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([646, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04262542724609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04262542724609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04324150085449219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05248260498046875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([590, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05301856994628906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05301856994628906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05358123779296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06599807739257812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([603, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06686687469482422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06686687469482422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06744194030761719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0844106674194336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([512, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08534383773803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08534383773803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08583211898803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10341024398803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([430, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10439634323120117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10439634323120117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10480642318725586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12243986129760742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([377, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12349319458007812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12349319458007812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12385272979736328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1418294906616211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([336, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14293146133422852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14293146133422852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14325189590454102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16151666641235352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 336, 128])
m.shape torch.Size([293, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1626138687133789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1626138687133789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 293, 128]), torch.Size([1, 293, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16289329528808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18077659606933594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 293, 128])
m.shape torch.Size([1909, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18973970413208008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18973970413208008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 1909, 128]), torch.Size([1, 1909, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1915602684020996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.32082033157348633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 1909, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.30454063415527344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3105649948120117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.31658935546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3105177879333496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([6317, 256])
first layer input nodes number: 12183
first layer output nodes number: 6317
edges number: 38289
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3166823387145996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3228912353515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3246612548828125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3246612548828125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([402, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3448600769042969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3448600769042969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3456268310546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3525223731994629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3528618812561035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3528618812561035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.353579044342041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36475324630737305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36527442932128906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36527442932128906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3658561706542969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37946510314941406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([274, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38025903701782227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38025903701782227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3807816505432129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39607906341552734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39679813385009766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39679813385009766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3971872329711914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4111948013305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([187, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.412078857421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.412078857421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41243553161621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42777252197265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([168, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4287247657775879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4287247657775879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4290452003479004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4450669288635254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44589900970458984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44589900970458984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44614505767822266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46016979217529297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([126, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4611368179321289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4611368179321289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4613771438598633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4767580032348633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4775509834289551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4775509834289551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47773218154907227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4905972480773926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4912681579589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4912681579589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4914054870605469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5021171569824219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5028676986694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5028676986694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5030031204223633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5145139694213867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5152711868286133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5152711868286133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5153970718383789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5269784927368164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5275616645812988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5275616645812988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5276532173156738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5367169380187988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5373921394348145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5373921394348145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5374875068664551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5475964546203613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.548133373260498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.548133373260498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5482058525085449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5563960075378418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5567846298217773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5567846298217773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5568342208862305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5627851486206055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5632448196411133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5632448196411133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.563298225402832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5700807571411133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5705657005310059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5705657005310059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5706191062927246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5777754783630371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5782103538513184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5782103538513184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5782561302185059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5847105979919434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5850915908813477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5850915908813477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5851297378540039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5907754898071289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5911159515380859  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5911159515380859  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5911483764648438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5961742401123047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5965561866760254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5965561866760254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.596590518951416  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6021523475646973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6023659706115723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6023659706115723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6023850440979004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6056084632873535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([108, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6081943511962891  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6081943511962891  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6084003448486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6446552276611328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 108, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6277027130126953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6281337738037109  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6285648345947266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6281118392944336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2890, 40])
input nodes number: 6317
output nodes number: 2890
edges number: 20237
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.628180980682373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6281814575195312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.018659591674804688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 10 input nodes size: 17825
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.017366409301757812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.017366409301757812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.025866031646728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.025887489318847656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02005624771118164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020589351654052734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020589351654052734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020589351654052734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([17825, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020589351654052734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([548, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04491901397705078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04491901397705078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.045441627502441406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04970598220825195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([578, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04999589920043945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04999589920043945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.050547122955322266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05881547927856445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([579, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.059368133544921875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.059368133544921875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.059920310974121094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0727548599243164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([528, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0734858512878418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0734858512878418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0739893913269043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08874654769897461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([471, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08961772918701172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08961772918701172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09006690979003906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10623741149902344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([374, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10708284378051758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10708284378051758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10743951797485352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12277650833129883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([335, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12371635437011719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12371635437011719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12403583526611328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14000988006591797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([317, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14120817184448242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14120817184448242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1415104866027832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15874242782592773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([280, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15979290008544922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15979290008544922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 280, 128]), torch.Size([1, 280, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16005992889404297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17714977264404297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 280, 128])
m.shape torch.Size([3048, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19155025482177734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19155025482177734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 3048, 128]), torch.Size([1, 3048, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19484615325927734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4082365036010742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 3048, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38593435287475586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39266538619995117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3993964195251465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3926124572753906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([7058, 256])
first layer input nodes number: 17825
first layer output nodes number: 7058
edges number: 48033
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39953136444091797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4062623977661133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4079451560974121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4079451560974121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([358, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43089723587036133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43089723587036133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4315800666809082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43767690658569336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([348, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4380044937133789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4380044937133789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43866825103759766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45023441314697266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([293, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4507474899291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4507474899291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4513063430786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46454620361328125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([266, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46529579162597656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46529579162597656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4658031463623047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4807281494140625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48143577575683594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48143577575683594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48181724548339844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49555015563964844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49622488021850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49622488021850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49651098251342773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5088133811950684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.509498119354248  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.509498119354248  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.509732723236084  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5214629173278809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5222682952880859  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5222682952880859  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5224971771240234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5355434417724609  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([112, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5363979339599609  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5363979339599609  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5366115570068359  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5502834320068359  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([107, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5512051582336426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5512051582336426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5514092445373535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5658993721008301  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.566622257232666  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.566622257232666  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5667710304260254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5783753395080566  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.579108715057373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.579108715057373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5792422294616699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5905909538269043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5912866592407227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5912866592407227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5914030075073242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.602107048034668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6027755737304688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6027755737304688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6028785705566406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6130752563476562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6137881278991699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6137881278991699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.613889217376709  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6246047019958496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6250619888305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6250619888305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6251249313354492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.632237434387207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6328105926513672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6328105926513672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6328811645507812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6413497924804688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6418509483337402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6418509483337402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6419100761413574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6494193077087402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6498098373413086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6498098373413086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6498537063598633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6557321548461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6561141014099121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6561141014099121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6561541557312012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.661801815032959  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6622262001037598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6622262001037598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6622681617736816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6684784889221191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6690921783447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6690921783447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6691493988037109  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6780185699462891  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.678255558013916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.678255558013916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6782784461975098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6819863319396973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6823673248291016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6823673248291016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6823997497558594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6878795623779297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([247, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6937985420227051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6937985420227051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6942696571350098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7771859169006348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 247, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7576675415039062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7580947875976562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7585220336914062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7580733299255371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2866, 40])
input nodes number: 7058
output nodes number: 2866
edges number: 23391
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7581439018249512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7581443786621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.021617889404296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 11 input nodes size: 26512
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020052433013916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020052433013916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.032694339752197266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03271627426147461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.024195194244384766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02491617202758789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02491617202758789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02491617202758789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([26512, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02491617202758789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([628, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06005239486694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06005239486694336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.060651302337646484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06544256210327148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([666, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06577825546264648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06577825546264648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06641340255737305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07606649398803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([669, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0767059326171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0767059326171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07734394073486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09162044525146484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([669, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09257745742797852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09257745742797852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0932154655456543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11195230484008789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([612, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11309242248535156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11309242248535156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11367607116699219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13511085510253906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([579, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1364755630493164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1364755630493164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13702774047851562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16085052490234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([534, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16235685348510742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16235685348510742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16286611557006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18841981887817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([466, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1899428367614746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1899428367614746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19038724899291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21571874618530273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([391, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21717453002929688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21717453002929688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 391, 128]), torch.Size([1, 391, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21754741668701172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24141216278076172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 391, 128])
m.shape torch.Size([4699, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26363229751586914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26363229751586914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 4699, 128]), torch.Size([1, 4699, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2681136131286621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5862870216369629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 4699, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5546517372131348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5647292137145996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5748066902160645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5646553039550781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([9913, 256])
first layer input nodes number: 26512
first layer output nodes number: 9913
edges number: 71152
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5743827819824219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5844602584838867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5862002372741699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5862002372741699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([387, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6113061904907227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6113061904907227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6120443344116211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6183385848999023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([322, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.618588924407959  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.618588924407959  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6192030906677246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6303129196166992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([279, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6308107376098633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6308107376098633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.631342887878418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6475248336791992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([221, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6481084823608398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6481084823608398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6485300064086914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6607542037963867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6614904403686523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6614904403686523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6618661880493164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6753931045532227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6761221885681152  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6761221885681152  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6764254570007324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6894659996032715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6903533935546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6903533935546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6906375885009766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7048473358154297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([132, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7057204246520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7057204246520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7059721946716309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7203230857849121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7210450172424316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7210450172424316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7212319374084473  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7331948280334473  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7339954376220703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7339954376220703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7341728210449219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7467670440673828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7473974227905273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7473974227905273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7475271224975586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7576436996459961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([83, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7585363388061523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7585363388061523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7586946487426758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.772150993347168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7727341651916504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7727341651916504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7728352546691895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7821354866027832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7828655242919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7828655242919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7829761505126953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7939281463623047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7944931983947754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7944931983947754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7945752143859863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8032689094543457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8038740158081055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8038740158081055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8039541244506836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8130064010620117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.813685417175293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.813685417175293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8137693405151367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8238401412963867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8242654800415039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8242654800415039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8243169784545898  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8308572769165039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8313980102539062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8313980102539062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8314571380615234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8393802642822266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8399467468261719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8399467468261719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8400058746337891  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8483428955078125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8488583564758301  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8488583564758301  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.848909854888916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8565316200256348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.856971263885498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.856971263885498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8570132255554199  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8635172843933105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8638944625854492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8638944625854492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8639287948608398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8694906234741211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8700270652770996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8700270652770996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8700728416442871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8778090476989746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([318, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8854274749755859  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8854274749755859  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8860340118408203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9947223663330078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 318, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9727215766906738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9731578826904297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9735941886901855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9731359481811523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2926, 40])
input nodes number: 9913
output nodes number: 2926
edges number: 25598
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.973240852355957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9732413291931152  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.026289939880371094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 12 input nodes size: 10408
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.024204254150390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.024204254150390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02916717529296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.029189109802246094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0165252685546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0168609619140625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0168609619140625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0168609619140625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([10408, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0168609619140625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([777, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0313420295715332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0313420295715332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03208303451538086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03894662857055664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([818, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.039356231689453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.039356231689453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04013633728027344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05243110656738281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([702, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05304527282714844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05304527282714844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.053714752197265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0691213607788086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([543, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06982231140136719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06982231140136719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07034015655517578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08623886108398438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([518, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08721494674682617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08721494674682617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08770895004272461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1056675910949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([399, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10656213760375977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10656213760375977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10694265365600586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12330484390258789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([309, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1241459846496582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1241459846496582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12444067001342773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1391749382019043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([254, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13999652862548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13999652862548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14023876190185547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15404605865478516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 254, 128])
m.shape torch.Size([214, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15484333038330078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15484333038330078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15504741668701172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16810894012451172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 214, 128])
m.shape torch.Size([1089, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17319965362548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17319965362548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1742382049560547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2496500015258789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2380208969116211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24338340759277344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24874591827392578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24334144592285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([5623, 256])
first layer input nodes number: 10408
first layer output nodes number: 5623
edges number: 28686
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2488255500793457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.25418806076049805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.25563716888427734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.25563716888427734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([513, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2718820571899414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2718820571899414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2728605270385742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.28153085708618164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([465, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2819356918334961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2819356918334961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2828226089477539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.29622840881347656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([385, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.29689598083496094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.29689598083496094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.29763031005859375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3137855529785156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([263, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.31458425521850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.31458425521850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.31508588790893555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3298506736755371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([252, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3308110237121582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3308110237121582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.33129167556762695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34859514236450195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([188, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.349515438079834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.349515438079834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34987401962280273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.365293025970459  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3660087585449219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3660087585449219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36626243591308594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37894630432128906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37968873977661133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37968873977661133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37990427017211914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39218950271606445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3928952217102051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3928952217102051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39307451248168945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40454912185668945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4052767753601074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4052767753601074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4054388999938965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4169497489929199  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41743993759155273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41743993759155273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4175429344177246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42557668685913086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4261598587036133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4261598587036133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42626476287841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4351816177368164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43567895889282227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43567895889282227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.435762882232666  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.443483829498291  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44399356842041016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44399356842041016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44407176971435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4518136978149414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45229387283325195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45229387283325195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4523625373840332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4596409797668457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4599757194519043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4599757194519043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4600214958190918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4651942253112793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4655308723449707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4655308723449707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4655728340148926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4706082344055176  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4708991050720215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4708991050720215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4709334373474121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4752936363220215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47545909881591797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47545909881591797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4754781723022461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47803401947021484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4782552719116211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4782552719116211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47827816009521484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4815053939819336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48175668716430664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48175668716430664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4817814826965332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48545122146606445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48558712005615234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48558712005615234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48560047149658203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4876699447631836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4877963066101074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4877963066101074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4878077507019043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48966169357299805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48986387252807617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48986387252807617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4898810386657715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4927821159362793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([58, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4941673278808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4941673278808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4942779541015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5137481689453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 58, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5008831024169922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5013155937194824  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5017480850219727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5012936592102051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2900, 40])
input nodes number: 5623
output nodes number: 2900
edges number: 16252
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5013537406921387  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5013542175292969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01755046844482422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 13 input nodes size: 9886
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.016521453857421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.016521453857421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02123546600341797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02125692367553711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01627206802368164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.016594409942626953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.016594409942626953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.016594409942626953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([9886, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.016594409942626953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([735, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.030377864837646484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.030377864837646484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 735, 128]), torch.Size([1, 735, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.031078815460205078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03732633590698242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 735, 128])
m.shape torch.Size([782, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03772163391113281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03772163391113281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0384674072265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05040311813354492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([653, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05096435546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05096435546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05158710479736328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06530475616455078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([581, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0661015510559082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0661015510559082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06665563583374023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08308649063110352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([451, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08388471603393555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08388471603393555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08431482315063477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09979867935180664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([357, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10060501098632812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10060501098632812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10094547271728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1155853271484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([319, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11647987365722656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11647987365722656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11678409576416016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13199520111083984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([256, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13281965255737305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13281965255737305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13306379318237305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14697980880737305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([211, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14776325225830078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14776325225830078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1479644775390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1608428955078125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([1015, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16558218002319336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16558218002319336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 1015, 128]), torch.Size([1, 1015, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1665501594543457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23562002182006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 1015, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2245631217956543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2296748161315918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2347865104675293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22963476181030273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([5360, 256])
first layer input nodes number: 9886
first layer output nodes number: 5360
edges number: 27309
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2348623275756836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2399740219116211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24125194549560547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24125194549560547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([519, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2570152282714844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2570152282714844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.25800514221191406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26729822158813477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([476, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2677183151245117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2677183151245117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26862621307373047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2829732894897461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([348, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.28360795974731445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.28360795974731445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2842717170715332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2990422248840332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([288, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.29985857009887695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.29985857009887695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.30040788650512695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.31651735305786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([231, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3173532485961914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3173532485961914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3177938461303711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.33365535736083984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([174, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3344388008117676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3344388008117676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.33477067947387695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3490414619445801  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3499183654785156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3499183654785156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35021400451660156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36499595642089844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36582469940185547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36582469940185547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36606693267822266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37987422943115234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38054895401000977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38054895401000977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3807244300842285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3919548988342285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39256906509399414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39256906509399414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39270830154418945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40259408950805664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40315914154052734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40315914154052734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4032735824584961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4121999740600586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4126734733581543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4126734733581543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41276121139526367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42021894454956055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4207000732421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4207000732421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4207801818847656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4281501770019531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42871570587158203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42871570587158203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4288015365600586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4372987747192383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4377608299255371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4377608299255371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43782758712768555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4449038505554199  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4452552795410156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4452552795410156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44530296325683594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45069122314453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4509453773498535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4509453773498535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45097780227661133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45486879348754883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4552159309387207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4552159309387207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45525598526000977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4603428840637207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4604511260986328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4604511260986328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4604644775390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4622535705566406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46243953704833984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46243953704833984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46245861053466797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4651479721069336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4652395248413086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4652395248413086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46524906158447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4666604995727539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4668464660644531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4668464660644531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46686363220214844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4695243835449219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4696488380432129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4696488380432129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46966028213500977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4715142250061035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4716930389404297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4716930389404297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4717082977294922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4742870330810547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([51, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47550487518310547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47550487518310547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4756021499633789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4927225112915039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 51, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4803190231323242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4807467460632324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4811744689941406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4807252883911133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2870, 40])
input nodes number: 5360
output nodes number: 2870
edges number: 15746
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48078203201293945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48078250885009766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.017256736755371094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 14 input nodes size: 16346
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01626729965209961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01626729965209961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02406167984008789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02408313751220703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.019347667694091797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01979970932006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01979970932006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01979970932006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([16346, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.01979970932006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([819, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04076051712036133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04076051712036133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04154157638549805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04859018325805664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([871, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.049030303955078125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.049030303955078125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04986095428466797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06250953674316406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([688, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06359148025512695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06359148025512695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 688, 128]), torch.Size([1, 688, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06424760818481445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07868242263793945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 688, 128])
m.shape torch.Size([558, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0795750617980957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0795750617980957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08010721206665039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09636735916137695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([480, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09724569320678711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09724569320678711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09770345687866211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11418294906616211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([427, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11517572402954102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11517572402954102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11558294296264648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13309335708618164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([378, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13415145874023438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13415145874023438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13451194763183594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15253639221191406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([294, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15347766876220703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15347766876220703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 294, 128]), torch.Size([1, 294, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15375804901123047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1697397232055664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 294, 128])
m.shape torch.Size([271, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1707625389099121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1707625389099121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1710209846496582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1875615119934082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 271, 128])
m.shape torch.Size([2266, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19823741912841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19823741912841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2266, 128]), torch.Size([1, 2266, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20039844512939453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35539674758911133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2266, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3375539779663086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34427928924560547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35100460052490234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3442263603210449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([7052, 256])
first layer input nodes number: 16346
first layer output nodes number: 7052
edges number: 41916
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35112857818603516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35785388946533203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35997581481933594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35997581481933594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([540, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3785133361816406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3785133361816406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3795433044433594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3877830505371094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([470, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3881716728210449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3881716728210449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3890681266784668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4033846855163574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([312, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4038362503051758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4038362503051758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4044313430786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4192771911621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4199409484863281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4199409484863281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42041778564453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4342460632324219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4349498748779297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4349498748779297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43532371520996094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44878196716308594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44961023330688477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44961023330688477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44994592666625977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46438074111938477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46509456634521484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46509456634521484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4653444290161133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47783756256103516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([92, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4784202575683594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4784202575683594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4785957336425781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4885978698730469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4893150329589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4893150329589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48949241638183594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5008449554443359  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5015063285827637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5015063285827637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.501655101776123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5122179985046387  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5128417015075684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5128417015075684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.512967586517334  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5227866172790527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5232429504394531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5232429504394531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5233287811279297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5306243896484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([31, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5309691429138184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5309691429138184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5310282707214355  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5364680290222168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5368690490722656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5368690490722656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5369300842285156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5429725646972656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5434756278991699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5434756278991699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.543546199798584  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5510268211364746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5512685775756836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5512685775756836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5513029098510742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5551824569702148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5556230545043945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5556230545043945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5556764602661133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5620851516723633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.562525749206543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.562525749206543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5625772476196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.569117546081543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5694208145141602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5694208145141602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5694551467895508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5740556716918945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5742502212524414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5742502212524414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5742712020874023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5772294998168945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5775623321533203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5775623321533203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5775947570800781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5823936462402344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5827584266662598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5827584266662598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5827927589416504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5881142616271973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5884733200073242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5884733200073242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.588505744934082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5937585830688477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5940656661987305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5940656661987305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5940923690795898  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5986051559448242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([157, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6023645401000977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6023645401000977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6026639938354492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6553678512573242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 157, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6401338577270508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6405625343322754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6409912109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6405410766601562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2874, 40])
input nodes number: 7052
output nodes number: 2874
edges number: 18611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6406164169311523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6406168937683105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020705699920654297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 15 input nodes size: 17849
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.019348621368408203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.019348621368408203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02785968780517578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.027881622314453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020065784454345703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02061319351196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02061319351196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02061319351196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([17849, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02061319351196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([572, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04584169387817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04584169387817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0463871955871582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05077028274536133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([720, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05118417739868164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05118417739868164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05187082290649414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06217050552368164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 720, 128])
m.shape torch.Size([665, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06277847290039062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06277847290039062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06341266632080078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0783071517944336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([638, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07920694351196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07920694351196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07981538772583008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0986332893371582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([548, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09963560104370117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09963560104370117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1001582145690918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11922216415405273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([431, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1201939582824707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1201939582824707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1206049919128418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13827943801879883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([410, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13944244384765625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13944244384765625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1398334503173828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15938377380371094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([435, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16084766387939453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16084766387939453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16126251220703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18490886688232422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([355, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18622493743896484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18622493743896484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18656349182128906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20823097229003906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([2949, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2221236228942871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2221236228942871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2949, 128]), torch.Size([1, 2949, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22493600845336914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4250221252441406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2949, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40286684036254883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4102320671081543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41759729385375977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4101743698120117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([7723, 256])
first layer input nodes number: 17849
first layer output nodes number: 7723
edges number: 50920
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41773223876953125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4250974655151367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4269390106201172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4269390106201172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([395, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4491004943847656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4491004943847656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44985389709472656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45621538162231445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4565596580505371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4565596580505371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4572749137878418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.468869686126709  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([299, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4693746566772461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4693746566772461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46994495391845703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48348283767700195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48445653915405273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48445653915405273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4849696159362793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5003671646118164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([215, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5011444091796875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5011444091796875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5015544891357422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5163173675537109  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.516937255859375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.516937255859375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5172100067138672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5289382934570312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5296096801757812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5296096801757812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5298385620117188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5412826538085938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([151, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5423293113708496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5423293113708496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5426173210144043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5590338706970215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5597119331359863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5597119331359863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5598931312561035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5714898109436035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5722451210021973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5722451210021973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5724129676818848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5843300819396973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5850181579589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5850181579589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5851573944091797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5960178375244141  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5967903137207031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5967903137207031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5969295501708984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6087646484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6093826293945312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6093826293945312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6094875335693359  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6191387176513672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.619880199432373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.619880199432373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.619992733001709  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6311335563659668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6317119598388672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6317119598388672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6317958831787109  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6406917572021484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6412649154663086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6412649154663086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6413412094116211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6499624252319336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6504635810852051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6504635810852051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6505265235900879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6580796241760254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6586017608642578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6586017608642578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6586627960205078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6664142608642578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6669502258300781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6669502258300781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6670093536376953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6749324798583984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.675325870513916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.675325870513916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6753678321838379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6812844276428223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6818289756774902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6818289756774902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.681882381439209  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.689786434173584  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6902675628662109  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6902675628662109  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6903133392333984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6974086761474609  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6978058815002441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6978058815002441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6978421211242676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7037129402160645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7040181159973145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7040181159973145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7040448188781738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7085576057434082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([202, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7133979797363281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7133979797363281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7137832641601562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7815933227539062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 202, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7626066207885742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7630386352539062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7634706497192383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7630167007446289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2899, 40])
input nodes number: 7723
output nodes number: 2899
edges number: 22459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7630996704101562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7631001472473145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.021671295166015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 16 input nodes size: 33214
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020069122314453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020069122314453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03590679168701172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.035927772521972656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.027394771575927734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.028264522552490234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.028264522552490234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.028264522552490234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([33214, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.028264522552490234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([714, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07469415664672852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07469415664672852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 714, 128]), torch.Size([1, 714, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07537508010864258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08120107650756836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 714, 128])
m.shape torch.Size([724, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08155107498168945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08155107498168945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08224153518676758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09273719787597656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([682, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0933675765991211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0933675765991211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 682, 128]), torch.Size([1, 682, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09401798248291016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10832691192626953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 682, 128])
m.shape torch.Size([631, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10923385620117188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10923385620117188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 631, 128]), torch.Size([1, 631, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10983562469482422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12797927856445312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 631, 128])
m.shape torch.Size([611, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1291351318359375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1291351318359375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12971782684326172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15150785446166992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([561, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15282154083251953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15282154083251953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15335655212402344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17697715759277344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([521, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17844867706298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17844867706298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17894554138183594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20438241958618164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([507, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2060680389404297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2060680389404297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20655155181884766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23411178588867188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([441, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2357625961303711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2357625961303711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23618316650390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26309967041015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([6938, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2959723472595215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2959723472595215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 6938, 128]), torch.Size([1, 6938, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.30258893966674805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.772367000579834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 6938, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7301998138427734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7419586181640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7537174224853516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7418665885925293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([12330, 256])
first layer input nodes number: 33214
first layer output nodes number: 12330
edges number: 94205
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7539668083190918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7657256126403809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7687153816223145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7687153816223145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([445, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7908544540405273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7908544540405273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7917032241821289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7997884750366211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([379, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8000926971435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8000926971435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8008155822753906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8119535446166992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([287, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8124198913574219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8124198913574219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8129673004150391  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8276515007019043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([194, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8281240463256836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8281240463256836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8284940719604492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8392248153686523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8399577140808105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8399577140808105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8403220176696777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8534369468688965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8542237281799316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8542237281799316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8545441627502441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8683228492736816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8691248893737793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8691248893737793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8693976402282715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8830351829528809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8836984634399414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8836984634399414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8838968276977539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8952035903930664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8958139419555664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8958139419555664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.895970344543457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.905980110168457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9066324234008789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9066324234008789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9067773818969727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9170694351196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.917811393737793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.917811393737793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9179582595825195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9294137954711914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9299402236938477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9299402236938477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9300394058227539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9384698867797852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([33, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9388327598571777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9388327598571777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9388957023620605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9446864128112793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9452066421508789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9452066421508789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9452848434448242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9530267715454102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9534492492675781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9534492492675781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9535102844238281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9599800109863281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9605493545532227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9605493545532227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9606237411499023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.969029426574707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9694991111755371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9694991111755371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9695582389831543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9766535758972168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9771261215209961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9771261215209961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9771814346313477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9842061996459961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9846720695495605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9846720695495605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9847235679626465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9916243553161621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9920988082885742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9920988082885742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9921483993530273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.999140739440918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9996004104614258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9996004104614258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9996461868286133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0064210891723633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0067367553710938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0067367553710938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0067672729492188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0114974975585938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0117034912109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0117034912109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0117225646972656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0148124694824219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0152873992919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0152873992919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0153274536132812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0220966339111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([283, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.028876781463623  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.028876781463623  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.029416561126709  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1366181373596191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 283, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.117537021636963  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1179561614990234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.118375301361084  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1179351806640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2810, 40])
input nodes number: 12330
output nodes number: 2810
edges number: 22459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1180353164672852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1180357933044434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02984476089477539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 17 input nodes size: 36561
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02738189697265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02738189697265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0448155403137207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04483652114868164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02897787094116211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.029818058013916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.029818058013916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.029818058013916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([36561, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.029818058013916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([757, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07577133178710938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07577133178710938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 757, 128]), torch.Size([1, 757, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0764932632446289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08292245864868164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 757, 128])
m.shape torch.Size([842, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08336448669433594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08336448669433594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08416748046875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09715890884399414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([697, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09775447845458984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09775447845458984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 697, 128]), torch.Size([1, 697, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.098419189453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11390542984008789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 697, 128])
m.shape torch.Size([663, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.114837646484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.114837646484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11546993255615234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13388442993164062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([629, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13517045974731445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13517045974731445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13577032089233398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15828657150268555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([555, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1595745086669922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1595745086669922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16010379791259766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18318653106689453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([525, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18467426300048828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18467426300048828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18517494201660156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21039247512817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([530, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21216392517089844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21216392517089844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21266937255859375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2422618865966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([429, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2438502311706543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2438502311706543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24425935745239258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2704434394836426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([6774, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3025398254394531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3025398254394531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 6774, 128]), torch.Size([1, 6774, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.30930137634277344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7696323394775391  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 6774, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7288932800292969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7407197952270508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7525463104248047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7406272888183594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([12401, 256])
first layer input nodes number: 36561
first layer output nodes number: 12401
edges number: 93175
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7528209686279297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7646474838256836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7676043510437012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7676043510437012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([490, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7870063781738281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7870063781738281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7879409790039062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7962965965270996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([422, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7966408729553223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7966408729553223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7974457740783691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8098659515380859  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8103055953979492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8103055953979492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8108625411987305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8232994079589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8239517211914062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8239517211914062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8244132995605469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.837799072265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8385438919067383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8385438919067383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8389310836791992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.852869987487793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8535590171813965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8535590171813965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8538508415222168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8663992881774902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([110, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8669939041137695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8669939041137695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8672037124633789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8776941299438477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8784584999084473  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8784584999084473  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8786740303039551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8909592628479004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8915352821350098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8915352821350098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.891685962677002  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.901329517364502  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9019079208374023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9019079208374023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9020376205444336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9112462997436523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9117841720581055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9117841720581055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9118928909301758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9203729629516602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9208264350891113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9208264350891113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9209103584289551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9280438423156738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.928502082824707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.928502082824707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9285783767700195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9355974197387695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9358959197998047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9358959197998047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.935943603515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9406642913818359  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9409866333007812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9409866333007812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9410324096679688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9458847045898438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9462466239929199  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9462466239929199  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9462943077087402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9516825675964355  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9520511627197266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9520511627197266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9520969390869141  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9575901031494141  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9578442573547363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9578442573547363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9578747749328613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9617505073547363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9621372222900391  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9621372222900391  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9621791839599609  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9678020477294922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9681081771850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9681081771850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9681406021118164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.972712516784668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9731001853942871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9731001853942871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9731383323669434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9787840843200684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9790611267089844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9790611267089844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9790878295898438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9832267761230469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9834127426147461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9834127426147461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9834299087524414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.986210823059082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.986386775970459  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.986386775970459  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9864020347595215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.988980770111084  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([241, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9956293106079102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9956293106079102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.996088981628418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.076991081237793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 241, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.06129789352417  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.061708927154541  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.062119960784912  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.06168794631958  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2758, 40])
input nodes number: 12401
output nodes number: 2758
edges number: 19567
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.061793327331543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0617938041687012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03137779235839844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 18 input nodes size: 33007
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.028969764709472656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.028969764709472656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0447087287902832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04472970962524414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02727508544921875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02791881561279297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02791881561279297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02791881561279297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([33007, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02791881561279297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([936, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06226348876953125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06226348876953125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0631561279296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07035112380981445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([977, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07083654403686523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07083654403686523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07176828384399414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08638429641723633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([851, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08713579177856445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08713579177856445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08794736862182617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10615873336791992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([739, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1071624755859375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1071624755859375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10786724090576172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12832069396972656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([673, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1298203468322754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1298203468322754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 673, 128]), torch.Size([1, 673, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1304621696472168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15384435653686523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 673, 128])
m.shape torch.Size([510, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1549825668334961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1549825668334961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15546894073486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17638301849365234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([478, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1777353286743164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1777353286743164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1781911849975586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20098400115966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([437, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.202423095703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.202423095703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20283985137939453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2265949249267578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 437, 128])
m.shape torch.Size([374, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22799158096313477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22799158096313477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2283482551574707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2511754035949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([4415, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.27248144149780273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.27248144149780273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 4415, 128]), torch.Size([1, 4415, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.27669191360473633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5849704742431641  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 4415, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5546317100524902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5645403861999512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5744490623474121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5644626617431641  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([10390, 256])
first layer input nodes number: 33007
first layer output nodes number: 10390
edges number: 69182
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5746970176696777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5846056938171387  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5870828628540039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5870828628540039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([566, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6041336059570312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6041336059570312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6052131652832031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6141996383666992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([467, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6145577430725098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6145577430725098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6154484748840332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6288094520568848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([301, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6292324066162109  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6292324066162109  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6298065185546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.643376350402832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6442170143127441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6442170143127441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6447300910949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6598615646362305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([229, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.66070556640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.66070556640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6611423492431641  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6768665313720703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6775016784667969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6775016784667969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6777839660644531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6899223327636719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6905484199523926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6905484199523926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6907658576965332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7016377449035645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([100, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7022981643676758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7022981643676758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.702488899230957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7133607864379883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([65, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7138280868530273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7138280868530273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7139520645141602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7218866348266602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7224397659301758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7224397659301758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7225618362426758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7312288284301758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7317600250244141  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7317600250244141  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7318668365478516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7401981353759766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7407679557800293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7407679557800293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7408709526062012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7496256828308105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([31, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7499618530273438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7499618530273438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7500209808349609  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7554607391357422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.755861759185791  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.755861759185791  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.755922794342041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.761965274810791  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7623677253723145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7623677253723145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7624249458312988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7684903144836426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7688155174255371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7688155174255371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7688593864440918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7738165855407715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.774284839630127  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.774284839630127  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7743420600891113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7812085151672363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.781404972076416  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.781404972076416  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7814297676086426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.784578800201416  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7848773002624512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7848773002624512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.784909725189209  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7892546653747559  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.789431095123291  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.789431095123291  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7894501686096191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7921395301818848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7923116683959961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7923116683959961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7923288345336914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7948694229125977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7950515747070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7950515747070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7950687408447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7977294921875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7979640960693359  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7979640960693359  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7979850769042969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8013839721679688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8015580177307129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8015580177307129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8015732765197754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8041520118713379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([147, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8076767921447754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8076767921447754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8079571723937988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8573040962219238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 147, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.843510627746582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.843928337097168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8443460464477539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.843907356262207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2803, 40])
input nodes number: 10390
output nodes number: 2803
edges number: 17042
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8440127372741699  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8440132141113281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02920818328857422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 19 input nodes size: 38040
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.027281761169433594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.027281761169433594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04542064666748047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.045441627502441406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.029681682586669922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.030837535858154297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.030837535858154297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.030837535858154297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([38040, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.030837535858154297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([614, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09223747253417969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09223747253417969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09282302856445312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09772872924804688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([660, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09806537628173828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09806537628173828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0986948013305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10881757736206055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([597, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10935688018798828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10935688018798828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10992622375488281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1224517822265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([535, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12327718734741211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12327718734741211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12378740310668945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13872289657592773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([540, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1397552490234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1397552490234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14027023315429688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1589794158935547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([485, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1601095199584961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1601095199584961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16057205200195312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18046092987060547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([475, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18181514739990234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18181514739990234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1822681427001953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20491790771484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([461, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2064499855041504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2064499855041504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20688962936401367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2319493293762207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([475, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23376798629760742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23376798629760742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2342209815979004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2632126808166504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([10224, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3117380142211914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3117380142211914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 10224, 128]), torch.Size([1, 10224, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3214883804321289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0144357681274414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 10224, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.956850528717041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9712185859680176  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9855866432189941  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9711060523986816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([15066, 256])
first layer input nodes number: 38040
first layer output nodes number: 15066
edges number: 125003
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9858722686767578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0002403259277344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0041770935058594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0041770935058594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([389, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.034196376800537  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.034196376800537  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0349383354187012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0422749519348145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([316, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0425114631652832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0425114631652832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.043114185333252  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0525097846984863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([251, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0529322624206543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0529322624206543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0534110069274902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0639433860778809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([177, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.064384937286377  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.064384937286377  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0647225379943848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0745129585266113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([137, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.075002670288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.075002670288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0752639770507812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0846710205078125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([107, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.085157871246338  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.085157871246338  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0853619575500488  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0941376686096191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([97, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0946884155273438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0946884155273438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0948734283447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1041240692138672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1046466827392578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1046466827392578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1047992706298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1134967803955078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1141128540039062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1141128540039062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1142654418945312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1240310668945312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1245603561401367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1245603561401367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.124680519104004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1332120895385742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.133744239807129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.133744239807129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1338510513305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1421823501586914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1426711082458496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1426711082458496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1427607536315918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1503806114196777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1508231163024902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1508231163024902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.15089750289917  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1577410697937012  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1582694053649902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1582694053649902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1583495140075684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1662802696228027  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.166773796081543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.166773796081543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.166844367980957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1743249893188477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1746745109558105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1746745109558105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1747221946716309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1801104545593262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.180528163909912  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.180528163909912  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.180579662322998  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1867594718933105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1873221397399902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1873221397399902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1873869895935059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1956229209899902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1962299346923828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1962299346923828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1962966918945312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2052421569824219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2057280540466309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2057280540466309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2057795524597168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.213040828704834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2134594917297363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2134594917297363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2135014533996582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2197117805480957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.22013521194458  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.22013521194458  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2201752662658691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2263836860656738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2267837524414062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2267837524414062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2268199920654297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2326908111572266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2331113815307617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2331113815307617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2331476211547852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.239272117614746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([650, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2548723220825195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2548723220825195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 650, 256]), torch.Size([1, 650, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2561120986938477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4750661849975586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 650, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4477453231811523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.44816255569458  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4485797882080078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4481415748596191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2797, 40])
input nodes number: 15066
output nodes number: 2797
edges number: 30051
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4482746124267578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.448275089263916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.032869815826416016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 20 input nodes size: 15118
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02968120574951172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02968120574951172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03689002990722656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.036911964416503906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.018752098083496094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.019197463989257812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.019197463989257812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.019197463989257812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([15118, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.019197463989257812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([720, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03963613510131836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03963613510131836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04032278060913086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.046205997467041016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 720, 128])
m.shape torch.Size([739, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.046567440032958984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.046567440032958984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0472722053527832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.057843685150146484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([727, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05853128433227539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05853128433227539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 727, 128]), torch.Size([1, 727, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.059224605560302734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07593822479248047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 727, 128])
m.shape torch.Size([623, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07677984237670898  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07677984237670898  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07737398147583008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0946040153503418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([544, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09560394287109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09560394287109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09612274169921875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1149139404296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([448, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.115936279296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.115936279296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.116363525390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.134735107421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([388, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1358165740966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1358165740966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1361865997314453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15468788146972656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([322, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.155731201171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.155731201171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1560382843017578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17354202270507812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([267, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17453432083129883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17453432083129883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1747889518737793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1910853385925293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 267, 128])
m.shape torch.Size([2042, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20138788223266602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20138788223266602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2042, 128]), torch.Size([1, 2042, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20333528518676758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34194421768188477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2042, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3245563507080078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.33106040954589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.33756446838378906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3310093879699707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([6820, 256])
first layer input nodes number: 15118
first layer output nodes number: 6820
edges number: 40394
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.337679386138916  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34420251846313477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3458094596862793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3458094596862793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([490, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3649768829345703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3649768829345703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36591148376464844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37338829040527344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([384, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3736591339111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3736591339111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3743915557861328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38553905487060547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([337, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38614463806152344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38614463806152344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38678741455078125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4010791778564453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40179014205932617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40179014205932617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40229368209838867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41764116287231445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([233, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41850948333740234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41850948333740234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41895389556884766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4349527359008789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43565940856933594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43565940856933594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43596649169921875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4491710662841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45000696182250977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45000696182250977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4502873420715332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4643063545227051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46503543853759766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46503543853759766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46525096893310547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4775362014770508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([111, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47838878631591797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47838878631591797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47860050201416016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49215030670166016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4927849769592285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4927849769592285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4929318428039551  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.503359317779541  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5038571357727051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5038571357727051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.503960132598877  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5119938850402832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5125885009765625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5125885009765625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5126953125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5217742919921875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5225081443786621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5225081443786621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5226283073425293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5336833000183105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5343770980834961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5343770980834961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5344839096069336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5450582504272461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5454950332641602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5454950332641602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5455598831176758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.552433967590332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5528321266174316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5528321266174316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5528855323791504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5589203834533691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5593838691711426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5593838691711426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.559441089630127  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.566307544708252  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5667810440063477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5667810440063477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5668363571166992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5738611221313477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5742902755737305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5742902755737305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5743379592895508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5807275772094727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5811076164245605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5811076164245605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5811476707458496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5867953300476074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5869569778442383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5869569778442383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5869741439819336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5895147323608398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5898447036743164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5898447036743164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5898752212524414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5946054458618164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5948333740234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5948333740234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5948543548583984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5982532501220703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5985198020935059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5985198020935059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5985426902770996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6024107933044434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([133, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6055951118469238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6055951118469238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6058487892150879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6504960060119629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 133, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6346316337585449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6350631713867188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6354947090148926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6350412368774414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2894, 40])
input nodes number: 6820
output nodes number: 2894
edges number: 19319
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6351284980773926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6351289749145508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02010059356689453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 21 input nodes size: 19369
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.018766403198242188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.018766403198242188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.028002262115478516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.028023719787597656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02079296112060547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02129840850830078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02129840850830078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02129840850830078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([19369, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02129840850830078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([773, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0458226203918457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0458226203918457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.046559810638427734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05289602279663086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([870, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05335712432861328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05335712432861328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05418682098388672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06692028045654297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([820, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06767845153808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06767845153808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06846046447753906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08566474914550781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([678, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08656692504882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08656692504882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08721351623535156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10652542114257812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([699, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10786867141723633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10786867141723633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 699, 128]), torch.Size([1, 699, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1085352897644043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1327667236328125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 699, 128])
m.shape torch.Size([548, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1340012550354004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1340012550354004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13452386856079102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15727472305297852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([455, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15853214263916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15853214263916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.158966064453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1806621551513672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([425, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1820664405822754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1820664405822754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18247175216674805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20557451248168945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([337, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20712995529174805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20712995529174805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20745134353637695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22802019119262695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([2515, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2398519515991211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2398519515991211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2515, 128]), torch.Size([1, 2515, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2422504425048828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4156332015991211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2515, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3946690559387207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40241289138793945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4101567268371582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40235233306884766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([8120, 256])
first layer input nodes number: 19369
first layer output nodes number: 8120
edges number: 49236
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41030311584472656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4180469512939453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4202404022216797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4202404022216797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([475, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43862485885620117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43862485885620117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4395308494567871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.447084903717041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([417, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4474339485168457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4474339485168457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4482293128967285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46102190017700195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([332, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4615817070007324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4615817070007324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.46221494674682617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47650671005249023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47711706161499023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47711706161499023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47757673263549805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4909071922302246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([235, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4918069839477539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4918069839477539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49225521087646484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5083913803100586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5091838836669922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5091838836669922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5095176696777344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5238704681396484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5246591567993164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5246591567993164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5249300003051758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5384721755981445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5392904281616211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5392904281616211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5395269393920898  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5530080795288086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5537552833557129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5537552833557129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5539460182189941  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5661530494689941  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.56671142578125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.56671142578125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5668411254882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5760498046875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5766935348510742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5766935348510742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5768213272094727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5867891311645508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5875787734985352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5875787734985352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5877199172973633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5997171401977539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6002964973449707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6002964973449707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.600395679473877  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.609520435333252  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6099553108215332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6099553108215332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6100239753723145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6168217658996582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6172056198120117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6172056198120117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6172609329223633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6231241226196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6235270500183105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6235270500183105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6235804557800293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.629615306854248  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6298828125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6298828125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6299171447753906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6340370178222656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6344351768493652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6344351768493652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6344809532165527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6402945518493652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6406736373901367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6406736373901367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6407155990600586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6463384628295898  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6466636657714844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6466636657714844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.646697998046875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6515388488769531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6517844200134277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6517844200134277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6518092155456543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6554789543151855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6556782722473145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6556782722473145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6556973457336426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.658653736114502  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.658909797668457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.658909797668457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6589326858520508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6626405715942383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6629524230957031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6629524230957031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6629791259765625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6674919128417969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([126, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.670506477355957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.670506477355957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6707468032836914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7130441665649414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 126, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6979084014892578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.698333740234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6987590789794922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6983122825622559  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2852, 40])
input nodes number: 8120
output nodes number: 2852
edges number: 18519
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6983880996704102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6983885765075684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.022294998168945312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 22 input nodes size: 22619
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020786762237548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020786762237548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03250551223754883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.032526493072509766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.023269176483154297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02376699447631836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02376699447631836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02376699447631836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([22619, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02376699447631836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([769, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04873800277709961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04873800277709961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.049471378326416016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.055338382720947266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([832, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05576515197753906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05576515197753906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05655860900878906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06943130493164062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([721, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07049942016601562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07049942016601562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.07118701934814453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0866079330444336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([624, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08745431900024414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08745431900024414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08804941177368164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1057591438293457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([597, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10688495635986328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10688495635986328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10745429992675781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12795066833496094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([470, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12901067733764648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12901067733764648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12945890426635742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14873266220092773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([425, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14992713928222656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14992713928222656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15033245086669922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17059803009033203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([373, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17181825637817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17181825637817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17217397689819336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19245004653930664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([320, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19364547729492188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19364547729492188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19395065307617188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21348190307617188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([2844, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22689056396484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22689056396484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2844, 128]), torch.Size([1, 2844, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22960281372070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4276275634765625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2844, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4059929847717285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41411590576171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4217214584350586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.41353893280029297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([7975, 256])
first layer input nodes number: 22619
first layer output nodes number: 7975
edges number: 50176
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4213747978210449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42949771881103516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43088197708129883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43088197708129883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([535, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4474196434020996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4474196434020996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4484400749206543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45684194564819336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([454, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45720481872558594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45720481872558594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4580707550048828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4720034599304199  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([358, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4732952117919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4732952117919922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.47397804260253906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4895625114440918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49016714096069336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49016714096069336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49063634872436523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5042433738708496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([224, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5050854682922363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5050854682922363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5055127143859863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5208935737609863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5215797424316406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5215797424316406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5218772888183594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5346717834472656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5352702140808105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5352702140808105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5354819297790527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5460677146911621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5467462539672852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5467462539672852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.546940803527832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5580301284790039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5587377548217773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5587377548217773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5589151382446289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5702676773071289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5709867477416992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5709867477416992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5711469650268555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5825223922729492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([50, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5829710960388184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5829710960388184  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.583066463470459  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5905051231384277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5910344123840332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5910344123840332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5911297798156738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.599236011505127  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5997381210327148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5997381210327148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5998220443725586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6075429916381836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6078915596008301  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6078915596008301  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6079468727111816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6134228706359863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6139721870422363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6139721870422363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6140484809875488  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6221356391906738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6226358413696289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6226358413696289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6227025985717773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6302461624145508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6305561065673828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6305561065673828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6305961608886719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6354026794433594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6357636451721191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6357636451721191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.635805606842041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6411347389221191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.641387939453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.641387939453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6414165496826172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6452503204345703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.645505428314209  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.645505428314209  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6455321311950684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6492972373962402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6495466232299805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6495466232299805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.649571418762207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6532411575317383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6533346176147461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6533346176147461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6533441543579102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6548223495483398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6550168991088867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6550168991088867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.655034065246582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6578149795532227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6579909324645996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6579909324645996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6580061912536621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6605849266052246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([93, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6632585525512695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6632585525512695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6634359359741211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6946554183959961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 93, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6814007759094238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6818199157714844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6822390556335449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6817989349365234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2811, 40])
input nodes number: 7975
output nodes number: 2811
edges number: 16540
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6818733215332031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6818737983703613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.02476215362548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 23 input nodes size: 18447
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.023262977600097656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.023262977600097656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0320591926574707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03208017349243164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020340442657470703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020775318145751953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020775318145751953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020775318145751953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([18447, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020775318145751953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([754, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04211711883544922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04211711883544922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04283618927001953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.048635005950927734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([870, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.049105167388916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.049105167388916016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04993486404418945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06270456314086914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([764, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06338739395141602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06338739395141602  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.06411600112915039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08020639419555664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([630, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08104372024536133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08104372024536133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.08164453506469727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0997166633605957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([555, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1007394790649414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1007394790649414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10126876831054688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12104272842407227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([450, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12206554412841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12206554412841797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12249469757080078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14094829559326172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([404, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14208221435546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14208221435546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14246749877929688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16173171997070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 404, 128])
m.shape torch.Size([348, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16286659240722656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16286659240722656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16319847106933594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1821155548095703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([319, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1833186149597168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1833186149597168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1836228370666504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2030930519104004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([2149, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21318817138671875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21318817138671875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 2149, 128]), torch.Size([1, 2149, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21523761749267578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36185312271118164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 2149, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34375524520874023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3506627082824707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35757017135620117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35060834884643555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([7243, 256])
first layer input nodes number: 18447
first layer output nodes number: 7243
edges number: 42754
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3577098846435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36461734771728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3663487434387207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3663487434387207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([510, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38174009323120117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38174009323120117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 510, 256]), torch.Size([1, 510, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38271284103393555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.39059877395629883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 510, 256])
m.shape torch.Size([489, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3910527229309082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3910527229309082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3919854164123535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4060959815979004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([353, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40669918060302734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40669918060302734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.40737247467041016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4231600761413574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([295, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42395782470703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42395782470703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.42452049255371094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44176578521728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([226, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44257068634033203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44257068634033203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44300174713134766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45851993560791016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45917558670043945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45917558670043945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.45946359634399414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4718480110168457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4726729393005371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4726729393005371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4729475975036621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4866805076599121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4873661994934082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4873661994934082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.48757028579711914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4992032051086426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.499819278717041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.499819278717041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.49997758865356445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5101094245910645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5106744766235352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5106744766235352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5108022689819336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5198755264282227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5204463005065918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5204463005065918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5205607414245605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.529487133026123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5299029350280762  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5299029350280762  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5299811363220215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.536628246307373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5371265411376953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5371265411376953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5372085571289062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5447540283203125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5451436042785645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5451436042785645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5452046394348145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5512471199035645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.551577091217041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.551577091217041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5516247749328613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5566792488098145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5569171905517578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5569171905517578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5569496154785156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5606136322021484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.560875415802002  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.560875415802002  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5609078407287598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5647988319396973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5650944709777832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5650944709777832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5651288032531738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5694890022277832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.569709300994873  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.569709300994873  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5697340965270996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.573056697845459  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5732946395874023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5732946395874023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5733194351196289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5768156051635742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5769848823547363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5769848823547363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5770020484924316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5795426368713379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5796613693237305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5796613693237305  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5796728134155273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.581446647644043  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5815739631652832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5815739631652832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5815854072570801  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5834393501281738  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5836181640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5836181640625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5836334228515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.586212158203125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([70, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5878868103027344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5878868103027344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5880203247070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6115188598632812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 70, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5993919372558594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5998096466064453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6002273559570312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5997886657714844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2803, 40])
input nodes number: 7243
output nodes number: 2803
edges number: 15371
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5998625755310059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5998630523681641  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.021656513214111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 24 input nodes size: 46648
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020339012145996094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.020339012145996094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.04258251190185547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.042603492736816406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03378629684448242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0349574089050293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0349574089050293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0349574089050293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([46648, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0349574089050293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([733, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09975099563598633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09975099563598633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10045003890991211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10680007934570312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([739, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10715532302856445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10715532302856445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10786008834838867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11843156814575195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([681, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11905336380004883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11905336380004883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11970281600952148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13455533981323242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([629, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1355581283569336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1355581283569336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13615798950195312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15447521209716797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([624, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15566301345825195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15566301345825195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15625810623168945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17836618423461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([580, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17972803115844727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17972803115844727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1802811622619629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2048478126525879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([544, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20638704299926758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20638704299926758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20690584182739258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23385286331176758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([513, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2355504035949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2355504035949707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2360396385192871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26480722427368164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([501, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26671266555786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26671266555786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26719045639038086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.29776906967163086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([10602, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3480844497680664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3480844497680664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 10602, 128]), torch.Size([1, 10602, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35819530487060547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.076406478881836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 10602, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.015890121459961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0312881469726562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0466861724853516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0311675071716309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([16146, 256])
first layer input nodes number: 46648
first layer output nodes number: 16146
edges number: 131811
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0470356941223145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0624337196350098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0665669441223145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0665669441223145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([446, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0913681983947754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0913681983947754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0922188758850098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0993895530700684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0996737480163574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0996737480163574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1003775596618652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1119494438171387  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([239, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1122870445251465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1122870445251465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1127429008483887  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1227717399597168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([189, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1232705116271973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1232705116271973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1236310005187988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1340851783752441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([176, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1347508430480957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1347508430480957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1350865364074707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1471714973449707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([133, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.147770881652832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.147770881652832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.148024559020996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1589326858520508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.159599781036377  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.159599781036377  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1598248481750488  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1710782051086426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([89, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1716504096984863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1716504096984863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1718201637268066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1814961433410645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1821985244750977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1821985244750977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1823720932006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1934804916381836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.194037914276123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.194037914276123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1941657066345215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2032389640808105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2037672996520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2037672996520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.203874111175537  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.212205410003662  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2126827239990234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2126827239990234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2127704620361328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2202281951904297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2208094596862793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2208094596862793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.22090482711792  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2296786308288574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2302637100219727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2302637100219727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2303533554077148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2392282485961914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2396736145019531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2396736145019531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2397384643554688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.246612548828125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2470722198486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2470722198486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2471332550048828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2540302276611328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.254408359527588  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.254408359527588  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2544560432434082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2601780891418457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2607078552246094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2607078552246094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2607688903808594  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2685203552246094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2688918113708496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2688918113708496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2689337730407715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2745566368103027  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2748627662658691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2748627662658691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.274895191192627  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2794671058654785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2798142433166504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2798142433166504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.279848575592041  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2849297523498535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2854413986206055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2854413986206055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2854890823364258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2928800582885742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2932324409484863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2932324409484863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2932648658752441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2985177040100098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2986860275268555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2986860275268555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.298701286315918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3012800216674805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([444, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.311941146850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.311941146850586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3127880096435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.468226432800293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 444, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4463324546813965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4467482566833496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4471640586853027  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4467272758483887  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2790, 40])
input nodes number: 16146
output nodes number: 2790
edges number: 25230
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4468669891357422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4468674659729004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.037056922912597656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 25 input nodes size: 45389
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03378438949584961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03378438949584961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05542755126953125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05544900894165039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03318452835083008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03420400619506836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03420400619506836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03420400619506836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([45389, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03420400619506836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([802, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0906820297241211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0906820297241211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.0914468765258789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09783029556274414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([800, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09821081161499023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09821081161499023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.09897375106811523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11041784286499023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([763, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11112785339355469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11112785339355469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11185550689697266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1282334327697754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([698, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12920093536376953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12920093536376953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 698, 128]), torch.Size([1, 698, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1298666000366211  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14986705780029297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 698, 128])
m.shape torch.Size([698, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1511983871459961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1511983871459961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 698, 128]), torch.Size([1, 698, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15186405181884766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1758279800415039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 698, 128])
m.shape torch.Size([567, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17711734771728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17711734771728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1776580810546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20178508758544922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([533, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2032938003540039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2032938003540039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20380210876464844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22936296463012695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([544, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2311840057373047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2311840057373047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2317028045654297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2612743377685547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([484, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2639446258544922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2639446258544922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2644062042236328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2939472198486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([8778, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3355731964111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3355731964111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 8778, 128]), torch.Size([1, 8778, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3439445495605469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9396963119506836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 8778, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.8875374794006348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9015250205993652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9155125617980957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9014153480529785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([14667, 256])
first layer input nodes number: 45389
first layer output nodes number: 14667
edges number: 114594
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9158530235290527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9298405647277832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9333376884460449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9333376884460449  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([490, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9551339149475098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9551339149475098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9560685157775879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9653072357177734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([396, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9656014442443848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9656014442443848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9663567543029785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9776864051818848  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9781222343444824  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9781222343444824  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9786601066589355  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9927620887756348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9933466911315918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9933466911315918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.9937701225280762  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.006049633026123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0068445205688477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0068445205688477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0072393417358398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0214529037475586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([133, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0220227241516113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0220227241516113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0222764015197754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.03318452835083  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0339055061340332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0339055061340332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0341458320617676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0461621284484863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.046872615814209  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.046872615814209  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0470786094665527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0588202476501465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([73, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0593490600585938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0593490600585938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.059488296508789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.068399429321289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0689449310302734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0689449310302734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0690670013427734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0777339935302734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0782546997070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0782546997070312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.078359603881836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0865421295166016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0870203971862793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0870203971862793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0871081352233887  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0945658683776855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0950469970703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0950469970703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0951271057128906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1024971008300781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([24, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1027803421020508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1027803421020508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1028261184692383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1073579788208008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.107940673828125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.107940673828125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1080207824707031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1165122985839844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.116933822631836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.116933822631836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1169910430908203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1234569549560547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1238207817077637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1238207817077637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1238665580749512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1293597221374512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1299424171447754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1299424171447754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1300091743469238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1384873390197754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.13905668258667  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.13905668258667  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1391196250915527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1475539207458496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1480417251586914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1480417251586914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1480932235717773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1553544998168945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1556315422058105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1556315422058105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1556601524353027  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1598944664001465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1602187156677246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1602187156677246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1602492332458496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1649794578552246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1651854515075684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1651854515075684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1652045249938965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1682944297790527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1685848236083984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1685848236083984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.168609619140625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.172800064086914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([304, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1800923347473145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1800923347473145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1806721687316895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2937579154968262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 304, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.275350570678711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.275770664215088  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2761907577514648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2757492065429688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2817, 40])
input nodes number: 14667
output nodes number: 2817
edges number: 22055
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2758846282958984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2758851051330566  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03609275817871094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 26 input nodes size: 50214
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.033188819885253906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.033188819885253906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.057132720947265625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05715370178222656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03548908233642578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03700542449951172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03700542449951172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03700542449951172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([50214, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03700542449951172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([516, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12036371231079102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12036371231079102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12085580825805664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12616395950317383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([577, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12646818161010742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12646818161010742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12701845169067383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13527250289916992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([589, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13583993911743164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13583993911743164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13640165328979492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14938116073608398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([548, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1501455307006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1501455307006836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15066814422607422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16669940948486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([599, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16786623001098633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16786623001098633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16843748092651367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19008255004882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([577, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19144773483276367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19144773483276367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19199800491333008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21601152420043945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([554, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21758556365966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21758556365966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21811389923095703  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24495506286621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([563, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24683856964111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24683856964111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24737548828125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2786073684692383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([614, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2809739112854004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2809739112854004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.28155946731567383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3206210136413574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([14410, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.389040470123291  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.389040470123291  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14410, 128]), torch.Size([1, 14410, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4027829170227051  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3784966468811035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14410, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2994661331176758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3189973831176758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3385286331176758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3188514709472656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([19547, 256])
first layer input nodes number: 50214
first layer output nodes number: 19547
edges number: 170094
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.338904857635498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.358436107635498  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.363142490386963  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.363142490386963  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([321, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3956828117370605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3956828117370605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3962950706481934  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4027438163757324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([244, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.402906894683838  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.402906894683838  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4033722877502441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.410353183746338  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([199, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4106945991516113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4106945991516113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.411074161529541  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4194245338439941  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([139, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.419769287109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.419769287109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.420034408569336  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4277229309082031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([147, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4282970428466797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4282970428466797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4285774230957031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4386711120605469  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([110, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4391655921936035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4391655921936035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.439375400543213  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.448397159576416  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4488844871520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4488844871520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.449052333831787  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.457444667816162  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4579377174377441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4579377174377441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.458080768585205  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4662346839904785  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([71, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4667773246765137  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4667773246765137  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4669127464294434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4755797386169434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4761176109313965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4761176109313965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4762377738952637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.484769344329834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4853968620300293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4853968620300293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.485520839691162  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4951910972595215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4958100318908691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4958100318908691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.495922565460205  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5054879188537598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5060691833496094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5060691833496094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5061664581298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.515115737915039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5157804489135742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5157804489135742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5158815383911133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5258893966674805  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5266175270080566  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5266175270080566  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5267205238342285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5376381874084473  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5382328033447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5382328033447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5383129119873047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5473651885986328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5479135513305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5479135513305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5479822158813477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5562219619750977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5580077171325684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5580077171325684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5581183433532715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5721678733825684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5728249549865723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5728249549865723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.572899341583252  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.58286714553833  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.583695411682129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.583695411682129  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5837812423706055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5958833694458008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.597661018371582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.597661018371582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.597764015197754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6130075454711914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6134848594665527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6134848594665527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.613532543182373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6209235191345215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6215853691101074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6215853691101074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6216444969177246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.631223201751709  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.632070541381836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.632070541381836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6321430206298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6443920135498047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([666, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6603589057922363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6603589057922363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 666, 256]), torch.Size([1, 666, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6616291999816895  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8929457664489746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 666, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.863025188446045  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.863438606262207  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8638520240783691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.863417625427246  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2773, 40])
input nodes number: 19547
output nodes number: 2773
edges number: 33408
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8635778427124023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8635783195495605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03960752487182617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 27 input nodes size: 45277
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03548240661621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03548240661621094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05707216262817383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05709362030029297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03312873840332031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03437328338623047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03437328338623047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03437328338623047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([45277, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03437328338623047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([610, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10273456573486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10273456573486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1033163070678711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10865449905395508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([739, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10906839370727539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10906839370727539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10977315902709961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12127923965454102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([772, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12203121185302734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12203121185302734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12276744842529297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13927173614501953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([643, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14013004302978516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14013004302978516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14074325561523438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15871524810791016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([679, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16002750396728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16002750396728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.160675048828125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18487977981567383  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([638, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18638134002685547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18638134002685547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18698978424072266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2138223648071289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([553, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2153639793395996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2153639793395996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21589136123657227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24242115020751953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([540, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2442173957824707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2442173957824707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24473237991333008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2748551368713379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([541, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2769193649291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2769193649291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.277435302734375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.311154842376709  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([11082, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3637399673461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3637399673461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 11082, 128]), torch.Size([1, 11082, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37430858612060547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1262969970703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 11082, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0622944831848145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0783133506774902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.094332218170166  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0781879425048828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([16797, 256])
first layer input nodes number: 45277
first layer output nodes number: 16797
edges number: 138079
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0946717262268066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1106905937194824  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1149439811706543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1149439811706543  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([318, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1430749893188477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1430749893188477  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.143681526184082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.149765968322754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([322, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1500821113586426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1500821113586426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1506962776184082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1599087715148926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([276, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1603975296020508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1603975296020508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.160923957824707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1728487014770508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([195, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1733355522155762  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1733355522155762  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1737074851989746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1844935417175293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1851582527160645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1851582527160645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1854958534240723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1976494789123535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([135, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1982593536376953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1982593536376953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.198516845703125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2095890045166016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([100, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2101330757141113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2101330757141113  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2103238105773926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.219860553741455  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2204804420471191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2204804420471191  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2206578254699707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2307686805725098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([71, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2312941551208496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2312941551208496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2314295768737793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2400965690612793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.240797996520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.240797996520996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.240950584411621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.251784324645996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.252363681793213  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.252363681793213  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2524819374084473  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2617058753967285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2622466087341309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2622466087341309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.262345790863037  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2707762718200684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2715015411376953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2715015411376953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2716197967529297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2824993133544922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.283045768737793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.283045768737793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2831315994262695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2916288375854492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2922492027282715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2922492027282715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2923369407653809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3016371726989746  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3023624420166016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3023624420166016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3024578094482422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3132343292236328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.31382417678833  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.31382417678833  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3138985633850098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3228249549865723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3233933448791504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3233933448791504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3234601020812988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3319382667541504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3324346542358398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3324346542358398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3324899673461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3399019241333008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3403167724609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3403167724609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3403606414794922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3465461730957031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3470492362976074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3470492362976074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3470988273620605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.354438304901123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3548364639282227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3548364639282227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.354874610900879  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3607873916625977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.361100196838379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.361100196838379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.361128807067871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3657636642456055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3662571907043457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3662571907043457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3662991523742676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3733906745910645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([531, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3861289024353027  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3861289024353027  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 531, 256]), torch.Size([1, 531, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3871417045593262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5707688331604004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 531, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5460329055786133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5464539527893066  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5464324951171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2824, 40])
input nodes number: 16797
output nodes number: 2824
edges number: 28818
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5465869903564453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5465874671936035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03658771514892578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 28 input nodes size: 45491
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03313636779785156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03313636779785156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05482816696166992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05484914779663086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03323793411254883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03449296951293945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03449296951293945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03449296951293945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([45491, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03449296951293945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([667, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.103759765625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.103759765625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 667, 128]), torch.Size([1, 667, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10439586639404297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11046600341796875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 667, 128])
m.shape torch.Size([681, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11079740524291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11079740524291992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11144685745239258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12118864059448242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([684, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1218423843383789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1218423843383789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12249469757080078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13718318939208984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([684, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13816165924072266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13816165924072266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13881397247314453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1577310562133789  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([574, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15877342224121094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15877342224121094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15932083129882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18015384674072266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([574, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18152236938476562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18152236938476562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1820697784423828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20621681213378906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([505, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20762872695922852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20762872695922852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20811033248901367  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23219060897827148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([494, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23383426666259766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23383426666259766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23430538177490234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26115894317626953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([463, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2629103660583496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2629103660583496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2633519172668457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2916111946105957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([11627, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.346832275390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.346832275390625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 11627, 128]), torch.Size([1, 11627, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.35792064666748047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1461067199707031  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 11627, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0814237594604492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0975914001464844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1137590408325195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.0974650382995605  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([16953, 256])
first layer input nodes number: 45491
first layer output nodes number: 16953
edges number: 141055
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1140999794006348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.13026762008667  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1343097686767578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1343097686767578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([387, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.161078929901123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.161078929901123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1618170738220215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1681737899780273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([314, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1684083938598633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1684083938598633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1690073013305664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1783685684204102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([257, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1788105964660645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1788105964660645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1793007850646973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1924724578857422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1930427551269531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1930427551269531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1934471130371094  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2051734924316406  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([155, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.205716609954834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.205716609954834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.20601224899292  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2166552543640137  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([127, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2172398567199707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2172398567199707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.217482089996338  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.227898120880127  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([100, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.228449821472168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.228449821472168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2286405563354492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2381772994995117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([79, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2386894226074219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2386894226074219  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.238840103149414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2474288940429688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([70, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2479591369628906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2479591369628906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2480926513671875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2566375732421875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.25726318359375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.25726318359375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2574005126953125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.26715087890625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.267632007598877  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.267632007598877  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2677311897277832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2754673957824707  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.276167869567871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.276167869567871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.276291847229004  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.286829948425293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2874178886413574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2874178886413574  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2875170707702637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2966418266296387  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2971577644348145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2971577644348145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2972378730773926  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.305168628692627  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3055758476257324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3055758476257324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3056349754333496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3119025230407715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.312242031097412  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.312242031097412  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3122878074645996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.317460536956787  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.318009853363037  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.318009853363037  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3180766105651855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.326087474822998  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3264694213867188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3264694213867188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3265151977539062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3323287963867188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3329086303710938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3329086303710938  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3329715728759766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3414058685302734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3419127464294434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3419127464294434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.341966152191162  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3494963645935059  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3499140739440918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3499140739440918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3499560356140137  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3561663627624512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3565049171447754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3565049171447754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3565373420715332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3615632057189941  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.362055778503418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.362055778503418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3620996475219727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.369206428527832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3695077896118164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3695077896118164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3695344924926758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3740472793579102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([524, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.386624813079834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.386624813079834  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 524, 256]), torch.Size([1, 524, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3876242637634277  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5681147575378418  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 524, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5441060066223145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5445175170898438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.544929027557373  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5444965362548828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2759, 40])
input nodes number: 16953
output nodes number: 2759
edges number: 27333
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5446343421936035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5446348190307617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03669261932373047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 29 input nodes size: 42292
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.033228397369384766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.033228397369384766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05339479446411133  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.053415775299072266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03170299530029297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03301525115966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03301525115966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03301525115966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([42292, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03301525115966797  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([594, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10434579849243164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10434579849243164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10491228103637695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10962915420532227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([607, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1099247932434082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1099247932434082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1105036735534668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1191868782043457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([581, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11972856521606445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11972856521606445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12028264999389648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13276243209838867  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([535, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13350582122802734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13350582122802734  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1340160369873047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14971256256103516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([529, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1509718894958496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1509718894958496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.15147638320922852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1702580451965332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([526, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1715106964111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1715106964111328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1720123291015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19358253479003906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([512, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19504070281982422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19504070281982422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.19552898406982422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21994304656982422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([469, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22148799896240234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22148799896240234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.22193527221679688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.24742984771728516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([466, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2492060661315918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2492060661315918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2496504783630371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2780928611755371  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([12235, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3362116813659668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3362116813659668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 12235, 128]), torch.Size([1, 12235, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.34787988662719727  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.179304599761963  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 12235, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1116538047790527  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.127917766571045  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.144181728363037  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1277904510498047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([17054, 256])
first layer input nodes number: 42292
first layer output nodes number: 17054
edges number: 145372
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1444988250732422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1607627868652344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1648287773132324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1648287773132324  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([349, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1948132514953613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1948132514953613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.195478916168213  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.202897071838379  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([264, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2030720710754395  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2030720710754395  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.203575611114502  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2113275527954102  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([251, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2117996215820312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2117996215820312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2122783660888672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2228107452392578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([161, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2231907844543457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2231907844543457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2234978675842285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.23240327835083  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([139, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2329177856445312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2329177856445312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2331829071044922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.242727279663086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([119, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.243281364440918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.243281364440918  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2435083389282227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2532682418823242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([104, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.253854751586914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.253854751586914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2540531158447266  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2639713287353516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([50, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2642569541931152  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2642569541931152  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2643523216247559  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2697882652282715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2704415321350098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2704415321350098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2705960273742676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2804837226867676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2810893058776855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2810893058776855  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2812247276306152  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.290839672088623  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2914700508117676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2914700508117676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2915959358215332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.301414966583252  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3021020889282227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3021020889282227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3022260665893555  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3127641677856445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3133645057678223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3133645057678223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3134655952453613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.322765827178955  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3232269287109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3232269287109375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3232994079589844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.330474853515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3311595916748047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3311595916748047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3312549591064453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3413639068603516  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3419928550720215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3419928550720215  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3420767784118652  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.351560115814209  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3520574569702148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3520574569702148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3521203994750977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3596735000610352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3603515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3603515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3604297637939453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.370361328125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.370851993560791  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.370851993560791  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3709073066711426  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.378319263458252  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3787918090820312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3787918090820312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3788414001464844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.385833740234375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3865761756896973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3865761756896973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3866486549377441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3973755836486816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3978681564331055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3978681564331055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3979158401489258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4053068161010742  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.405703067779541  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.405703067779541  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4057393074035645  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4116101264953613  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4120073318481445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4120073318481445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4120416641235352  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4178438186645508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([624, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4328203201293945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4328203201293945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4340105056762695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6497540473937988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 624, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6226601600646973  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6230711936950684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6234822273254395  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6230502128601074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2758, 40])
input nodes number: 17054
output nodes number: 2758
edges number: 30618
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6231980323791504  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6231985092163086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.035284996032714844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 30 input nodes size: 41505
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.031702518463134766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.031702518463134766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05149364471435547  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05151557922363281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03132820129394531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03275489807128906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03275489807128906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03275489807128906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([41505, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03275489807128906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([425, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10808992385864258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10808992385864258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.10849523544311523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11173772811889648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([472, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1119852066040039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1119852066040039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11243534088134766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1191873550415039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([475, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11964178085327148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11964178085327148  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12009477615356445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13006067276000977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([473, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1307363510131836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1307363510131836  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13118743896484375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14426898956298828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([481, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1457366943359375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1457366943359375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1461954116821289  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16270923614501953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([495, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1638960838317871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1638960838317871  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1643681526184082  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18466711044311523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([488, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18605995178222656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18605995178222656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1865253448486328  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2097949981689453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([477, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2113819122314453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2113819122314453  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2118368148803711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23776626586914062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([464, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23953008651733398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23953008651733398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23997259140014648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2682929039001465  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([13231, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3311619758605957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3311619758605957  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 13231, 128]), torch.Size([1, 13231, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3437800407409668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2440600395202637  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 13231, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1715140342712402  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.188185214996338  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2048563957214355  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.1880545616149902  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([17481, 256])
first layer input nodes number: 41505
first layer output nodes number: 17481
edges number: 153779
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2051677703857422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2218389511108398  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2267990112304688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2267990112304688  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([259, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2633233070373535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2633233070373535  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.263817310333252  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2679009437561035  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([227, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2680907249450684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2680907249450684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2685236930847168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2750182151794434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([186, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2753381729125977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2753381729125977  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2756929397583008  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2834978103637695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([155, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2839164733886719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2839164733886719  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2842121124267578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.29278564453125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([129, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2932581901550293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2932581901550293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.293504238128662  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3023619651794434  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([113, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3028907775878906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3028907775878906  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3031063079833984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3123741149902344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3129057884216309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3129057884216309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.313086986541748  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3221468925476074  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([92, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3227639198303223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3227639198303223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.322939395904541  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3329415321350098  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3336238861083984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3336238861083984  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3337936401367188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3446578979492188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3453035354614258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3453035354614258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3454484939575195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3557405471801758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3564190864562988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3564190864562988  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3565545082092285  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3671174049377441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3678803443908691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3678803443908691  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3680176734924316  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3796906471252441  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3804593086242676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3804593086242676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.380587100982666  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3923439979553223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3930740356445312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3930740356445312  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3931865692138672  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.404327392578125  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4050211906433105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4050211906433105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4051203727722168  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4156336784362793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.41652250289917  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.41652250289917  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4166388511657715  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.429786205291748  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4305615425109863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4305615425109863  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4306588172912598  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4423317909240723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4430789947509766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4430789947509766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.443166732788086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4543094635009766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4551973342895508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4551973342895508  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4552946090698242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4683294296264648  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.470160961151123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.470160961151123  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.470262050628662  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.48451566696167  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4853734970092773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4853734970092773  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.485459327697754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4981622695922852  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4985847473144531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4985847473144531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.498626708984375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5051307678222656  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5059499740600586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5059499740600586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5060224533081055  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5177640914916992  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5186967849731445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5186967849731445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5187768936157227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5323152542114258  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([772, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5512399673461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5512399673461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 772, 256]), torch.Size([1, 772, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5527124404907227  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.813218593597412  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 772, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.779402732849121  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7798385620117188  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7802743911743164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7798166275024414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2923, 40])
input nodes number: 17481
output nodes number: 2923
edges number: 37609
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.779994010925293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7799944877624512  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.035221099853515625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

pseudo mini batch 31 input nodes size: 48208
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.031352996826171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.031352996826171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.054790496826171875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.05481147766113281  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.034998416900634766  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03648710250854492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03648710250854492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03648710250854492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([48208, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03648710250854492  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([586, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11815834045410156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11815834045410156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11871719360351562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12318801879882812  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([567, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12344932556152344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12344932556152344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.12399005889892578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13222360610961914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([568, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1327657699584961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1327657699584961  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13330745697021484  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1461191177368164  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([580, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14695453643798828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.14695453643798828  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1475076675415039  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16429615020751953  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([539, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16530466079711914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.16530466079711914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1658186912536621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18536758422851562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([526, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1866154670715332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1866154670715332  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1871170997619629  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.20966196060180664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([514, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21112680435180664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21112680435180664  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.21161699295043945  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23618078231811523  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([499, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2378392219543457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2378392219543457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23831510543823242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2654404640197754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([534, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26749420166015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.26749420166015625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2680034637451172  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.30113887786865234  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([14258, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36887168884277344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.36887168884277344  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 14258, 128]), torch.Size([1, 14258, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.38246917724609375  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.348337173461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 14258, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2708873748779297  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.289170265197754  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3074531555175781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.289027214050293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([19171, 256])
first layer input nodes number: 48208
first layer output nodes number: 19171
edges number: 166571
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.307814598083496  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3260974884033203  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3310127258300781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3310127258300781  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

m.shape torch.Size([364, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3632431030273438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3632431030273438  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3639373779296875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3716316223144531  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([260, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3717846870422363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3717846870422363  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3722805976867676  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3806071281433105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([193, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3809161186218262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3809161186218262  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.381284236907959  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3893828392028809  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([146, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3897604942321777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3897604942321777  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3900389671325684  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3981146812438965  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([115, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3985280990600586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3985280990600586  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.398747444152832  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4066438674926758  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([97, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4070940017700195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4070940017700195  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4072790145874023  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4152345657348633  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([85, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4157142639160156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4157142639160156  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4158763885498047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4239826202392578  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([79, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.424509048461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.424509048461914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4246597290039062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.433248519897461  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4338479042053223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4338479042053223  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4339966773986816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4435181617736816  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.444145679473877  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.444145679473877  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4442849159240723  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4541707038879395  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4548521041870117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4548521041870117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4549875259399414  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.465550422668457  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4661636352539062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4661636352539062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4662761688232422  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4758415222167969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4763975143432617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4763975143432617  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4764909744262695  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4850893020629883  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4854464530944824  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4854464530944824  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4855036735534668  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.49116849899292  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.491659164428711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.491659164428711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4917278289794922  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4990062713623047  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.499587059020996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.499587059020996  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4996633529663086  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.508284568786621  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5087532997131348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5087532997131348  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.508812427520752  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5159077644348145  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5164146423339844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5164146423339844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5164737701416016  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5239830017089844  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5245561599731445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5245561599731445  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5246191024780273  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5330533981323242  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.53375244140625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.53375244140625  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5338249206542969  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5440444946289062  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5445938110351562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5445938110351562  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5446491241455078  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.552835464477539  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5533366203308105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5533366203308105  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5533843040466309  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5607752799987793  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5613484382629395  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5613484382629395  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5613999366760254  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5697426795959473  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5703167915344238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5703167915344238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.570366382598877  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.578747272491455  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([743, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5965757369995117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5965757369995117  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

 h.shape torch.Size([1, 743, 256]), torch.Size([1, 743, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5979928970336914  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes
Using backend: pytorch

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8513188362121582  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

rst.shape  torch.Size([1, 743, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8216595649719238  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.822070598602295  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.822481632232666  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.822049617767334  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

torch.Size([2758, 40])
input nodes number: 19171
output nodes number: 2758
edges number: 33040
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8221888542175293  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8221893310546875  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03901815414428711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03901815414428711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.03901815414428711  GigaBytes
Max Memory Allocated: 1.9326300621032715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008322589099407196 |0.0014335140585899353 |0.11740147322416306 |8.57040286064148e-05 |0.07674762606620789 |0.004853963851928711 |
----------------------------------------------------------pseudo_mini_loss sum 3.90187931060791
Total (block generation + training)time/epoch 27.974318861961365
Training time/epoch 6.713806867599487
Training time without block to device /epoch 6.667934417724609
Training time without total dataloading part /epoch 6.220367670059204
load block tensor time/epoch 0.2663228511810303
block to device time/epoch 0.04587244987487793
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1165617
Number of first layer input nodes during this epoch:  834032
Number of first layer output nodes during this epoch:  331585
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
